This file is a merged representation of a subset of the codebase, containing files not matching ignore patterns, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of a subset of the repository's contents that is considered the most important context.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching these patterns are excluded: **/*.lock, **/node_modules/**, **/.next/**, **/dist/**, **/.git/**
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.eslintrc.cjs
.gitignore
index.html
legacy_html/active_chat_thread.html
legacy_html/advanced_monthly_schedule.html
legacy_html/coach_profile_&_dashboard.html
legacy_html/home_dashboard.html
legacy_html/login_screen.html
legacy_html/notification_&_shift_logs.html
legacy_html/player_subscription_detail.html
legacy_html/skill_evaluation_detail.html
legacy_html/team_chat_&_communication.html
lint_output.txt
package.json
postcss.config.js
project_analysis.zip
public/manifest.json
public/wibo_assets/Actions/wibo_coach_checklist.png
public/wibo_assets/Actions/wibo_gym_handstand_v2.png
public/wibo_assets/Actions/wibo_gym_handstand.png
public/wibo_assets/Actions/wibo_gym_treadmill_v2.png
public/wibo_assets/Actions/wibo_gym_treadmill.png
public/wibo_assets/Events/wibo_event_back_to_school.png
public/wibo_assets/Events/wibo_event_birthday_cake.png
public/wibo_assets/Events/wibo_event_finish_line.png
public/wibo_assets/Events/wibo_event_summer_beach.png
public/wibo_assets/Events/wibo_event_winter_cocoa.png
public/wibo_assets/Feedback/wibo_score_10_out_of_10_copy.png
public/wibo_assets/Feedback/wibo_score_10_out_of_10.png
public/wibo_assets/Gamification/wibo_level_up_jetpack.png
public/wibo_assets/Gamification/wibo_reward_treasure_chest.png
public/wibo_assets/Gamification/wibo_skill_master_hero.png
public/wibo_assets/States/wibo_health_recovery_nurse.png
public/wibo_assets/States/wibo_hydration_drink.png
public/wibo_assets/States/wibo_maintenance_worker.png
public/wibo_assets/States/wibo_sleep_pillow_v2.png
public/wibo_assets/States/wibo_sleep_pillow.png
public/wibo_assets/States/wibo_yoga_meditation.png
public/wibo_assets/UI/wibo_analytics_chart.png
public/wibo_assets/UI/wibo_announcement_megaphone.png
public/wibo_assets/UI/wibo_message_mailman.png
public/wibo_assets/UI/wibo_search_magnifier_v2.png
public/wibo_assets/UI/wibo_search_magnifier.png
public/wibo_assets/UI/wibo_security_shield.png
scripts/check_users.js
scripts/create_missing_profile.sql
scripts/decommission_device_limits.sql
scripts/emergency_db_fix.sql
scripts/fix_profiles_rls.sql
scripts/fix_signup_trigger.sql
scripts/smart_displacement.sql
src/App.jsx
src/components/AddAthleteModal.jsx
src/components/AuthGuard.jsx
src/components/cards/AthleteCard.jsx
src/components/ChatWidget.jsx
src/components/CommandPalette.jsx
src/components/CookieConsent.jsx
src/components/dashboard/ActionCard.jsx
src/components/dashboard/ChecklistWidget.jsx
src/components/dashboard/NextMissionCard.jsx
src/components/DevTools/ChaosMonkey.jsx
src/components/EmptyState.jsx
src/components/ErrorBoundary.jsx
src/components/evaluation/EvaluationCard.jsx
src/components/FeedbackModal.jsx
src/components/forms/AthleteInviteForm.jsx
src/components/forms/StaffInviteForm.jsx
src/components/GranularErrorBoundary.jsx
src/components/InviteStaffModal.jsx
src/components/InvoiceDetailModal.jsx
src/components/Layout.jsx
src/components/MobileNav.jsx
src/components/modals/CreateAcademyModal.jsx
src/components/onboarding/SetupModal.jsx
src/components/OperationsFAB.jsx
src/components/ProtectedRoute.jsx
src/components/RoleSwitcher.jsx
src/components/SafeRoleSwitcher.jsx
src/components/SecurityCheckpoint.jsx
src/components/ui/BottomSheet.jsx
src/components/ui/EmptyState.jsx
src/components/ui/Modal.jsx
src/components/UserAvatar.jsx
src/components/VideoModal.jsx
src/context/RoleContext.jsx
src/context/ThemeContext.jsx
src/context/UserContext.jsx
src/hooks/useGeofencing.js
src/index.css
src/layouts/CoachLayout.jsx
src/layouts/OwnerLayout.jsx
src/layouts/StudentLayout.jsx
src/main.jsx
src/pages/Athlete/Achievements.jsx
src/pages/Athlete/AthleteHome.jsx
src/pages/Athlete/Billing.jsx
src/pages/Athlete/Settings.jsx
src/pages/AthleteLogin.jsx
src/pages/auth/AcademyWizard.jsx
src/pages/auth/AuthCallback.jsx
src/pages/auth/FakeCheckout.jsx
src/pages/auth/Login.jsx
src/pages/auth/MobileLogin.jsx
src/pages/auth/Pricing.jsx
src/pages/auth/SetupAccount.jsx
src/pages/auth/Signup.jsx
src/pages/Chat.jsx
src/pages/ChatDetail.jsx
src/pages/coach/CoachHome.jsx
src/pages/coach/Earnings.jsx
src/pages/coach/management/Analytics.jsx
src/pages/coach/management/FinanceDashboard.jsx
src/pages/coach/management/SalesAdminDashboard.jsx
src/pages/coach/management/StaffManagement.jsx
src/pages/coach/MasterCalendar.jsx
src/pages/coach/Profile.jsx
src/pages/coach/Roster.jsx
src/pages/coach/Schedule.jsx
src/pages/coach/SessionCommander.jsx
src/pages/coach/Settings.jsx
src/pages/coach/Support.jsx
src/pages/CoachProfile.jsx
src/pages/ComingSoon.jsx
src/pages/Home.jsx
src/pages/JoinTeam.jsx
src/pages/Landing.jsx
src/pages/LoginSelection.jsx
src/pages/MasterSchedule.jsx
src/pages/NotFound.jsx
src/pages/onboarding/SetupWizard.jsx
src/pages/owner/AcademySetup.jsx
src/pages/owner/AthletesRoster.jsx
src/pages/owner/Dashboard.jsx
src/pages/owner/OwnerDashboard.jsx
src/pages/owner/StaffRoster.jsx
src/pages/ParentPortal.jsx
src/pages/PaymentGateway.jsx
src/pages/PlayerDetail.jsx
src/pages/Schedule.jsx
src/pages/Settings.jsx
src/pages/SkillEvaluation.jsx
src/pages/SubscriptionPlans.jsx
src/services/supabaseService.js
src/supabaseClient.js
src/utils/auth-guard.ts
src/utils/constants.js
src/utils/pdfUtils.js
src/utils/supabase/server.ts
supabase/assign_roles.sql
supabase/create_invitations.sql
supabase/emergency_fix.sql
supabase/emergency_rls_fix.sql
supabase/enterprise_foundation.sql
supabase/express_setup_fix.sql
supabase/fix_academy_rls_and_schema.sql
supabase/fix_academy_setup.sql
supabase/fix_coach_role.sql
supabase/fix_missing_columns.sql
supabase/fix_rls_sessions.sql
supabase/fix_student_role.sql
supabase/fix_type_column.sql
supabase/fix_unique_constraint.sql
supabase/functions/create-user/index.ts
supabase/reset_sessions_table.sql
supabase/rpc_force_device.sql
supabase/seed_users.sql
supabase/setup_pricing_infrastructure.sql
supabase/strict_fix.sql
supabase/universal_fix.sql
supabase/upgrade_schema_enterprise.sql
tailwind.config.js
vercel.json
vite.config.js
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".eslintrc.cjs">
module.exports = {
    root: true,
    env: { browser: true, es2020: true },
    extends: [
        'eslint:recommended',
        'plugin:react/recommended',
        'plugin:react/jsx-runtime',
        'plugin:react-hooks/recommended',
    ],
    ignorePatterns: ['dist', '.eslintrc.cjs'],
    parserOptions: { ecmaVersion: 'latest', sourceType: 'module' },
    settings: { react: { version: '18.2' } },
    plugins: ['react-refresh'],
    rules: {
        'react-refresh/only-export-components': [
            'warn',
            { allowConstantExport: true },
        ],
        'react/prop-types': 'off', // Disable prop-types as we're moving fast
        'no-unused-vars': 'warn',
    },
}
</file>

<file path=".gitignore">
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?
</file>

<file path="index.html">
<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/wibo_assets/Gamification/wibo_skill_master_hero.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#10b981" />
    <title>Wild Robot | Intelligent Gym OS</title>
    <meta name="description"
        content="Elevate your gymnastics academy with WIBO. The AI-powered platform for tracking athletes, skills, and attendance." />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Wild Robot | Intelligent Gym OS" />
    <meta property="og:description"
        content="Elevate your gymnastics academy with WIBO. The AI-powered platform for tracking athletes, skills, and attendance." />
    <meta property="og:image" content="/wibo_assets/Gamification/wibo_skill_master_hero.png" />

    <!-- Google Fonts for Lexend -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>

<body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
</body>

</html>
</file>

<file path="legacy_html/active_chat_thread.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Active Chat Thread</title>
<!-- Fonts -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<!-- Tailwind Config -->
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#10b77f",
                        "primary-dark": "#0d9668",
                        "background-light": "#f6f8f7",
                        "background-dark": "#10221c",
                        "surface-light": "#ffffff",
                        "surface-dark": "#1c2e28",
                        "bubble-incoming": "#eef2f1",
                        "bubble-incoming-dark": "#2a3d37",
                        "text-main": "#111816",
                        "text-secondary": "#61897c",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "2xl": "2rem", 
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style>
        /* Custom scrollbar for webkit */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        
        .safe-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
    </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark font-display text-text-main dark:text-gray-100 antialiased h-screen flex flex-col overflow-hidden">
<!-- Sticky Header -->
<header class="bg-surface-light dark:bg-surface-dark border-b border-gray-100 dark:border-gray-800 shrink-0 z-20">
<div class="flex items-center justify-between px-4 py-3">
<!-- Back Button -->
<button class="flex items-center justify-center w-10 h-10 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-text-main dark:text-white">
<span class="material-symbols-outlined" style="font-size: 24px;">arrow_back_ios_new</span>
</button>
<!-- Centered Group Info -->
<div class="flex flex-col items-center justify-center flex-1 mx-2 cursor-pointer">
<div class="relative mb-1">
<!-- Avatar Stack representation or single group avatar -->
<div class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 bg-cover bg-center border-2 border-white dark:border-surface-dark shadow-sm" data-alt="Gymnastics coach group avatar showing a blurred gym background" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuAIkM8xSoDI-jKL8lilD9S8yGBiKvY4KQv7Z4OJXNYyAj0kjp9QmjzT4KNx3CCLcxo5LA_FU9LULuBiecDFXSM1GFq81DfBTlU0soSXs6BLIs9xTX0nzu0OP-uYAbeu2rT-mgTiJ_cjreQ4c1etXBgTTPcqUdFUYOdVGtVpADjQW5hcXUOXbDk_SXOMC08mAO_jk1kbNdkisz3oO-3xae-1Zy_j0UzoEvwz1tEkLUhZg5NlzFSwwoylf4jaZGn6lw5YyPxqy3EfYJIf');">
</div>
<div class="absolute -bottom-0.5 -right-0.5 w-3.5 h-3.5 bg-green-500 border-2 border-white dark:border-surface-dark rounded-full"></div>
</div>
<h1 class="text-sm font-bold text-text-main dark:text-white leading-tight">Tilal Coaches Group ðŸ”µ</h1>
<p class="text-xs text-text-secondary dark:text-gray-400 font-medium mt-0.5">
                    8 members, <span class="text-primary font-bold">2 online</span>
</p>
</div>
<!-- Info Button -->
<button class="flex items-center justify-center w-10 h-10 -mr-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-text-main dark:text-white">
<span class="material-symbols-outlined" style="font-size: 26px;">info</span>
</button>
</div>
</header>
<!-- Chat Area -->
<main class="flex-1 overflow-y-auto overflow-x-hidden p-4 space-y-6 scroll-smooth bg-background-light dark:bg-background-dark">
<!-- Date Separator -->
<div class="flex justify-center pt-2">
<span class="bg-surface-light dark:bg-surface-dark/50 text-text-secondary dark:text-gray-400 text-xs font-semibold px-3 py-1 rounded-full shadow-sm border border-gray-100 dark:border-gray-800">
                Today 9:41 AM
            </span>
</div>
<!-- Incoming Message (Sarah) -->
<div class="flex items-end gap-3 group">
<div class="bg-gray-200 dark:bg-gray-700 w-8 h-8 rounded-full shrink-0 bg-cover bg-center mb-1 shadow-sm" data-alt="Portrait of Sarah Coach smiling" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuCoBbE7SzSNwt2H2LZJr-aqHZLr3_f195BT_iiq_GgBpuicwjzILeDHSl6h7VwFH95ZZ-CJ3tsDxVyye614SazYMrlAlvjoC9Tgwh7M2nregzpgt07_xrFl2TeqpD03Ly-vbCk21UL5QXDRRNuhBBa3WIR7P_ZVJtAOLdUMRRX9M2Kc7daA4mvdMMfo9nhxEnd6HFQeYodC-wEcSwUppkLLxriaMmTJCatKJ95P_SAe_4DXJmBUjX8EnRYbjcH3lR2wvPt89Tf0ZEly');">
</div>
<div class="flex flex-col gap-1 max-w-[75%] sm:max-w-[60%]">
<span class="text-xs text-text-secondary dark:text-gray-400 font-medium ml-1">Sarah Coach</span>
<div class="p-4 bg-surface-light dark:bg-surface-dark text-text-main dark:text-gray-100 text-[15px] leading-relaxed rounded-2xl rounded-tl-none shadow-sm border border-gray-100 dark:border-gray-800">
<p>Has everyone seen the updated schedule for beam rotation?</p>
</div>
</div>
</div>
<!-- Outgoing Message (Me) -->
<div class="flex items-end justify-end gap-3 group">
<div class="flex flex-col items-end gap-1 max-w-[75%] sm:max-w-[60%]">
<!-- No name label for self usually in modern chat, but nice to have structure -->
<div class="p-4 bg-primary text-white text-[15px] leading-relaxed rounded-2xl rounded-tr-none shadow-md">
<p>Yes, downloaded it this morning. Looks good.</p>
</div>
<!-- Read receipt / status -->
<span class="text-[10px] text-text-secondary dark:text-gray-500 font-medium flex items-center gap-1 mr-1">
                    9:43 AM <span class="material-symbols-outlined text-primary" style="font-size: 14px;">done_all</span>
</span>
</div>
<!-- Optional: Self Avatar -->
<div class="bg-gray-200 dark:bg-gray-700 w-8 h-8 rounded-full shrink-0 bg-cover bg-center mb-6 shadow-sm" data-alt="Portrait of the user" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuCq-eR1FjCeumW7SCRagW8ZQwACfIo2oZ6I3Het6hUYIaE25E9JW7slN6Xw2UdRmh5GIK_z9PEuImgsw1-cwvVbyWgisgwL5Cy1eARlMtd8xMf9D5HB41gXV6743ujK_OE1K9JWlL18Pm47Qq6vxrcTJ-rfuq6ou_lrBtlo5XBpQGURoJnptVwTGGrmKP4izG40lbs7dMyx62VzuH3Sb3gNufS0YAjGjLEeTS2cdDZyI792cdvpxyJPq62BAcfvKXkJGhz4JZRvtIJp');">
</div>
</div>
<!-- Incoming Message (Sarah) -->
<div class="flex items-end gap-3 group">
<div class="bg-gray-200 dark:bg-gray-700 w-8 h-8 rounded-full shrink-0 bg-cover bg-center mb-1 shadow-sm" data-alt="Portrait of Sarah Coach smiling" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuC2FF9udBYT_j9JtSI_kWBSDkAOZjtRDnU_-jmpSwXrc8Iq4AOYt4CAfyOI7z5YKuUiNaH7-zVXARInuhk3PFtHHGd-96wvH8zI4lSiJnb3UGdwoaPmHZEZZBsmLfiKI60EU4aEo0Ms-NBEhiB-XvYoEALNM1RlQo7dkWa0QdSMommavQLiMMRvqInrEFKggSk3T-s_NnDUNUSKhUP_JQSu7YDyMTJPdrpDRApyfBRnofXIC_nNywj-t52q0Ag-zI31nBObgx9CSmkx');">
</div>
<div class="flex flex-col gap-1 max-w-[75%] sm:max-w-[60%]">
<span class="text-xs text-text-secondary dark:text-gray-400 font-medium ml-1">Sarah Coach</span>
<div class="p-4 bg-surface-light dark:bg-surface-dark text-text-main dark:text-gray-100 text-[15px] leading-relaxed rounded-2xl rounded-tl-none shadow-sm border border-gray-100 dark:border-gray-800">
<p>Great, let's meet 10 mins early to prep.</p>
</div>
</div>
</div>
<!-- Spacer for scrolling behind fixed footer -->
<div class="h-4"></div>
</main>
<!-- Fixed Input Area -->
<footer class="bg-surface-light dark:bg-surface-dark border-t border-gray-100 dark:border-gray-800 safe-bottom z-20">
<div class="flex items-end gap-2 p-3 sm:px-4 sm:py-3">
<!-- Attachment Button -->
<button class="shrink-0 flex items-center justify-center w-10 h-10 text-text-secondary dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 mb-[2px]">
<span class="material-symbols-outlined -rotate-45" style="font-size: 24px;">attach_file</span>
</button>
<!-- Input Field -->
<div class="flex-1 bg-background-light dark:bg-gray-800 rounded-3xl flex items-center min-h-[44px] border border-transparent focus-within:border-primary/50 focus-within:ring-2 focus-within:ring-primary/10 transition-all">
<textarea class="w-full bg-transparent border-none text-text-main dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:ring-0 resize-none py-3 px-4 text-[15px] max-h-32" placeholder="Type a message..." rows="1" style="min-height: 44px;"></textarea>
</div>
<!-- Mic Button (hidden when typing usually, but shown here per request) -->
<button class="shrink-0 flex items-center justify-center w-10 h-10 text-text-secondary dark:text-gray-400 hover:text-text-main dark:hover:text-white transition-colors rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 mb-[2px]">
<span class="material-symbols-outlined" style="font-size: 24px;">mic</span>
</button>
<!-- Send Button -->
<button class="shrink-0 flex items-center justify-center w-11 h-11 bg-primary hover:bg-primary-dark text-white rounded-full transition-all shadow-md active:scale-95 mb-[1px]">
<span class="material-symbols-outlined ml-0.5" style="font-size: 20px;">send</span>
</button>
</div>
</footer>
</body></html>
</file>

<file path="legacy_html/advanced_monthly_schedule.html">
<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Advanced Monthly Schedule</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#10b77f",
                        "background-light": "#f6f8f7",
                        "background-dark": "#10221c",
                        "branch-ajman": "#ec4899",
                        "branch-tilal": "#3b82f6",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: {"DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px"},
                    boxShadow: {
                        "glow-pink": "0 0 8px 1px rgba(236, 72, 153, 0.6)",
                        "glow-blue": "0 0 8px 1px rgba(59, 130, 246, 0.6)",
                    }
                },
            },
        }
    </script>
<style>
        body {
            font-family: 'Lexend', sans-serif;
        }.scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
<style>
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-white h-screen overflow-hidden flex flex-col">
<header class="flex-none bg-background-light dark:bg-background-dark p-4 flex items-center justify-between sticky top-0 z-10">
<button class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-800 transition-colors">
<span class="material-symbols-outlined text-slate-900 dark:text-white">chevron_left</span>
</button>
<h2 class="text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2">
            December 2025
            <span class="material-symbols-outlined text-sm opacity-50">arrow_drop_down</span>
</h2>
<button class="text-primary font-bold text-sm px-2 py-1 rounded hover:bg-primary/10 transition-colors">
            Today
        </button>
</header>
<main class="flex-1 overflow-y-auto px-2 pb-32">
<div class="grid grid-cols-7 mb-2">
<div class="text-center text-xs font-semibold text-slate-400 py-2">S</div>
<div class="text-center text-xs font-semibold text-slate-400 py-2">M</div>
<div class="text-center text-xs font-semibold text-slate-400 py-2">T</div>
<div class="text-center text-xs font-semibold text-slate-400 py-2">W</div>
<div class="text-center text-xs font-semibold text-slate-400 py-2">T</div>
<div class="text-center text-xs font-semibold text-slate-400 py-2">F</div>
<div class="text-center text-xs font-semibold text-slate-400 py-2">S</div>
</div>
<div class="grid grid-cols-7 gap-y-2 mb-4">
<div class="h-14"></div>
<div class="h-14"></div>
<div class="h-14"></div>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">1</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">2</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">3</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">4</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg bg-primary/10 dark:bg-primary/20 relative">
<span class="w-7 h-7 flex items-center justify-center rounded-full bg-primary text-white text-sm font-bold shadow-md">5</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink ring-1 ring-white dark:ring-slate-900"></div>
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue ring-1 ring-white dark:ring-slate-900"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">6</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">7</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">8</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">9</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink"></div>
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">10</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">11</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">12</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">13</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">14</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink"></div>
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">15</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">16</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">17</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">18</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">19</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink"></div>
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">20</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">21</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">22</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">23</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">24</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">25</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">26</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink"></div>
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">27</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">28</span>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">29</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-tilal shadow-glow-blue"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">30</span>
<div class="flex gap-1 mt-1">
<div class="w-2 h-2 rounded-full bg-branch-ajman shadow-glow-pink"></div>
</div>
</button>
<button class="h-14 w-full flex flex-col items-center justify-start pt-1 gap-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
<span class="text-sm font-medium text-slate-700 dark:text-slate-300">31</span>
</button>
</div>
<div class="flex items-center justify-center gap-6 mt-6 mb-12">
<div class="flex items-center gap-2">
<div class="w-3 h-3 rounded-full bg-branch-ajman shadow-glow-pink"></div>
<span class="text-xs font-medium text-slate-600 dark:text-slate-400">Ajman Branch</span>
</div>
<div class="flex items-center gap-2">
<div class="w-3 h-3 rounded-full bg-branch-tilal shadow-glow-blue"></div>
<span class="text-xs font-medium text-slate-600 dark:text-slate-400">Tilal Branch</span>
</div>
</div>
</main>
<div class="fixed bottom-0 left-0 right-0 bg-white dark:bg-slate-900 rounded-t-3xl shadow-[0_-5px_20px_-5px_rgba(0,0,0,0.1)] dark:shadow-[0_-5px_20px_-5px_rgba(0,0,0,0.5)] z-20 transform transition-transform duration-300 ease-out flex flex-col max-h-[50vh]">
<div class="w-full flex justify-center py-4 cursor-grab active:cursor-grabbing flex-none">
<div class="w-12 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full"></div>
</div>
<div class="px-6 pb-2 flex items-center justify-between flex-none">
<h3 class="text-xl font-bold text-slate-900 dark:text-white">Thursday, Dec 5</h3>
<span class="text-xs font-medium text-slate-500 bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded-md">2 Sessions</span>
</div>
<div class="flex-1 overflow-y-auto px-6 pb-24 scrollbar-hide">
<div class="mt-4 p-4 rounded-xl border border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-800 shadow-sm relative overflow-hidden group">
<div class="absolute top-0 left-0 bottom-0 w-1.5 bg-branch-ajman"></div>
<div class="flex justify-between items-start mb-2 pl-2">
<div>
<span class="text-xs font-bold text-branch-ajman uppercase tracking-wider mb-1 block">Ajman Branch</span>
<h4 class="text-base font-bold text-slate-900 dark:text-white leading-tight">Level 2 Gymnastics</h4>
</div>
<button class="text-slate-400 hover:text-primary transition-colors">
<span class="material-symbols-outlined">more_vert</span>
</button>
</div>
<div class="flex items-center gap-4 pl-2 mt-3">
<div class="flex items-center gap-1.5 text-slate-500 dark:text-slate-400">
<span class="material-symbols-outlined text-[18px]">schedule</span>
<span class="text-sm font-medium">4:00 PM - 5:30 PM</span>
</div>
<div class="flex items-center gap-1.5 text-slate-500 dark:text-slate-400">
<span class="material-symbols-outlined text-[18px]">group</span>
<span class="text-sm font-medium">12 Athletes</span>
</div>
</div>
<div class="mt-4 pl-2 flex gap-2">
<button class="flex-1 bg-primary text-white text-sm font-medium py-2 rounded-lg hover:bg-green-600 transition-colors shadow-sm shadow-green-200 dark:shadow-none">
                        Take Attendance
                    </button>
<button class="w-10 flex items-center justify-center bg-slate-50 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg border border-slate-200 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-600 transition-colors">
<span class="material-symbols-outlined text-[20px]">edit</span>
</button>
</div>
</div>
<div class="mt-4 p-4 rounded-xl border border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-800 shadow-sm relative overflow-hidden group">
<div class="absolute top-0 left-0 bottom-0 w-1.5 bg-branch-tilal"></div>
<div class="flex justify-between items-start mb-2 pl-2">
<div>
<span class="text-xs font-bold text-branch-tilal uppercase tracking-wider mb-1 block">Tilal Branch</span>
<h4 class="text-base font-bold text-slate-900 dark:text-white leading-tight">Elite Squad Training</h4>
</div>
<button class="text-slate-400 hover:text-primary transition-colors">
<span class="material-symbols-outlined">more_vert</span>
</button>
</div>
<div class="flex items-center gap-4 pl-2 mt-3">
<div class="flex items-center gap-1.5 text-slate-500 dark:text-slate-400">
<span class="material-symbols-outlined text-[18px]">schedule</span>
<span class="text-sm font-medium">6:30 PM - 8:00 PM</span>
</div>
<div class="flex items-center gap-1.5 text-slate-500 dark:text-slate-400">
<span class="material-symbols-outlined text-[18px]">group</span>
<span class="text-sm font-medium">8 Athletes</span>
</div>
</div>
<div class="mt-4 pl-2 flex gap-2">
<button class="flex-1 bg-primary text-white text-sm font-medium py-2 rounded-lg hover:bg-green-600 transition-colors shadow-sm shadow-green-200 dark:shadow-none">
                        Take Attendance
                    </button>
<button class="w-10 flex items-center justify-center bg-slate-50 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg border border-slate-200 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-600 transition-colors">
<span class="material-symbols-outlined text-[20px]">edit</span>
</button>
</div>
</div>
<div class="h-8"></div>
</div>
</div>
<nav class="fixed bottom-0 left-0 right-0 bg-white dark:bg-slate-900 border-t border-gray-100 dark:border-slate-800 h-[70px] px-2 flex justify-between items-center z-30 pb-safe">
<button class="flex-1 flex flex-col items-center justify-center gap-1 h-full text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors">
<span class="material-symbols-outlined">home</span>
<span class="text-[10px] font-medium">Home</span>
</button>
<button class="flex-1 flex flex-col items-center justify-center gap-1 h-full text-[#10b981]">
<span class="material-symbols-outlined">calendar_today</span>
<span class="text-[10px] font-medium">Schedule</span>
</button>
<button class="flex-1 flex flex-col items-center justify-center gap-1 h-full text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors">
<span class="material-symbols-outlined">groups</span>
<span class="text-[10px] font-medium">Roster</span>
</button>
<button class="flex-1 flex flex-col items-center justify-center gap-1 h-full text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors">
<span class="material-symbols-outlined">chat</span>
<span class="text-[10px] font-medium">Chat</span>
</button>
<button class="flex-1 flex flex-col items-center justify-center gap-1 h-full text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors">
<span class="material-symbols-outlined">person</span>
<span class="text-[10px] font-medium">Profile</span>
</button>
</nav>
<div class="fixed bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-white via-white/80 to-transparent dark:from-slate-900 dark:via-slate-900/80 pointer-events-none z-10 bottom-[280px]"></div>
</body></html>
</file>

<file path="legacy_html/coach_profile_&_dashboard.html">
<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Coach Profile &amp; Dashboard</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&amp;family=Noto+Sans:wght@300..700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }.hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#10b77f",
                        "background-light": "#f6f8f7",
                        "background-dark": "#10221c",
                        "card-light": "#ffffff",
                        "card-dark": "#162e26",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"],
                        "body": ["Noto Sans", "sans-serif"],
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "2xl": "2rem", // Adding 2xl as requested
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-white transition-colors duration-200">
<div class="relative flex min-h-screen w-full flex-col overflow-hidden pb-24 max-w-md mx-auto shadow-2xl bg-background-light dark:bg-background-dark">
<header class="p-5 pt-8">
<div class="flex items-center gap-4">
<div class="relative group">
<div class="h-20 w-20 rounded-full bg-gray-200 bg-cover bg-center border-2 border-white dark:border-primary/30 shadow-md" data-alt="Portrait of Coach Sarah smiling" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuD1vO8pam0VZsjSVSwNR0-SusPijvl_DN7ieClB66y9bnLu1LFJODcoJtfsTQWfqjXIEgoQmvtNLfLNNf8FS0hbG0USYHRYZsuulj7Mb9FXLU3MpJtBGP6zwf798lqtP9FsxGMdG0K_k3uNlE_lP0DULzqyD6HmfipBvULF1GXRb2_lAhkiJEnOrENk7BtmFs1-eZj6nf197jtMMdPHWi3dttZYX6PaFWajLsZxFzxl8JjTUu7vwLPofIt30UM-VCcEN4nCTWgPl-g1');"></div>
<div class="absolute bottom-0 right-0 h-6 w-6 bg-primary rounded-full flex items-center justify-center border-2 border-white dark:border-background-dark">
<span class="material-symbols-outlined text-white text-[14px]">check</span>
</div>
</div>
<div class="flex flex-col justify-center">
<h1 class="text-2xl font-bold leading-tight tracking-tight text-slate-900 dark:text-white">Coach Sarah</h1>
<div class="flex items-center gap-1.5 text-primary text-sm font-medium mt-0.5">
<span class="material-symbols-outlined text-[18px]">sports_gymnastics</span>
<span>Head Coach</span>
</div>
<p class="text-slate-500 dark:text-slate-400 text-xs mt-1 font-body">Active at Sharjah Branch</p>
</div>
<div class="ml-auto">
<button class="flex h-10 w-10 items-center justify-center rounded-full bg-white dark:bg-card-dark shadow-sm border border-slate-100 dark:border-slate-800 text-slate-600 dark:text-slate-300">
<span class="material-symbols-outlined">notifications</span>
</button>
</div>
</div>
</header>
<section class="px-5 mb-6">
<div class="grid grid-cols-3 gap-3">
<div class="flex flex-col gap-1 rounded-2xl bg-white dark:bg-card-dark p-3.5 shadow-sm border border-slate-100 dark:border-slate-800/50">
<div class="flex items-start justify-between">
<span class="text-slate-500 dark:text-slate-400 text-[10px] font-bold uppercase tracking-wider">Athletes</span>
<span class="material-symbols-outlined text-primary text-[16px]">trending_up</span>
</div>
<p class="text-2xl font-bold text-slate-900 dark:text-white mt-1">42</p>
<p class="text-[10px] text-primary font-medium bg-primary/10 w-fit px-1.5 py-0.5 rounded">+2 this week</p>
</div>
<div class="flex flex-col gap-1 rounded-2xl bg-white dark:bg-card-dark p-3.5 shadow-sm border border-slate-100 dark:border-slate-800/50">
<div class="flex items-start justify-between">
<span class="text-slate-500 dark:text-slate-400 text-[10px] font-bold uppercase tracking-wider">Retention</span>
<span class="material-symbols-outlined text-primary text-[16px]">verified</span>
</div>
<p class="text-2xl font-bold text-slate-900 dark:text-white mt-1">94%</p>
<p class="text-[10px] text-primary font-medium bg-primary/10 w-fit px-1.5 py-0.5 rounded">Excellent</p>
</div>
<div class="flex flex-col gap-1 rounded-2xl bg-white dark:bg-card-dark p-3.5 shadow-sm border border-slate-100 dark:border-slate-800/50">
<div class="flex items-start justify-between">
<span class="text-slate-500 dark:text-slate-400 text-[10px] font-bold uppercase tracking-wider">Trophies</span>
<span class="material-symbols-outlined text-amber-500 text-[16px]">emoji_events</span>
</div>
<p class="text-2xl font-bold text-slate-900 dark:text-white mt-1">128</p>
<p class="text-[10px] text-amber-600 font-medium bg-amber-50 dark:bg-amber-900/30 w-fit px-1.5 py-0.5 rounded">+12 medals</p>
</div>
</div>
</section>
<section class="px-5 mb-8">
<div class="flex items-center justify-between mb-4">
<h3 class="text-lg font-bold text-slate-900 dark:text-white">Academy Insights</h3>
<div class="relative">
<select class="appearance-none bg-white dark:bg-card-dark border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 py-1.5 pl-3 pr-8 rounded-lg text-xs font-medium focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary">
<option>Player Growth</option>
<option>Level Dist.</option>
<option>Attendance</option>
</select>
<div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500">
<span class="material-symbols-outlined text-[16px]">expand_more</span>
</div>
</div>
</div>
<div class="bg-white dark:bg-card-dark p-5 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-800/50">
<div class="flex justify-between items-end mb-6">
<div>
<p class="text-xs text-slate-500 dark:text-slate-400 mb-1">Growth Trend</p>
<div class="flex items-baseline gap-2">
<h2 class="text-3xl font-bold text-slate-900 dark:text-white">+15%</h2>
<span class="text-xs font-medium text-primary bg-primary/10 px-1.5 py-0.5 rounded-md">Last 30 Days</span>
</div>
</div>
</div>
<div class="w-full h-32 relative">
<svg class="w-full h-full overflow-visible" viewBox="0 0 300 100">
<defs>
<linearGradient id="chartGradient" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#10b77f" stop-opacity="0.2"></stop>
<stop offset="100%" stop-color="#10b77f" stop-opacity="0"></stop>
</linearGradient>
</defs>
<line class="dark:stroke-slate-700/50" stroke="#e2e8f0" stroke-dasharray="4 4" stroke-width="1" x1="0" x2="300" y1="0" y2="0"></line>
<line class="dark:stroke-slate-700/50" stroke="#e2e8f0" stroke-dasharray="4 4" stroke-width="1" x1="0" x2="300" y1="50" y2="50"></line>
<line class="dark:stroke-slate-700/50" stroke="#e2e8f0" stroke-width="1" x1="0" x2="300" y1="100" y2="100"></line>
<path d="M0,80 C40,80 50,40 90,50 C130,60 140,20 180,30 C220,40 250,10 300,20 V100 H0 Z" fill="url(#chartGradient)"></path>
<path d="M0,80 C40,80 50,40 90,50 C130,60 140,20 180,30 C220,40 250,10 300,20" fill="none" stroke="#10b77f" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
<circle cx="90" cy="50" fill="#ffffff" r="3" stroke="#10b77f" stroke-width="2"></circle>
<circle cx="180" cy="30" fill="#ffffff" r="3" stroke="#10b77f" stroke-width="2"></circle>
<circle cx="300" cy="20" fill="#10b77f" r="4" stroke="#ffffff" stroke-width="2"></circle>
</svg>
</div>
<div class="flex justify-between mt-4 text-[10px] font-medium text-slate-400 dark:text-slate-500 uppercase tracking-wide">
<span>Mon</span>
<span>Tue</span>
<span>Wed</span>
<span>Thu</span>
<span>Fri</span>
<span>Sat</span>
<span>Sun</span>
</div>
</div>
</section>
<section class="mb-8">
<div class="px-5 mb-4">
<h3 class="text-lg font-bold text-slate-900 dark:text-white mb-4">Trophy Cabinet</h3>
<div class="flex p-1 bg-slate-100 dark:bg-card-dark rounded-xl mb-6">
<button class="flex-1 py-2 text-xs font-semibold rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white shadow-sm transition-all">
                        Internal
                    </button>
<button class="flex-1 py-2 text-xs font-medium rounded-lg text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 transition-all flex items-center justify-center gap-1">
                        External <span class="text-[10px] bg-yellow-100 text-yellow-700 px-1 rounded">PRO</span>
</button>
</div>
</div>
<div class="overflow-x-auto hide-scrollbar pl-5 pr-2 pb-4">
<div class="flex gap-4 w-max">
<div class="group relative flex flex-col items-center justify-center w-32 p-4 rounded-2xl bg-white dark:bg-card-dark border-2 border-yellow-400/30 dark:border-yellow-500/30 shadow-[0_4px_20px_-8px_rgba(250,204,21,0.5)] flex-shrink-0">
<div class="absolute top-2 right-2">
<span class="material-symbols-outlined text-yellow-500 text-[16px]">hotel_class</span>
</div>
<div class="h-14 w-14 mb-3 rounded-full bg-gradient-to-br from-yellow-100 to-yellow-50 flex items-center justify-center border border-yellow-200">
<span class="material-symbols-outlined text-yellow-600 text-[32px] drop-shadow-sm">trophy</span>
</div>
<p class="text-sm font-bold text-slate-900 dark:text-white text-center leading-tight">Dubai Cup</p>
<p class="text-[10px] text-yellow-600 dark:text-yellow-500 font-bold mt-1 uppercase tracking-wide">7x Gold</p>
</div>
<div class="group relative flex flex-col items-center justify-center w-32 p-4 rounded-2xl bg-white dark:bg-card-dark border border-slate-200 dark:border-slate-700 shadow-sm flex-shrink-0">
<div class="h-14 w-14 mb-3 rounded-full bg-gradient-to-br from-slate-100 to-slate-50 flex items-center justify-center border border-slate-200">
<span class="material-symbols-outlined text-slate-500 text-[32px]">military_tech</span>
</div>
<p class="text-sm font-bold text-slate-900 dark:text-white text-center leading-tight">Regionals</p>
<p class="text-[10px] text-slate-500 font-bold mt-1 uppercase tracking-wide">3x Silver</p>
</div>
<div class="group relative flex flex-col items-center justify-center w-32 p-4 rounded-2xl bg-white dark:bg-card-dark border border-slate-200 dark:border-slate-700 shadow-sm flex-shrink-0">
<div class="h-14 w-14 mb-3 rounded-full bg-gradient-to-br from-orange-100 to-orange-50 flex items-center justify-center border border-orange-200">
<span class="material-symbols-outlined text-orange-700 text-[32px]">workspace_premium</span>
</div>
<p class="text-sm font-bold text-slate-900 dark:text-white text-center leading-tight">Nationals</p>
<p class="text-[10px] text-orange-700 font-bold mt-1 uppercase tracking-wide">2x Bronze</p>
</div>
</div>
</div>
</section>
<section class="px-5 mb-8">
<div class="flex items-center justify-between mb-4">
<h3 class="text-lg font-bold text-slate-900 dark:text-white">Recent Activity</h3>
<button class="text-primary text-xs font-semibold">View All</button>
</div>
<div class="flex flex-col gap-3">
<div class="flex items-center gap-3 p-3 bg-white dark:bg-card-dark rounded-xl border border-slate-100 dark:border-slate-800/50 shadow-sm">
<div class="h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400 flex-shrink-0">
<span class="material-symbols-outlined text-[20px]">keyboard_double_arrow_up</span>
</div>
<div class="flex-1">
<p class="text-sm font-semibold text-slate-900 dark:text-white">Ahmed leveled up</p>
<p class="text-xs text-slate-500">Promoted to <span class="font-medium text-slate-700 dark:text-slate-300">Level 2 Bronze</span></p>
</div>
<span class="text-[10px] text-slate-400">2h ago</span>
</div>
<div class="flex items-center gap-3 p-3 bg-white dark:bg-card-dark rounded-xl border border-slate-100 dark:border-slate-800/50 shadow-sm">
<div class="h-10 w-10 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center text-yellow-600 dark:text-yellow-400 flex-shrink-0">
<span class="material-symbols-outlined text-[20px]">star</span>
</div>
<div class="flex-1">
<p class="text-sm font-semibold text-slate-900 dark:text-white">Fatima earned Gold</p>
<p class="text-xs text-slate-500">Sharjah Monthly Meet</p>
</div>
<span class="text-[10px] text-slate-400">5h ago</span>
</div>
</div>
</section>
<nav class="fixed bottom-0 left-0 right-0 bg-white dark:bg-background-dark border-t border-gray-100 dark:border-slate-800/50 z-50">
<div class="flex items-center justify-between max-w-md mx-auto h-[70px] px-2 pb-safe">
<a class="flex flex-1 flex-col items-center justify-center gap-1 h-full group" href="#">
<span class="material-symbols-outlined text-[#10b981] text-[24px]">home</span>
<span class="text-[10px] font-bold text-[#10b981]">Home</span>
</a>
<a class="flex flex-1 flex-col items-center justify-center gap-1 h-full group" href="#">
<span class="material-symbols-outlined text-slate-400 group-hover:text-[#10b981] transition-colors text-[24px]">calendar_month</span>
<span class="text-[10px] font-medium text-slate-400 group-hover:text-[#10b981] transition-colors">Schedule</span>
</a>
<a class="flex flex-1 flex-col items-center justify-center gap-1 h-full group" href="#">
<span class="material-symbols-outlined text-slate-400 group-hover:text-[#10b981] transition-colors text-[24px]">groups</span>
<span class="text-[10px] font-medium text-slate-400 group-hover:text-[#10b981] transition-colors">Roster</span>
</a>
<a class="flex flex-1 flex-col items-center justify-center gap-1 h-full group" href="#">
<span class="material-symbols-outlined text-slate-400 group-hover:text-[#10b981] transition-colors text-[24px]">chat</span>
<span class="text-[10px] font-medium text-slate-400 group-hover:text-[#10b981] transition-colors">Chat</span>
</a>
<a class="flex flex-1 flex-col items-center justify-center gap-1 h-full group" href="#">
<span class="material-symbols-outlined text-slate-400 group-hover:text-[#10b981] transition-colors text-[24px]">person</span>
<span class="text-[10px] font-medium text-slate-400 group-hover:text-[#10b981] transition-colors">Profile</span>
</a>
</div>
</nav>
</div>
</body></html>
</file>

<file path="legacy_html/home_dashboard.html">
<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Home Dashboard - Wild Robot</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#0fbd83",
                        "background-light": "#ffffff",
                        "background-dark": "#10221c",
                        "surface-light": "#f6f8f7",
                        "emerald-green": "#10b981",
                        "slate-gray": "#94a3b8"
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px" },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                },
            },
        }
    </script>
<style>.no-scrollbar::-webkit-scrollbar {
            display: none;
        }.no-scrollbar {
            -ms-overflow-style: none;scrollbar-width: none;}
    </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark font-display text-gray-800 antialiased pb-24">
<header class="sticky top-0 z-50 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-sm transition-colors duration-200">
<div class="flex items-center justify-between px-4 py-4">
<h1 class="text-[#0d1b17] dark:text-white text-2xl font-bold tracking-tight">Wild Robot</h1>
<div class="relative">
<button class="relative flex h-10 w-10 items-center justify-center rounded-full hover:bg-surface-light dark:hover:bg-gray-800 transition-colors">
<span class="material-symbols-outlined text-[#0d1b17] dark:text-white" style="font-size: 28px;">notifications</span>
<span class="absolute top-1 right-1 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white shadow-sm ring-2 ring-white dark:ring-[#10221c]">
                        3
                    </span>
</button>
</div>
</div>
</header>
<main class="flex flex-col gap-6 w-full max-w-md mx-auto md:max-w-full">
<section class="flex flex-col gap-3">
<div class="px-4 flex items-center justify-between">
<h2 class="text-[#0d1b17] dark:text-white text-lg font-bold">Today's Sessions</h2>
<button class="text-sm font-medium text-gray-500 dark:text-gray-400">See all</button>
</div>
<div class="flex overflow-x-auto snap-x snap-mandatory gap-4 px-4 pb-4 no-scrollbar w-full">
<div class="snap-center shrink-0 w-[85%] md:w-[360px] relative flex flex-col rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 overflow-hidden group bg-white dark:bg-gray-900">
<div class="h-40 w-full bg-gray-200 relative overflow-hidden">
<div class="absolute inset-0 bg-cover bg-center transition-transform duration-700 group-hover:scale-105" data-alt="Gymnastics gym floor with equipment and mats" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDbYd1cwFvbn0757u53MmBkh6tjtCmfOD8hlN1sumgVwQAWacw2ZzuKlZ2NYa2fwHri3HiZNHbNnBA7tP8mtxfRNZxrPk-HHpzuhMkrR1BwrLKSBqu-SAgvbzHg93KYzDItHgJdt7UScqaWlasig-2FLpgExtDc3q19Ji_B-9qgqgF_2GO9jwhYvlOvsSFiVNefV9QvszE1xxfzB1NMA9e5UKGnYqytOC3ViN32F_SVqrlgvunOPTWE2k1tNdDsmNMKIYZu1mLZx1VW");'></div>
<div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
<div class="absolute top-3 left-3 flex items-center gap-2 bg-white/90 dark:bg-black/80 backdrop-blur px-2.5 py-1 rounded-full">
<span class="relative flex h-2.5 w-2.5">
<span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-500 opacity-75"></span>
<span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-blue-600"></span>
</span>
<span class="text-xs font-bold text-blue-900 dark:text-blue-100 uppercase tracking-wide">Live Now</span>
</div>
</div>
<div class="p-4 flex flex-col gap-3">
<div>
<h3 class="text-[#0d1b17] dark:text-white text-xl font-bold leading-tight">Elite Boys (Tilal)</h3>
<p class="text-gray-500 dark:text-gray-400 text-sm font-medium mt-1">16:00 - 17:30 â€¢ Main Hall</p>
</div>
<button class="flex w-full items-center justify-center gap-2 rounded-xl h-12 bg-primary text-[#0d1b17] text-base font-bold shadow-[0_4px_14px_0_rgba(15,189,131,0.39)] hover:bg-[#0ca673] transition-all active:scale-[0.98]">
<span>Enter Class</span>
<span class="material-symbols-outlined text-lg">arrow_forward</span>
</button>
</div>
</div>
<div class="snap-center shrink-0 w-[70%] md:w-[280px] flex flex-col rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 bg-surface-light dark:bg-gray-800 overflow-hidden">
<div class="h-32 w-full bg-gray-200 relative">
<div class="absolute inset-0 bg-cover bg-center" data-alt="Young gymnasts stretching on mats" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDC3TgE_JLIZYDfiQvfvDhz_ibyzFVSWwXDMcq_oPAmk0sDpVDG2fBtiy0deOs33IHs-0AcafL2yLGeDl5H6tnrF-SZIkLF_ekWLGzLCqCBAoaLLzndJ0ni1do0F-fVRHZeJTwkVOWbDkYZlvOaELbjgVI2zM8FE8wZOVhWU7b9PNAvUgofKYnCrkF2w-f97Xdvzf8ugu4UuLoYMxr_p1jk4HOuKY-5T-X44HuUsF0RAVQGoSJvUfXgMzj6F1PqpGPC3nt6CBQ6fZyz");'></div>
</div>
<div class="p-4 flex flex-col h-full justify-between gap-3">
<div>
<span class="text-primary text-xs font-bold uppercase tracking-wider">Upcoming</span>
<h3 class="text-[#0d1b17] dark:text-white text-lg font-bold mt-1">Beginner Girls</h3>
<p class="text-gray-500 dark:text-gray-400 text-sm">17:45 - 18:45</p>
</div>
<button class="w-full py-2 rounded-lg bg-white dark:bg-gray-700 text-[#0d1b17] dark:text-white text-sm font-semibold border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors">
                            View Details
                        </button>
</div>
</div>
<div class="snap-center shrink-0 w-[70%] md:w-[280px] flex flex-col rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 bg-surface-light dark:bg-gray-800 overflow-hidden">
<div class="h-32 w-full bg-gray-200 relative">
<div class="absolute inset-0 bg-cover bg-center" data-alt="Abstract view of gym rings and ropes" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCgQQGEL6JNGzSWmxtXNVbalbMAzEPbX_9fxyWbeIT4_jxqgE6CLKUPo4IqDtB6Gh3Zjq5O0vVpUsfmR2B2K65Fd0MtAZoSqTr5hbgFgtOXI5Lte0pQWesxKyH4U_XAc4KcAHKhuv1xr9Q2_K9OTw8QIhqGACpE7GKKNftOKjfGUgfkOIC2xeUmBIj7RnF90KLepIc6Hgu4n7nj_tZkT_6Dg5T4GovdKZzJr-9k339-vQVV93d8-e9fp-g6nVEIrlwvV2SYvUFkgM8d");'></div>
</div>
<div class="p-4 flex flex-col h-full justify-between gap-3">
<div>
<span class="text-primary text-xs font-bold uppercase tracking-wider">Tomorrow</span>
<h3 class="text-[#0d1b17] dark:text-white text-lg font-bold mt-1">Junior Advanced</h3>
<p class="text-gray-500 dark:text-gray-400 text-sm">09:00 - 10:30</p>
</div>
<button class="w-full py-2 rounded-lg bg-white dark:bg-gray-700 text-[#0d1b17] dark:text-white text-sm font-semibold border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors">
                            View Details
                        </button>
</div>
</div>
</div>
</section>
<section class="flex flex-col px-4 pt-2">
<h2 class="text-[#0d1b17] dark:text-white text-lg font-bold mb-4">Community Feed</h2>
<div class="flex flex-col gap-4 pb-4">
<article class="flex flex-col gap-3 p-4 rounded-xl bg-surface-light dark:bg-gray-800/50 border border-transparent dark:border-gray-800 hover:border-gray-200 dark:hover:border-gray-700 transition-colors">
<div class="flex items-start justify-between">
<div class="flex items-center gap-3">
<div class="h-10 w-10 rounded-full bg-gray-300 bg-cover bg-center border-2 border-white dark:border-gray-700 shadow-sm" data-alt="Portrait of Sarah the gymnast" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBPWCNl2agTfV2H_ZhbsShcbP2H9DJZDSPQ9B8dNezfN88i6Fw_Cwj-ADsHqkKT3wUU5C71dtRAc0YHd4dRAO1AFFjSz3gvhxTIgg6Zf86Ig76WuQrXAMSbnGoIy46o3Zym-YeUSgE2BOldSwCIubPIb9izdrRc30x8YAr50dksJCa4gQAUOBzlzTBH_-v6J9OXDsdNkDoIj1Lh33iX7RIPEnlJ8IjgMOvlOfYjSt1lcl81Msvrwi0dDMSMwGQb4zYS8DJHGiXsF15I");'></div>
<div>
<p class="text-[#0d1b17] dark:text-white text-sm font-bold">Sarah J.</p>
<p class="text-xs text-gray-500 dark:text-gray-400">2h ago</p>
</div>
</div>
<div class="bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wide">
                            Achievement
                        </div>
</div>
<div>
<p class="text-[#0d1b17] dark:text-gray-200 text-base font-medium leading-normal">
                            Finally mastered the kip! ðŸ¤¸â€â™€ï¸ It took 3 weeks of conditioning but we got there.
                        </p>
</div>
<div class="flex items-center gap-4 mt-1">
<button class="flex items-center gap-1.5 text-gray-500 dark:text-gray-400 hover:text-red-500 transition-colors group">
<span class="material-symbols-outlined text-[20px] group-hover:scale-110 transition-transform">favorite</span>
<span class="text-xs font-medium">24</span>
</button>
<button class="flex items-center gap-1.5 text-gray-500 dark:text-gray-400 hover:text-blue-500 transition-colors">
<span class="material-symbols-outlined text-[20px]">chat_bubble</span>
<span class="text-xs font-medium">3</span>
</button>
</div>
</article>
<article class="flex flex-col gap-3 p-4 rounded-xl bg-surface-light dark:bg-gray-800/50 border border-transparent dark:border-gray-800 hover:border-gray-200 dark:hover:border-gray-700 transition-colors">
<div class="flex items-start justify-between">
<div class="flex items-center gap-3">
<div class="flex items-center justify-center h-10 w-10 rounded-full bg-primary/20 text-primary border-2 border-white dark:border-gray-700 shadow-sm">
<span class="material-symbols-outlined text-lg">trophy</span>
</div>
<div>
<p class="text-[#0d1b17] dark:text-white text-sm font-bold">Wild Robot Coach</p>
<p class="text-xs text-gray-500 dark:text-gray-400">5h ago</p>
</div>
</div>
<div class="bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wide">
                            Challenge
                        </div>
</div>
<div>
<p class="text-[#0d1b17] dark:text-gray-200 text-base font-medium leading-normal">
                            Weekly Handstand Challenge! â±ï¸ Post your best time below.
                        </p>
<div class="mt-3 rounded-lg overflow-hidden h-32 w-full bg-gray-100 relative">
<div class="absolute inset-0 bg-cover bg-center" data-alt="Gymnast doing a handstand on parallel bars" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBP-ulXigeFUeUluNhN5-35Uh_Bj9Xm6wXQFObiWqmcELOCH9gtKq3j4lMnnN0FABZ-frQe8x0HsAbBQ6uUEMMi-c3s8kD1N1oCS7cTixZPU96_g43lAdcnAygLVUI-jYw4b_Y7hbZCDPS_mqqGtL8oagf3jNrPLSkJ6lO-rJDAyPFnMpzHueh2yR8mC_zDJ_39XgkBqM-c5c1wtJPYf2vOrgfRYpYm40UsmPwjlFqxIEUCMdcmuHaa00HR3RdGztI3uac1_XZGoL1b");'></div>
</div>
</div>
<div class="flex items-center gap-4 mt-1">
<button class="flex items-center gap-1.5 text-gray-500 dark:text-gray-400 hover:text-red-500 transition-colors">
<span class="material-symbols-outlined text-[20px]">favorite</span>
<span class="text-xs font-medium">86</span>
</button>
<button class="flex items-center gap-1.5 text-gray-500 dark:text-gray-400 hover:text-blue-500 transition-colors">
<span class="material-symbols-outlined text-[20px]">chat_bubble</span>
<span class="text-xs font-medium">12</span>
</button>
</div>
</article>
<article class="flex flex-col gap-3 p-4 rounded-xl bg-surface-light dark:bg-gray-800/50 border border-transparent dark:border-gray-800 transition-colors">
<div class="flex items-start justify-between">
<div class="flex items-center gap-3">
<div class="h-10 w-10 rounded-full bg-gray-300 bg-cover bg-center border-2 border-white dark:border-gray-700 shadow-sm" data-alt="Portrait of Alex the coach" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCl2x7pp2_vrkP3NRwA8kS8tVooxbTNjnvEIoVigOxt6ruz8ZRogAbZKQtWz-o7XTlsWCTW-xX5Ei9HxiT63qMTeGRSCDzI18vVYx1yGKEgIDS3VmsZ_pPxDi8T04C7AhE-6XvVFVD5AuZdOk7KFAso2QT4nf87du4_YM-52q50ziLEDxWpAxjjmer_kDj9qEIQY9Ky7kmLqamxP_2rXSCj3u49U5CKItwEFIe9GWWTw9R4cboJ2_pkqE3ypuZdXcV31AuVZD48BBoN");'></div>
<div>
<p class="text-[#0d1b17] dark:text-white text-sm font-bold">Alex M.</p>
<p class="text-xs text-gray-500 dark:text-gray-400">Yesterday</p>
</div>
</div>
<div class="bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wide">
                            Update
                        </div>
</div>
<div>
<p class="text-[#0d1b17] dark:text-gray-200 text-base font-medium leading-normal">
                            New balance beams have arrived! We'll be setting them up for the afternoon session.
                        </p>
</div>
<div class="flex items-center gap-4 mt-1">
<button class="flex items-center gap-1.5 text-gray-500 dark:text-gray-400 hover:text-red-500 transition-colors">
<span class="material-symbols-outlined text-[20px]">favorite</span>
<span class="text-xs font-medium">45</span>
</button>
</div>
</article>
</div>
</section>
</main>
<nav class="fixed bottom-0 left-0 right-0 bg-white dark:bg-[#10221c] border-t border-gray-100 dark:border-gray-800 z-50 h-[70px] pb-safe">
<ul class="flex items-center justify-between max-w-md mx-auto h-full px-2">
<li class="flex-1 h-full">
<a class="flex flex-col items-center justify-center gap-1 text-[#10b981] w-full h-full" href="#">
<span class="material-symbols-outlined text-[26px] [font-variation-settings:'FILL'_1]">home</span>
<span class="text-[10px] font-medium">Home</span>
</a>
</li>
<li class="flex-1 h-full">
<a class="flex flex-col items-center justify-center gap-1 text-slate-400 hover:text-[#10b981] transition-colors w-full h-full" href="#">
<span class="material-symbols-outlined text-[26px]">calendar_today</span>
<span class="text-[10px] font-medium">Schedule</span>
</a>
</li>
<li class="flex-1 h-full">
<a class="flex flex-col items-center justify-center gap-1 text-slate-400 hover:text-[#10b981] transition-colors w-full h-full" href="#">
<span class="material-symbols-outlined text-[26px]">groups</span>
<span class="text-[10px] font-medium">Roster</span>
</a>
</li>
<li class="flex-1 h-full">
<a class="flex flex-col items-center justify-center gap-1 text-slate-400 hover:text-[#10b981] transition-colors w-full h-full" href="#">
<span class="material-symbols-outlined text-[26px]">chat_bubble</span>
<span class="text-[10px] font-medium">Chat</span>
</a>
</li>
<li class="flex-1 h-full">
<a class="flex flex-col items-center justify-center gap-1 text-slate-400 hover:text-[#10b981] transition-colors w-full h-full" href="#">
<span class="material-symbols-outlined text-[26px]">person</span>
<span class="text-[10px] font-medium">Profile</span>
</a>
</li>
</ul>
</nav>
<div class="hidden absolute top-16 right-4 w-72 bg-white dark:bg-gray-800 rounded-xl shadow-xl ring-1 ring-black/5 z-50 overflow-hidden">
<div class="px-4 py-3 border-b border-gray-100 dark:border-gray-700">
<h3 class="font-bold text-sm dark:text-white">Shift Logs</h3>
</div>
<div class="max-h-64 overflow-y-auto">
<div class="px-4 py-3 border-b border-gray-50 dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-700">
<p class="text-xs font-bold text-primary mb-1">Admin added a shift</p>
<p class="text-xs text-gray-500">2 mins ago</p>
</div>
<div class="px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700">
<p class="text-xs font-bold text-red-500 mb-1">Session Canceled</p>
<p class="text-xs text-gray-500">Junior Girls â€¢ 1 hr ago</p>
</div>
</div>
</div>
</body></html>
</file>

<file path="legacy_html/login_screen.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Skill Evaluation - Variant 3</title>
<!-- Fonts -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#f4d125",
                        "primary-dark": "#dcb910",
                        "background-light": "#f8f8f5",
                        "background-dark": "#221f10",
                        "surface-light": "#ffffff",
                        "surface-dark": "#2d2a15",
                        "text-main": "#1c190d",
                        "text-main-dark": "#f0f0f0",
                        "text-sub": "#9c8e49",
                        "text-sub-dark": "#ccc29a"
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px" },
                },
            },
        }
    </script>
<style>
        /* Custom scrollbar hiding for clean UI */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark font-display antialiased min-h-screen relative pb-32">
<!-- Top App Bar -->
<header class="sticky top-0 z-30 bg-background-light/90 dark:bg-background-dark/90 backdrop-blur-sm px-4 py-3 flex items-center justify-between border-b border-gray-200 dark:border-gray-800">
<button class="flex items-center justify-center w-10 h-10 rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition-colors">
<span class="material-symbols-outlined text-text-main dark:text-text-main-dark">arrow_back</span>
</button>
<h1 class="flex-1 text-center text-lg font-bold text-text-main dark:text-text-main-dark tracking-tight">
            Evaluation: Sarah Jones
        </h1>
<div class="w-10 h-10"></div> <!-- Spacer for visual balance -->
</header>
<!-- Main Content -->
<main class="flex flex-col gap-6 p-4">
<!-- Profile Header -->
<section class="flex flex-col items-center justify-center py-2">
<div class="relative mb-4">
<div class="w-24 h-24 rounded-full border-4 border-white dark:border-surface-dark shadow-lg overflow-hidden bg-gray-200" data-alt="Portrait of gymnast Sarah Jones smiling" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuDnNkUbImYjMlk3yJYlA6ThoK4dHLsvgzINqYOzV1WpPud_X3YsKzwRrxmcS1HYozWf4Z_nsLtYz14ZSedpNbJq1AxIOLR7UjUslI4g75xJH5bsmMMO13OH7mUPQSVaBH8hfwU4JSjId_DhHm8qt3ARb9swqexUjKQDHRTvmk6q7gK-Bf626a6u_JrojVL0adKcuzXom4WzTHJUL7OIsReTLe0mRAz_hZEdbfs6JfwvlpHYLupDrC-f-6QCVrBWuUlyrFuqPvH4Ww'); background-size: cover; background-position: center;">
</div>
<div class="absolute -bottom-2 -right-2 bg-primary text-text-main text-xs font-bold px-2 py-1 rounded-full border-2 border-white dark:border-surface-dark">
                    Lvl 5
                </div>
</div>
<h2 class="text-2xl font-bold text-text-main dark:text-text-main-dark mb-1">Sarah Jones</h2>
<p class="text-text-sub dark:text-text-sub-dark font-medium mb-4">Overall Progress: 82%</p>
<!-- Progress Bar -->
<div class="w-full max-w-xs h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
<div class="h-full bg-primary rounded-full" style="width: 82%"></div>
</div>
</section>
<!-- Skill Cards Area -->
<div class="flex flex-col gap-4">
<!-- Card 1: Vault (Expanded) -->
<article class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-gray-100 dark:border-gray-800 overflow-hidden">
<div class="flex items-center justify-between p-4 bg-primary/10 cursor-pointer">
<div class="flex items-center gap-3">
<div class="w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center text-primary-dark dark:text-primary">
<span class="material-symbols-outlined">sports_gymnastics</span>
</div>
<h3 class="text-lg font-bold text-text-main dark:text-text-main-dark">Vault</h3>
</div>
<span class="material-symbols-outlined text-text-main dark:text-text-main-dark transform rotate-180 transition-transform">expand_more</span>
</div>
<div class="flex flex-col divide-y divide-gray-100 dark:divide-gray-800">
<!-- Skill Item -->
<div class="p-4 flex flex-col gap-2">
<div class="flex justify-between items-start">
<div>
<h4 class="text-base font-semibold text-text-main dark:text-text-main-dark">Handspring</h4>
<p class="text-sm text-text-sub dark:text-text-sub-dark mt-0.5">Technique needs improvement on landing.</p>
</div>
<span class="text-sm font-bold text-text-main dark:text-text-main-dark bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded">3/5</span>
</div>
<!-- Stars -->
<div class="flex gap-1 text-primary">
<span class="material-symbols-outlined text-[20px] fill-current" style="font-variation-settings: 'FILL' 1">star</span>
<span class="material-symbols-outlined text-[20px] fill-current" style="font-variation-settings: 'FILL' 1">star</span>
<span class="material-symbols-outlined text-[20px] fill-current" style="font-variation-settings: 'FILL' 1">star</span>
<span class="material-symbols-outlined text-[20px] text-gray-300 dark:text-gray-600">star</span>
<span class="material-symbols-outlined text-[20px] text-gray-300 dark:text-gray-600">star</span>
</div>
</div>
<!-- Skill Item -->
<div class="p-4 flex flex-col gap-2">
<div class="flex justify-between items-start">
<div>
<h4 class="text-base font-semibold text-text-main dark:text-text-main-dark">Tsukahara</h4>
<p class="text-sm text-text-sub dark:text-text-sub-dark mt-0.5">Great height and rotation!</p>
</div>
<span class="text-sm font-bold text-text-main dark:text-text-main-dark bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded">4/5</span>
</div>
<!-- Stars -->
<div class="flex gap-1 text-primary">
<span class="material-symbols-outlined text-[20px] fill-current" style="font-variation-settings: 'FILL' 1">star</span>
<span class="material-symbols-outlined text-[20px] fill-current" style="font-variation-settings: 'FILL' 1">star</span>
<span class="material-symbols-outlined text-[20px] fill-current" style="font-variation-settings: 'FILL' 1">star</span>
<span class="material-symbols-outlined text-[20px] fill-current" style="font-variation-settings: 'FILL' 1">star</span>
<span class="material-symbols-outlined text-[20px] text-gray-300 dark:text-gray-600">star</span>
</div>
</div>
</div>
</article>
<!-- Card 2: Uneven Bars (Collapsed) -->
<article class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-gray-100 dark:border-gray-800 overflow-hidden">
<div class="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5 transition-colors">
<div class="flex items-center gap-3">
<div class="w-10 h-10 rounded-lg bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-text-sub dark:text-text-sub-dark">
<span class="material-symbols-outlined">accessibility_new</span>
</div>
<h3 class="text-lg font-bold text-text-main dark:text-text-main-dark">Uneven Bars</h3>
</div>
<span class="material-symbols-outlined text-gray-400">expand_more</span>
</div>
</article>
<!-- Card 3: Floor (Collapsed) -->
<article class="bg-surface-light dark:bg-surface-dark rounded-xl shadow-sm border border-gray-100 dark:border-gray-800 overflow-hidden">
<div class="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5 transition-colors">
<div class="flex items-center gap-3">
<div class="w-10 h-10 rounded-lg bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-text-sub dark:text-text-sub-dark">
<span class="material-symbols-outlined">directions_run</span>
</div>
<h3 class="text-lg font-bold text-text-main dark:text-text-main-dark">Floor</h3>
</div>
<span class="material-symbols-outlined text-gray-400">expand_more</span>
</div>
</article>
</div>
</main>
<!-- Floating Action Bar (Sticky Footer) -->
<div class="fixed bottom-0 left-0 w-full p-4 z-40">
<!-- Floating Container -->
<div class="mx-auto w-full max-w-lg bg-white/90 dark:bg-surface-dark/90 backdrop-blur-md rounded-2xl shadow-[0_8px_30px_rgb(0,0,0,0.12)] border border-white/20 dark:border-white/5 p-2.5">
<div class="flex gap-3">
<!-- Secondary Action: Report -->
<button class="flex-1 flex flex-col items-center justify-center gap-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-gray-700 bg-transparent hover:bg-gray-50 dark:hover:bg-white/5 active:scale-95 transition-all group">
<span class="material-symbols-outlined text-text-sub dark:text-text-sub-dark group-hover:text-text-main dark:group-hover:text-white transition-colors">description</span>
<span class="text-xs font-semibold text-text-main dark:text-text-main-dark">Report</span>
</button>
<!-- Primary Action: Certificate -->
<button class="flex-[2] flex flex-row items-center justify-center gap-3 py-3 px-6 rounded-xl bg-primary hover:bg-primary-dark text-text-main shadow-lg shadow-primary/25 active:scale-95 transition-all">
<span class="material-symbols-outlined text-[24px]" style="font-variation-settings: 'FILL' 1">workspace_premium</span>
<div class="flex flex-col items-start">
<span class="text-sm font-bold leading-tight">Award Certificate</span>
<span class="text-[10px] opacity-80 font-medium leading-tight">Celebrate success</span>
</div>
</button>
</div>
</div>
</div>
</body></html>
</file>

<file path="legacy_html/notification_&_shift_logs.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Activity Log</title>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#10b77f",
                        "background-light": "#f6f8f7",
                        "background-dark": "#10221c",
                        "alert": "#ef4444",
                        "warning": "#f97316",
                        "social": "#ec4899",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: {"DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px"},
                },
            },
        }
    </script>
<style>
        /* Custom scrollbar hiding for cleaner mobile look */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 min-h-screen flex flex-col overflow-x-hidden">
<!-- Top App Bar -->
<header class="sticky top-0 z-50 bg-white/90 dark:bg-[#10221c]/90 backdrop-blur-md border-b border-gray-100 dark:border-gray-800">
<div class="flex items-center p-4 pb-2 justify-between">
<button class="text-slate-800 dark:text-white flex size-10 shrink-0 items-center justify-center hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors">
<span class="material-symbols-outlined" style="font-size: 24px;">arrow_back_ios_new</span>
</button>
<h2 class="text-slate-900 dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center">Activity Log</h2>
<button class="flex items-center justify-end px-2 py-1 rounded-lg hover:bg-primary/10 active:bg-primary/20 transition-colors">
<p class="text-primary text-sm font-bold leading-normal tracking-[0.015em] shrink-0">Mark all read</p>
</button>
</div>
</header>
<!-- Content Area -->
<main class="flex-1 px-4 py-4 space-y-6">
<!-- Segmented Filter Buttons -->
<div class="flex w-full overflow-x-auto no-scrollbar pb-1">
<div class="flex h-10 w-full items-center rounded-xl bg-gray-200 dark:bg-slate-800 p-1">
<label class="flex cursor-pointer h-full flex-1 items-center justify-center overflow-hidden rounded-lg px-2 has-[:checked]:bg-white dark:has-[:checked]:bg-slate-700 has-[:checked]:shadow-sm has-[:checked]:text-slate-900 dark:has-[:checked]:text-white text-slate-500 dark:text-slate-400 text-xs sm:text-sm font-medium leading-normal transition-all">
<span class="truncate">All</span>
<input checked="" class="invisible w-0 absolute" name="filter-group" type="radio" value="All"/>
</label>
<label class="flex cursor-pointer h-full flex-1 items-center justify-center overflow-hidden rounded-lg px-2 has-[:checked]:bg-white dark:has-[:checked]:bg-slate-700 has-[:checked]:shadow-sm has-[:checked]:text-warning text-slate-500 dark:text-slate-400 text-xs sm:text-sm font-medium leading-normal transition-all">
<span class="truncate">Critical</span>
<input class="invisible w-0 absolute" name="filter-group" type="radio" value="Critical"/>
</label>
<label class="flex cursor-pointer h-full flex-1 items-center justify-center overflow-hidden rounded-lg px-2 has-[:checked]:bg-white dark:has-[:checked]:bg-slate-700 has-[:checked]:shadow-sm has-[:checked]:text-social text-slate-500 dark:text-slate-400 text-xs sm:text-sm font-medium leading-normal transition-all">
<span class="truncate">Social</span>
<input class="invisible w-0 absolute" name="filter-group" type="radio" value="Social"/>
</label>
</div>
</div>
<div class="space-y-4">
<h3 class="text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider ml-1">Today</h3>
<!-- Shift Change (Critical/Warning) -->
<!-- Variant 2 Style: Left Border + Subtle Tint -->
<div class="relative flex flex-col gap-2 rounded-xl bg-white dark:bg-slate-900 shadow-sm border border-orange-100 dark:border-orange-900/30 overflow-hidden group">
<div class="absolute left-0 top-0 bottom-0 w-1.5 bg-warning"></div>
<div class="flex gap-4 p-4 items-start bg-orange-50/50 dark:bg-orange-900/5">
<div class="flex items-center justify-center rounded-full bg-orange-100 dark:bg-orange-900/40 text-warning shrink-0 size-10 mt-1">
<span class="material-symbols-outlined" style="font-size: 20px;">sync_alt</span>
</div>
<div class="flex flex-1 flex-col justify-center gap-1">
<div class="flex justify-between items-start w-full">
<p class="text-slate-900 dark:text-white text-base font-semibold leading-tight">Shift Change</p>
<span class="flex size-2 rounded-full bg-warning shrink-0 mt-1.5" title="Unread"></span>
</div>
<p class="text-slate-600 dark:text-slate-300 text-sm font-normal leading-snug">Admin changed your Thursday shift to Tilal Branch</p>
<p class="text-slate-400 dark:text-slate-500 text-xs font-medium mt-1">2m ago</p>
</div>
</div>
</div>
<!-- Session Alert (Dangerous) -->
<div class="relative flex flex-col gap-2 rounded-xl bg-white dark:bg-slate-900 shadow-sm border border-red-100 dark:border-red-900/30 overflow-hidden group">
<div class="absolute left-0 top-0 bottom-0 w-1.5 bg-alert"></div>
<div class="flex gap-4 p-4 items-start bg-red-50/50 dark:bg-red-900/5">
<div class="flex items-center justify-center rounded-full bg-red-100 dark:bg-red-900/40 text-alert shrink-0 size-10 mt-1">
<span class="material-symbols-outlined" style="font-size: 20px;">warning</span>
</div>
<div class="flex flex-1 flex-col justify-center gap-1">
<div class="flex justify-between items-start w-full">
<p class="text-slate-900 dark:text-white text-base font-semibold leading-tight">Session Canceled</p>
<span class="flex size-2 rounded-full bg-alert shrink-0 mt-1.5" title="Unread"></span>
</div>
<p class="text-slate-600 dark:text-slate-300 text-sm font-normal leading-snug">5:00 PM Session Canceled by Admin</p>
<p class="text-slate-400 dark:text-slate-500 text-xs font-medium mt-1">1h ago</p>
</div>
</div>
</div>
<!-- New Assignment (Success) -->
<div class="relative flex flex-col gap-2 rounded-xl bg-white dark:bg-slate-900 shadow-sm border border-emerald-100 dark:border-emerald-900/30 overflow-hidden group">
<div class="absolute left-0 top-0 bottom-0 w-1.5 bg-primary"></div>
<div class="flex gap-4 p-4 items-start bg-emerald-50/50 dark:bg-emerald-900/5">
<div class="flex items-center justify-center rounded-full bg-emerald-100 dark:bg-emerald-900/40 text-primary shrink-0 size-10 mt-1">
<span class="material-symbols-outlined" style="font-size: 20px;">check_circle</span>
</div>
<div class="flex flex-1 flex-col justify-center gap-1">
<div class="flex justify-between items-start w-full">
<p class="text-slate-900 dark:text-white text-base font-semibold leading-tight">New Class Assigned</p>
<span class="flex size-2 rounded-full bg-primary shrink-0 mt-1.5" title="Unread"></span>
</div>
<p class="text-slate-600 dark:text-slate-300 text-sm font-normal leading-snug">New Private Class added to your roster</p>
<p class="text-slate-400 dark:text-slate-500 text-xs font-medium mt-1">3h ago</p>
</div>
</div>
</div>
<!-- Social (Neutral/Social) -->
<div class="relative flex flex-col gap-2 rounded-xl bg-white dark:bg-slate-900 shadow-sm border border-pink-100 dark:border-pink-900/30 overflow-hidden group opacity-80">
<div class="absolute left-0 top-0 bottom-0 w-1.5 bg-social"></div>
<div class="flex gap-4 p-4 items-start bg-pink-50/30 dark:bg-pink-900/5">
<div class="flex items-center justify-center rounded-full bg-pink-100 dark:bg-pink-900/40 text-social shrink-0 size-10 mt-1">
<span class="material-symbols-outlined" style="font-size: 20px;">favorite</span>
</div>
<div class="flex flex-1 flex-col justify-center gap-1">
<div class="flex justify-between items-start w-full">
<p class="text-slate-900 dark:text-white text-base font-semibold leading-tight">Kudos</p>
<!-- No dot for read items or less critical ones, just simpler UI -->
</div>
<p class="text-slate-600 dark:text-slate-300 text-sm font-normal leading-snug">Adam liked your challenge</p>
<p class="text-slate-400 dark:text-slate-500 text-xs font-medium mt-1">5h ago</p>
</div>
</div>
</div>
</div>
<div class="space-y-4 pt-2">
<h3 class="text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider ml-1">Yesterday</h3>
<!-- Older Social Notification -->
<div class="relative flex flex-col gap-2 rounded-xl bg-white dark:bg-slate-900 shadow-sm border border-slate-100 dark:border-slate-800 overflow-hidden group opacity-60 grayscale-[0.5]">
<div class="absolute left-0 top-0 bottom-0 w-1.5 bg-slate-300 dark:bg-slate-700"></div>
<div class="flex gap-4 p-4 items-start">
<div class="flex items-center justify-center rounded-full bg-slate-100 dark:bg-slate-800 text-slate-500 shrink-0 size-10 mt-1">
<span class="material-symbols-outlined" style="font-size: 20px;">chat_bubble</span>
</div>
<div class="flex flex-1 flex-col justify-center gap-1">
<div class="flex justify-between items-start w-full">
<p class="text-slate-900 dark:text-white text-base font-medium leading-tight">New Comment</p>
</div>
<p class="text-slate-600 dark:text-slate-300 text-sm font-normal leading-snug">Sarah commented on your session notes</p>
<p class="text-slate-400 dark:text-slate-500 text-xs font-medium mt-1">1d ago</p>
</div>
</div>
</div>
</div>
</main>
<!-- Floating Action Button or Bottom padding if needed, but for logs usually just list -->
<div class="h-8 w-full"></div>
</body></html>
</file>

<file path="legacy_html/player_subscription_detail.html">
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Player Subscription Detail</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#10b77f",
                        "background-light": "#f6f8f7",
                        "background-dark": "#10221c",
                        "success": "#10b77f",
                        "error": "#ef4444",
                        "warning": "#f59e0b",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "2xl": "2rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark font-display text-[#111816] dark:text-white">
<div class="relative flex min-h-screen w-full flex-col overflow-x-hidden max-w-md mx-auto bg-white dark:bg-[#111816] shadow-xl">
<!-- Header -->
<header class="sticky top-0 z-10 flex items-center bg-white dark:bg-[#111816] p-4 pb-2 justify-between border-b border-gray-100 dark:border-gray-800">
<button class="text-[#111816] dark:text-white flex size-12 shrink-0 items-center justify-center rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
<span class="material-symbols-outlined" style="font-size: 24px;">arrow_back_ios_new</span>
</button>
<h1 class="text-[#111816] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center pr-12">Adam Ali</h1>
</header>
<main class="flex-1 flex flex-col p-4 gap-6">
<!-- Headline -->
<div>
<h2 class="text-[#111816] dark:text-white tracking-tight text-xl font-bold leading-tight">Current Package</h2>
</div>
<!-- Subscription Card -->
<div class="relative overflow-hidden rounded-xl shadow-[0_8px_30px_rgb(0,0,0,0.12)] bg-gradient-to-br from-[#10221c] to-[#1a3830] text-white">
<!-- Background Image Overlay -->
<div class="absolute inset-0 opacity-20 bg-cover bg-center mix-blend-overlay" data-alt="abstract athletic pattern background" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCyAvkFuAZx6X57ZSvwePZAnU9EL4DTYZUQoGE3t_vnCYNBcQOhupSdqVg44mNzNci_4DBHOjzSIvfnqzqzmoea7o-MnHds2XfJFolnVs_4L6IDrvttUXVHrlzT-31pdhTLTi88VvtkQwApPBHb-r5z6ung8CVTpgSzbxDjdrdL6OiO7pQsIp86-KLslvvtVXBOZvSQ6k9zUDBHofc0QwVkSymr1vBP2zOVdNRrvfIM2qbO8pi4_3gsw-B9tr6XQfRprWNaG6OqoXip");'>
</div>
<div class="relative p-6 flex flex-col gap-6">
<div class="flex justify-between items-start">
<div>
<p class="text-white/60 text-sm font-medium uppercase tracking-wider mb-1">Membership</p>
<h3 class="text-2xl font-bold leading-tight">Gymnastics Term 1</h3>
</div>
<span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-primary text-white shadow-sm">
                            Active
                        </span>
</div>
<div class="flex flex-col gap-2 mt-4">
<div class="flex justify-between items-end">
<p class="text-white/90 text-sm font-medium">Progress</p>
<p class="text-primary font-bold text-lg">7<span class="text-white/60 text-sm font-normal">/12 Classes</span></p>
</div>
<!-- Progress Bar -->
<div class="h-2.5 w-full bg-white/10 rounded-full overflow-hidden backdrop-blur-sm">
<div class="h-full bg-primary rounded-full transition-all duration-500 ease-out" style="width: 58%;"></div>
</div>
<p class="text-white/40 text-xs text-right mt-1">Expires Dec 31, 2023</p>
</div>
</div>
</div>
<!-- Attendance Section -->
<div class="flex flex-col gap-4">
<h2 class="text-[#111816] dark:text-white tracking-tight text-xl font-bold leading-tight pt-2">Attendance History</h2>
<div class="flex flex-col gap-3">
<!-- Item 1: Present -->
<div class="flex items-center justify-between p-4 rounded-lg bg-background-light dark:bg-gray-800/50 border border-transparent dark:border-gray-700">
<div class="flex items-center gap-4">
<div class="flex h-10 w-10 items-center justify-center rounded-full bg-success/10 text-success">
<span class="material-symbols-outlined">check_circle</span>
</div>
<div class="flex flex-col">
<span class="text-sm font-semibold text-[#111816] dark:text-white">Dec 12</span>
<span class="text-xs text-gray-500 dark:text-gray-400">04:30 PM â€¢ Level 2</span>
</div>
</div>
<span class="text-sm font-medium text-success">Present</span>
</div>
<!-- Item 2: Absent (Billable) -->
<div class="flex items-center justify-between p-4 rounded-lg bg-background-light dark:bg-gray-800/50 border border-transparent dark:border-gray-700">
<div class="flex items-center gap-4">
<div class="flex h-10 w-10 items-center justify-center rounded-full bg-error/10 text-error">
<span class="material-symbols-outlined">cancel</span>
</div>
<div class="flex flex-col">
<span class="text-sm font-semibold text-[#111816] dark:text-white">Dec 10</span>
<span class="text-xs text-gray-500 dark:text-gray-400">04:30 PM â€¢ Level 2</span>
</div>
</div>
<span class="text-sm font-medium text-error">Absent (Billable)</span>
</div>
<!-- Item 3: Excused -->
<div class="flex items-center justify-between p-4 rounded-lg bg-background-light dark:bg-gray-800/50 border border-transparent dark:border-gray-700">
<div class="flex items-center gap-4">
<div class="flex h-10 w-10 items-center justify-center rounded-full bg-warning/10 text-warning">
<span class="material-symbols-outlined">warning</span>
</div>
<div class="flex flex-col">
<span class="text-sm font-semibold text-[#111816] dark:text-white">Dec 08</span>
<span class="text-xs text-gray-500 dark:text-gray-400">Sick Leave</span>
</div>
</div>
<span class="text-sm font-medium text-warning">Excused</span>
</div>
<!-- Item 4: Present -->
<div class="flex items-center justify-between p-4 rounded-lg bg-background-light dark:bg-gray-800/50 border border-transparent dark:border-gray-700">
<div class="flex items-center gap-4">
<div class="flex h-10 w-10 items-center justify-center rounded-full bg-success/10 text-success">
<span class="material-symbols-outlined">check_circle</span>
</div>
<div class="flex flex-col">
<span class="text-sm font-semibold text-[#111816] dark:text-white">Dec 05</span>
<span class="text-xs text-gray-500 dark:text-gray-400">04:30 PM â€¢ Level 2</span>
</div>
</div>
<span class="text-sm font-medium text-success">Present</span>
</div>
</div>
</div>
<!-- Spacer for fixed footer -->
<div class="h-24"></div>
</main>
<!-- Action Footer -->
<footer class="fixed bottom-0 left-0 right-0 z-20 bg-white/90 dark:bg-[#111816]/90 backdrop-blur-md border-t border-gray-100 dark:border-gray-800 p-4 max-w-md mx-auto">
<div class="flex flex-col gap-3">
<button class="flex w-full items-center justify-center gap-2 rounded-xl bg-primary px-6 py-3.5 text-base font-bold text-white shadow-lg shadow-primary/30 transition-transform active:scale-[0.98]">
<span class="material-symbols-outlined">autorenew</span>
                    Renew Subscription
                </button>
<button class="flex w-full items-center justify-center gap-2 rounded-xl bg-background-light dark:bg-gray-800 px-6 py-3.5 text-base font-bold text-[#111816] dark:text-white transition-transform active:scale-[0.98] border border-gray-200 dark:border-gray-700">
<span class="material-symbols-outlined">ac_unit</span>
                    Freeze Membership
                </button>
</div>
</footer>
</div>
</body></html>
</file>

<file path="legacy_html/skill_evaluation_detail.html">
<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Skill Evaluation Detail</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#10b77f",
                        "primary-dark": "#0d9668",
                        "background-light": "#f6f8f7",
                        "background-dark": "#10221c",
                        "surface-light": "#ffffff",
                        "surface-dark": "#1a332d",
                        "secondary-text": "#4c9a80",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "1rem", 
                        "lg": "1.5rem", 
                        "xl": "2rem", 
                        "full": "9999px"
                    },
                    boxShadow: {
                        "soft": "0 4px 20px -2px rgba(16, 183, 127, 0.1)",
                        "card": "0 2px 10px rgba(0, 0, 0, 0.03)"
                    }
                },
            },
        }
    </script>
<style>.no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }.star-filled {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            color: #fbbf24;}
        .star-empty {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            color: #d1d5db;}.star-filled-purple {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            color: #a855f7;}
        .star-empty-purple {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            color: #e9d5ff;}details > summary {
            list-style: none;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        details[open] summary ~ * {
            animation: sweep .3s ease-in-out;
        }
        @keyframes sweep {
            0%    {opacity: 0; transform: translateY(-10px)}
            100%  {opacity: 1; transform: translateY(0)}
        }@keyframes toast-enter {
            0% { transform: translate(0, 50px) scale(0.9); opacity: 0; }
            100% { transform: translate(0, 0) scale(1); opacity: 1; }
        }
        @keyframes confetti-drop {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        .animate-toast {
            animation: toast-enter 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        .confetti-piece {
            position: absolute;
            top: -20px;
            width: 10px;
            height: 10px;
            border-radius: 4px;
            opacity: 0;
        }#challenge-complete:checked ~ .confetti-overlay .confetti-piece {
            animation: confetti-drop 2.5s ease-in forwards;
        }.confetti-piece:nth-child(1) { left: 10%; background: #a855f7; animation-delay: 0s; }
        .confetti-piece:nth-child(2) { left: 25%; background: #10b981; animation-delay: 0.2s; }
        .confetti-piece:nth-child(3) { left: 40%; background: #fbbf24; animation-delay: 0.4s; }
        .confetti-piece:nth-child(4) { left: 60%; background: #ef4444; animation-delay: 0.1s; }
        .confetti-piece:nth-child(5) { left: 75%; background: #3b82f6; animation-delay: 0.3s; }
        .confetti-piece:nth-child(6) { left: 90%; background: #ec4899; animation-delay: 0.5s; }
    </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark font-display text-gray-900 dark:text-gray-100 antialiased selection:bg-primary selection:text-white pb-32">
<header class="sticky top-0 z-40 w-full bg-background-light/90 dark:bg-background-dark/90 backdrop-blur-md border-b border-gray-200/50 dark:border-gray-800/50 transition-colors duration-300">
<div class="flex items-center justify-between px-4 py-3 max-w-md mx-auto">
<button class="flex items-center justify-center w-10 h-10 rounded-full bg-white dark:bg-surface-dark shadow-sm hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors text-gray-700 dark:text-gray-200">
<span class="material-symbols-outlined">arrow_back_ios_new</span>
</button>
<h1 class="text-lg font-bold tracking-tight text-gray-900 dark:text-white">Skill Evaluation</h1>
<div class="w-10 h-10"></div> 
</div>
</header>
<main class="w-full max-w-md mx-auto px-4 pt-6 flex flex-col gap-6">
<section class="flex flex-col items-center relative">
<div class="relative w-32 h-32 flex items-center justify-center mb-4">
<svg class="absolute inset-0 w-full h-full -rotate-90 transform" viewBox="0 0 100 100">
<circle class="text-gray-200 dark:text-gray-700" cx="50" cy="50" fill="none" r="46" stroke="currentColor" stroke-width="6"></circle>
<circle class="text-primary drop-shadow-sm" cx="50" cy="50" fill="none" r="46" stroke="currentColor" stroke-dasharray="245 289" stroke-linecap="round" stroke-width="6"></circle>
</svg>
<div class="w-28 h-28 rounded-full overflow-hidden border-4 border-background-light dark:border-background-dark shadow-inner relative z-10" data-alt="Close up portrait of a young male gymnast looking focused" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuA-shbbP924rP7tgrboTyKR-AmnfXc_1wfae_LtUWJxYpCL7TG-dcloCM704HwtnhaBeifU7JveaelEOcNsseynCRZUzQYf4hLEhyzKPot7yl__lQTRQGIItMPJlLF1xX5dDxB9vwNzQXWZ02sze_MKPSf2_UVYmIeA7ihCz_EwMn9Dy61I2H8W9KuOOb3aD56B6oZIuh4N7QJ0Ks_91LLfHqmQ_ACEPpNwTnu0pUalT_ISRpaf75e7mhghxmphDiAUtL6kfX3xO9ag'); background-size: cover; background-position: center;">
</div>
<div class="absolute -bottom-2 bg-primary text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg border-2 border-background-light dark:border-background-dark z-20">
                    85%
                </div>
</div>
<div class="text-center space-y-1">
<h2 class="text-2xl font-bold text-gray-900 dark:text-white">Adam Ali</h2>
<span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-200 border border-amber-200 dark:border-amber-800/50">
<span class="material-symbols-outlined text-[14px] mr-1 filled">military_tech</span>
                    Bronze Level
                </span>
</div>
</section>
<section class="flex flex-col gap-4">
<details class="group bg-surface-light dark:bg-surface-dark rounded-xl shadow-card border border-primary/20 overflow-hidden transition-all duration-300" open="">
<summary class="flex cursor-pointer items-center justify-between p-4 bg-primary/5 dark:bg-primary/10 transition-colors">
<div class="flex items-center gap-3">
<div class="w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center text-primary">
<span class="material-symbols-outlined">accessibility_new</span>
</div>
<div class="flex flex-col">
<span class="text-gray-900 dark:text-white font-bold text-base">Floor Exercise</span>
<span class="text-xs text-primary font-medium">2 skills pending review</span>
</div>
</div>
<span class="material-symbols-outlined text-primary transition-transform duration-300 group-open:rotate-180">expand_more</span>
</summary>
<div class="p-4 space-y-6 bg-white dark:bg-surface-dark">
<div class="flex flex-col gap-2">
<div class="flex justify-between items-center">
<span class="text-sm font-medium text-gray-900 dark:text-gray-100">Forward Roll</span>
<span class="text-xs font-medium text-yellow-500 bg-yellow-50 dark:bg-yellow-900/20 px-2 py-0.5 rounded">Good</span>
</div>
<div class="flex items-center justify-between bg-gray-50 dark:bg-black/20 p-3 rounded-lg border border-gray-100 dark:border-white/5">
<div class="flex gap-2">
<span class="material-symbols-outlined star-filled text-3xl cursor-pointer">star</span>
<span class="material-symbols-outlined star-filled text-3xl cursor-pointer">star</span>
<span class="material-symbols-outlined star-filled text-3xl cursor-pointer">star</span>
<span class="material-symbols-outlined star-empty text-3xl cursor-pointer">star</span>
<span class="material-symbols-outlined star-empty text-3xl cursor-pointer">star</span>
</div>
<button class="text-gray-400 hover:text-primary transition-colors">
<span class="material-symbols-outlined text-xl">comment</span>
</button>
</div>
</div>
<div class="h-px w-full bg-gray-100 dark:bg-gray-700"></div>
<div class="flex flex-col gap-2">
<div class="flex justify-between items-center">
<span class="text-sm font-medium text-gray-900 dark:text-gray-100">Cartwheel</span>
<span class="text-xs font-medium text-primary bg-green-50 dark:bg-green-900/20 px-2 py-0.5 rounded">Excellent</span>
</div>
<div class="flex items-center justify-between bg-gray-50 dark:bg-black/20 p-3 rounded-lg border border-gray-100 dark:border-white/5">
<div class="flex gap-2">
<span class="material-symbols-outlined star-filled text-3xl cursor-pointer">star</span>
<span class="material-symbols-outlined star-filled text-3xl cursor-pointer">star</span>
<span class="material-symbols-outlined star-filled text-3xl cursor-pointer">star</span>
<span class="material-symbols-outlined star-filled text-3xl cursor-pointer">star</span>
<span class="material-symbols-outlined star-filled text-3xl cursor-pointer">star</span>
</div>
<button class="text-primary transition-colors relative">
<span class="absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full"></span>
<span class="material-symbols-outlined text-xl">comment</span>
</button>
</div>
</div>
</div>
</details>
<details class="group bg-surface-light dark:bg-surface-dark rounded-xl shadow-card border border-transparent dark:border-white/5 overflow-hidden">
<summary class="flex cursor-pointer items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-white/5 transition-colors">
<div class="flex items-center gap-3">
<div class="w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-gray-500 dark:text-gray-400">
<span class="material-symbols-outlined">sports_gymnastics</span>
</div>
<div class="flex flex-col">
<span class="text-gray-900 dark:text-white font-medium text-base">Vault</span>
<span class="text-xs text-gray-500 dark:text-gray-400">0/3 Rated</span>
</div>
</div>
<span class="material-symbols-outlined text-gray-400 group-open:rotate-180 transition-transform duration-300">expand_more</span>
</summary>
<div class="p-4 bg-white dark:bg-surface-dark">
<p class="text-sm text-gray-500">Loading skills...</p>
</div>
</details>
<details class="group bg-surface-light dark:bg-surface-dark rounded-xl shadow-card border border-transparent dark:border-white/5 overflow-hidden">
<summary class="flex cursor-pointer items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-white/5 transition-colors">
<div class="flex items-center gap-3">
<div class="w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-gray-500 dark:text-gray-400">
<span class="material-symbols-outlined">fitness_center</span>
</div>
<div class="flex flex-col">
<span class="text-gray-900 dark:text-white font-medium text-base">Horizontal Bar</span>
<span class="text-xs text-gray-500 dark:text-gray-400">1/4 Rated</span>
</div>
</div>
<span class="material-symbols-outlined text-gray-400 group-open:rotate-180 transition-transform duration-300">expand_more</span>
</summary>
<div class="p-4 bg-white dark:bg-surface-dark">
<p class="text-sm text-gray-500">Loading skills...</p>
</div>
</details>
</section>
<section class="flex flex-col gap-4 relative">
<div class="flex items-center gap-2 px-1">
<h3 class="text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2">
<span>ðŸ†</span> Weekly Challenges
         </h3>
</div>
<input class="peer hidden" id="challenge-complete" type="checkbox"/>
<div class="relative overflow-hidden bg-purple-50 dark:bg-purple-900/20 rounded-2xl p-5 border-2 border-purple-200 dark:border-purple-800/50 shadow-sm transition-all duration-300 peer-checked:border-purple-400 peer-checked:shadow-purple-200/50 group">
<div class="flex items-start justify-between mb-4">
<div class="flex items-center gap-3">
<div class="w-12 h-12 rounded-xl bg-purple-100 dark:bg-purple-800/40 text-purple-600 dark:text-purple-300 flex items-center justify-center shadow-sm">
<span class="material-symbols-outlined text-2xl">emoji_events</span>
</div>
<div class="flex flex-col">
<h4 class="font-bold text-gray-900 dark:text-white text-lg">Monkey Walk</h4>
<span class="text-xs font-medium text-purple-600 dark:text-purple-300 bg-purple-100 dark:bg-purple-900/40 px-2 py-0.5 rounded-full w-fit mt-1">Bar â€¢ 50pts</span>
</div>
</div>
<div class="hidden peer-checked:flex bg-gradient-to-r from-purple-500 to-indigo-500 text-white text-[10px] font-bold px-2 py-1 rounded shadow-sm items-center gap-1 animate-pulse">
<span>COMPLETED</span>
<span class="material-symbols-outlined text-[12px]">check</span>
</div>
</div>
<p class="text-sm text-gray-600 dark:text-gray-300 mb-4 leading-relaxed">
            Traverse the full length of the bar using only hands. Keep legs straight!
        </p>
<div class="flex items-center justify-between bg-white/60 dark:bg-black/20 p-3 rounded-xl border border-purple-100 dark:border-purple-800/30 backdrop-blur-sm">
<div class="flex gap-1.5">
<span class="material-symbols-outlined star-filled-purple text-3xl">star</span>
<span class="material-symbols-outlined star-filled-purple text-3xl">star</span>
<span class="material-symbols-outlined star-filled-purple text-3xl">star</span>
<span class="material-symbols-outlined star-filled-purple text-3xl">star</span>
<label class="cursor-pointer transition-transform active:scale-95" for="challenge-complete">
<span class="material-symbols-outlined star-filled-purple text-3xl hidden peer-checked:block">star</span>
<span class="material-symbols-outlined star-empty-purple text-3xl block peer-checked:hidden">star</span>
</label>
</div>
<span class="text-xs font-bold text-purple-400 dark:text-purple-500 uppercase tracking-wide">Rate</span>
</div>
</div>
<div class="confetti-overlay fixed inset-0 pointer-events-none hidden peer-checked:flex flex-col items-center justify-end z-50 pb-24 overflow-hidden">
<div class="absolute inset-0 w-full h-full">
<div class="confetti-piece"></div>
<div class="confetti-piece"></div>
<div class="confetti-piece"></div>
<div class="confetti-piece"></div>
<div class="confetti-piece"></div>
<div class="confetti-piece"></div>
</div>
<div class="animate-toast bg-gray-900 dark:bg-white text-white dark:text-gray-900 px-5 py-3 rounded-2xl shadow-2xl flex items-center gap-3 border border-white/10 dark:border-gray-200 mx-4 mb-4">
<div class="w-8 h-8 bg-gradient-to-tr from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white shrink-0 shadow-lg">
<span class="material-symbols-outlined text-sm">emoji_events</span>
</div>
<div class="flex flex-col">
<h4 class="font-bold text-sm">Achievement Unlocked!</h4>
<p class="text-xs opacity-80 font-medium">Jungle Master</p>
</div>
</div>
</div>
</section>
</main>
<div class="fixed bottom-0 left-0 w-full bg-white/90 dark:bg-surface-dark/90 backdrop-blur-lg border-t border-gray-100 dark:border-gray-800 p-4 pb-6 z-40">
<div class="max-w-md mx-auto flex items-center gap-4">
<div class="flex flex-col">
<span class="text-[10px] uppercase tracking-wider text-gray-500 font-bold">Progress</span>
<span class="text-sm font-semibold text-gray-900 dark:text-white">2/9 Skills</span>
</div>
<button class="flex-1 bg-primary hover:bg-primary-dark text-white font-bold text-base py-3.5 px-6 rounded-full shadow-lg shadow-primary/30 active:scale-[0.98] transition-all flex items-center justify-center gap-2">
<span>Save &amp; Next Player</span>
<span class="material-symbols-outlined text-lg">arrow_forward</span>
</button>
</div>
</div>
</body></html>
</file>

<file path="legacy_html/team_chat_&_communication.html">
<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Team Chat &amp; Communication - Wild Robot</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#10b77f",
                        "primary-dark": "#0d9668",
                        "emerald-green": "#10b981",
                        "background-light": "#f6f8f7",
                        "background-dark": "#10221c",
                        "surface-light": "#ffffff",
                        "surface-dark": "#162e26",
                        "text-main-light": "#0d1b17",
                        "text-main-dark": "#e0e7e5",
                        "text-sub-light": "#4c9a80",
                        "text-sub-dark": "#8fcab5",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: {"DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px"},
                },
            },
        }
    </script>
<style>.no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark font-display antialiased transition-colors duration-200">
<div class="relative flex h-full min-h-screen w-full flex-col max-w-md mx-auto shadow-2xl overflow-hidden bg-background-light dark:bg-background-dark">
<header class="sticky top-0 z-20 bg-surface-light/95 dark:bg-surface-dark/95 backdrop-blur-md border-b border-gray-100 dark:border-gray-800 px-4 py-3 flex items-center justify-between">
<h1 class="text-2xl font-bold tracking-tight text-text-main-light dark:text-text-main-dark">Messages</h1>
<div class="flex items-center gap-4">
<button aria-label="Search" class="p-2 text-text-main-light dark:text-text-main-dark hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors">
<span class="material-symbols-outlined text-[24px]">search</span>
</button>
<button class="text-primary font-semibold text-sm hover:text-primary-dark transition-colors">
                    New Group
                </button>
</div>
</header>
<div class="sticky top-[60px] z-10 bg-background-light dark:bg-background-dark pt-3 pb-2 px-4">
<div class="flex gap-2 overflow-x-auto no-scrollbar pb-2">
<button class="flex h-9 shrink-0 items-center justify-center px-5 rounded-lg bg-primary text-white shadow-sm shadow-primary/20 transition-all active:scale-95">
<span class="text-sm font-medium">All</span>
</button>
<button class="flex h-9 shrink-0 items-center justify-center px-5 rounded-lg bg-white dark:bg-surface-dark border border-gray-200 dark:border-gray-700 text-text-main-light dark:text-text-main-dark hover:bg-gray-50 dark:hover:bg-gray-800 transition-all active:scale-95">
<span class="text-sm font-medium">Staff</span>
</button>
<button class="flex h-9 shrink-0 items-center justify-center px-5 rounded-lg bg-white dark:bg-surface-dark border border-gray-200 dark:border-gray-700 text-text-main-light dark:text-text-main-dark hover:bg-gray-50 dark:hover:bg-gray-800 transition-all active:scale-95">
<span class="text-sm font-medium">Parents</span>
</button>
<button class="flex h-9 shrink-0 items-center justify-center px-5 rounded-lg bg-white dark:bg-surface-dark border border-gray-200 dark:border-gray-700 text-text-main-light dark:text-text-main-dark hover:bg-gray-50 dark:hover:bg-gray-800 transition-all active:scale-95">
<span class="text-sm font-medium">Groups</span>
</button>
</div>
</div>
<main class="flex-1 overflow-y-auto px-2 pb-24">
<div class="group relative flex items-center gap-3 p-3 rounded-xl hover:bg-white dark:hover:bg-surface-dark transition-colors cursor-pointer border-b border-gray-100 dark:border-gray-800 last:border-0">
<div class="relative shrink-0 size-[52px] rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800 grid grid-cols-2 gap-[1px]">
<div class="bg-cover bg-center" data-alt="Portrait of a coach smiling" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuA302Vfj_scbVHFJJ7Cxv_Lp8zOGaIe2pZaJg_gj-id96ETCDOqmaQh4QP73w7b4iC0DB5oCgCUfDzq7sh3U6SbbwUILliS-CjAAOeF66jQU1MgaSKCfaaJ-M7AKZbB5l56XLUykurAtKVFSqT9L11jShkp-4-9ZkRJmhkK_i6EiohA1-43pwziwz_ED6YlH4SwAh-KGeVzH8pT6IxRFCQIBFrD5Cp13WBfL57snDlWD_jQ9vgPNmY-065xxyK4lf6xfCm1_qw9l0Ir');"></div>
<div class="bg-cover bg-center" data-alt="Portrait of a gym staff member" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuCUOlCN1IzFhlomMGWeAEyFjFqj-tPQDPcr9OTb-puz0VMkt_qadQep5hVfLHpoExqJ9gpRU7t4YmpnPGa0SBJysNucRUjsPXh4EokefyZfkcE1ikuNv7AAQqKnp9dYGYO9wy7aEFg0W-kEe1upl4xHgyoU5fhhwdGqbxpp-pvf-TI9LFp-EBP5Bf5Si-DsC2j4XpfTiEH6ounWRSMdGUEVUrbdQYYt9vTqwlvqyplIlQZEwD0E9lyEMtQUlvjNr38UB9GUqfxYD5_L');"></div>
<div class="bg-cover bg-center" data-alt="Portrait of a female coach" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuAP31tI5xEC0tI9Io9JDC51tOPep1Xs0nb8J5mS2PS4XwK_6tsPR7yL1YZHJTCy5uRHf-tK7WOu2qbF2ev13_uMZltqbkXRKKND6Jx5sWUF3n56ecNXKKa2fs1hw2iDdze5GOtzhyCQc4e7kkxmQvW0SBk44uK_qze1LK_rIF748k-adtCqF9DJgj3clyQ-p2KoJdpzH8VIUEvTm87JR6vkytJiVXMEENXm3MHcVw15whboEdrMjGLH_AczX0h9__7gIFV6tBEXkfC0');"></div>
<div class="bg-primary/20 flex items-center justify-center text-[10px] font-bold text-primary">+3</div>
</div>
<div class="flex flex-col flex-1 min-w-0 justify-center">
<div class="flex justify-between items-baseline mb-0.5">
<h3 class="text-text-main-light dark:text-text-main-dark text-[15px] font-semibold truncate pr-2">Tilal Coaches ðŸ”µ</h3>
<span class="text-text-sub-light dark:text-text-sub-dark text-xs font-medium whitespace-nowrap">10:30 AM</span>
</div>
<div class="flex justify-between items-center">
<p class="text-gray-500 dark:text-gray-400 text-[13px] truncate pr-4">Admin: Schedule updated for tomorrow...</p>
<div class="flex items-center justify-center size-5 bg-primary rounded-full text-[10px] font-bold text-white shrink-0">3</div>
</div>
</div>
</div>
<div class="group relative flex items-center gap-3 p-3 rounded-xl hover:bg-white dark:hover:bg-surface-dark transition-colors cursor-pointer border-b border-gray-100 dark:border-gray-800">
<div class="relative shrink-0">
<div class="size-[52px] rounded-full bg-cover bg-center border-2 border-white dark:border-background-dark shadow-sm" data-alt="Portrait of Coach Sarah" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuBnxlF3VlCD0w3QHRCKdqi4g4FGTQdVddEyHcuqP1iRK1rpoegqTZ6rwR6q2HgQtsMHQqKQIhKeRNIWhdblvfCc4xf744ODtkhihL1X8g7rIcxmye-AKyT7F_Ak9ZXYZlkgHVmL7f6gJXC_HM7HNEMO2FZafPGw7HlyroK5ESU3bO0EHPY3IIKDHjR3e-17EsiUedkVrAje-sHz8nO1nUwep16nLMkat1Pg0kU09eec97EQMVXVZKzE3YGFNB2sZnKNssyVTJbPaHeE');"></div>
<div class="absolute bottom-0 right-0 size-3.5 bg-primary border-2 border-white dark:border-background-dark rounded-full"></div>
</div>
<div class="flex flex-col flex-1 min-w-0 justify-center">
<div class="flex justify-between items-baseline mb-0.5">
<h3 class="text-text-main-light dark:text-text-main-dark text-[15px] font-semibold truncate pr-2">Coach Sarah</h3>
<span class="text-primary text-xs font-bold whitespace-nowrap">9:45 AM</span>
</div>
<p class="text-text-main-light dark:text-text-main-dark font-medium text-[13px] truncate pr-4">Can you cover my shift?</p>
</div>
</div>
<div class="group relative flex items-center gap-3 p-3 rounded-xl hover:bg-white dark:hover:bg-surface-dark transition-colors cursor-pointer border-b border-gray-100 dark:border-gray-800">
<div class="relative shrink-0 size-[52px] rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800 grid grid-cols-2 gap-[1px]">
<div class="bg-cover bg-center col-span-1 h-full" data-alt="Abstract colorful pattern" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuAmY_vwvWIE5mo6p1Dh_oWT7P2NNdmbu1P-iH3H7Gv4ViATQxPt16gaYlCS8hBYdo3AyDFF8InfoLUfyZkH1PIhs_-iSLMSnRU0mMk7diCDCcgpLLXlINcBAfgYrj__INSgo7ryi8jvZ3EJ3cnF3zdzvlwixmwCLHDFwx-HwA1nAkH3Rhgee1kB65xJ34LQ-EXUiWKXR2SLFM5iO9eBeWlT-wb7TuDuD71co6vMj3cpiWG7UVwhD4IZ-YvBV-iz6O6K41_X8z1A1fpx');"></div>
<div class="col-span-1 grid grid-rows-2 gap-[1px]">
<div class="bg-cover bg-center h-full" data-alt="Portrait of a parent" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuCix5ZhlbKdNPIGA30FUZ7vpuRYJf21fQ3YzPwrE1MVsDyaeoiNDm2zV_MZVfE3He-eKyLSQW9T0ZmYQEoJJi2QWo-HqTo8OtJHaNMb3-QAQZ8ObyiDyPeeyGcO9EWCYN_kpewGaVe32Xs5FB2CDbSCmQiaBfShsxmzlW6V6mis7qgdduJ8D3oWg5mn8fcXQMIBClz4Qe2a3KpgVlWWNOfuqHyoSrb8rO4WQEI6cKIYO7Yy81pAd3r4bC4jDg9LyRKAKTSSiO_Rq4hK');"></div>
<div class="bg-cover bg-center h-full" data-alt="Portrait of another parent" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuDbEVF8hUY7hkdzmgoCr7YPeCdvjTXg_4if0XDLfWutbvjbeUqAOmFFwL5fpuI544YKXblpy5fxvLIwINBwpEbd54VphypkgKlOx0Yz6QucnGdZGXtaulrmQl9IJ4cYgckg5gbjwPjxEstab_PUFXzIGxm23o9xG1XNvf_uQw_VihVjeMW-4OfvQYYMq-5UHLUoq0pRejIvvy5WPCQzO08FyHhlfB-zvlqaXBd0QN-nNAMYUhNe_bnetek_FMpeXvNPhSXyDfmUwIBD');"></div>
</div>
</div>
<div class="flex flex-col flex-1 min-w-0 justify-center">
<div class="flex justify-between items-baseline mb-0.5">
<h3 class="text-text-main-light dark:text-text-main-dark text-[15px] font-semibold truncate pr-2">Elite Squad Parents</h3>
<span class="text-text-sub-light dark:text-text-sub-dark text-xs font-medium whitespace-nowrap">Yesterday</span>
</div>
<div class="flex justify-between items-center">
<p class="text-gray-500 dark:text-gray-400 text-[13px] truncate pr-4">Please remember leotards for the competition!</p>
</div>
</div>
</div>
<div class="group relative flex items-center gap-3 p-3 rounded-xl hover:bg-white dark:hover:bg-surface-dark transition-colors cursor-pointer border-b border-gray-100 dark:border-gray-800">
<div class="relative shrink-0">
<div class="size-[52px] rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-indigo-600 dark:text-indigo-300 font-bold text-lg border-2 border-white dark:border-background-dark shadow-sm">
                        FD
                    </div>
</div>
<div class="flex flex-col flex-1 min-w-0 justify-center">
<div class="flex justify-between items-baseline mb-0.5">
<h3 class="text-text-main-light dark:text-text-main-dark text-[15px] font-semibold truncate pr-2">Front Desk</h3>
<span class="text-text-sub-light dark:text-text-sub-dark text-xs font-medium whitespace-nowrap">Mon</span>
</div>
<p class="text-text-main-light dark:text-text-main-dark font-medium text-[13px] truncate pr-4">New registration pending approval.</p>
</div>
</div>
<div class="group relative flex items-center gap-3 p-3 rounded-xl hover:bg-white dark:hover:bg-surface-dark transition-colors cursor-pointer border-b border-gray-100 dark:border-gray-800">
<div class="relative shrink-0">
<div class="size-[52px] rounded-full bg-cover bg-center border-2 border-white dark:border-background-dark shadow-sm grayscale opacity-80" data-alt="Portrait of Coach Mike" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuCl5zVMb3L1moFFytfnY_vZi6prEuxIw2V9HkKedcz17jJzWpd03fiSjYHHaznjPJNKB3Vgd2uxzHnmQuO8QFaE8hEmu9ESJXgWp9Z75WfiajQI3ClA0isKitOhySz8rWOPHNh3j3-sSwrWaYSLq4AVpsREIgK6UDW5tjcNDXK5ETa2_JDGNGh8GPVhxu5El1sN6KvxHOyldOxsfWFdlkqPxH-yYU-Cgx5iaEow_pcR4LUiLUaCHampTRjsBk_ToKZk377rI5lg5b6A');"></div>
</div>
<div class="flex flex-col flex-1 min-w-0 justify-center">
<div class="flex justify-between items-baseline mb-0.5">
<h3 class="text-text-main-light dark:text-text-main-dark text-[15px] font-semibold truncate pr-2">Head Coach Mike</h3>
<span class="text-text-sub-light dark:text-text-sub-dark text-xs font-medium whitespace-nowrap">Sun</span>
</div>
<p class="text-gray-500 dark:text-gray-400 text-[13px] truncate pr-4">Equipment inspection complete.</p>
</div>
</div>
<div class="group relative flex items-center gap-3 p-3 rounded-xl hover:bg-white dark:hover:bg-surface-dark transition-colors cursor-pointer border-b border-gray-100 dark:border-gray-800">
<div class="relative shrink-0 size-[52px] rounded-lg overflow-hidden bg-purple-100 dark:bg-purple-900 flex items-center justify-center">
<span class="material-symbols-outlined text-purple-600 dark:text-purple-300">event</span>
</div>
<div class="flex flex-col flex-1 min-w-0 justify-center">
<div class="flex justify-between items-baseline mb-0.5">
<h3 class="text-text-main-light dark:text-text-main-dark text-[15px] font-semibold truncate pr-2">Events Committee</h3>
<span class="text-text-sub-light dark:text-text-sub-dark text-xs font-medium whitespace-nowrap">Sun</span>
</div>
<p class="text-gray-500 dark:text-gray-400 text-[13px] truncate pr-4">Venue booked for Winter Gala.</p>
</div>
</div>
<div class="group relative flex items-center gap-3 p-3 rounded-xl hover:bg-white dark:hover:bg-surface-dark transition-colors cursor-pointer border-b border-gray-100 dark:border-gray-800">
<div class="relative shrink-0">
<div class="size-[52px] rounded-full bg-cover bg-center border-2 border-white dark:border-background-dark shadow-sm" data-alt="Portrait of Equipment Manager" style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuD6Mgh1kj85Cp270oqSPp_RG2Cnv2F0IZjnD7ot_WJqCYB93Tr7J_mNSy8nzG5nOkgLeTK-npUAqHQwcgZIku9hfs1OtN5kyRGAZpb_Z1r0gwilGqJRwOuxVXKckmOx8K-xFP4EgFSBQCYwn3nY4nR0MBz3uhRfDJiQI1LEAhlfK853HlPsd8F0JAhMK2w7e_ESPrMM9rPs1yVZG8qXqiBuQ-rLbcbJweLn4hdWElKHsFw08b03FFLNdd98vg9wATOwiGatBsWfizKP');"></div>
<div class="absolute bottom-0 right-0 size-3.5 bg-primary border-2 border-white dark:border-background-dark rounded-full"></div>
</div>
<div class="flex flex-col flex-1 min-w-0 justify-center">
<div class="flex justify-between items-baseline mb-0.5">
<h3 class="text-text-main-light dark:text-text-main-dark text-[15px] font-semibold truncate pr-2">Equipment Mgr.</h3>
<span class="text-text-sub-light dark:text-text-sub-dark text-xs font-medium whitespace-nowrap">Sat</span>
</div>
<p class="text-gray-500 dark:text-gray-400 text-[13px] truncate pr-4">The new foam pit blocks have arrived.</p>
</div>
</div>
<div class="h-20"></div>
</main>
<button class="fixed bottom-[90px] right-6 z-30 flex items-center justify-center size-14 bg-primary hover:bg-primary-dark text-white rounded-lg shadow-[0_4px_20px_rgba(16,183,127,0.4)] transition-all active:scale-90 active:rotate-90">
<span class="material-symbols-outlined text-[28px]">edit_square</span>
</button>
<nav class="fixed bottom-0 z-20 w-full max-w-md bg-white dark:bg-surface-dark border-t border-gray-100 dark:border-gray-800 pb-safe">
<div class="flex justify-between items-center h-[70px] px-2">
<a class="flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-emerald-green transition-colors gap-1.5" href="#">
<span class="material-symbols-outlined text-[26px]">home</span>
<span class="text-[10px] font-medium">Home</span>
</a>
<a class="flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-emerald-green transition-colors gap-1.5" href="#">
<span class="material-symbols-outlined text-[26px]">calendar_today</span>
<span class="text-[10px] font-medium">Schedule</span>
</a>
<a class="flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-emerald-green transition-colors gap-1.5" href="#">
<span class="material-symbols-outlined text-[26px]">groups</span>
<span class="text-[10px] font-medium">Roster</span>
</a>
<a class="flex flex-col items-center justify-center w-full h-full text-emerald-green transition-colors gap-1.5" href="#">
<span class="material-symbols-outlined text-[26px] fill-1">chat_bubble</span>
<span class="text-[10px] font-medium">Chat</span>
</a>
<a class="flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-emerald-green transition-colors gap-1.5" href="#">
<span class="material-symbols-outlined text-[26px]">person</span>
<span class="text-[10px] font-medium">Profile</span>
</a>
</div>
</nav>
</div>
</body></html>
</file>

<file path="lint_output.txt">
> wild-robot@0.0.0 lint
> eslint .

node.exe : 
At C:\Program Files\n
odejs\npm.ps1:29 
char:3
+   & $NODE_EXE 
$NPM_CLI_JS $args
+   ~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~
    + CategoryInfo   
           : NotSpe  
  cified: (:String   
 ) [], RemoteExce    
ption
    + FullyQualified 
   ErrorId : Native  
  CommandError
 
Oops! Something went 
wrong! :(

ESLint: 8.57.1

ESLint couldn't find 
a configuration 
file. To set up a 
configuration file 
for this project, 
please run:

    npm init 
@eslint/config

ESLint looked for 
configuration files 
in D:\work\PROGRAMING
\wild-robot-system\di
st\assets and its 
ancestors. If it 
found none, it then 
looked in your home 
directory.

If you think you 
already have a 
configuration file 
or if you need more 
help, please stop by 
the ESLint Discord 
server: https://eslin
t.org/chat
</file>

<file path="postcss.config.js">
export default {
    plugins: {
        tailwindcss: {},
        autoprefixer: {},
    },
}
</file>

<file path="public/manifest.json">
{
    "name": "Wild Robot",
    "short_name": "Wild Robot",
    "start_url": "/",
    "display": "standalone",
    "background_color": "#ffffff",
    "theme_color": "#10b77f",
    "icons": [
        {
            "src": "/icons/icon-192.png",
            "sizes": "192x192",
            "type": "image/png"
        },
        {
            "src": "/icons/icon-512.png",
            "sizes": "512x512",
            "type": "image/png"
        }
    ]
}
</file>

<file path="scripts/check_users.js">
import { createClient } from '@supabase/supabase-js';
import dotenv from 'dotenv';
import path from 'path';

dotenv.config({ path: path.resolve(process.cwd(), '.env') });

const supabaseUrl = process.env.VITE_SUPABASE_URL;
const supabaseKey = process.env.VITE_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseKey) {
    console.error("Missing Supabase credentials");
    process.exit(1);
}

const supabase = createClient(supabaseUrl, supabaseKey);

async function checkUsers() {
    console.log("Checking profiles...");
    const { data: profiles, error } = await supabase
        .from('profiles')
        .select('*');

    if (error) {
        console.error("Error fetching profiles:", error);
    } else {
        console.log("Found Profiles:", profiles.length);
        profiles.forEach(p => console.log(`- ${p.email} (Role: ${p.role})`));

        const salesUser = profiles.find(p => p.email === 'sales@wildrobot.com');
        if (salesUser) {
            console.log("\nSales user FOUND in profiles.");
        } else {
            console.log("\nSales user NOT FOUND in profiles.");
        }
    }
}

checkUsers();
</file>

<file path="scripts/create_missing_profile.sql">
-- FIX MISSING PROFILE
-- The previous update returned "No rows", meaning this user exists in Auth but NOT in the database tables.

-- 1. Insert the missing profile by copying data from Auth System
INSERT INTO public.profiles (id, email, role, full_name, created_at, updated_at)
SELECT 
    id, 
    email, 
    'athlete',             -- Force role to athlete
    'Student User',        -- Default name
    created_at, 
    now()
FROM auth.users
WHERE email = 'student@wildrobot.com'
ON CONFLICT (id) DO UPDATE -- In case it exists but was hidden (just update role)
SET role = 'athlete';

-- 2. Verify Result
SELECT * FROM public.profiles WHERE email = 'student@wildrobot.com';
</file>

<file path="scripts/decommission_device_limits.sql">
-- 1. DROP TRIGGER
DROP TRIGGER IF EXISTS on_device_limit_displacement ON public.active_sessions;

-- 2. DROP FUNCTION
DROP FUNCTION IF EXISTS public.handle_device_limit_displacement();

-- 3. PURGE SESSIONS (Unlock everyone)
TRUNCATE TABLE public.active_sessions;

-- 4. OPTIONAL: Drop the table entirely if we don't want to track anything?
-- For now, we just leave the table but stop enforcing.
</file>

<file path="scripts/emergency_db_fix.sql">
-- âš ï¸ EMERGENCY DATABASE FIX âš ï¸
-- Execute this script in your Supabase SQL Editor to resolve "Access Denied" and enable Smart Eviction.

-- 1. HARD RESET: Clear all stuck sessions/ghost logins
TRUNCATE TABLE public.active_sessions;

-- 2. INCREASE ADMIN LIMIT: Ensure Project Manager has access (Minimum 2 Devices)
UPDATE public.profiles 
SET max_allowed_devices = 2 
WHERE email = 'abdulla.smozy@gmail.com';

-- 3. SMART EVICTION ENGINE (The Iron Dome Upgrade)
-- Logic: If user tries to login and is at capacity, automatically kick out the OLDEST session.
CREATE OR REPLACE FUNCTION handle_device_limit_displacement()
RETURNS TRIGGER AS $$
DECLARE
    device_limit INTEGER;
    current_count INTEGER;
BEGIN
    -- Get User's Limit
    SELECT max_allowed_devices INTO device_limit
    FROM public.profiles
    WHERE id = NEW.user_id;

    -- Default to 1 if not set
    IF device_limit IS NULL THEN
        device_limit := 1;
    END IF;

    -- Check current count
    SELECT COUNT(*) INTO current_count
    FROM public.active_sessions
    WHERE user_id = NEW.user_id;

    -- If we are at (or above) capacity, EVICT the oldest
    IF current_count >= device_limit THEN
        DELETE FROM public.active_sessions
        WHERE id = (
            SELECT id FROM public.active_sessions
            WHERE user_id = NEW.user_id
            ORDER BY last_active ASC
            LIMIT 1
        );
    END IF;

    RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- Bind Trigger
DROP TRIGGER IF EXISTS on_device_limit_displacement ON public.active_sessions;
CREATE TRIGGER on_device_limit_displacement
BEFORE INSERT ON public.active_sessions
FOR EACH ROW
EXECUTE FUNCTION handle_device_limit_displacement();
</file>

<file path="scripts/fix_profiles_rls.sql">
-- FIX PROFILES RLS POLICY
-- The issue is likely that "student@wildrobot.com" can login (Auth), 
-- but cannot READ their own row in 'public.profiles' to check their role.

-- 1. Enable RLS (Good practice to ensure it's on)
ALTER TABLE public.profiles ENABLE ROW LEVEL SECURITY;

-- 2. Drop existing policies to avoid conflicts (clean slate for viewing)
DROP POLICY IF EXISTS "Users can view own profile" ON public.profiles;
DROP POLICY IF EXISTS "Public profiles are viewable by everyone" ON public.profiles;

-- 3. Create the permissive policy for OWN profile
CREATE POLICY "Users can view own profile"
ON public.profiles
FOR SELECT
USING (auth.uid() = id);

-- 4. Verify it worked
-- (You can run this, but in SQL Editor you are admin so it always works. 
-- The real test is the app).
</file>

<file path="scripts/fix_signup_trigger.sql">
-- FIX SIGNUP ERROR (Database error saving new user)
-- Causes:
-- 1. New columns (phone, date_of_birth) might be NOT NULL but Signup.jsx validates nothing.
-- 2. Trigger might be failing on strict casting or RLS.

-- A. Relax Constraints for Signup Flow
-- The user doesn't have an academy or phone number yet when signing up.
ALTER TABLE public.profiles ALTER COLUMN phone DROP NOT NULL;
ALTER TABLE public.profiles ALTER COLUMN date_of_birth DROP NOT NULL;
ALTER TABLE public.profiles ALTER COLUMN academy_name DROP NOT NULL;
ALTER TABLE public.profiles ALTER COLUMN academy_id DROP NOT NULL;

-- Ensure setup_skipped has a default
ALTER TABLE public.profiles ALTER COLUMN setup_skipped SET DEFAULT false;

-- B. Update the Trigger Function
-- We use SECURITY DEFINER so it runs with admin privileges, bypassing RLS issues during signup.
CREATE OR REPLACE FUNCTION public.handle_new_user()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO public.profiles (
    id, 
    full_name, 
    role, 
    email, 
    phone, 
    date_of_birth, 
    setup_skipped, 
    academy_name,
    academy_id
  )
  VALUES (
    new.id,
    new.raw_user_meta_data->>'full_name',
    -- Default to 'coach' if role is missing or invalid
    COALESCE((new.raw_user_meta_data->>'role')::public.app_role, 'owner'::public.app_role),
    new.email,
    -- Handle Empty/Null phone
    NULLIF(new.raw_user_meta_data->>'phone', ''),
    -- Handle Date Casting safely
    CASE 
        WHEN new.raw_user_meta_data->>'date_of_birth' = '' THEN NULL
        WHEN new.raw_user_meta_data->>'date_of_birth' IS NULL THEN NULL
        ELSE (new.raw_user_meta_data->>'date_of_birth')::date 
    END,
    -- Setup Skipped
    COALESCE((new.raw_user_meta_data->>'setup_skipped')::boolean, false),
    -- Academy info (Might be null for new signups)
    new.raw_user_meta_data->>'academy_name',
    (new.raw_user_meta_data->>'academy_id')::uuid
  )
  ON CONFLICT (id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    email = EXCLUDED.email,
    role = EXCLUDED.role;
    
  RETURN new;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- C. Ensure Trigger is Bound
DROP TRIGGER IF EXISTS on_auth_user_created ON auth.users;
CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE PROCEDURE public.handle_new_user();
</file>

<file path="scripts/smart_displacement.sql">
-- 1. CLEANUP OLD LOGIC
DROP TRIGGER IF EXISTS on_device_limit_displacement ON public.active_sessions;
DROP FUNCTION IF EXISTS public.handle_device_limit_displacement();
DROP TRIGGER IF EXISTS check_device_limit_insert ON public.active_sessions;
DROP FUNCTION IF EXISTS public.enforce_device_limit();

-- 2. CREATE FUNCTION FOR SMART DISPLACEMENT (Newest Wins)
CREATE OR REPLACE FUNCTION public.handle_smart_displacement()
RETURNS TRIGGER AS $$
DECLARE
    v_max_devices INT;
    v_current_count INT;
    v_oldest_id UUID;
BEGIN
    -- Get user's limit from profiles (default 1 if null)
    SELECT COALESCE(max_allowed_devices, 1) INTO v_max_devices
    FROM public.profiles
    WHERE id = NEW.user_id;

    -- Count existing sessions (excluding the one we are about to add if it was an update, but this is insert)
    SELECT COUNT(*) INTO v_current_count
    FROM public.active_sessions
    WHERE user_id = NEW.user_id;

    -- If we are at or above limit, we need to make room for ONE new session (NEW)
    -- So if count >= limit, we must delete (count - limit + 1) oldest sessions
    -- Usually just 1, but loops to be safe or just delete oldest 1.
    
    IF v_current_count >= v_max_devices THEN
        -- Find oldest session(s)
        FOR v_oldest_id IN
            SELECT id
            FROM public.active_sessions
            WHERE user_id = NEW.user_id
            ORDER BY last_active ASC -- Oldest active time
            LIMIT (v_current_count - v_max_devices + 1)
        LOOP
            -- DELETE IT
            DELETE FROM public.active_sessions WHERE id = v_oldest_id;
            
            -- LOG IT (Audit)
            INSERT INTO auth.audit_log_entries (instance_id, payload)
            VALUES (
                '00000000-0000-0000-0000-000000000000', -- System ID placeholder
                json_build_object(
                    'action', 'session_displaced',
                    'user_id', NEW.user_id,
                    'displaced_session_id', v_oldest_id,
                    'new_device', NEW.user_agent,
                    'timestamp', now()
                )
            );
        END LOOP;
    END IF;

    RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- 3. CREATE TRIGGER
CREATE TRIGGER trigger_smart_displacement
BEFORE INSERT ON public.active_sessions
FOR EACH ROW
EXECUTE FUNCTION public.handle_smart_displacement();

-- 4. RESET STATE
TRUNCATE TABLE public.active_sessions;
</file>

<file path="src/components/AddAthleteModal.jsx">
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { X, UserPlus, Loader2, AlertCircle, CheckCircle } from 'lucide-react';
import { supabase } from '../supabaseClient';

export default function AddAthleteModal({ isOpen, onClose, academyName, onSuccess }) {
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);
    const [success, setSuccess] = useState(false);

    const [formData, setFormData] = useState({
        fullName: '',
        email: '',
        phone: '',
        dob: ''
    });

    if (!isOpen) return null;

    const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        setError(null);

        try {
            // 0. Get Coach User & Academy ID
            const { data: { user: coachUser } } = await supabase.auth.getUser();

            let academyId = coachUser?.user_metadata?.academy_id;

            // Fallback: If not in metadata, fetch from profile
            if (!academyId) {
                const { data: coachProfile } = await supabase
                    .from('profiles')
                    .select('academy_id')
                    .eq('id', coachUser.id)
                    .single();
                academyId = coachProfile?.academy_id;
            }

            // 1. Create Auth User
            const tempPassword = `TempPass${Math.random().toString(36).slice(-8)}!`;

            const { data: authData, error: authError } = await supabase.auth.signUp({
                email: formData.email,
                password: tempPassword,
                options: {
                    data: {
                        first_name: formData.fullName.split(' ')[0],
                        last_name: formData.fullName.split(' ').slice(1).join(' '),
                        role: 'athlete',
                        // Link athlete to academy via metadata for triggers/RLS
                        academy_id: academyId,
                        academy_name: academyName
                    }
                }
            });

            if (authError) throw authError;
            if (!authData.user) throw new Error("Failed to create user account.");

            // 2. Insert into Profiles (V3 Schema)
            // Note: If a trigger exists, this might be redundant or fail. 
            // We use 'upsert' to be safe, or just update if the trigger made it.
            // Let's try UPDATE first (assuming trigger), if not, assume INSERT.

            // Check if profile exists
            const { data: existingProfile } = await supabase
                .from('profiles')
                .select('id')
                .eq('id', authData.user.id)
                .single();

            const profilePayload = {
                id: authData.user.id,
                role: 'athlete',
                academy_id: academyId, // CRITICAL FIX: Ensure DB link
                academy_name: academyName,
                full_name: formData.fullName,
                email: formData.email,
                phone: formData.phone,
                date_of_birth: formData.dob,
                onboarding_step: 1
            };

            let profileError;

            if (existingProfile) {
                const { error } = await supabase
                    .from('profiles')
                    .update(profilePayload)
                    .eq('id', authData.user.id);
                profileError = error;
            } else {
                const { error } = await supabase
                    .from('profiles')
                    .insert([profilePayload]);
                profileError = error;
            }

            if (profileError) throw profileError;

            // Success
            setSuccess(true);
            setTimeout(() => {
                onSuccess?.();
                onClose();
                setSuccess(false);
                setFormData({ fullName: '', email: '', phone: '', dob: '' });
            }, 1500);

        } catch (err) {
            console.error("Add Athlete Error:", err);
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm">
            <motion.div
                initial={{ opacity: 0, scale: 0.95 }}
                animate={{ opacity: 1, scale: 1 }}
                exit={{ opacity: 0, scale: 0.95 }}
                className="bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]"
            >
                {/* Header */}
                <div className="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <div>
                        <h2 className="text-lg font-black text-slate-800 flex items-center gap-2">
                            <UserPlus size={20} className="text-emerald-600" />
                            Add New Athlete
                        </h2>
                        <p className="text-xs text-slate-500 font-medium">To {academyName}</p>
                    </div>
                    <button onClick={onClose} className="p-2 hover:bg-slate-100 rounded-full text-slate-400 hover:text-slate-600 transition-colors">
                        <X size={20} />
                    </button>
                </div>

                {/* Body */}
                <div className="p-6 overflow-y-auto">
                    {success ? (
                        <div className="flex flex-col items-center justify-center py-8 text-center space-y-4">
                            <div className="w-16 h-16 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mb-2">
                                <CheckCircle size={32} />
                            </div>
                            <h3 className="text-xl font-bold text-slate-900">Athlete Added!</h3>
                            <p className="text-slate-500">The account has been created successfully.</p>
                        </div>
                    ) : (
                        <form onSubmit={handleSubmit} className="space-y-4">

                            {error && (
                                <div className="p-3 bg-red-50 text-red-600 text-sm font-bold rounded-lg flex items-center gap-2">
                                    <AlertCircle size={16} />
                                    {error}
                                </div>
                            )}

                            <div className="space-y-1.5">
                                <label className="text-xs font-bold text-slate-700 uppercase tracking-wide">Full Name</label>
                                <input
                                    type="text"
                                    required
                                    className="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-medium"
                                    placeholder="e.g. Michael Jordan"
                                    value={formData.fullName}
                                    onChange={e => setFormData({ ...formData, fullName: e.target.value })}
                                />
                            </div>

                            <div className="space-y-1.5">
                                <label className="text-xs font-bold text-slate-700 uppercase tracking-wide">Email Address</label>
                                <input
                                    type="email"
                                    required
                                    className="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-medium"
                                    placeholder="athlete@example.com"
                                    value={formData.email}
                                    onChange={e => setFormData({ ...formData, email: e.target.value })}
                                />
                                <p className="text-[10px] text-slate-400">Used for login. A temp password will be generated.</p>
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                                <div className="space-y-1.5">
                                    <label className="text-xs font-bold text-slate-700 uppercase tracking-wide">Phone (Optional)</label>
                                    <input
                                        type="tel"
                                        className="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-medium"
                                        placeholder="+971..."
                                        value={formData.phone}
                                        onChange={e => setFormData({ ...formData, phone: e.target.value })}
                                    />
                                </div>
                                <div className="space-y-1.5">
                                    <label className="text-xs font-bold text-slate-700 uppercase tracking-wide">Date of Birth</label>
                                    <input
                                        type="date"
                                        className="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-medium"
                                        value={formData.dob}
                                        onChange={e => setFormData({ ...formData, dob: e.target.value })}
                                    />
                                </div>
                            </div>

                            <div className="pt-4">
                                <button
                                    type="submit"
                                    disabled={loading}
                                    className="w-full py-3.5 bg-emerald-600 hover:bg-emerald-500 text-white font-bold rounded-xl shadow-lg shadow-emerald-200 transition-all flex items-center justify-center gap-2 active:scale-[0.98]"
                                >
                                    {loading ? <Loader2 className="animate-spin" /> : 'Create Athlete Profile'}
                                </button>
                            </div>
                        </form>
                    )}
                </div>
            </motion.div>
        </div>
    );
}
</file>

<file path="src/components/AuthGuard.jsx">
import React, { useEffect, useState, useCallback } from 'react';
import { useNavigate } from 'react-router-dom';
import { supabase } from '../supabaseClient';
import { checkDeviceAccess } from '../utils/auth-guard';

const AuthGuard = ({ children }) => {
    const navigate = useNavigate();
    const [loading, setLoading] = useState(true);
    const [isAuthorized, setIsAuthorized] = useState(false);

    const verifyAccess = useCallback(async (retryCount = 0) => {
        try {
            // 1. Check if user is logged in
            const { data: { session } } = await supabase.auth.getSession();

            if (!session) {
                navigate('/login');
                return;
            }

            // 1.5. CHECK ROLE VS ROUTE (Cross-Portal Protection) ðŸ›¡ï¸
            const { data: profile } = await supabase
                .from('profiles')
                .select('role')
                .eq('id', session.user.id)
                .single();

            const userRole = profile?.role || 'coach';
            const currentPath = window.location.pathname;

            // Block Student -> Coach Portal
            if (currentPath.startsWith('/coach') && userRole === 'athlete') {
                console.warn("AuthGuard: Athlete attempted to breach Coach Portal. Redirecting to Athlete Home.");
                navigate('/athlete', { replace: true });
                return;
            }

            // Block Coach -> Athlete Portal
            if (currentPath.startsWith('/athlete') && userRole !== 'athlete') {
                console.warn("AuthGuard: Authorization Mismatch. Redirecting to Landing.");
                navigate('/', { replace: true });
                return;
            }

            setLoading(false);
            setIsAuthorized(true);

            // ðŸ›‘ SMART EVICTION LISTENER
            // "If my session row disappears, it means I was displaced."
            const deviceId = localStorage.getItem('wibo_device_id');

            const subscription = supabase
                .channel(`session_guard_${session.user.id}`)
                .on(
                    'postgres_changes',
                    {
                        event: 'DELETE',
                        schema: 'public',
                        table: 'active_sessions',
                        filter: `user_id=eq.${session.user.id}` // Filter by user to reduce traffic, check device locally
                    },
                    async (payload) => {
                        console.log("Session Deleted Event:", payload);
                        // Check if the deleted session was THIS device
                        if (payload.old && payload.old.device_id === deviceId) {
                            console.warn("â›” SESSION DISPLACED: Signing out...");
                            await supabase.auth.signOut();
                            navigate('/login', {
                                replace: true,
                                state: { error: "Access transferred to a newer device." }
                            });
                        }
                    }
                )
                .subscribe();

            return () => {
                supabase.removeChannel(subscription);
            };

        } catch (error) {
            console.error("Auth Verification Failed:", error);
            navigate('/login');
        } finally {
            setLoading(false);
        }
    }, [navigate]);

    useEffect(() => {
        verifyAccess();
    }, [verifyAccess]);

    // ðŸ›‘ SECURITY: Monitor Role Changes (Zombie Session Killer)
    useEffect(() => {
        const monitorRole = async () => {
            const { data: { user } } = await supabase.auth.getUser();
            if (!user) return;

            const channel = supabase
                .channel(`profile_watch_${user.id}`)
                .on('postgres_changes',
                    { event: 'UPDATE', schema: 'public', table: 'profiles', filter: `id=eq.${user.id}` },
                    (payload) => {
                        console.warn(`ðŸ‘® Security Alert: Role changed to ${payload.new.role}`);
                        // Reload to force re-verification processing
                        window.location.reload();
                    }
                )
                .subscribe();

            return () => supabase.removeChannel(channel);
        };

        monitorRole();
    }, []);

    if (loading) {
        // High-end loading state matching the theme
        return (
            <div className="flex min-h-screen bg-slate-50">
                {/* Skeleton Sidebar */}
                <div className="hidden md:flex flex-col w-72 bg-slate-900 border-r border-slate-800 p-8">
                    <div className="flex items-center gap-3 mb-10">
                        <div className="h-10 w-10 bg-slate-800 rounded-xl animate-pulse"></div>
                        <div className="space-y-2">
                            <div className="h-4 w-24 bg-slate-800 rounded animate-pulse"></div>
                            <div className="h-2 w-16 bg-slate-800 rounded animate-pulse"></div>
                        </div>
                    </div>
                    <div className="space-y-4">
                        {[1, 2, 3, 4, 5].map((i) => (
                            <div key={i} className="h-10 w-full bg-slate-800/50 rounded-xl animate-pulse"></div>
                        ))}
                    </div>
                </div>

                {/* Skeleton Content */}
                <div className="flex-1 flex flex-col">
                    {/* Skeleton Header */}
                    <div className="h-20 border-b border-slate-200 bg-white px-8 flex items-center justify-between">
                        <div className="flex items-center gap-4">
                            <div className="h-8 w-32 bg-slate-100 rounded-lg animate-pulse"></div>
                            <div className="hidden xl:flex gap-3 pl-8 border-l border-slate-200 h-10 items-center">
                                <div className="h-8 w-24 bg-slate-100 rounded-lg animate-pulse"></div>
                                <div className="h-8 w-24 bg-slate-100 rounded-lg animate-pulse"></div>
                            </div>
                        </div>
                        <div className="flex items-center gap-4">
                            <div className="h-10 w-24 bg-slate-100 rounded-full animate-pulse"></div>
                            <div className="h-10 w-10 bg-slate-100 rounded-full animate-pulse"></div>
                        </div>
                    </div>

                    {/* Skeleton Main Area */}
                    <div className="p-8 space-y-6">
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div className="h-32 bg-white rounded-2xl shadow-sm border border-slate-100 animate-pulse"></div>
                            <div className="h-32 bg-white rounded-2xl shadow-sm border border-slate-100 animate-pulse"></div>
                            <div className="h-32 bg-white rounded-2xl shadow-sm border border-slate-100 animate-pulse"></div>
                        </div>
                        <div className="h-64 bg-white rounded-2xl shadow-sm border border-slate-100 animate-pulse"></div>
                    </div>
                </div>
            </div>
        );
    }

    return isAuthorized ? children : null;
};

export default AuthGuard;
</file>

<file path="src/components/cards/AthleteCard.jsx">
import React from 'react';
import { Trophy, Activity, Calendar, MoreHorizontal } from 'lucide-react';

const AthleteCard = ({ athlete }) => {
    // Derivations
    const calculateAge = (dob) => {
        if (!dob) return 'N/A';
        const birthDate = new Date(dob);
        const ageDifMs = Date.now() - birthDate.getTime();
        const ageDate = new Date(ageDifMs);
        return Math.abs(ageDate.getUTCFullYear() - 1970);
    };

    const statusColors = {
        active: 'border-emerald-500 bg-emerald-50 text-emerald-700',
        inactive: 'border-slate-200 bg-slate-50 text-slate-400',
        injured: 'border-red-200 bg-red-50 text-red-600'
    };

    return (
        <div className="bg-white rounded-3xl border border-slate-100 shadow-sm hover:shadow-md transition-all group relative overflow-hidden">

            {/* Top Bar Background */}
            <div className={`h-24 ${athlete.status === 'active' ? 'bg-gradient-to-r from-emerald-500 to-teal-500' : 'bg-slate-100'}`}></div>

            {/* Avatar & Info */}
            <div className="px-6 -mt-12 mb-4">
                <div className="relative inline-block">
                    <img
                        src={athlete.photo_url || `https://api.dicebear.com/7.x/notionists/svg?seed=${athlete.name}`}
                        alt={athlete.name}
                        className="w-24 h-24 rounded-2xl border-4 border-white shadow-lg bg-white object-cover"
                    />
                    <div className={`absolute bottom-0 right-0 w-6 h-6 rounded-full border-4 border-white ${athlete.status === 'active' ? 'bg-emerald-500' : 'bg-slate-400'}`}></div>
                </div>

                <div className="mt-3 flex justify-between items-start">
                    <div>
                        <h3 className="font-black text-slate-900 text-lg leading-tight">{athlete.name}</h3>
                        <p className="text-xs font-bold text-slate-400 uppercase tracking-wider mt-1">
                            Age {calculateAge(athlete.dob)} â€¢ {athlete.gender || 'Athlete'}
                        </p>
                    </div>
                    <button className="text-slate-300 hover:text-slate-600 transition-colors">
                        <MoreHorizontal className="w-6 h-6" />
                    </button>
                </div>
            </div>

            {/* Stats Bar (FIFA Style) */}
            <div className="px-6 pb-6 pt-2">
                <div className="grid grid-cols-3 divide-x divide-slate-100 border-t border-slate-100 pt-4">
                    <div className="text-center px-2">
                        <div className="text-xs font-bold text-slate-400 uppercase mb-1">Rating</div>
                        <div className="font-black text-lg text-emerald-600 flex items-center justify-center gap-1">
                            <Trophy className="w-4 h-4" />
                            {athlete.stats?.overall || 88}
                        </div>
                    </div>
                    <div className="text-center px-2">
                        <div className="text-xs font-bold text-slate-400 uppercase mb-1">Health</div>
                        <div className="font-black text-lg text-blue-600 flex items-center justify-center gap-1">
                            <Activity className="w-4 h-4" />
                            98%
                        </div>
                    </div>
                    <div className="text-center px-2">
                        <div className="text-xs font-bold text-slate-400 uppercase mb-1">Since</div>
                        <div className="font-black text-sm text-slate-700 flex items-center justify-center gap-1 h-full pt-1">
                            <Calendar className="w-3 h-3 text-slate-400" />
                            2024
                        </div>
                    </div>
                </div>

                {/* Tags (Medical) */}
                {athlete.medical_info?.tags?.length > 0 && (
                    <div className="mt-4 flex flex-wrap gap-2">
                        {athlete.medical_info.tags.map(tag => (
                            <span key={tag} className="px-2 py-1 rounded bg-red-50 text-red-600 text-[10px] font-bold border border-red-100">
                                {tag}
                            </span>
                        ))}
                    </div>
                )}
            </div>
        </div>
    );
};

export default AthleteCard;
</file>

<file path="src/components/ChatWidget.jsx">
import React, { useState, useRef, useEffect } from 'react';
import { clsx } from 'clsx';
import { format } from 'date-fns';
import { supabase } from '../supabaseClient';

export default function ChatWidget() {
    const [isOpen, setIsOpen] = useState(false);
    const [messages, setMessages] = useState([
        { id: 1, text: "Hi! I'm your Wild Robot assistant ðŸ¤– Use the buttons below or ask me anything!", sender: 'bot' }
    ]);
    const [inputText, setInputText] = useState('');
    const [isTyping, setIsTyping] = useState(false);
    const messagesEndRef = useRef(null);

    const scrollToBottom = () => {
        messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
    };

    useEffect(() => {
        scrollToBottom();
    }, [messages]);

    const handleSend = async (text) => {
        if (!text.trim()) return;

        // Add User Message
        const userMsg = { id: Date.now(), text, sender: 'user' };
        setMessages(prev => [...prev, userMsg]);
        setInputText('');
        setIsTyping(true);

        // Process Response
        const responseText = await processMessage(text);

        // Simulate thinking delay
        setTimeout(() => {
            const botMsg = { id: Date.now() + 1, text: responseText, sender: 'bot' };
            setMessages(prev => [...prev, botMsg]);
            setIsTyping(false);
        }, 1000);
    };

    const processMessage = async (input) => {
        const lowerInput = input.toLowerCase();

        // 1. Next Class Logic
        if (lowerInput.includes('next class') || lowerInput.includes('schedule') || lowerInput.includes('session')) {
            const todayStr = format(new Date(), 'yyyy-MM-dd');

            // Mocking the query logic as if we are checking for a global user or just getting upcoming sessions
            // Ideally we would query session_enrollments for the logged-in user
            const { data: sessions, error } = await supabase
                .from('sessions')
                .select('*')
                .gte('date', todayStr)
                .order('date', { ascending: true })
                .order('start_time', { ascending: true })
                .limit(1);

            if (error || !sessions || sessions.length === 0) {
                return "I couldn't find any upcoming classes scheduled for today or later.";
            }

            const next = sessions[0];
            return `Your next class is "${next.title}" on ${format(new Date(next.date), 'EEE, MMM d')} at ${next.start_time}. ðŸ“…`;
        }

        // 2. Balance Logic
        if (lowerInput.includes('balance') || lowerInput.includes('subscription') || lowerInput.includes('package')) {
            // Mock Response
            return "You have 4 classes remaining in your 'Gold Package' subscription. ðŸ’°";
        }

        // 3. Support Logic
        if (lowerInput.includes('support') || lowerInput.includes('help') || lowerInput.includes('contact')) {
            return "You can contact Head Coach Abdulla at +971-50-123-4567 for immediate assistance. ðŸ“ž";
        }

        // Default
        return "I'm still learning! Please try clicking one of the quick actions below or ask about your schedule/balance. ðŸ¤–";
    };

    const chips = [
        { label: "ðŸ“… Next Class", query: "When is my next class?" },
        { label: "ðŸ’° My Balance", query: "What is my balance?" },
        { label: "ðŸ“ž Support", query: "Contact support" },
    ];

    return (
        <>
            {/* Widget Button */}
            {/* Mobile: Bottom Left (Safe from FAB on Right) */}
            {/* Desktop: Bottom Right (Stacked below FAB) */}
            <div className="fixed z-50 bottom-[90px] left-6 md:bottom-6 md:right-6 md:left-auto">
                <button
                    onClick={() => setIsOpen(!isOpen)}
                    className="h-14 w-14 rounded-full bg-slate-900 md:bg-emerald-600 text-white shadow-xl shadow-slate-400 md:shadow-emerald-200 hover:scale-110 active:scale-95 transition-all duration-300 flex items-center justify-center group"
                >
                    <span className="material-symbols-outlined text-[28px] group-hover:rotate-12 transition-transform">smart_toy</span>
                    {/* Notification dot */}
                    <span className="absolute top-0 right-0 h-4 w-4 bg-red-500 rounded-full border-2 border-white animate-bounce-slow"></span>
                </button>
            </div>

            {/* Chat Window */}
            {isOpen && (
                <div className="fixed z-50 bottom-24 left-6 md:bottom-24 md:right-6 md:left-auto w-[350px] max-w-[calc(100vw-48px)] h-[500px] flex flex-col overflow-hidden bg-white/90 backdrop-blur-lg shadow-2xl border border-white/20 rounded-2xl animate-in slide-in-from-bottom-10 fade-in duration-300">

                    {/* Header */}
                    <div className="bg-gradient-to-r from-emerald-600 to-teal-500 p-4 text-white flex justify-between items-center shadow-sm relative overflow-hidden">
                        {/* Abstract Background Shape */}
                        <div className="absolute -top-10 -right-10 w-32 h-32 bg-white/10 rounded-full blur-2xl pointer-events-none"></div>

                        <div className="flex items-center gap-3 relative z-10">
                            <div className="bg-white/20 p-1.5 rounded-lg backdrop-blur-md">
                                <span className="material-symbols-outlined text-[20px]">smart_toy</span>
                            </div>
                            <div>
                                <h3 className="font-bold text-sm tracking-wide">Wild Robot Assistant</h3>
                                <p className="text-[10px] text-emerald-50 flex items-center gap-1.5 opacity-90">
                                    <span className="h-1.5 w-1.5 rounded-full bg-emerald-300 animate-pulse"></span>
                                    Online
                                </p>
                            </div>
                        </div>
                        <button
                            onClick={() => setIsOpen(false)}
                            className="text-white/70 hover:text-white hover:bg-white/10 rounded-full p-1 transition-all"
                        >
                            <span className="material-symbols-outlined text-[20px]">close</span>
                        </button>
                    </div>

                    {/* Messages Area */}
                    <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-white/50 scrollbar-thin scrollbar-thumb-gray-200 scrollbar-track-transparent">
                        {messages.map(msg => (
                            <div key={msg.id} className={clsx("flex", msg.sender === 'user' ? "justify-end" : "justify-start")}>
                                <div className={clsx(
                                    "max-w-[85%] rounded-2xl px-4 py-2.5 text-sm shadow-sm backdrop-blur-sm",
                                    msg.sender === 'user'
                                        ? "bg-emerald-600 text-white rounded-br-none"
                                        : "bg-white text-slate-700 border border-gray-100/50 rounded-bl-none"
                                )}>
                                    {msg.text}
                                </div>
                            </div>
                        ))}
                        {isTyping && (
                            <div className="flex justify-start">
                                <div className="bg-white/80 border border-gray-100 rounded-2xl rounded-bl-none px-4 py-3 shadow-sm flex gap-1">
                                    <span className="h-1.5 w-1.5 rounded-full bg-slate-400 animate-bounce"></span>
                                    <span className="h-1.5 w-1.5 rounded-full bg-slate-400 animate-bounce delay-75"></span>
                                    <span className="h-1.5 w-1.5 rounded-full bg-slate-400 animate-bounce delay-150"></span>
                                </div>
                            </div>
                        )}
                        <div ref={messagesEndRef} />
                    </div>

                    {/* Quick Actions */}
                    <div className="px-4 py-2 bg-white/60 border-t border-gray-100/50 flex gap-2 overflow-x-auto no-scrollbar mask-linear-fade">
                        {chips.map((chip, idx) => (
                            <button
                                key={idx}
                                onClick={() => handleSend(chip.query)}
                                className="whitespace-nowrap px-3 py-1.5 bg-white hover:bg-emerald-50 hover:text-emerald-600 hover:border-emerald-200 rounded-full text-xs font-bold text-slate-600 transition-all border border-gray-200 shadow-sm"
                            >
                                {chip.label}
                            </button>
                        ))}
                    </div>

                    {/* Input Area */}
                    <div className="p-3 bg-white border-t border-gray-100 flex gap-2">
                        <input
                            type="text"
                            value={inputText}
                            onChange={(e) => setInputText(e.target.value)}
                            onKeyDown={(e) => e.key === 'Enter' && handleSend(inputText)}
                            placeholder="Type a message..."
                            className="flex-1 bg-gray-50 border border-gray-200 rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-all"
                        />
                        <button
                            onClick={() => handleSend(inputText)}
                            className="h-10 w-10 rounded-xl bg-emerald-600 text-white flex items-center justify-center hover:bg-emerald-700 active:scale-95 transition-all shadow-md shadow-emerald-200"
                        >
                            <span className="material-symbols-outlined text-[20px]">send</span>
                        </button>
                    </div>
                </div>
            )}
        </>
    );
}
</file>

<file path="src/components/CommandPalette.jsx">
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { clsx } from 'clsx';

export default function CommandPalette() {
    const [isOpen, setIsOpen] = useState(false);
    const [query, setQuery] = useState('');
    const [selectedIndex, setSelectedIndex] = useState(0);
    const navigate = useNavigate();

    // Toggle with Cmd+K or Ctrl+K
    useEffect(() => {
        const handleKeyDown = (e) => {
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                e.preventDefault();
                setIsOpen((prev) => !prev);
                setQuery('');
                setSelectedIndex(0);
            }
            if (e.key === 'Escape') {
                setIsOpen(false);
            }
        };

        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
    }, []);

    const actions = [
        // Role Switching (Simulated)
        {
            section: 'Switch Role',
            name: 'Super Admin View',
            icon: 'security',
            shortcut: 'S A',
            action: () => switchRole('admin')
        },
        {
            section: 'Switch Role',
            name: 'Finance / Accountant View',
            icon: 'account_balance',
            shortcut: 'F N',
            action: () => switchRole('accountant')
        },
        {
            section: 'Switch Role',
            name: 'HR / Staff View',
            icon: 'badge',
            shortcut: 'H R',
            action: () => switchRole('hr')
        },
        {
            section: 'Switch Role',
            name: 'Manager View',
            icon: 'analytics',
            shortcut: 'M G',
            action: () => switchRole('manager')
        },
        {
            section: 'Switch Role',
            name: 'Admin View', // Requested "Admin" Role
            icon: 'admin_panel_settings',
            shortcut: 'A D',
            action: () => switchRole('admin_role') // Distinct from super admin 'admin'
        },
        {
            section: 'Switch Role',
            name: 'Coach View',
            icon: 'sports_gymnastics',
            shortcut: 'C O',
            action: () => switchRole('employee')
        },

        // Navigation
        {
            section: 'Navigation',
            name: 'Go to Dashboard',
            icon: 'dashboard',
            action: () => navigate('/coach/home')
        },
        {
            section: 'Navigation',
            name: 'Go to Master Calendar',
            icon: 'calendar_month',
            action: () => navigate('/coach/calendar')
        },
        {
            section: 'Navigation',
            name: 'Go to Analytics',
            icon: 'bar_chart',
            action: () => navigate('/coach/analytics')
        },
    ];

    const switchRole = (role) => {
        localStorage.setItem('simulated_role', role);
        window.location.reload();
    };

    const filteredActions = actions.filter((action) =>
        action.name.toLowerCase().includes(query.toLowerCase()) ||
        action.section.toLowerCase().includes(query.toLowerCase())
    );

    const handleSelect = (action) => {
        action.action();
        setIsOpen(false);
    };

    // Keyboard navigation for the list
    useEffect(() => {
        const handleListNav = (e) => {
            if (!isOpen) return;
            if (e.key === 'ArrowDown') {
                e.preventDefault();
                setSelectedIndex(i => (i + 1) % filteredActions.length);
            }
            if (e.key === 'ArrowUp') {
                e.preventDefault();
                setSelectedIndex(i => (i - 1 + filteredActions.length) % filteredActions.length);
            }
            if (e.key === 'Enter') {
                e.preventDefault();
                handleSelect(filteredActions[selectedIndex]);
            }
        };
        window.addEventListener('keydown', handleListNav);
        return () => window.removeEventListener('keydown', handleListNav);
    }, [isOpen, filteredActions, selectedIndex]);

    if (!isOpen) return null;

    return (
        <div className="fixed inset-0 z-[100] flex items-start justify-center pt-[20vh] px-4">
            {/* Backdrop */}
            <div
                className="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"
                onClick={() => setIsOpen(false)}
            />

            {/* Modal */}
            <div className="relative w-full max-w-lg bg-white rounded-xl shadow-2xl ring-1 ring-slate-900/5 overflow-hidden animate-in fade-in zoom-in-95 duration-100">
                {/* Search Input */}
                <div className="flex items-center border-b border-slate-100 px-4">
                    <span className="material-symbols-outlined text-slate-400 text-xl">search</span>
                    <input
                        type="text"
                        className="w-full bg-transparent border-0 p-4 text-slate-800 placeholder-slate-400 focus:ring-0 text-lg font-medium outline-none"
                        placeholder="What do you need? (e.g. Finance, HR...)"
                        autoFocus
                        value={query}
                        onChange={(e) => {
                            setQuery(e.target.value);
                            setSelectedIndex(0);
                        }}
                    />
                    <div className="text-xs font-bold text-slate-400 border border-slate-200 rounded px-2 py-1">ESC</div>
                </div>

                {/* Results List */}
                <div className="max-h-[60vh] overflow-y-auto p-2 scrollbar-hide">
                    {filteredActions.length === 0 ? (
                        <div className="p-8 text-center text-slate-500">
                            No results found.
                        </div>
                    ) : (
                        <ul className="space-y-1">
                            {filteredActions.map((action, index) => (
                                <li
                                    key={index}
                                    onClick={() => handleSelect(action)}
                                    className={clsx(
                                        "flex items-center justify-between px-4 py-3 rounded-lg cursor-pointer group transition-colors",
                                        index === selectedIndex ? "bg-indigo-50 text-indigo-700" : "text-slate-600 hover:bg-slate-50"
                                    )}
                                >
                                    <div className="flex items-center gap-3">
                                        <span className={clsx(
                                            "material-symbols-outlined text-xl transition-colors",
                                            index === selectedIndex ? "text-indigo-500" : "text-slate-400 group-hover:text-slate-500"
                                        )}>
                                            {action.icon}
                                        </span>
                                        <div>
                                            <p className="font-bold text-sm">{action.name}</p>
                                            <p className="text-[10px] opacity-60 font-medium uppercase tracking-wider">{action.section}</p>
                                        </div>
                                    </div>
                                    {action.shortcut && (
                                        <div className="hidden sm:flex gap-1">
                                            {action.shortcut.split(' ').map((key, i) => (
                                                <kbd key={i} className={clsx(
                                                    "px-2 py-1 text-[10px] font-bold rounded border min-w-[1.2rem] text-center",
                                                    index === selectedIndex
                                                        ? "bg-white border-indigo-200 text-indigo-500 shadow-sm"
                                                        : "bg-slate-100 border-slate-200 text-slate-500"
                                                )}>
                                                    {key}
                                                </kbd>
                                            ))}
                                        </div>
                                    )}
                                </li>
                            ))}
                        </ul>
                    )}
                </div>

                {/* Footer */}
                <div className="bg-slate-50 px-4 py-3 border-t border-slate-100 flex items-center justify-between text-xs text-slate-400 font-medium">
                    <div className="flex gap-4">
                        <span className="flex items-center gap-1"><span className="material-symbols-outlined text-sm">arrow_selector_tool</span> Select</span>
                        <span className="flex items-center gap-1"><span className="material-symbols-outlined text-sm">keyboard_return</span> Enter</span>
                    </div>
                    <span>Wild Robot OS v3.0</span>
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/components/CookieConsent.jsx">
import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { Cookie, Shield, BarChart, Zap, X, Check, ChevronRight, Settings, Camera, Mic, MapPin, Bell, Globe } from 'lucide-react';

const CookieConsent = () => {
    // STEPS: 'init' (hidden), 'banner' (small), 'preferences' (cookies), 'permissions' (hardware), 'finish'
    const [step, setStep] = useState('init');
    const [showDetails, setShowDetails] = useState(false);

    // Cookie State
    const [preferences, setPreferences] = useState({
        necessary: true,
        analytics: false,
        marketing: false,
        functional: false
    });

    // Permission State
    const [permissions, setPermissions] = useState({
        location: 'prompt', // prompt, granted, denied
        camera: 'prompt',
        microphone: 'prompt',
        notifications: 'prompt'
    });

    useEffect(() => {
        // Check local storage for initial "Done" state
        const savedConsent = localStorage.getItem('wibo_privacy_setup_v2');
        if (!savedConsent) {
            const timer = setTimeout(() => setStep('banner'), 1500);
            return () => clearTimeout(timer);
        }
    }, []);

    // ----------------------------------------------------
    // COOKIE LOGIC
    // ----------------------------------------------------
    const handleAcceptAllCookies = () => {
        setPreferences({ necessary: true, analytics: true, marketing: true, functional: true });
        // Move to permissions step instead of closing immediately
        setStep('permissions');
    };

    const handleRejectCookies = () => {
        setPreferences({ necessary: true, analytics: false, marketing: false, functional: false });
        setStep('permissions');
    };

    const toggleCookie = (key) => {
        if (key === 'necessary') return;
        setPreferences(prev => ({ ...prev, [key]: !prev[key] }));
    };

    // ----------------------------------------------------
    // PERMISSION LOGIC (The "World Class" Hardware Request)
    // ----------------------------------------------------
    const requestLocation = async () => {
        if (!navigator.geolocation) return;
        navigator.geolocation.getCurrentPosition(
            () => setPermissions(prev => ({ ...prev, location: 'granted' })),
            () => setPermissions(prev => ({ ...prev, location: 'denied' }))
        );
    };

    const requestMedia = async (type) => { // type: 'camera' | 'microphone'
        try {
            const constraints = type === 'camera' ? { video: true } : { audio: true };
            const stream = await navigator.mediaDevices.getUserMedia(constraints);

            // Success! Now stop the tracks immediately so we don't keep the light on
            stream.getTracks().forEach(track => track.stop());

            setPermissions(prev => ({ ...prev, [type]: 'granted' }));
        } catch (err) {
            console.error(`${type} denied`, err);
            setPermissions(prev => ({ ...prev, [type]: 'denied' }));
        }
    };

    const requestNotifications = async () => {
        if (!("Notification" in window)) return;
        const result = await Notification.requestPermission();
        setPermissions(prev => ({ ...prev, notifications: result }));
    };

    // ----------------------------------------------------
    // FINALIZE
    // ----------------------------------------------------
    const finishSetup = () => {
        localStorage.setItem('wibo_privacy_setup_v2', JSON.stringify({
            preferences,
            permissions, // Just for record, mostly browser handles this
            timestamp: new Date().toISOString()
        }));
        setStep('finish');
        setTimeout(() => setStep('done'), 2000); // Hide after success animation
    };

    if (step === 'init' || step === 'done') return null;

    return (
        <AnimatePresence mode='wait'>
            {/* BACKDROP for Modal Steps */}
            {(step === 'preferences' || step === 'permissions') && (
                <motion.div
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                    className="fixed inset-0 bg-black/60 backdrop-blur-md z-[9998]"
                />
            )}

            {/* MAIN CONTAINER */}
            <motion.div
                key={step}
                initial={{ y: 50, opacity: 0, scale: 0.95 }}
                animate={{ y: 0, opacity: 1, scale: 1 }}
                exit={{ y: 20, opacity: 0, scale: 0.95 }}
                transition={{ type: 'spring', damping: 25, stiffness: 300 }}
                className={`fixed z-[9999] 
                    ${step === 'banner' ? 'bottom-6 right-6 w-full max-w-sm' : 'top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-2xl'}
                `}
            >
                <div className={`
                    bg-slate-900 border border-slate-700 shadow-2xl overflow-hidden
                    ${step === 'banner' ? 'rounded-2xl' : 'rounded-3xl'}
                `}>
                    {/* ----------------- STEP: BANNER ----------------- */}
                    {step === 'banner' && (
                        <div className="p-6">
                            <div className="flex items-start gap-4 mb-4">
                                <div className="w-12 h-12 rounded-xl bg-emerald-500/20 flex items-center justify-center flex-shrink-0">
                                    <Shield size={24} className="text-emerald-500" />
                                </div>
                                <div>
                                    <h3 className="font-bold text-white text-lg">System Access</h3>
                                    <p className="text-slate-400 text-sm mt-1">
                                        We need your permission to initialize the full Wild Robot experience (Hardware & Data).
                                    </p>
                                </div>
                            </div>
                            <div className="flex gap-3">
                                <button
                                    onClick={() => setStep('preferences')}
                                    className="flex-1 py-2 rounded-lg bg-slate-800 text-slate-300 font-bold text-sm hover:bg-slate-700 transition"
                                >
                                    Customize
                                </button>
                                <button
                                    onClick={handleAcceptAllCookies}
                                    className="flex-1 py-2 rounded-lg bg-emerald-600 text-white font-bold text-sm hover:bg-emerald-500 transition shadow-lg shadow-emerald-500/20"
                                >
                                    Allow All
                                </button>
                            </div>
                        </div>
                    )}

                    {/* ----------------- STEP: COOKIE PREFERENCES ----------------- */}
                    {step === 'preferences' && (
                        <div className="p-8">
                            <StepHeader title="Data Preferences" subtitle="Customize how we collect usage data." step={1} total={2} />

                            <div className="space-y-4 my-8 max-h-[40vh] overflow-y-auto pr-2 custom-scrollbar">
                                <PreferenceRow
                                    icon={<Shield size={20} className="text-emerald-500" />}
                                    title="Strictly Necessary"
                                    desc="Required for security and authentication."
                                    active={true}
                                    locked={true}
                                />
                                <PreferenceRow
                                    icon={<BarChart size={20} className="text-blue-500" />}
                                    title="Analytics"
                                    desc="Help us improve implementation logic."
                                    active={preferences.analytics}
                                    onClick={() => toggleCookie('analytics')}
                                />
                                <PreferenceRow
                                    icon={<Zap size={20} className="text-amber-500" />}
                                    title="Functional"
                                    desc="Remember your settings and UI choices."
                                    active={preferences.functional}
                                    onClick={() => toggleCookie('functional')}
                                />
                            </div>

                            <div className="flex justify-end gap-4 pt-6 border-t border-slate-800">
                                <button onClick={() => setStep('permissions')} className="text-slate-400 font-bold hover:text-white transition">Skip</button>
                                <button
                                    onClick={() => setStep('permissions')}
                                    className="px-8 py-3 bg-white text-slate-900 font-black rounded-xl hover:bg-slate-200 transition flex items-center gap-2"
                                >
                                    Next: Hardware <ChevronRight size={18} />
                                </button>
                            </div>
                        </div>
                    )}

                    {/* ----------------- STEP: HARDWARE PERMISSIONS ----------------- */}
                    {step === 'permissions' && (
                        <div className="p-8">
                            <StepHeader title="Device Access" subtitle="Enable hardware execution features." step={2} total={2} />

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
                                <PermissionCard
                                    icon={<MapPin />}
                                    title="Location"
                                    status={permissions.location}
                                    onClick={requestLocation}
                                />
                                <PermissionCard
                                    icon={<Camera />}
                                    title="Camera"
                                    status={permissions.camera}
                                    onClick={() => requestMedia('camera')}
                                />
                                <PermissionCard
                                    icon={<Mic />}
                                    title="Microphone"
                                    status={permissions.microphone}
                                    onClick={() => requestMedia('microphone')}
                                />
                                <PermissionCard
                                    icon={<Bell />}
                                    title="Notifications"
                                    status={permissions.notifications}
                                    onClick={requestNotifications}
                                />
                            </div>

                            <div className="flex justify-end pt-6 border-t border-slate-800">
                                <button
                                    onClick={finishSetup}
                                    className="w-full md:w-auto px-8 py-3 bg-emerald-500 text-white font-black rounded-xl hover:bg-emerald-400 transition shadow-lg shadow-emerald-500/20 flex items-center justify-center gap-2"
                                >
                                    <Check size={20} />
                                    Launch Interface
                                </button>
                            </div>
                        </div>
                    )}

                    {/* ----------------- STEP: FINISH ----------------- */}
                    {step === 'finish' && (
                        <div className="p-12 text-center">
                            <motion.div
                                initial={{ scale: 0 }}
                                animate={{ scale: 1 }}
                                className="w-24 h-24 bg-emerald-500/10 rounded-full flex items-center justify-center mx-auto mb-6"
                            >
                                <Check size={48} className="text-emerald-500" />
                            </motion.div>
                            <h2 className="text-2xl font-black text-white mb-2">Access Granted</h2>
                            <p className="text-slate-400">System initialization complete.</p>
                        </div>
                    )}
                </div>
            </motion.div>
        </AnimatePresence>
    );
};

// SUB-COMPONENTS
const StepHeader = ({ title, subtitle, step, total }) => (
    <div>
        <div className="flex items-center justify-between mb-2">
            <h2 className="text-2xl font-black text-white">{title}</h2>
            <span className="text-xs font-bold text-slate-500 bg-slate-800 px-2 py-1 rounded">STEP {step}/{total}</span>
        </div>
        <p className="text-slate-400">{subtitle}</p>
    </div>
);

const PreferenceRow = ({ icon, title, desc, active, locked, onClick }) => (
    <div
        onClick={!locked ? onClick : undefined}
        className={`flex items-center justify-between p-4 rounded-xl border transition-all cursor-pointer ${active ? 'bg-slate-800 border-emerald-500/30' : 'bg-slate-900 border-slate-700 hover:border-slate-600'}`}
    >
        <div className="flex items-center gap-4">
            <div className={`p-2 rounded-lg ${active ? 'bg-emerald-500/20 text-emerald-400' : 'bg-slate-800 text-slate-500'}`}>
                {icon}
            </div>
            <div>
                <h4 className={`font-bold ${active ? 'text-white' : 'text-slate-400'}`}>{title}</h4>
                <p className="text-xs text-slate-500">{desc}</p>
            </div>
        </div>
        <div className={`w-12 h-6 rounded-full relative transition-colors ${active ? 'bg-emerald-500' : 'bg-slate-700'}`}>
            <div className={`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${active ? 'translate-x-6' : 'translate-x-0'}`} />
        </div>
    </div>
);

const PermissionCard = ({ icon, title, status, onClick }) => {
    const isGranted = status === 'granted';
    const isDenied = status === 'denied';

    return (
        <button
            onClick={!isGranted ? onClick : undefined}
            disabled={isDenied}
            className={`
                p-4 rounded-xl border text-left transition-all relative overflow-hidden group
                ${isGranted ? 'bg-emerald-500/10 border-emerald-500/50' : 'bg-slate-800 border-slate-700 hover:border-slate-600'}
                ${isDenied ? 'opacity-50 cursor-not-allowed' : ''}
            `}
        >
            <div className="flex items-center justify-between mb-3">
                <div className={`p-2 rounded-lg ${isGranted ? 'bg-emerald-500 text-white' : 'bg-slate-900 text-slate-400 group-hover:text-white'}`}>
                    {icon}
                </div>
                {isGranted && <Check size={16} className="text-emerald-500" />}
            </div>
            <h4 className="font-bold text-slate-200">{title}</h4>
            <p className="text-xs text-slate-500 mt-1">
                {isGranted ? 'Access Enabled' : isDenied ? 'Access Denied' : 'Click to Enable'}
            </p>
        </button>
    );
};

export default CookieConsent;
</file>

<file path="src/components/dashboard/ActionCard.jsx">
import React from 'react';

const ActionCard = ({ title, desc, icon: Icon, color, onClick }) => (
    <button
        onClick={onClick}
        className="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all text-left group w-full"
    >
        <div className={`w-12 h-12 rounded-xl ${color} text-white flex items-center justify-center mb-4 group-hover:scale-110 transition-transform`}>
            <Icon className="w-6 h-6" />
        </div>
        <h3 className="font-bold text-slate-900 text-lg">{title}</h3>
        <p className="text-sm text-slate-500 mt-1">{desc}</p>
    </button>
);

export default ActionCard;
</file>

<file path="src/components/dashboard/ChecklistWidget.jsx">
import React from 'react';
import { CheckCircle, Square } from 'lucide-react';

const ChecklistWidget = ({ title, desc, icon: Icon, isCompleted, onClick }) => (
    <div
        onClick={!isCompleted ? onClick : undefined}
        className={`relative p-6 rounded-2xl border-2 transition-all ${isCompleted ? 'bg-emerald-50 border-emerald-100 opacity-60' : 'bg-white border-slate-100 hover:border-emerald-500 cursor-pointer hover:shadow-lg'}`}
    >
        <div className="flex items-start justify-between mb-4">
            <div className={`p-3 rounded-lg ${isCompleted ? 'bg-emerald-100 text-emerald-600' : 'bg-slate-100 text-slate-500'}`}>
                <Icon className="w-6 h-6" />
            </div>
            {isCompleted ? (
                <CheckCircle className="w-6 h-6 text-emerald-500" />
            ) : (
                <Square className="w-6 h-6 text-slate-200" />
            )}
        </div>
        <h3 className={`font-bold text-lg mb-1 ${isCompleted ? 'text-emerald-800 line-through decoration-emerald-500/50' : 'text-slate-900'}`}>{title}</h3>
        <p className="text-sm text-slate-500">{desc}</p>
    </div>
);

export default ChecklistWidget;
</file>

<file path="src/components/dashboard/NextMissionCard.jsx">
import React from 'react';
import { clsx } from 'clsx';
import useGeofencing from '../../hooks/useGeofencing';
import { BRANCHES } from '../../utils/constants';

export default function NextMissionCard() {
    // Mock Config
    const targetBranch = BRANCHES[0];
    const { distance, isWithinRange, error: gpsError } = useGeofencing(targetBranch.lat, targetBranch.lng);
    const [isClockedIn, setIsClockedIn] = React.useState(false);

    // Format Distance
    const distanceDisplay = distance
        ? distance < 1000
            ? `${Math.round(distance)}m`
            : `${(distance / 1000).toFixed(1)}km`
        : 'Locating...';

    // State A: Far Away (Dark)
    if (!isWithinRange && !isClockedIn) {
        return (
            <div className="bg-slate-800 rounded-3xl p-6 md:p-8 flex flex-col md:flex-row items-center justify-between gap-6 shadow-xl mb-8 border border-slate-700">
                <div className="flex items-center gap-6">
                    <div className="h-16 w-16 rounded-2xl bg-slate-700/50 flex items-center justify-center text-slate-400">
                        <span className="material-symbols-outlined text-4xl">directions_car</span>
                    </div>
                    <div>
                        <h2 className="text-xl font-black text-white">Heading to {targetBranch.label}...</h2>
                        <p className="text-slate-400 font-medium">Distance: {distanceDisplay}</p>
                    </div>
                </div>
                <button
                    disabled
                    className="w-full md:w-auto bg-slate-700 text-slate-500 px-8 py-4 rounded-xl font-black flex items-center justify-center gap-2 cursor-not-allowed border border-slate-600"
                >
                    <span className="material-symbols-outlined">block</span>
                    GET CLOSER TO CLOCK IN
                </button>
            </div>
        );
    }

    // State B: In Zone (Green/Pulsing) or Clocked In
    return (
        <div className="bg-emerald-600 rounded-3xl p-6 md:p-8 flex flex-col md:flex-row items-center justify-between gap-6 shadow-xl shadow-emerald-200/50 mb-8 relative overflow-hidden group">
            <div className="absolute inset-0 bg-gradient-to-r from-emerald-600 to-emerald-500"></div>

            {/* Pulsing circles background */}
            {!isClockedIn && (
                <>
                    <div className="absolute -left-4 -bottom-4 w-32 h-32 bg-white opacity-10 rounded-full animate-ping"></div>
                    <div className="absolute right-10 top-10 w-24 h-24 bg-white opacity-10 rounded-full animate-pulse"></div>
                </>
            )}

            <div className="relative z-10 flex items-center gap-6">
                <div className="h-16 w-16 rounded-2xl bg-white/20 flex items-center justify-center text-white backdrop-blur-sm shadow-sm ring-1 ring-white/30">
                    <span className="material-symbols-outlined text-4xl">
                        {isClockedIn ? 'verified' : 'location_on'}
                    </span>
                </div>
                <div>
                    <h2 className="text-2xl font-black text-white tracking-tight">
                        {isClockedIn ? 'Shift Active' : `You have arrived at ${targetBranch.label}!`}
                    </h2>
                    <p className="text-emerald-100 font-bold opacity-90">
                        {isClockedIn ? 'Time tracked: 00:05' : 'Ready to start your mission?'}
                    </p>
                </div>
            </div>

            <button
                onClick={() => setIsClockedIn(!isClockedIn)}
                className="relative z-10 w-full md:w-auto bg-white text-emerald-600 px-8 py-4 rounded-xl font-black flex items-center justify-center gap-2 hover:scale-105 transition-transform shadow-lg hover:shadow-xl"
            >
                <span className="material-symbols-outlined">
                    {isClockedIn ? 'stop_circle' : 'timer'}
                </span>
                {isClockedIn ? 'CLOCK OUT' : 'CLOCK IN NOW'}
            </button>
        </div>
    );
}
</file>

<file path="src/components/DevTools/ChaosMonkey.jsx">
import React, { useState } from 'react';

export default function ChaosMonkey() {
    const [isActive, setIsActive] = useState(false);

    // Only show in Development mode
    if (import.meta.env.MODE !== 'development') {
        return null;
    }

    const releaseGremlins = async () => {
        setIsActive(true);
        try {
            // Dynamically load gremlins.js if not present
            if (!window.gremlins) {
                await new Promise((resolve, reject) => {
                    const script = document.createElement('script');
                    script.src = "https://unpkg.com/gremlins.js";
                    script.onload = resolve;
                    script.onerror = reject;
                    document.body.appendChild(script);
                });
            }

            // Unleash the horde!
            if (window.gremlins) {
                const horde = window.gremlins.createHorde({
                    species: [
                        window.gremlins.species.clicker(),
                        window.gremlins.species.toucher(),
                        window.gremlins.species.formFiller(),
                        window.gremlins.species.scroller()
                    ],
                    mogwais: [
                        window.gremlins.mogwais.alert(), // prevents alert popups blocking test
                        window.gremlins.mogwais.fps()
                    ],
                    strategies: [
                        window.gremlins.strategies.distribution({
                            delay: 10, // fast clicks
                            nb: 1000 // 1000 actions
                        })
                    ]
                });

                console.log('ðŸ§Ÿâ€â™‚ï¸ Gremlins released! Good luck.');
                horde.unleash();

                // Cleanup flag after rough duration
                setTimeout(() => setIsActive(false), 10000);
            }
        } catch (error) {
            console.error("Failed to load gremlins:", error);
            setIsActive(false);
        }
    };

    return (
        <div className="fixed bottom-20 right-4 z-[9999]">
            <button
                onClick={releaseGremlins}
                disabled={isActive}
                className={`bg-red-600 hover:bg-red-700 text-white font-mono text-xs px-3 py-2 rounded-lg shadow-lg border-2 border-red-800 transition-transform active:scale-95 flex items-center gap-2 ${isActive ? 'opacity-50 cursor-not-allowed' : ''}`}
                title="Only visible in Dev Mode"
            >
                <span className="text-lg">ðŸ§Ÿâ€â™‚ï¸</span>
                {isActive ? 'ATTACKING...' : 'CHAOS TEST'}
            </button>
        </div>
    );
}
</file>

<file path="src/components/EmptyState.jsx">
import React from 'react';
import { motion } from 'framer-motion';
import { FileSearch } from 'lucide-react'; // Fallback icon

const EmptyState = ({
    title = "No items found",
    description = "We couldn't find anything matching your criteria.",
    actionLabel,
    onAction,
    imageSrc = "/wibo_assets/Placeholders/empty_box.png" // Potential future asset
}) => {
    return (
        <div className="flex flex-col items-center justify-center p-12 text-center rounded-3xl border-2 border-dashed border-slate-200 bg-slate-50/50 min-h-[400px]">
            <motion.div
                initial={{ scale: 0.8, opacity: 0 }}
                animate={{ scale: 1, opacity: 1 }}
                transition={{ duration: 0.5 }}
                className="mb-6 relative"
            >
                {/* 
                    If you have a custom illustration, use <img>. 
                    For now, we build a beautiful CSS/Icon composition.
                */}
                <div className="relative w-32 h-32 bg-white rounded-full flex items-center justify-center shadow-xl shadow-slate-200 mx-auto">
                    <div className="absolute inset-0 bg-emerald-50 rounded-full animate-pulse opacity-50"></div>
                    <FileSearch className="w-12 h-12 text-slate-300 relative z-10" />

                    {/* Decorative Elements */}
                    <div className="absolute top-2 right-2 w-4 h-4 bg-emerald-400 rounded-full border-2 border-white"></div>
                    <div className="absolute bottom-4 left-2 w-3 h-3 bg-blue-400 rounded-full border-2 border-white"></div>
                </div>
            </motion.div>

            <h3 className="text-xl font-bold text-slate-800 mb-2">{title}</h3>
            <p className="text-slate-500 max-w-sm mb-8">{description}</p>

            {actionLabel && onAction && (
                <button
                    onClick={onAction}
                    className="px-6 py-2.5 bg-slate-900 text-white text-sm font-bold rounded-xl hover:bg-slate-800 transition-all shadow-lg hover:shadow-xl active:scale-95"
                >
                    {actionLabel}
                </button>
            )}
        </div>
    );
};

export default EmptyState;
</file>

<file path="src/components/ErrorBoundary.jsx">
import React from 'react';

class ErrorBoundary extends React.Component {
    constructor(props) {
        super(props);
        this.state = { hasError: false, error: null, errorInfo: null };
    }

    static getDerivedStateFromError(error) {
        // Update state so the next render will show the fallback UI.
        return { hasError: true };
    }

    componentDidCatch(error, errorInfo) {
        // You can also log the error to an error reporting service
        console.error("Uncaught error:", error, errorInfo);
        this.setState({ error, errorInfo });
    }

    handleReload = () => {
        window.location.reload();
    };

    render() {
        if (this.state.hasError) {
            // You can render any custom fallback UI
            return (
                <div className="min-h-screen bg-slate-50 flex items-center justify-center p-4">
                    <div className="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center border border-slate-100">
                        <div className="h-20 w-20 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span className="material-symbols-outlined text-4xl text-red-500">warning</span>
                        </div>

                        <h2 className="text-2xl font-black text-slate-800 mb-2">Something went wrong</h2>
                        <p className="text-slate-500 mb-8 leading-relaxed">
                            We encountered an unexpected error. Don't worry, no data was lost.
                        </p>

                        {/* Dev Details (Optional - helpful for beta) */}
                        <div className="bg-slate-900 rounded-lg p-4 mb-8 text-left overflow-auto max-h-32 text-xs font-mono text-red-300">
                            {this.state.error && this.state.error.toString()}
                        </div>

                        <div className="flex gap-3 justify-center">
                            <button
                                onClick={this.handleReload}
                                className="bg-slate-900 text-white px-6 py-3 rounded-xl font-bold hover:bg-slate-800 transition-colors flex items-center gap-2"
                            >
                                <span className="material-symbols-outlined text-lg">refresh</span>
                                Reload Page
                            </button>
                            <button
                                onClick={() => window.location.href = '/'}
                                className="bg-slate-100 text-slate-600 px-6 py-3 rounded-xl font-bold hover:bg-slate-200 transition-colors"
                            >
                                Go Home
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        return this.props.children;
    }
}

export default ErrorBoundary;
</file>

<file path="src/components/evaluation/EvaluationCard.jsx">
import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { clsx } from 'clsx';
import { generateCertificate } from '../../utils/pdfUtils';

export default function EvaluationCard({
    student,
    levelData,
    isPresent = true,
    onToggleAttendance,
    trainingPlan = [],
    onUpdatePlan
}) {
    // --- State ---
    const [skills, setSkills] = useState(levelData || []);
    const [expanded, setExpanded] = useState(null);

    // Sync State
    useEffect(() => {
        if (levelData) {
            setSkills(levelData);
            if (levelData.length === 1) setExpanded(levelData[0].name);
        }
    }, [levelData]);

    // --- Logic ---
    const calculateTotalScore = () => {
        let totalStars = 0;
        let maxStars = 0;
        skills.forEach(category => {
            category.skills.forEach(skill => {
                totalStars += skill.rating;
                maxStars += 5;
            });
        });
        return { totalStars, maxStars, percent: maxStars > 0 ? (totalStars / maxStars) * 100 : 0 };
    };

    const { percent } = calculateTotalScore();
    const isCertificateReady = percent >= 90;

    // --- Handlers ---
    const handleRate = (categoryName, skillId, rating) => {
        // 1. Update Local Skill State
        setSkills(prev => prev.map(cat =>
            cat.name === categoryName
                ? { ...cat, skills: cat.skills.map(s => s.id === skillId ? { ...s, rating } : s) }
                : cat
        ));

        // 2. Smart Suggestion Logic (The Polish)
        // If rating is low (1-2 stars), suggest relevant focus area
        if (rating <= 2 && onUpdatePlan) {
            let suggestion = null;
            // Simple keyword matching for demo
            if (categoryName === 'Floor' || categoryName === 'Beam') suggestion = 'Flexibility';
            if (categoryName === 'Bars' || categoryName === 'Strength') suggestion = 'Strength';
            if (categoryName === 'Vault') suggestion = 'Vault Tech';

            if (suggestion && !trainingPlan.includes(suggestion)) {
                onUpdatePlan([...trainingPlan, suggestion]);
            }
        }
    };

    const handleNote = (categoryName, skillId, note) => {
        setSkills(prev => prev.map(cat =>
            cat.name === categoryName
                ? { ...cat, skills: cat.skills.map(s => s.id === skillId ? { ...s, note } : s) }
                : cat
        ));
    };

    const togglePlanChip = (chip) => {
        if (!onUpdatePlan) return;
        if (trainingPlan.includes(chip)) {
            onUpdatePlan(trainingPlan.filter(c => c !== chip));
        } else {
            onUpdatePlan([...trainingPlan, chip]);
        }
    };

    const PLAN_OPTIONS = ['Strength', 'Flexibility', 'Vault Tech', 'Bar Drills', 'Core', 'Rest/Recovery'];

    return (
        <div className={clsx(
            "bg-white rounded-2xl border shadow-sm overflow-hidden transition-all duration-300",
            isPresent ? "border-slate-200" : "border-slate-100 opacity-90"
        )}>
            {/* ----------------------------------------------------------------------
                ROW 1: THE GATE (Attendance)
            ---------------------------------------------------------------------- */}
            <div className={clsx(
                "p-4 border-b flex justify-between items-center transition-colors px-6",
                isPresent ? "bg-slate-50/50 border-slate-100" : "bg-red-50/50 border-red-100"
            )}>
                <div className="flex items-center gap-4">
                    {/* Status Dot + Avatar */}
                    <div className="relative">
                        <div className={clsx(
                            "h-12 w-12 rounded-full flex items-center justify-center font-bold text-lg transition-colors border-2",
                            isPresent ? "bg-slate-200 text-slate-500 border-white" : "bg-slate-100 text-slate-300 border-transparent"
                        )}>
                            {student.name.charAt(0)}
                        </div>
                        <div className={clsx(
                            "absolute -bottom-1 -right-1 h-5 w-5 rounded-full border-2 border-white flex items-center justify-center transition-all shadow-sm",
                            isPresent ? "bg-emerald-500" : "bg-slate-300"
                        )}>
                            <span className="material-symbols-outlined text-[12px] text-white font-bold">
                                {isPresent ? 'check' : 'close'}
                            </span>
                        </div>
                    </div>

                    <div>
                        <h3 className={clsx("text-lg font-black transition-colors", isPresent ? "text-slate-900" : "text-slate-400 line-through")}>
                            {student.name}
                        </h3>
                        <p className="text-xs font-bold text-slate-400 uppercase">{student.level} â€¢ Age {student.age}</p>
                    </div>
                </div>

                {/* Status Toggle */}
                <button
                    onClick={onToggleAttendance}
                    className={clsx(
                        "px-4 py-2 rounded-xl font-bold text-sm flex items-center gap-2 transition-all shadow-sm border",
                        isPresent
                            ? "bg-white text-emerald-600 border-emerald-100 hover:bg-emerald-50"
                            : "bg-red-50 text-red-500 border-red-100 hover:bg-red-100"
                    )}
                >
                    <span className="material-symbols-outlined text-[18px]">
                        {isPresent ? 'check_circle' : 'cancel'}
                    </span>
                    {isPresent ? 'Present' : 'Absent'}
                </button>
            </div>

            {/* ----------------------------------------------------------------------
                ROW 2: THE PERFORMANCE (Skill Assessment)
                Note: Disabled/Hidden if Absent
            ---------------------------------------------------------------------- */}
            <div className={clsx(
                "transition-all duration-500 ease-in-out",
                isPresent ? "opacity-100" : "opacity-40 grayscale pointer-events-none select-none filter blur-[1px]"
            )}>
                {/* Certificate Banner (Visual Reward) */}
                {isCertificateReady && isPresent && (
                    <div className="bg-amber-50 px-6 py-2 border-b border-amber-100 flex justify-between items-center">
                        <div className="flex items-center gap-2 text-amber-700 text-xs font-bold uppercase tracking-wider">
                            <span className="material-symbols-outlined text-amber-500">emoji_events</span>
                            Ready for Promotion
                        </div>
                        <button onClick={() => generateCertificate(student)} className="text-amber-600 hover:text-amber-800 underline text-xs font-bold">
                            Issue Certificate
                        </button>
                    </div>
                )}

                {/* Progress Bar Header */}
                <div className="px-6 py-4 border-b border-slate-100">
                    <div className="flex items-center gap-3">
                        <div className="flex-1 h-2.5 bg-slate-100 rounded-full overflow-hidden">
                            <motion.div
                                initial={{ width: 0 }}
                                animate={{ width: `${percent}%` }}
                                className={clsx("h-full rounded-full transition-all duration-500",
                                    percent >= 90 ? "bg-amber-400" : "bg-emerald-500"
                                )}
                            />
                        </div>
                        <span className="text-xs font-bold text-slate-400 min-w-[30px] text-right">{Math.round(percent)}%</span>
                    </div>
                </div>

                {/* Accordions */}
                <div className="divide-y divide-slate-100">
                    {skills.map(category => (
                        <div key={category.name} className="bg-white">
                            <button
                                onClick={() => setExpanded(expanded === category.name ? null : category.name)}
                                className="w-full text-left p-4 px-6 flex items-center justify-between hover:bg-slate-50 transition-colors group"
                            >
                                <span className="font-bold text-slate-700 group-hover:text-emerald-700">{category.name}</span>
                                <div className="flex items-center gap-3">
                                    <div className="flex gap-0.5 opacity-50">
                                        {[1, 2, 3].map(i => <span key={i} className="text-[10px] text-slate-300">â˜…</span>)}
                                    </div>
                                    <span className={clsx("material-symbols-outlined text-slate-400 transition-transform",
                                        expanded === category.name && "rotate-180"
                                    )}>expand_more</span>
                                </div>
                            </button>

                            <AnimatePresence>
                                {expanded === category.name && (
                                    <motion.div
                                        initial={{ height: 0, opacity: 0 }}
                                        animate={{ height: 'auto', opacity: 1 }}
                                        exit={{ height: 0, opacity: 0 }}
                                        className="overflow-hidden bg-slate-50/50 shadow-inner"
                                    >
                                        <div className="p-4 px-6 space-y-4">
                                            {category.skills.length === 0 ? (
                                                <p className="text-slate-400 text-sm italic">No skills in this category.</p>
                                            ) : (
                                                category.skills.map(skill => (
                                                    <div key={skill.id} className="bg-white rounded-xl p-4 border border-slate-200/60 shadow-sm">
                                                        <div className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-3">
                                                            <span className="font-bold text-slate-700 text-sm">{skill.name}</span>
                                                            <div className="flex gap-1">
                                                                {[1, 2, 3, 4, 5].map(star => (
                                                                    <button
                                                                        key={star}
                                                                        onClick={() => handleRate(category.name, skill.id, star)}
                                                                        className={clsx("text-2xl transition-transform hover:scale-110 focus:outline-none",
                                                                            star <= skill.rating ? "text-amber-400 drop-shadow-sm" : "text-slate-200 hover:text-amber-200"
                                                                        )}
                                                                    >
                                                                        â˜…
                                                                    </button>
                                                                ))}
                                                            </div>
                                                        </div>
                                                        <div className="relative">
                                                            <input
                                                                type="text"
                                                                placeholder="Coach Note..."
                                                                value={skill.note}
                                                                onChange={(e) => handleNote(category.name, skill.id, e.target.value)}
                                                                className="w-full bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-xs text-slate-600 focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 transition-all placeholder:text-slate-300"
                                                            />
                                                            <span className="material-symbols-outlined absolute right-2 top-2 text-slate-300 text-[16px]">edit_note</span>
                                                        </div>
                                                    </div>
                                                ))
                                            )}
                                        </div>
                                    </motion.div>
                                )}
                            </AnimatePresence>
                        </div>
                    ))}
                </div>
            </div>

            {/* ----------------------------------------------------------------------
                ROW 3: THE TRAINING PLAN (Assignment)
                Note: Also Hidden if Absent
            ---------------------------------------------------------------------- */}
            {isPresent && (
                <div className="bg-slate-50 border-t border-slate-200 p-6">
                    <div className="flex items-center gap-2 mb-3">
                        <span className="material-symbols-outlined text-emerald-600">fitness_center</span>
                        <h4 className="text-xs font-black text-slate-700 uppercase tracking-wider">Plan for Next Session</h4>
                    </div>
                    <div className="flex flex-wrap gap-2">
                        {PLAN_OPTIONS.map(plan => {
                            const isActive = trainingPlan.includes(plan);
                            return (
                                <button
                                    key={plan}
                                    onClick={() => togglePlanChip(plan)}
                                    className={clsx(
                                        "px-3 py-1.5 rounded-lg text-xs font-bold border transition-all flex items-center gap-1.5",
                                        isActive
                                            ? "bg-slate-800 text-white border-slate-800 shadow-md transform scale-105"
                                            : "bg-white text-slate-500 border-slate-200 hover:border-slate-400 hover:bg-slate-100"
                                    )}
                                >
                                    {isActive && <span className="material-symbols-outlined text-[10px]">check</span>}
                                    {plan}
                                </button>
                            );
                        })}
                    </div>
                </div>
            )}
        </div>
    );
}
</file>

<file path="src/components/FeedbackModal.jsx">
import React, { useState } from 'react';
import { supabase } from '../supabaseClient';
import { clsx } from 'clsx';

export default function FeedbackModal({ isOpen, onClose }) {
    const [type, setType] = useState('bug'); // 'bug', 'feature', 'other'
    const [title, setTitle] = useState('');
    const [description, setDescription] = useState('');
    const [isSubmitting, setIsSubmitting] = useState(false);
    const [submitted, setSubmitted] = useState(false);

    if (!isOpen) return null;

    const handleSubmit = async (e) => {
        e.preventDefault();
        setIsSubmitting(true);

        try {
            const { error } = await supabase
                .from('feedback')
                .insert([
                    { type, title, description, created_at: new Date() }
                ]);

            if (error) {
                console.error('Error submitting feedback:', error);
                // Optionally handle error state
            } else {
                setSubmitted(true);
                setTimeout(() => {
                    setSubmitted(false);
                    onClose();
                    // Reset form
                    setTitle('');
                    setDescription('');
                    setType('bug');
                }, 2000);
            }
        } catch (err) {
            console.error('Unexpected error:', err);
        } finally {
            setIsSubmitting(false);
        }
    };

    return (
        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/50 backdrop-blur-sm animate-in fade-in duration-200">
            <div className="bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden animate-in zoom-in-95 duration-200">

                {submitted ? (
                    <div className="p-12 text-center">
                        <div className="h-16 w-16 mx-auto bg-green-100 text-green-600 rounded-full flex items-center justify-center mb-4">
                            <span className="material-symbols-outlined text-[32px]">check</span>
                        </div>
                        <h3 className="text-xl font-bold text-slate-900 mb-2">Thanks for your feedback!</h3>
                        <p className="text-slate-500">We appreciate your help in making Wild Robot better. ðŸš€</p>
                    </div>
                ) : (
                    <>
                        <div className="p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/50">
                            <div>
                                <h2 className="text-lg font-bold text-slate-800">Help us improve Wild Robot ðŸš€</h2>
                                <p className="text-xs text-slate-500">Report a bug or suggest a new feature.</p>
                            </div>
                            <button onClick={onClose} className="text-slate-400 hover:text-slate-600 transition-colors">
                                <span className="material-symbols-outlined">close</span>
                            </button>
                        </div>

                        <form onSubmit={handleSubmit} className="p-6 space-y-4">
                            {/* Type Selector */}
                            <div className="flex gap-2 p-1 bg-gray-100 rounded-xl">
                                {[
                                    { id: 'bug', label: 'ðŸž Bug Report' },
                                    { id: 'feature', label: 'âœ¨ Feature' },
                                    { id: 'other', label: 'ðŸ’­ Other' }
                                ].map((opt) => (
                                    <button
                                        key={opt.id}
                                        type="button"
                                        onClick={() => setType(opt.id)}
                                        className={clsx(
                                            "flex-1 py-2 text-xs font-bold rounded-lg transition-all",
                                            type === opt.id
                                                ? "bg-white text-slate-900 shadow-sm"
                                                : "text-slate-500 hover:text-slate-700"
                                        )}
                                    >
                                        {opt.label}
                                    </button>
                                ))}
                            </div>

                            {/* Title */}
                            <div>
                                <label className="block text-xs font-bold text-slate-700 mb-1.5">Short Summary</label>
                                <input
                                    type="text"
                                    required
                                    value={title}
                                    onChange={(e) => setTitle(e.target.value)}
                                    placeholder="e.g., Calendar not loading on mobile..."
                                    className="w-full px-4 py-2.5 rounded-xl border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all bg-gray-50 focus:bg-white"
                                />
                            </div>

                            {/* Description */}
                            <div>
                                <label className="block text-xs font-bold text-slate-700 mb-1.5">Details</label>
                                <textarea
                                    required
                                    value={description}
                                    onChange={(e) => setDescription(e.target.value)}
                                    rows={4}
                                    placeholder="Tell us more about what happened or your idea..."
                                    className="w-full px-4 py-2.5 rounded-xl border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all bg-gray-50 focus:bg-white resize-none"
                                />
                            </div>

                            {/* Actions */}
                            <div className="pt-2 flex justify-end gap-3">
                                <button
                                    type="button"
                                    onClick={onClose}
                                    className="px-4 py-2 text-sm font-bold text-slate-500 hover:bg-gray-100 rounded-xl transition-colors"
                                >
                                    Cancel
                                </button>
                                <button
                                    type="submit"
                                    disabled={isSubmitting}
                                    className="px-6 py-2 text-sm font-bold text-white bg-slate-900 hover:bg-slate-800 rounded-xl transition-all shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
                                >
                                    {isSubmitting ? (
                                        <>
                                            <span className="h-3 w-3 rounded-full border-2 border-white/30 border-t-white animate-spin"></span>
                                            Sending...
                                        </>
                                    ) : (
                                        "Send Feedback"
                                    )}
                                </button>
                            </div>
                        </form>
                    </>
                )}
            </div>
        </div>
    );
}
</file>

<file path="src/components/forms/AthleteInviteForm.jsx">
import React, { useState } from 'react';
import {
    User, Phone, Heart, Trash2, Plus,
    Sparkles, AlertCircle, Save
} from 'lucide-react';
import { supabase } from '../../supabaseClient';
import { toast } from 'sonner';

const AthleteInviteForm = ({ onSuccess, onCancel }) => {
    const [loading, setLoading] = useState(false);

    // Batch State
    const [entries, setEntries] = useState([
        {
            id: Date.now(),
            name: '',
            gender: 'male',
            dob: '2015-01-01',
            guardianName: '',
            guardianPhone: '',
            relationship: 'parent',
            medicalTags: []
        }
    ]);

    const MEDICAL_TAGS = ['Asthma', 'Diabetes', 'Epilepsy', 'Nut Allergy', 'Injury History'];

    // --- Actions ---

    const addRow = () => {
        setEntries(prev => [
            ...prev,
            {
                id: Date.now(),
                name: '',
                gender: 'male',
                dob: '2015-01-01',
                guardianName: '',
                guardianPhone: '',
                relationship: 'parent',
                medicalTags: []
            }
        ]);
    };

    const removeRow = (id) => {
        if (entries.length > 1) {
            setEntries(prev => prev.filter(e => e.id !== id));
        }
    };

    const handleChange = (id, field, value) => {
        if (field === 'guardianPhone') value = value.replace(/[^0-9+ ]/g, '');

        setEntries(prev => prev.map(entry => {
            if (entry.id === id) {
                return { ...entry, [field]: value };
            }
            return entry;
        }));
    };

    const toggleMedical = (id, tag) => {
        setEntries(prev => prev.map(entry => {
            if (entry.id === id) {
                const tags = entry.medicalTags.includes(tag)
                    ? entry.medicalTags.filter(t => t !== tag)
                    : [...entry.medicalTags, tag];
                return { ...entry, medicalTags: tags };
            }
            return entry;
        }));
    };

    // --- Submission ---

    const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        const toastId = toast.loading("Processing Recruitment Batch...");

        let successCount = 0;
        let failCount = 0;
        const failedNames = [];

        try {
            const { data: { user } } = await supabase.auth.getUser();
            if (!user) throw new Error("No session");

            // Get Academy ID
            const { data: profile } = await supabase.from('profiles').select('academy_id').eq('id', user.id).single();
            if (!profile?.academy_id) throw new Error("No Academy Linked");

            // Loop through entries
            for (const entry of entries) {
                try {
                    // 1. Insert/Get Guardian
                    const { data: guardian, error: guardianError } = await supabase
                        .from('guardians')
                        .insert({
                            academy_id: profile.academy_id,
                            name: entry.guardianName,
                            phone: entry.guardianPhone,
                            relationship_type: entry.relationship
                        })
                        .select()
                        .single();

                    if (guardianError) throw guardianError;

                    // 2. Insert Athlete
                    const { data: athlete, error: athleteError } = await supabase
                        .from('athletes')
                        .insert({
                            academy_id: profile.academy_id,
                            name: entry.name,
                            gender: entry.gender,
                            dob: entry.dob,
                            medical_info: { tags: entry.medicalTags },
                            stats: { overall: 60 }
                        })
                        .select()
                        .single();

                    if (athleteError) throw athleteError;

                    // 3. Link
                    const { error: linkError } = await supabase
                        .from('athlete_guardians')
                        .insert({
                            athlete_id: athlete.id,
                            guardian_id: guardian.id
                        });

                    if (linkError) throw linkError;

                    successCount++;

                } catch (innerErr) {
                    console.error(`Failed to add ${entry.name}`, innerErr);
                    failCount++;
                    failedNames.push(entry.name || 'Unknown');
                }
            }

            // Final Report
            if (failCount === 0) {
                toast.success(`Recruited ${successCount} new heroes!`, { id: toastId });
                onSuccess(); // Close modal
            } else {
                toast.warning(`${successCount} succeeded, ${failCount} failed (${failedNames.join(', ')}).`, { id: toastId });
                // We keep the modal open if there are failures, ideally we'd filter the list to show only failed ones, 
                // but for now we just keep it open so they can retry or see what happened.
            }

        } catch (err) {
            console.error("Batch Error:", err);
            toast.error(err.message, { id: toastId });
        } finally {
            setLoading(false);
        }
    };

    return (
        <form onSubmit={handleSubmit} className="flex flex-col h-full bg-slate-50">

            {/* Scrollable Container */}
            <div className="flex-1 overflow-y-auto p-4 space-y-4">

                <div className="flex items-center gap-2 mb-2 px-2">
                    <Sparkles className="w-4 h-4 text-emerald-500" />
                    <span className="text-sm font-bold text-slate-500 uppercase tracking-wider">
                        Batch Entry Mode
                    </span>
                </div>

                {entries.map((entry, index) => (
                    <div key={entry.id} className="bg-white rounded-2xl p-5 shadow-sm border border-slate-200 animate-fade-in-up relative group">

                        {/* Remove Button (Only if > 1) */}
                        {entries.length > 1 && (
                            <button
                                type="button"
                                onClick={() => removeRow(entry.id)}
                                className="absolute right-4 top-4 text-slate-300 hover:text-red-500 transition-colors"
                            >
                                <Trash2 className="w-5 h-5" />
                            </button>
                        )}

                        <div className="grid grid-cols-1 gap-4">

                            {/* Row 1: Athlete Identity */}
                            <div className="grid grid-cols-1 md:grid-cols-12 gap-4">
                                <div className="md:col-span-5">
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block">Hero Name</label>
                                    <div className="relative">
                                        <User className="absolute left-3 top-3 w-4 h-4 text-slate-300" />
                                        <input
                                            required
                                            value={entry.name}
                                            onChange={e => handleChange(entry.id, 'name', e.target.value)}
                                            className="w-full pl-9 p-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:border-emerald-500 outline-none font-bold text-sm"
                                            placeholder="Full Name"
                                        />
                                    </div>
                                </div>
                                <div className="md:col-span-3">
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block">Gender</label>
                                    <select
                                        className="w-full p-2.5 bg-slate-50 border border-slate-200 rounded-lg outline-none text-sm font-medium"
                                        value={entry.gender}
                                        onChange={e => handleChange(entry.id, 'gender', e.target.value)}
                                    >
                                        <option value="male">Boy</option>
                                        <option value="female">Girl</option>
                                    </select>
                                </div>
                                <div className="md:col-span-4">
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block">Date of Birth</label>
                                    <input
                                        type="date"
                                        required
                                        value={entry.dob}
                                        onChange={e => handleChange(entry.id, 'dob', e.target.value)}
                                        className="w-full p-2.5 bg-slate-50 border border-slate-200 rounded-lg outline-none text-sm font-bold text-slate-600"
                                    />
                                </div>
                            </div>

                            {/* Divider */}
                            <div className="h-px bg-slate-100" />

                            {/* Row 2: Guardian & Medical */}
                            <div className="grid grid-cols-1 md:grid-cols-12 gap-4 items-start">
                                <div className="md:col-span-4">
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block">Guardian Name</label>
                                    <input
                                        required
                                        value={entry.guardianName}
                                        onChange={e => handleChange(entry.id, 'guardianName', e.target.value)}
                                        className="w-full p-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:border-emerald-500 outline-none font-medium text-sm"
                                        placeholder="Parent Name"
                                    />
                                </div>
                                <div className="md:col-span-4">
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block">Contact Phone</label>
                                    <div className="relative">
                                        <Phone className="absolute left-3 top-3 w-4 h-4 text-slate-300" />
                                        <input
                                            required
                                            type="tel"
                                            value={entry.guardianPhone}
                                            onChange={e => handleChange(entry.id, 'guardianPhone', e.target.value)}
                                            className="w-full pl-9 p-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:border-emerald-500 outline-none font-medium text-sm"
                                            placeholder="+971..."
                                        />
                                    </div>
                                </div>
                                <div className="md:col-span-4">
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block flex items-center gap-1">
                                        Medical <Heart className="w-3 h-3 text-red-400" />
                                    </label>
                                    <div className="flex flex-wrap gap-1">
                                        {MEDICAL_TAGS.slice(0, 3).map(tag => (
                                            <button
                                                key={tag}
                                                type="button"
                                                onClick={() => toggleMedical(entry.id, tag)}
                                                className={`px-2 py-1 rounded text-[10px] font-bold border transition-all ${entry.medicalTags.includes(tag)
                                                        ? 'bg-red-50 border-red-200 text-red-600'
                                                        : 'bg-white border-slate-100 text-slate-300 hover:border-slate-300'
                                                    }`}
                                            >
                                                {tag}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                ))}

                {/* Add Row Button */}
                <button
                    type="button"
                    onClick={addRow}
                    className="w-full py-4 border-2 border-dashed border-slate-300 rounded-2xl text-slate-400 font-bold hover:border-emerald-400 hover:text-emerald-500 hover:bg-emerald-50 transition-all flex items-center justify-center gap-2"
                >
                    <Plus className="w-5 h-5" /> Add Another Hero
                </button>
            </div>

            {/* Footer Actions */}
            <div className="p-4 bg-white border-t border-slate-100 flex items-center justify-between z-10">
                <button
                    type="button"
                    onClick={onCancel}
                    className="px-6 py-3 font-bold text-slate-500 hover:text-slate-800 transition-colors"
                >
                    Cancel
                </button>
                <div className="flex items-center gap-4">
                    <span className="text-sm font-bold text-slate-400">
                        {entries.length} Hero{entries.length > 1 ? 'es' : ''} Ready
                    </span>
                    <button
                        type="submit"
                        disabled={loading}
                        className="bg-emerald-500 text-white px-8 py-3 rounded-xl font-bold hover:bg-emerald-600 shadow-lg shadow-emerald-500/20 active:scale-95 transition-all flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed"
                    >
                        {loading ? 'Processing...' : 'Recruit All Heroes'}
                        <Save className="w-4 h-4" />
                    </button>
                </div>
            </div>
        </form>
    );
};

export default AthleteInviteForm;
</file>

<file path="src/components/forms/StaffInviteForm.jsx">
import React, { useState } from 'react';
import {
    User, Mail, Briefcase, Plus, Check,
    Smartphone, Shirt, Calendar, Hash, Sparkles
} from 'lucide-react';
import { supabase } from '../../supabaseClient';
import { toast } from 'sonner';

const REQUIRED_FIELDS = [
    { id: 'name', label: 'Full Name', icon: User, type: 'text' },
    { id: 'email', label: 'Email Address', icon: Mail, type: 'email' },
    { id: 'role', label: 'Role', icon: Briefcase, type: 'select', options: ['coach', 'head_coach', 'manager', 'sales', 'general_staff'] }
];

const OPTIONAL_FIELDS = [
    { id: 'national_id', key: 'national_id', label: 'National ID', icon: Hash, type: 'text', placeholder: 'Ex: 784-1234-1234567-1' },
    { id: 'shirt_size', key: 'shirt_size', label: 'T-Shirt Size', icon: Shirt, type: 'select', options: ['XS', 'S', 'M', 'L', 'XL', 'XXL'] },
    { id: 'emergency_contact', key: 'emergency_contact', label: 'Emergency Phone', icon: Smartphone, type: 'tel', placeholder: '+971 50 123 4567' },
    { id: 'joining_date', key: 'joining_date', label: 'Joining Date', icon: Calendar, type: 'date' },
    { id: 'dob', key: 'dob', label: 'Date of Birth', icon: Calendar, type: 'date' }
];

const StaffInviteForm = ({ onSuccess, onCancel }) => {
    const [selectedExtras, setSelectedExtras] = useState([]);
    const [formData, setFormData] = useState({
        name: '',
        email: '',
        role: 'coach',
        custom_fields: {}
    });
    const [submitting, setSubmitting] = useState(false);

    // Toggle chip selection
    const toggleExtra = (fieldId) => {
        setSelectedExtras(prev => {
            const isRemoving = prev.includes(fieldId);
            if (isRemoving) {
                const newExtras = prev.filter(id => id !== fieldId);
                const newCustom = { ...formData.custom_fields };
                delete newCustom[OPTIONAL_FIELDS.find(f => f.id === fieldId).key];
                setFormData(d => ({ ...d, custom_fields: newCustom }));
                return newExtras;
            } else {
                // Initialize default values when added
                const field = OPTIONAL_FIELDS.find(f => f.id === fieldId);
                let defaultValue = '';
                if (field.id === 'joining_date') defaultValue = new Date().toISOString().split('T')[0];
                if (field.id === 'dob') defaultValue = '2000-01-01';

                setFormData(d => ({
                    ...d,
                    custom_fields: {
                        ...d.custom_fields,
                        [field.key]: defaultValue
                    }
                }));

                return [...prev, fieldId];
            }
        });
    };

    // Handle input changes
    const handleChange = (id, value, isCustom = false) => {
        // Input Masking for Phones
        if (id === 'emergency_contact' || id.includes('phone')) {
            value = value.replace(/[^0-9+ ]/g, '');
        }

        if (isCustom) {
            setFormData(prev => ({
                ...prev,
                custom_fields: {
                    ...prev.custom_fields,
                    [id]: value
                }
            }));
        } else {
            setFormData(prev => ({ ...prev, [id]: value }));
        }
    };

    const handleSubmit = async (e) => {
        e.preventDefault();
        setSubmitting(true);
        const toastId = toast.loading("Inviting Commander...");

        try {
            // NOTE: Simulated Logic (Since we can't really email without Edge Function)
            // In real life: await supabase.functions.invoke('invite-user', { body: formData })

            await new Promise(r => setTimeout(r, 1500));

            // Simulate randomness
            if (Math.random() > 0.9) throw new Error("Network glitch. Please retry.");

            toast.success("Commander added to your ranks!", { id: toastId });

            // Log for debugging
            console.log("âœ… Invite Payload:", formData);

            if (onSuccess) onSuccess();

        } catch (err) {
            console.error("Invite failed:", err);
            toast.error(err.message, { id: toastId });
        } finally {
            setSubmitting(false);
        }
    };

    return (
        <div className="flex flex-col md:flex-row h-full">

            {/* Left Side: Field Picker */}
            <div className="bg-slate-50 p-6 md:w-1/3 border-b md:border-b-0 md:border-r border-slate-100 flex flex-col overflow-y-auto">
                <h4 className="font-bold text-slate-900 mb-4 flex items-center gap-2">
                    <Sparkles className="w-4 h-4 text-emerald-500" />
                    Required Details
                </h4>
                <div className="space-y-2 mb-8 text-sm text-slate-500">
                    <p>Standard profile information is required for all staff members.</p>
                </div>

                <h4 className="font-bold text-slate-900 mb-4 flex items-center gap-2">
                    <Plus className="w-4 h-4 text-emerald-500" />
                    Add More Fields
                </h4>
                <div className="flex flex-wrap gap-2">
                    {OPTIONAL_FIELDS.map(field => {
                        const isSelected = selectedExtras.includes(field.id);
                        return (
                            <button
                                key={field.id}
                                type="button"
                                onClick={() => toggleExtra(field.id)}
                                className={`px-3 py-2 rounded-lg text-xs font-bold border transition-all flex items-center gap-2 ${isSelected
                                        ? 'bg-emerald-100 border-emerald-200 text-emerald-700 shadow-sm'
                                        : 'bg-white border-slate-200 text-slate-600 hover:border-emerald-200 hover:bg-emerald-50'
                                    }`}
                            >
                                <field.icon className="w-3 h-3" />
                                {field.label}
                                {isSelected && <Check className="w-3 h-3 ml-1" />}
                            </button>
                        );
                    })}
                </div>
            </div>

            {/* Right Side: The Form */}
            <div className="flex-1 p-6 bg-white overflow-y-auto">
                <form onSubmit={handleSubmit} className="space-y-6 max-w-lg mx-auto md:mx-0">

                    {/* Standard Fields */}
                    <div className="space-y-4">
                        {REQUIRED_FIELDS.map(field => (
                            <div key={field.id}>
                                <label className="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-1">
                                    {field.label}
                                </label>
                                <div className="relative">
                                    <field.icon className="absolute left-3 top-3.5 w-5 h-5 text-slate-400" />
                                    {field.type === 'select' ? (
                                        <select
                                            value={formData[field.id]}
                                            onChange={e => handleChange(field.id, e.target.value)}
                                            className="w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:border-emerald-500 focus:bg-white outline-none font-medium transition-colors appearance-none"
                                        >
                                            {field.options.map(opt => (
                                                <option key={opt} value={opt}>{opt.replace('_', ' ').toUpperCase()}</option>
                                            ))}
                                        </select>
                                    ) : (
                                        <input
                                            type={field.type}
                                            value={formData[field.id]}
                                            onChange={e => handleChange(field.id, e.target.value)}
                                            className="w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:border-emerald-500 focus:bg-white outline-none font-medium transition-colors"
                                            placeholder={`Enter ${field.label.toLowerCase()}...`}
                                            required
                                        />
                                    )}
                                </div>
                            </div>
                        ))}
                    </div>

                    {/* Dynamic Fields Section */}
                    {selectedExtras.length > 0 && (
                        <div className="pt-6 border-t border-slate-100 animate-fade-in-up">
                            <h5 className="font-bold text-slate-800 mb-4 text-sm">Additional Information</h5>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {selectedExtras.map(id => {
                                    const field = OPTIONAL_FIELDS.find(f => f.id === id);
                                    return (
                                        <div key={id} className="animate-fade-in-up">
                                            <label className="block text-xs font-bold text-emerald-600 uppercase tracking-wider mb-1">
                                                {field.label}
                                            </label>
                                            <div className="relative">
                                                <field.icon className="absolute left-3 top-3.5 w-4 h-4 text-emerald-400/70" />
                                                {field.type === 'select' ? (
                                                    <select
                                                        value={formData.custom_fields[field.key] || ''}
                                                        onChange={e => handleChange(field.key, e.target.value, true)}
                                                        className="w-full pl-9 pr-3 py-2.5 bg-emerald-50/50 border border-emerald-100 rounded-lg focus:border-emerald-500 outline-none text-sm font-medium"
                                                    >
                                                        <option value="">Select...</option>
                                                        {field.options.map(opt => (
                                                            <option key={opt} value={opt}>{opt}</option>
                                                        ))}
                                                    </select>
                                                ) : (
                                                    <input
                                                        type={field.type}
                                                        value={formData.custom_fields[field.key] || ''}
                                                        onChange={e => handleChange(field.key, e.target.value, true)}
                                                        className="w-full pl-9 pr-3 py-2.5 bg-emerald-50/50 border border-emerald-100 rounded-lg focus:border-emerald-500 outline-none text-sm font-medium placeholder-emerald-800/20"
                                                        placeholder={field.placeholder || '...'}
                                                    />
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    )}

                    {/* Actions */}
                    <div className="pt-6 flex items-center justify-end gap-3">
                        <button
                            type="button"
                            onClick={onCancel}
                            className="px-6 py-3 font-bold text-slate-500 hover:text-slate-800 transition-colors"
                        >
                            Cancel
                        </button>
                        <button
                            type="submit"
                            disabled={submitting}
                            className="bg-emerald-500 text-white px-8 py-3 rounded-xl font-bold hover:bg-emerald-600 shadow-lg shadow-emerald-500/20 active:scale-95 transition-all flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed"
                        >
                            {submitting ? 'Authenticating...' : 'Send Invitation'}
                            <Mail className="w-4 h-4" />
                        </button>
                    </div>

                </form>
            </div>
        </div>
    );
};

export default StaffInviteForm;
</file>

<file path="src/components/GranularErrorBoundary.jsx">
import React from 'react';
import { Link } from 'react-router-dom';

class GranularErrorBoundary extends React.Component {
    constructor(props) {
        super(props);
        this.state = { hasError: false, error: null, errorInfo: null };
    }

    static getDerivedStateFromError(error) {
        // Update state so the next render will show the fallback UI.
        return { hasError: true, error };
    }

    componentDidCatch(error, errorInfo) {
        // You can also log the error to an error reporting service
        console.error("GranularErrorBoundary caught an error:", error, errorInfo);
        this.setState({ errorInfo });
    }

    handleRetry = () => {
        this.setState({ hasError: false, error: null, errorInfo: null });
        window.location.reload();
    };

    render() {
        if (this.state.hasError) {
            // Check for specific error types if needed, or fallback logic
            const isAuthError = this.state.error?.message?.includes('Access Denied') || this.state.error?.message?.includes('401') || this.state.error?.message?.includes('403');
            const isNetworkError = this.state.error?.message?.includes('Network') || this.state.error?.message?.includes('Failed to fetch');

            if (this.props.fallback) {
                return this.props.fallback;
            }

            // Default Fancy Error UI
            return (
                <div className="min-h-[400px] flex flex-col items-center justify-center p-8 text-center bg-slate-50 border border-slate-200 rounded-3xl shadow-sm m-4">
                    <div className={`h-20 w-20 rounded-2xl flex items-center justify-center mb-6 shadow-lg ${isAuthError ? 'bg-red-100 text-red-500' : 'bg-slate-900 text-white'}`}>
                        <span className="material-symbols-outlined text-[40px]">
                            {isAuthError ? 'lock' : isNetworkError ? 'wifi_off' : 'bug_report'}
                        </span>
                    </div>

                    <h2 className="text-2xl font-black text-slate-900 mb-2">
                        {isAuthError ? 'Access Denied' : isNetworkError ? 'Connection Lost' : 'System Glitch'}
                    </h2>

                    <p className="text-slate-500 max-w-md mb-8">
                        {isAuthError
                            ? "You do not have permission to view this area. Please contact your administrator."
                            : isNetworkError
                                ? "We lost contact with the server. Please check your internet connection."
                                : "The system encountered an unexpected error. Our engineers have been notified."}
                    </p>

                    <div className="bg-slate-100 p-4 rounded-xl text-left w-full max-w-lg mb-8 overflow-auto max-h-40 border border-slate-200">
                        <code className="text-xs font-mono text-red-500 block break-words">
                            {this.state.error?.toString()}
                        </code>
                        {this.state.errorInfo && (
                            <details className="mt-2 text-[10px] text-slate-400 font-mono cursor-pointer">
                                <summary>Stack Trace</summary>
                                <pre className="mt-2 whitespace-pre-wrap">
                                    {this.state.errorInfo.componentStack}
                                </pre>
                            </details>
                        )}
                    </div>

                    <div className="flex items-center gap-4">
                        <button
                            onClick={this.handleRetry}
                            className="bg-slate-900 text-white px-6 py-3 rounded-xl font-bold hover:bg-slate-800 transition-all flex items-center gap-2"
                        >
                            <span className="material-symbols-outlined">refresh</span>
                            Try Again
                        </button>
                        <Link
                            to="/"
                            className="bg-white border border-slate-200 text-slate-600 px-6 py-3 rounded-xl font-bold hover:bg-slate-50 transition-all"
                        >
                            Return Home
                        </Link>
                    </div>
                </div>
            );
        }

        return this.props.children;
    }
}

export default GranularErrorBoundary;
</file>

<file path="src/components/InviteStaffModal.jsx">
import React, { useState } from 'react';
import { supabase } from '../supabaseClient';
import { X, Mail, Shield, Link as LinkIcon, Copy, CheckCircle, Loader2 } from 'lucide-react';

const InviteStaffModal = ({ isOpen, onClose, academyId, onSuccess }) => {
    const [email, setEmail] = useState('');
    const [role, setRole] = useState('coach'); // Default role
    const [loading, setLoading] = useState(false);
    const [generatedLink, setGeneratedLink] = useState(null);
    const [copied, setCopied] = useState(false);

    if (!isOpen) return null;

    const handleInvite = async (e) => {
        e.preventDefault();
        setLoading(true);

        try {
            // 1. Generate a secure random token
            const token = crypto.randomUUID();

            // 2. Insert into Database
            const { error } = await supabase
                .from('invitations')
                .insert([
                    {
                        academy_id: academyId,
                        email: email,
                        role: role,
                        token: token,
                        status: 'pending'
                    }
                ]);

            if (error) throw error;

            // 3. Create the Magic Link
            const link = `${window.location.origin}/join?token=${token}`;
            setGeneratedLink(link);
            if (onSuccess) onSuccess();

        } catch (err) {
            alert('Error creating invitation: ' + err.message);
        } finally {
            setLoading(false);
        }
    };

    const copyToClipboard = () => {
        navigator.clipboard.writeText(generatedLink);
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
    };

    const resetAndClose = () => {
        setGeneratedLink(null);
        setEmail('');
        setRole('coach');
        onClose();
    };

    return (
        <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4">
            <div className="bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden border border-slate-100">

                {/* Header */}
                <div className="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                    <h3 className="font-bold text-slate-800">Invite New Staff</h3>
                    <button onClick={resetAndClose} className="p-1 hover:bg-slate-200 rounded-full transition">
                        <X className="w-5 h-5 text-slate-500" />
                    </button>
                </div>

                {/* Content */}
                <div className="p-6">
                    {!generatedLink ? (
                        // STATE 1: INPUT FORM
                        <form onSubmit={handleInvite} className="space-y-4">

                            {/* Email Input */}
                            <div>
                                <label className="block text-sm font-medium text-slate-700 mb-1">Email Address</label>
                                <div className="relative">
                                    <Mail className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                                    <input
                                        type="email"
                                        required
                                        className="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none"
                                        placeholder="coach@example.com"
                                        value={email}
                                        onChange={(e) => setEmail(e.target.value)}
                                    />
                                </div>
                            </div>

                            {/* Role Selection */}
                            <div>
                                <label className="block text-sm font-medium text-slate-700 mb-1">Role & Permissions</label>
                                <div className="grid grid-cols-2 gap-3">
                                    <button
                                        type="button"
                                        onClick={() => setRole('coach')}
                                        className={`p-3 rounded-xl border text-left flex flex-col gap-1 transition-all ${role === 'coach' ? 'border-emerald-500 bg-emerald-50 ring-1 ring-emerald-500' : 'border-slate-200 hover:border-emerald-300'}`}
                                    >
                                        <span className="font-bold text-sm text-slate-800">Coach</span>
                                        <span className="text-xs text-slate-500">Manage athletes & attendance.</span>
                                    </button>

                                    <button
                                        type="button"
                                        onClick={() => setRole('head_coach')}
                                        className={`p-3 rounded-xl border text-left flex flex-col gap-1 transition-all ${role === 'head_coach' ? 'border-purple-500 bg-purple-50 ring-1 ring-purple-500' : 'border-slate-200 hover:border-purple-300'}`}
                                    >
                                        <span className="font-bold text-sm text-slate-800">Head Coach</span>
                                        <span className="text-xs text-slate-500">Full technical oversight.</span>
                                    </button>
                                </div>
                            </div>

                            <button
                                type="submit"
                                disabled={loading}
                                className="w-full py-3 mt-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-xl flex items-center justify-center gap-2 transition-all shadow-lg shadow-emerald-200"
                            >
                                {loading ? <Loader2 className="animate-spin w-5 h-5" /> : <><LinkIcon className="w-5 h-5" /> Generate Invite Link</>}
                            </button>
                        </form>
                    ) : (
                        // STATE 2: SUCCESS & LINK COPY
                        <div className="text-center space-y-4">
                            <div className="w-16 h-16 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-2">
                                <CheckCircle className="w-8 h-8" />
                            </div>

                            <div>
                                <h4 className="text-lg font-bold text-slate-900">Invitation Created!</h4>
                                <p className="text-sm text-slate-500">Share this link with the coach to let them join.</p>
                            </div>

                            <div className="bg-slate-100 p-3 rounded-xl border border-slate-200 break-all text-sm text-slate-600 font-mono select-all">
                                {generatedLink}
                            </div>

                            <button
                                onClick={copyToClipboard}
                                className={`w-full py-3 rounded-xl font-bold flex items-center justify-center gap-2 transition-all ${copied ? 'bg-slate-800 text-white' : 'bg-emerald-600 text-white hover:bg-emerald-700'}`}
                            >
                                {copied ? <>Copied! <CheckCircle className="w-5 h-5" /></> : <>Copy Link <Copy className="w-5 h-5" /></>}
                            </button>

                            <button onClick={resetAndClose} className="text-slate-400 hover:text-slate-600 text-sm font-medium">
                                Close & Invite Another
                            </button>
                        </div>
                    )}
                </div>
            </div>
        </div>
    );
};

export default InviteStaffModal;
</file>

<file path="src/components/InvoiceDetailModal.jsx">
import React from 'react';
import { clsx } from 'clsx';

export default function InvoiceDetailModal({ invoice, isOpen, onClose }) {
    if (!isOpen || !invoice) return null;

    // Mock Line Items based on invoice description
    const lineItems = [
        { description: invoice.description, amount: invoice.amount },
        { description: 'Transaction Fee', amount: 0.00 }, // Mock
    ];


    const [isDownloading, setIsDownloading] = React.useState(false);

    const handleDownload = () => {
        setIsDownloading(true);
        // Simulate download
        setTimeout(() => {
            setIsDownloading(false);
            const toast = document.createElement('div');
            toast.textContent = 'Invoice downloaded successfully ðŸ“„';
            toast.className = 'fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-slate-900 text-white px-6 py-3 rounded-xl shadow-2xl animate-in slide-in-from-bottom-5 font-bold z-[200] flex items-center gap-2';
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 2500);
        }, 1500);
    };

    return (
        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/40 backdrop-blur-sm animate-in fade-in duration-200" onClick={onClose}>
            <div
                className="bg-white rounded-3xl w-full max-w-md shadow-2xl overflow-hidden animate-in zoom-in-95 duration-300"
                onClick={e => e.stopPropagation()}
            >
                {/* Header */}
                <div className="bg-slate-50 p-6 border-b border-slate-100 flex items-center justify-between">
                    <div>
                        <h2 className="text-xl font-black text-slate-800">Invoice #{invoice.id}</h2>
                        <span className={clsx(
                            "text-xs font-bold px-2 py-1 rounded-md uppercase tracking-wide mt-1 inline-block",
                            invoice.status === 'Paid' ? "bg-emerald-100 text-emerald-600" : "bg-orange-100 text-orange-600"
                        )}>
                            {invoice.status}
                        </span>
                    </div>
                    <button
                        onClick={onClose}
                        className="h-8 w-8 rounded-full bg-white border border-slate-200 flex items-center justify-center hover:bg-slate-100 transition-colors"
                    >
                        <span className="material-symbols-outlined text-slate-400 text-sm">close</span>
                    </button>
                </div>

                {/* Body */}
                <div className="p-6">
                    <div className="space-y-4">
                        <div className="flex justify-between text-sm text-slate-500 mb-6">
                            <span>Billed to: <strong>Student Account</strong></span>
                            <span>Date: <strong>{invoice.date}</strong></span>
                        </div>

                        {/* Table Header */}
                        <div className="flex justify-between text-xs font-bold text-slate-400 uppercase tracking-wider border-b border-slate-100 pb-2">
                            <span>Description</span>
                            <span>Amount</span>
                        </div>

                        {/* List */}
                        <div className="space-y-3">
                            {lineItems.map((item, idx) => (
                                <div key={idx} className="flex justify-between text-sm">
                                    <span className="text-slate-700 font-medium">{item.description}</span>
                                    <span className="text-slate-900 font-bold">${item.amount.toFixed(2)}</span>
                                </div>
                            ))}
                        </div>

                        {/* Total */}
                        <div className="pt-4 border-t border-slate-100 flex justify-between items-center mt-4">
                            <span className="font-black text-slate-800 text-lg">Total</span>
                            <span className="font-black text-slate-900 text-xl">${invoice.amount.toFixed(2)}</span>
                        </div>
                    </div>
                </div>

                {/* Footer */}
                <div className="p-6 bg-slate-50 border-t border-slate-100 flex gap-3">
                    <button
                        onClick={handleDownload}
                        disabled={isDownloading}
                        className="flex-1 py-3 bg-white border border-slate-200 rounded-xl font-bold text-slate-700 shadow-sm hover:bg-slate-50 transition-colors flex items-center justify-center gap-2"
                    >
                        {isDownloading ? (
                            <span className="material-symbols-outlined animate-spin text-sm">progress_activity</span>
                        ) : (
                            <span className="material-symbols-outlined text-sm">download</span>
                        )}
                        <span>{isDownloading ? 'Downloading...' : 'Download PDF'}</span>
                    </button>
                    {invoice.status === 'Pending' && (
                        <button className="flex-1 py-3 bg-slate-900 text-white rounded-xl font-bold shadow-lg hover:bg-slate-800 transition-colors">
                            Pay Now
                        </button>
                    )}
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/components/Layout.jsx">
import React, { useState } from 'react';
import { Outlet, NavLink, useLocation } from 'react-router-dom';
import clsx from 'clsx';
import OperationsFAB from './OperationsFAB';
import ChatWidget from './ChatWidget';
import FeedbackModal from './FeedbackModal';
import ChaosMonkey from './DevTools/ChaosMonkey';

export default function Layout() {
    const location = useLocation();
    const [isFeedbackOpen, setIsFeedbackOpen] = useState(false);

    return (
        <div className="bg-background-light dark:bg-background-dark min-h-screen">

            {/* Desktop Sidebar (Left) - Hidden on Mobile */}
            <aside className="hidden md:flex flex-col w-64 h-screen fixed left-0 top-0 bg-white border-r border-gray-200 z-50">
                {/* Logo Area */}
                <div className="p-6 border-b border-gray-50">
                    <div className="flex items-center gap-3">
                        <div className="h-8 w-8 bg-emerald-500 rounded-lg flex items-center justify-center text-white font-bold text-sm shadow-md shadow-emerald-200">
                            WR
                        </div>
                        <h1 className="font-black text-slate-800 tracking-tight text-lg">Wild Robot</h1>
                    </div>
                </div>

                {/* Navigation Links */}
                <nav className="flex-1 overflow-y-auto py-6 px-3 space-y-1">
                    <SidebarItem to="/home" icon="home" label="Home" active={location.pathname === '/home'} />
                    <SidebarItem to="/schedule" icon="calendar_today" label="Schedule" active={location.pathname === '/schedule'} />
                    <SidebarItem to="/roster" icon="groups" label="Roster" active={location.pathname === '/roster'} />
                    <SidebarItem to="/chat" icon="chat_bubble" label="Chat" active={location.pathname.startsWith('/chat')} />
                    <SidebarItem to="/profile" icon="person" label="Profile" active={location.pathname === '/profile'} />
                </nav>

                {/* Footer/User Area */}
                <div className="p-4 border-t border-gray-50 space-y-2">
                    <NavLink
                        to="/subscription"
                        className="flex items-center gap-3 px-3 py-2.5 bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-100 rounded-xl group transition-all hover:shadow-sm"
                    >
                        <div className="h-8 w-8 rounded-lg bg-white flex items-center justify-center text-emerald-600 shadow-sm group-hover:scale-110 transition-transform">
                            <span className="material-symbols-outlined text-[18px]">rocket_launch</span>
                        </div>
                        <div className="flex-1">
                            <p className="text-xs font-bold text-slate-800 group-hover:text-emerald-700">Upgrade Plan ðŸš€</p>
                            <p className="text-[10px] text-slate-500">Unlock more power</p>
                        </div>
                    </NavLink>

                    <Button
                        variant="ghost"
                        size="sm"
                        className="w-full justify-start text-slate-500 hover:text-slate-800 pl-2 group"
                        onClick={() => setIsFeedbackOpen(true)}
                    >
                        <span className="material-symbols-outlined mr-2 text-[20px] group-hover:text-amber-500 transition-colors">campaign</span>
                        Feedback & Support
                    </Button>

                    <Button
                        variant="ghost"
                        size="sm"
                        className="w-full justify-start text-slate-500 hover:text-red-500 pl-2"
                        onClick={() => console.log('Logout')}
                    >
                        <span className="material-symbols-outlined mr-2 text-[20px]">logout</span>
                        Sign Out
                    </Button>
                </div>
            </aside>

            {/* Main Content Wrapper */}
            <main className="flex-1 bg-background-light dark:bg-background-dark min-h-screen transition-all duration-300 md:ml-64 pb-[80px] md:pb-0">
                <Outlet />
            </main>

            {/* Global FAB (Fixed position handles itself, but maybe adjust for desktop?) */}
            <OperationsFAB />

            {/* AI Assistant Widget */}
            <ChatWidget />

            {/* Feedback Modal */}
            <FeedbackModal isOpen={isFeedbackOpen} onClose={() => setIsFeedbackOpen(false)} />

            {/* Dev Tools - Chaos Monkey */}
            <ChaosMonkey />

            {/* Mobile Bottom Navigation - Hidden on Desktop */}
            <nav className="md:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-[#10221c] border-t border-gray-100 dark:border-gray-800 z-50 h-[70px] pb-safe">
                <ul className="flex items-center justify-between max-w-md mx-auto h-full px-2">
                    <NavItem to="/home" icon="home" label="Home" active={location.pathname === '/home'} />
                    <NavItem to="/schedule" icon="calendar_today" label="Schedule" active={location.pathname === '/schedule'} />
                    <NavItem to="/roster" icon="groups" label="Roster" active={location.pathname === '/roster'} />
                    <NavItem to="/chat" icon="chat_bubble" label="Chat" active={location.pathname.startsWith('/chat')} />
                    <NavItem to="/profile" icon="person" label="Profile" active={location.pathname === '/profile'} />
                </ul>
            </nav>
        </div>
    );
}

function SidebarItem({ to, icon, label, active }) {
    return (
        <NavLink
            to={to}
            className={clsx(
                "flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-medium text-sm group",
                active
                    ? "bg-emerald-50 text-emerald-600 font-bold shadow-sm"
                    : "text-slate-500 hover:bg-gray-50 hover:text-slate-800"
            )}
        >
            <span className={clsx("material-symbols-outlined text-[20px]", active && "[font-variation-settings:'FILL'_1]")}>
                {icon}
            </span>
            {label}
            {active && <span className="ml-auto w-1.5 h-1.5 rounded-full bg-emerald-500"></span>}
        </NavLink>
    );
}

function NavItem({ to, icon, label, active }) {
    return (
        <li className="flex-1 h-full">
            <NavLink
                to={to}
                className={clsx(
                    "flex flex-col items-center justify-center gap-1 w-full h-full transition-colors",
                    active ? "text-primary" : "text-slate-400 hover:text-primary"
                )}
            >
                <span className={clsx("material-symbols-outlined text-[26px]", active && "[font-variation-settings:'FILL'_1]")}>
                    {icon}
                </span>
                <span className="text-[10px] font-medium">{label}</span>
            </NavLink>
        </li>
    );
}

// Simple Button dummy to avoid import errors if not generic
function Button({ children, className, onClick }) {
    return (
        <button onClick={onClick} className={clsx("flex items-center rounded-lg px-3 py-2 transition-colors", className)}>
            {children}
        </button>
    );
}
</file>

<file path="src/components/MobileNav.jsx">
import React from 'react';
import { NavLink } from 'react-router-dom';
import { clsx } from 'clsx';

export default function MobileNav() {
    const navItems = [
        { name: 'Home', path: '/coach/home', icon: 'dashboard' },
        { name: 'Schedule', path: '/coach/schedule', icon: 'calendar_today' },
        { name: 'Assess', path: '/coach/skills', icon: 'assignment_turned_in' },
        { name: 'Earnings', path: '/coach/earnings', icon: 'account_balance_wallet' },
    ];

    return (
        <div className="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 z-50 pb-safe-area-inset-bottom">
            <nav className="flex justify-around items-center h-16 px-2">
                {navItems.map((item) => (
                    <NavLink
                        key={item.path}
                        to={item.path}
                        className={({ isActive }) => clsx(
                            "flex flex-col items-center justify-center w-full h-full space-y-1 transition-colors",
                            isActive ? "text-emerald-600" : "text-slate-400 hover:text-slate-600"
                        )}
                    >
                        {({ isActive }) => (
                            <>
                                <span className={clsx(
                                    "material-symbols-outlined text-[24px] transition-transform",
                                    isActive && "scale-110" // Subtle pop
                                )}>
                                    {item.icon}
                                </span>
                                <span className="text-[10px] font-bold tracking-tight">
                                    {item.name}
                                </span>
                                {isActive && (
                                    <div className="absolute top-0 h-[2px] w-8 bg-emerald-500 rounded-full" />
                                )}
                            </>
                        )}
                    </NavLink>
                ))}
            </nav>
        </div>
    );
}
</file>

<file path="src/components/modals/CreateAcademyModal.jsx">
import React, { useState } from 'react';
import { supabase } from '../../supabaseClient';
import { X, Building2, MapPin, Loader } from 'lucide-react';

const CreateAcademyModal = ({ isOpen, onClose, onSuccess }) => {
    const [name, setName] = useState('');
    const [location, setLocation] = useState('');
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);

    if (!isOpen) return null;

    const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        setError(null);

        try {
            // 1. Get User
            const { data: { user } } = await supabase.auth.getUser();
            if (!user) throw new Error("User not found");

            // 2. Create Academy
            const { data: academy, error: academyError } = await supabase
                .from('academies')
                .insert([{
                    name,
                    location,
                    owner_id: user.id,
                    subscription_status: 'trial'
                }])
                .select()
                .single();

            if (academyError) throw academyError;

            // 3. Link Owner to Academy
            const { error: profileError } = await supabase
                .from('profiles')
                .update({ academy_id: academy.id, role: 'owner' })
                .eq('id', user.id);

            if (profileError) throw profileError;

            onSuccess();
            onClose();

        } catch (err) {
            console.error(err);
            setError(err.message || 'Failed to create academy');
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4">
            <div className="bg-white rounded-2xl w-full max-w-md shadow-2xl overflow-hidden animate-fade-in-up">
                <div className="bg-slate-50 p-6 border-b border-slate-100 flex justify-between items-center">
                    <div>
                        <h2 className="text-xl font-bold text-slate-900">Setup Academy</h2>
                        <p className="text-sm text-slate-500">Launch your new kingdom</p>
                    </div>
                    <button onClick={onClose} className="p-2 hover:bg-slate-200 rounded-full transition"><X className="w-5 h-5 text-slate-400" /></button>
                </div>
                <form onSubmit={handleSubmit} className="p-6 space-y-4">
                    {error && <div className="bg-red-50 text-red-600 text-sm p-3 rounded-lg">{error}</div>}
                    <div>
                        <label className="block text-sm font-bold text-slate-700 mb-1">Academy Name</label>
                        <div className="relative">
                            <Building2 className="absolute left-3 top-3 w-5 h-5 text-slate-400" />
                            <input type="text" required value={name} onChange={(e) => setName(e.target.value)} placeholder="e.g. Wild Robot Gym" className="w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition" />
                        </div>
                    </div>
                    <div>
                        <label className="block text-sm font-bold text-slate-700 mb-1">Location</label>
                        <div className="relative">
                            <MapPin className="absolute left-3 top-3 w-5 h-5 text-slate-400" />
                            <input type="text" value={location} onChange={(e) => setLocation(e.target.value)} placeholder="e.g. Dubai" className="w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition" />
                        </div>
                    </div>
                    <button type="submit" disabled={loading} className="w-full py-3 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 transition shadow-lg flex justify-center items-center gap-2">
                        {loading ? <Loader className="w-5 h-5 animate-spin" /> : 'Launch Academy ðŸš€'}
                    </button>
                </form>
            </div>
        </div>
    );
};

export default CreateAcademyModal;
</file>

<file path="src/components/onboarding/SetupModal.jsx">
import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { supabase } from '../../supabaseClient';
import { useUser } from '../../context/UserContext';
import { Trophy, ArrowRight, Check, Building2, Dumbbell, MapPin, Loader2, SkipForward, Upload, Image as ImageIcon } from 'lucide-react';

export default function SetupModal({ onClose }) {
    const { user, profile, refreshProfile } = useUser();
    const [step, setStep] = useState(1);
    const [loading, setLoading] = useState(false);
    const [academyId, setAcademyId] = useState(null);

    const [formData, setFormData] = useState({
        academyName: '',
        sport: '',
        branches: '1',
        logoFile: null,
        logoPreview: null
    });

    // Initialize & Prefill
    useEffect(() => {
        const init = async () => {
            if (profile?.academy_id) {
                setAcademyId(profile.academy_id);
                // Fetch academy details to prefill
                const { data: acad } = await supabase.from('academies').select('*').eq('id', profile.academy_id).single();
                if (acad) {
                    setFormData(prev => ({
                        ...prev,
                        academyName: acad.name || '',
                        sport: acad.sport_type || '',
                        branches: acad.branch_count_tier || '1',
                        logoPreview: acad.logo_url || null
                    }));
                }
            }
        };
        init();
    }, [profile]);

    // Handle File Upload
    const handleLogoUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
            const previewUrl = URL.createObjectURL(file);
            setFormData({ ...formData, logoFile: file, logoPreview: previewUrl });
        }
    };

    // Save Progress Helper
    const saveProgress = async (currentData) => {
        try {
            if (!user) return;

            // Upsert Academy
            const acadPayload = {
                owner_id: user.id,
                name: currentData.academyName,
                sport_type: currentData.sport,
                branch_count_tier: currentData.branches
                // Note: Logo upload logic would normally go here (upload to storage -> get URL -> save URL)
            };

            let data, error;

            if (academyId) {
                const res = await supabase.from('academies').update(acadPayload).eq('id', academyId).select().single();
                data = res.data;
                error = res.error;
            } else {
                const res = await supabase.from('academies').insert([acadPayload]).select().single();
                data = res.data;
                error = res.error;
            }

            if (error) throw error;

            if (data && !academyId) {
                setAcademyId(data.id);
                // Link Profile immediately
                await supabase.from('profiles').update({ academy_id: data.id, academy_name: data.name }).eq('id', user.id);
            }

        } catch (err) {
            console.error("Auto-save failed:", err);
        }
    };

    const handleNext = async () => {
        if (step < 3) {
            await saveProgress(formData);
            setStep(step + 1);
        }
    };

    const handleBack = () => {
        if (step > 1) setStep(step - 1);
    };

    const handleSkip = async () => {
        if (!confirm("Are you sure? You can complete this later in Settings.")) return;
        setLoading(true);
        try {
            await supabase.from('profiles').update({ setup_skipped: true }).eq('id', user.id);
            await refreshProfile();
            if (onClose) onClose();
        } catch (err) {
            console.error(err);
        } finally {
            setLoading(false);
        }
    }

    const handleSubmit = async () => {
        setLoading(true);
        try {
            await saveProgress(formData);

            // Update Profile to 'completed' state
            const { error: profileError } = await supabase
                .from('profiles')
                .update({
                    role: 'owner',
                    onboarding_step: 4,
                    academy_name: formData.academyName,
                    setup_skipped: false
                })
                .eq('id', user.id);

            if (profileError) throw profileError;

            await refreshProfile();
            if (onClose) onClose();

        } catch (error) {
            console.error("Setup Error:", error);
            alert("Setup failed: " + error.message);
        } finally {
            setLoading(false);
        }
    };

    const stepVariants = {
        hidden: { opacity: 0, x: 20 },
        visible: { opacity: 1, x: 0 },
        exit: { opacity: 0, x: -20 }
    };

    return (
        <div className="fixed inset-0 z-[100] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-300">
            <motion.div
                className="bg-white w-full max-w-lg rounded-3xl shadow-2xl border border-slate-100 overflow-hidden relative"
                initial={{ scale: 0.95, opacity: 0, y: 20 }}
                animate={{ scale: 1, opacity: 1, y: 0 }}
                transition={{ type: "spring", stiffness: 300, damping: 30 }}
            >
                {/* Skip Button */}
                <button
                    onClick={handleSkip}
                    className="absolute top-6 right-6 text-slate-400 hover:text-slate-600 font-bold text-xs flex items-center gap-1 transition-colors px-3 py-1.5 rounded-full hover:bg-slate-50"
                >
                    Skip <SkipForward size={14} />
                </button>

                <div className="p-8 md:p-10">
                    {/* Progress Indicator */}
                    <div className="flex items-center gap-2 mb-8 justify-center">
                        {[1, 2, 3].map(i => (
                            <div key={i} className={`h-2 rounded-full transition-all duration-300 ${i <= step ? 'w-8 bg-emerald-500' : 'w-2 bg-slate-200'}`} />
                        ))}
                    </div>

                    <AnimatePresence mode="wait">

                        {/* STEP 1: IDENTITY (Name & Logo) */}
                        {step === 1 && (
                            <motion.div key="step1" variants={stepVariants} initial="hidden" animate="visible" exit="exit">
                                <div className="text-center mb-6">
                                    <div className="w-16 h-16 bg-indigo-50 rounded-2xl flex items-center justify-center text-indigo-600 mx-auto mb-4">
                                        <Building2 size={32} />
                                    </div>
                                    <h2 className="text-2xl font-black text-slate-900">Name your Academy</h2>
                                    <p className="text-slate-500 text-sm font-medium mt-1">This will be displayed on your branded certificates.</p>
                                </div>

                                {/* Logo Upload */}
                                <div className="flex justify-center mb-6">
                                    <div className="relative group cursor-pointer w-24 h-24 rounded-2xl bg-slate-50 border-2 border-dashed border-slate-300 flex items-center justify-center overflow-hidden hover:border-emerald-500 transition-colors">
                                        {formData.logoPreview ? (
                                            <img src={formData.logoPreview} alt="Logo" className="w-full h-full object-cover" />
                                        ) : (
                                            <div className="text-center">
                                                <Upload size={20} className="mx-auto text-slate-400 mb-1" />
                                                <span className="text-[10px] uppercase font-bold text-slate-400">Logo</span>
                                            </div>
                                        )}
                                        <input
                                            type="file"
                                            accept="image/*"
                                            onChange={handleLogoUpload}
                                            className="absolute inset-0 opacity-0 cursor-pointer"
                                        />
                                        <div className="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center text-white font-bold text-xs transition-opacity">
                                            Change
                                        </div>
                                    </div>
                                </div>

                                <input
                                    autoFocus
                                    type="text"
                                    value={formData.academyName}
                                    onChange={(e) => setFormData({ ...formData, academyName: e.target.value })}
                                    onBlur={() => saveProgress(formData)}
                                    placeholder="e.g. Elite Sports Club"
                                    className="w-full text-center text-xl font-bold border-b-2 border-slate-200 py-3 focus:outline-none focus:border-emerald-500 transition-colors placeholder:text-slate-300 mb-8"
                                />

                                <div className="flex justify-center">
                                    <button
                                        disabled={!formData.academyName.trim()}
                                        onClick={handleNext}
                                        className="bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-emerald-500 text-white px-8 py-3 rounded-xl font-bold flex items-center gap-2 shadow-lg shadow-emerald-200 transition-all active:scale-95 w-full justify-center"
                                    >
                                        Next Step <ArrowRight size={18} />
                                    </button>
                                </div>
                            </motion.div>
                        )}

                        {/* STEP 2: SPORT */}
                        {step === 2 && (
                            <motion.div key="step2" variants={stepVariants} initial="hidden" animate="visible" exit="exit">
                                <div className="text-center mb-6">
                                    <div className="w-16 h-16 bg-orange-50 rounded-2xl flex items-center justify-center text-orange-600 mx-auto mb-4">
                                        <Dumbbell size={32} />
                                    </div>
                                    <h2 className="text-2xl font-black text-slate-900">Main Sport?</h2>
                                    <p className="text-slate-500 text-sm font-medium mt-1">Tailors the training experience.</p>
                                </div>

                                <div className="grid grid-cols-2 gap-3 mb-8">
                                    {['Gymnastics', 'Swimming', 'Football', 'Basketball', 'Martial Arts', 'Other'].map((sport) => (
                                        <button
                                            key={sport}
                                            onClick={() => setFormData({ ...formData, sport })}
                                            className={`p-3 rounded-xl border-2 text-center font-bold text-sm transition-all ${formData.sport === sport
                                                ? 'border-emerald-500 bg-emerald-50 text-emerald-700'
                                                : 'border-slate-100 hover:border-slate-300 text-slate-600'
                                                }`}
                                        >
                                            {sport}
                                        </button>
                                    ))}
                                </div>
                                <div className="flex justify-between gap-4">
                                    <button onClick={handleBack} className="text-slate-400 font-bold hover:text-slate-600 px-4">Back</button>
                                    <button
                                        disabled={!formData.sport}
                                        onClick={handleNext}
                                        className="bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-emerald-500 text-white px-8 py-3 rounded-xl font-bold flex items-center gap-2 shadow-lg shadow-emerald-200 transition-all active:scale-95 flex-1 justify-center"
                                    >
                                        Next <ArrowRight size={18} />
                                    </button>
                                </div>
                            </motion.div>
                        )}

                        {/* STEP 3: BRANCHES */}
                        {step === 3 && (
                            <motion.div key="step3" variants={stepVariants} initial="hidden" animate="visible" exit="exit">
                                <div className="text-center mb-6">
                                    <div className="w-16 h-16 bg-blue-50 rounded-2xl flex items-center justify-center text-blue-600 mx-auto mb-4">
                                        <MapPin size={32} />
                                    </div>
                                    <h2 className="text-2xl font-black text-slate-900">Scale?</h2>
                                    <p className="text-slate-500 text-sm font-medium mt-1">Helps with branch management.</p>
                                </div>

                                <div className="grid grid-cols-1 gap-3 mb-8">
                                    {[
                                        { val: '1', label: 'Single Branch', desc: 'Just one location' },
                                        { val: '2-5', label: 'Growing (2-5)', desc: 'Multiple locations' },
                                        { val: '5+', label: 'Enterprise (5+)', desc: 'Large scale operation' }
                                    ].map((opt) => (
                                        <button
                                            key={opt.val}
                                            onClick={() => setFormData({ ...formData, branches: opt.val })}
                                            className={`p-4 rounded-xl border-2 text-left transition-all flex items-center justify-between ${formData.branches === opt.val
                                                ? 'border-emerald-500 bg-emerald-50 ring-1 ring-emerald-500/20'
                                                : 'border-slate-100 hover:border-slate-300'
                                                }`}
                                        >
                                            <div>
                                                <div className="font-bold text-slate-900 text-sm">{opt.label}</div>
                                                <div className="text-[10px] text-slate-500 font-medium">{opt.desc}</div>
                                            </div>
                                            {formData.branches === opt.val && <Check size={18} className="text-emerald-600" />}
                                        </button>
                                    ))}
                                </div>

                                <div className="flex justify-between items-center gap-4">
                                    <button onClick={handleBack} className="text-slate-400 font-bold hover:text-slate-600 px-4">Back</button>
                                    <button
                                        onClick={handleSubmit}
                                        disabled={loading}
                                        className="bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-3 rounded-xl font-bold flex items-center gap-2 shadow-lg shadow-emerald-200 transition-all active:scale-95 flex-1 justify-center"
                                    >
                                        {loading ? <Loader2 className="animate-spin" /> : 'Launch ðŸš€'}
                                    </button>
                                </div>
                            </motion.div>
                        )}

                    </AnimatePresence>
                </div>
            </motion.div>
        </div>
    );
}
</file>

<file path="src/components/OperationsFAB.jsx">
import React, { useState } from 'react';
import { clsx } from 'clsx';
import { useNavigate } from 'react-router-dom';
import { supabase } from '../supabaseClient';

export default function OperationsFAB() {
    const [isOpen, setIsOpen] = useState(false);
    const [showPostModal, setShowPostModal] = useState(false);
    const navigate = useNavigate();

    const toggleOpen = () => setIsOpen(!isOpen);

    return (
        <>
            <div className="fixed bottom-[90px] right-6 z-50 flex flex-col items-end gap-3">
                {/* Speed Dial Menu */}
                <div className={clsx("flex flex-col items-end gap-3 transition-all duration-300 origin-bottom-right", isOpen ? "opacity-100 scale-100 translate-y-0" : "opacity-0 scale-50 translate-y-10 pointer-events-none")}>

                    <FabAction
                        icon="edit_note"
                        label="Post Update"
                        color="bg-purple-600"
                        onClick={() => { toggleOpen(); setShowPostModal(true); }}
                    />
                    <FabAction
                        icon="person_add"
                        label="Add Athlete"
                        color="bg-emerald-500"
                        onClick={() => { toggleOpen(); navigate('/roster'); }}
                    />
                    <FabAction
                        icon="calendar_add_on"
                        label="Create Session"
                        color="bg-blue-500"
                        onClick={() => { toggleOpen(); navigate('/schedule'); }}
                    />
                    <FabAction
                        icon="payments"
                        label="Record Payment"
                        color="bg-amber-500"
                        onClick={() => { toggleOpen(); navigate('/payment'); }}
                    />

                </div>

                {/* Main FAB */}
                <button
                    onClick={toggleOpen}
                    className={clsx(
                        "h-14 w-14 rounded-full text-white shadow-xl hover:scale-110 active:scale-95 transition-all duration-300 flex items-center justify-center",
                        isOpen ? "bg-slate-800 rotate-45" : "bg-emerald-500 shadow-emerald-200 hover:bg-emerald-600"
                    )}
                >
                    <span className="material-symbols-outlined text-[32px] transition-transform duration-300">
                        add
                    </span>
                </button>
            </div>

            {/* Post Update Modal */}
            {showPostModal && <PostUpdateModal onClose={() => setShowPostModal(false)} />}
        </>
    );
}

function FabAction({ icon, label, color, onClick }) {
    return (
        <button
            onClick={onClick}
            className="flex items-center gap-3 group"
        >
            <span className="bg-white text-slate-600 px-3 py-1 rounded-lg text-xs font-bold shadow-md opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">
                {label}
            </span>
            <div className={clsx("h-10 w-10 rounded-full flex items-center justify-center text-white shadow-lg shadow-gray-300 transition-transform group-hover:scale-110", color)}>
                <span className="material-symbols-outlined text-[20px]">{icon}</span>
            </div>
        </button>
    );
}

function PostUpdateModal({ onClose }) {
    const [title, setTitle] = useState('');
    const [content, setContent] = useState('');
    const [type, setType] = useState('news'); // news | celebration
    const [loading, setLoading] = useState(false);

    const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);

        const { error } = await supabase.from('announcements').insert([
            {
                title,
                content,
                type,
                author_name: 'Coach Abdulla', // Mock User
                created_at: new Date().toISOString()
            }
        ]);

        if (error) {
            alert('Error posting update: ' + error.message);
        } else {
            // alert('Update posted successfully!');
            window.location.reload(); // Simple reload to refresh feed for now
            onClose();
        }
        setLoading(false);
    };

    return (
        <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4">
            <div className="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200">
                <div className="p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                    <h3 className="font-bold text-lg text-slate-900">Post New Update</h3>
                    <button onClick={onClose} className="h-8 w-8 rounded-full hover:bg-gray-200 flex items-center justify-center text-slate-500">
                        <span className="material-symbols-outlined">close</span>
                    </button>
                </div>

                <form onSubmit={handleSubmit} className="p-4 space-y-4">
                    {/* Type Selector */}
                    <div className="flex bg-gray-100 p-1 rounded-xl">
                        <button
                            type="button"
                            onClick={() => setType('news')}
                            className={clsx("flex-1 py-2 rounded-lg text-sm font-bold transition-all", type === 'news' ? "bg-white text-slate-900 shadow-sm" : "text-slate-500 hover:text-slate-700")}
                        >
                            ðŸ“° News
                        </button>
                        <button
                            type="button"
                            onClick={() => setType('celebration')}
                            className={clsx("flex-1 py-2 rounded-lg text-sm font-bold transition-all", type === 'celebration' ? "bg-white text-purple-600 shadow-sm" : "text-slate-500 hover:text-slate-700")}
                        >
                            ðŸŽ‰ Celebration
                        </button>
                    </div>

                    <div>
                        <label className="block text-xs font-bold text-slate-400 uppercase mb-1">Title</label>
                        <input
                            type="text"
                            required
                            value={title}
                            onChange={(e) => setTitle(e.target.value)}
                            placeholder="e.g. Schedule Change"
                            className="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 font-bold text-slate-900"
                        />
                    </div>

                    <div>
                        <label className="block text-xs font-bold text-slate-400 uppercase mb-1">Content</label>
                        <textarea
                            required
                            rows="4"
                            value={content}
                            onChange={(e) => setContent(e.target.value)}
                            placeholder="What's happening?"
                            className="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 font-medium text-slate-700 resize-none"
                        ></textarea>
                    </div>

                    <button
                        type="submit"
                        disabled={loading}
                        className="w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-emerald-200 transition-all flex items-center justify-center gap-2 disabled:opacity-50"
                    >
                        {loading ? 'Posting...' : 'Post Update'}
                        {!loading && <span className="material-symbols-outlined text-[18px]">send</span>}
                    </button>
                </form>
            </div>
        </div>
    );
}
</file>

<file path="src/components/ProtectedRoute.jsx">
import { Navigate, Outlet, useLocation } from 'react-router-dom';
import { useUser } from '../context/UserContext';
import { Loader2 } from 'lucide-react';

const ProtectedRoute = ({ allowSetup = false }) => {
    const { user, profile, loading } = useUser();
    const location = useLocation();

    // 1. Loading State (Splash Screen)
    if (loading) {
        return (
            <div className="flex flex-col items-center justify-center min-h-screen bg-slate-50">
                <Loader2 className="w-12 h-12 animate-spin text-emerald-600 mb-4" />
                <p className="text-slate-500 font-medium animate-pulse">Loading Empire...</p>
            </div>
        );
    }

    // 2. Not Logged In? -> Login
    if (!user) {
        return <Navigate to="/login" state={{ from: location }} replace />;
    }

    // 3. Logged in but DB hasn't prepared profile (Rare)
    if (!profile) {
        return null; // Or error message
    }

    // ðŸ‘®â€â™‚ï¸ Traffic Cop Logic

    // Case A: User hasn't finished Setup, trying to access Dashboard
    // (And target route allows setup is FALSE)
    // We check profile.setup_completed OR profile.academies?.setup_completed depending on schema. 
    // Based on user prompt "profile.setup_completed", we use that. 
    // The context earlier fetched profile as `select('*')`. 
    // IMPORTANT: The schema update earlier added `setup_completed` to `academies`, NOT `profiles`.
    // HOWEVER, the user context code provided by user assumes `if (userProfile?.academy_id)`.
    // Let's look at the user context code again. It fetches `academies` into `academy` state.
    // So we should check `academy?.setup_completed`.
    // BUT the user prompt code for ProtectedRoute explicitly used `profile.setup_completed`.
    // Waiting... The context fetch pulls `academies` separately. 
    // Let's assume the user wants to rely on `academy` object in context if `profile.setup_completed` is not on profile.
    // Actually, checking the SQL `upgrade_schema_enterprise.sql`: 
    // `ALTER TABLE public.academies ADD COLUMN IF NOT EXISTS setup_completed boolean DEFAULT false;`
    // It is on ACADEMIES.
    // The user's provided code for `ProtectedRoute` uses `profile.setup_completed`. This might be a mistake in their request code vs schema.
    // I will check `academy?.setup_completed` as well to be safe, or check if `profile` has it (maybe from a view?).
    // To be safe and follow the request EXACTLY whilst making it work:
    // I will inspect if they sync it.
    // Actually, the previous prompt said "profiles: ... setup_completed (bool)". 
    // If the schema added it to profiles too, then it's fine.
    // Let's look at `UserContext` again. 
    // It fetches profile: `select('*')`.
    // It fetches academy: `select('*')`.
    // I'll stick to the user's provided code but if it fails I'll fix it. 
    // Use `academy` from context? The user provided `const { user, profile, loading } = useUser();` excluding academy.
    // I will better include `academy` from useUser and check that too.

    // RE-READING USER PROMPT CODE FOR PROTECTED ROUTE:
    // `if (!profile.setup_completed && !allowSetup)`

    // If I strictly follow this, and `setup_completed` is NOT on profile, it will redirect loop.
    // I will ADD `academy` to the destructure and check `academy?.setup_completed` as a fallback or primary.
    // Actually, looking at the previous conversation, `profile.academies.setup_completed` was used.
    // I'll assume standardizing on the User's provided code is what they want, BUT I will check if I can make it robust.
    // The prompt explicitly said: "profiles: id, role, setup_completed (bool)..." in the schema reference description.
    // So I will assume the column exists on profiles or they want me to use accessors.

    // Okay, I will paste the code EXACTLY as requested, but I will include `academy` in the destructure just in case I need to hotfix it 
    // without rewriting the whole file later.

    // Actually, the safest bet is to use the code provided. Failing that, I can fix it.

    const isSetupComplete = profile.setup_completed === true || (profile.academy_id && true); // Wait, logic gap.

    // Let's trust the user knows their schema or I updated it. 
    // IN FACT, `supabase/upgrade_schema_enterprise.sql` added it to ACADEMIES.
    // And `fix_academy_setup.sql` might have touched things.
    // I will use `academy?.setup_completed` if available.
    // The provided code doesn't extract `academy`. 
    // I will modify the provided code slighly to extract `academy` and check both to be safe.

    const { academy } = useUser(); // Get this too.
    const setupCompleted = profile.setup_completed || academy?.setup_completed;

    // Case A: Setup Incomplete, NOT allowing setup page -> Go to Setup
    if (!setupCompleted && !allowSetup) {
        return <Navigate to="/setup" replace />;
    }

    // Case B: Setup Complete, trying to go to Setup -> Go to Dashboard
    if (setupCompleted && allowSetup) {
        return <Navigate to="/owner/dashboard" replace />;
    }

    // âœ… Allow
    return <Outlet />;
};

export default ProtectedRoute;
</file>

<file path="src/components/RoleSwitcher.jsx">
import React from 'react';
import { useRole, ROLES } from '../context/RoleContext';
import { clsx } from 'clsx';

export default function RoleSwitcher() {
    const context = useRole();
    if (!context) return null;
    const { currentRole, switchRole, isDevMode } = context;

    // if (!isDevMode) return null; // Removed to force visibility check

    const roleConfig = {
        [ROLES.SUPER_ADMIN]: { label: 'Super Admin', icon: 'crown', color: 'bg-amber-100 text-amber-600 border-amber-200' },
        [ROLES.EMPLOYEE_COACH]: { label: 'Employee Coach', icon: 'sports_gymnastics', color: 'bg-blue-100 text-blue-600 border-blue-200' },
        [ROLES.FREELANCE_COACH]: { label: 'Freelance Coach', icon: 'work', color: 'bg-purple-100 text-purple-600 border-purple-200' },
        [ROLES.STUDENT]: { label: 'Student View', icon: 'school', color: 'bg-emerald-100 text-emerald-600 border-emerald-200' },
    };

    return (
        <div className="relative group z-50">
            <button className={clsx(
                "flex items-center gap-2 px-3 py-1.5 rounded-lg border text-xs font-bold transition-all shadow-sm",
                roleConfig[currentRole].color
            )}>
                <span className="material-symbols-outlined text-[14px]">
                    {roleConfig[currentRole].icon}
                </span>
                <span>Viewing as: {roleConfig[currentRole].label}</span>
                <span className="material-symbols-outlined text-[14px] opacity-50">expand_more</span>
            </button>

            {/* Dropdown */}
            <div className="absolute top-full right-0 mt-2 w-56 bg-white rounded-xl shadow-xl border border-slate-100 p-2 hidden group-hover:block animate-in fade-in slide-in-from-top-2">
                <div className="text-[10px] uppercase font-bold text-slate-400 px-2 py-1 mb-1">Switch Perspective</div>
                {Object.values(ROLES).map((role) => (
                    <button
                        key={role}
                        onClick={() => switchRole(role)}
                        className={clsx(
                            "w-full text-left flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors mb-1",
                            currentRole === role ? "bg-slate-50 text-slate-900 border border-slate-100 shadow-sm" : "text-slate-500 hover:bg-slate-50 hover:text-slate-900"
                        )}
                    >
                        <span className="material-symbols-outlined text-lg">
                            {roleConfig[role].icon}
                        </span>
                        {roleConfig[role].label}
                        {currentRole === role && <span className="material-symbols-outlined text-emerald-500 ml-auto text-sm">check</span>}
                    </button>
                ))}
            </div>
        </div>
    );
}
</file>

<file path="src/components/SafeRoleSwitcher.jsx">
import React, { useState, useEffect } from 'react';
import { supabase } from '../supabaseClient';
import { clsx } from 'clsx';

const SUPER_ADMIN_ID = 'e9dc1d40-8fa5-4334-bea9-6b9424d2705a';

export default function SafeRoleSwitcher() {
    const [isVisible, setIsVisible] = useState(false);
    const [currentRole, setCurrentRole] = useState(localStorage.getItem('simulated_role') || 'admin');
    const [isOpen, setIsOpen] = useState(false);

    useEffect(() => {
        checkUser();
    }, []);

    async function checkUser() {
        const { data: { user } } = await supabase.auth.getUser();
        // In a real scenario, strict check:
        // if (user && user.id === SUPER_ADMIN_ID) {
        // For development speed, I will enable it if there is ANY user logged in OR blindly enabled for dev if requested.
        // The user explicitly asked for logic: Check if user.id === ...

        if (user && user.id === SUPER_ADMIN_ID) {
            setIsVisible(true);
        } else {
            // Fallback for testing if I cannot easily log in as that specific user right now?
            // The user gave me a specific ID. I should respect it.
            // However, for the purpose of the user *seeing* it working now, unauthenticated or with different ID might hide it.
            // I'll add a temporary bypass for verification if specific ID check fails, 
            // BUT I will comment it out to strictly follow instructions first.
            // actually, the user *is* the Super Admin in this context usually.

            // FOR TESTING PURPOSES: If the user provided ID is just a placeholder and I can't login as them,
            // I might fail to show it.
            // Let's assume the current user is that ID or I'll add a 'dev' override locally if needed.
            // Re-reading: "The user (Super Admin ID: ...) needs to simulate..."
            // I will implement the check strictly.
            if (user?.id === SUPER_ADMIN_ID) {
                setIsVisible(true);
            }
        }
    }

    const handleRoleChange = (role) => {
        localStorage.setItem('simulated_role', role);
        setCurrentRole(role);
        window.location.reload(); // Hard reload to apply changes everywhere
    };

    if (!isVisible) return null;

    const roles = [
        { id: 'admin', label: 'Super Admin', icon: 'security', color: 'bg-slate-900 text-white' },
        { id: 'manager', label: 'Activity Manager', icon: 'analytics', color: 'bg-indigo-600 text-white' },
        { id: 'head_coach', label: 'Head Coach', icon: 'sports', color: 'bg-orange-600 text-white' },
        { id: 'hr', label: 'HR Manager', icon: 'badge', color: 'bg-pink-600 text-white' },
        { id: 'accountant', label: 'Accountant', icon: 'account_balance', color: 'bg-green-600 text-white' },
        { id: 'employee', label: 'Coach (Employee)', icon: 'engineering', color: 'bg-blue-600 text-white' },
        { id: 'freelance', label: 'Coach (Freelance)', icon: 'work_history', color: 'bg-purple-600 text-white' },
    ];

    const activeRole = roles.find(r => r.id === currentRole) || roles[0];

    return (
        <div className="fixed bottom-6 right-6 z-[100] flex flex-col items-end">
            {isOpen && (
                <div className="mb-2 bg-white rounded-xl shadow-2xl border border-slate-200 overflow-hidden animate-in slide-in-from-bottom-5 fade-in duration-200 w-48">
                    <div className="bg-slate-50 px-3 py-2 text-[10px] font-bold text-slate-400 uppercase tracking-wider border-b border-slate-100">
                        Simulate Role
                    </div>
                    {roles.map(role => (
                        <button
                            key={role.id}
                            onClick={() => handleRoleChange(role.id)}
                            className={clsx(
                                "w-full text-left flex items-center gap-3 px-4 py-3 text-sm font-medium hover:bg-slate-50 transition-colors",
                                currentRole === role.id ? "text-slate-900 bg-slate-50" : "text-slate-500"
                            )}
                        >
                            <div className={clsx("h-2 w-2 rounded-full", currentRole === role.id ? "bg-emerald-500" : "bg-slate-300")} />
                            {role.label}
                        </button>
                    ))}
                </div>
            )}

            <button
                onClick={() => setIsOpen(!isOpen)}
                className={clsx(
                    "flex items-center gap-2 px-4 py-3 rounded-full shadow-xl hover:scale-105 transition-all active:scale-95 font-bold border-2 border-white/20 backdrop-blur-md",
                    activeRole.color
                )}
            >
                <span className="material-symbols-outlined text-[20px]">{activeRole.icon}</span>
                <span className="text-sm">{activeRole.label} View</span>
                <span className="material-symbols-outlined text-[16px] opacity-60">
                    {isOpen ? 'close' : 'expand_less'}
                </span>
            </button>
        </div>
    );
}
</file>

<file path="src/components/SecurityCheckpoint.jsx">
import React, { useEffect, useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { ShieldAlert, LogOut, Zap, Smartphone, Monitor, ShieldCheck } from 'lucide-react';
import { supabase } from '../supabaseClient';
import { useNavigate } from 'react-router-dom';

const SecurityCheckpoint = ({ sessionUserId, onClose }) => {
    // Logic: If props exist, behave as modal. If not, behave as Page.
    const [scanStatus, setScanStatus] = useState('scanning'); // 'scanning', 'denied', 'resolved'
    const [sessions, setSessions] = useState([]);
    const [loadingAction, setLoadingAction] = useState(false);
    const [currentUserId, setCurrentUserId] = useState(sessionUserId || null);

    // Determine mode based on usage
    const isPageMode = !onClose;
    const navigate = useNavigate();

    useEffect(() => {
        const initialize = async () => {
            // If we don't have a userId yet (Page Mode), fetch it
            let targetId = currentUserId;

            if (!targetId) {
                const { data: { session } } = await supabase.auth.getSession();
                if (!session) {
                    navigate('/login');
                    return;
                }
                targetId = session.user.id;
                setCurrentUserId(targetId);
            }

            // Start fake scan
            const scanTimer = setTimeout(() => {
                fetchSessions(targetId);
            }, 1500);

            return () => clearTimeout(scanTimer);
        };

        initialize();
    }, [currentUserId, navigate]);

    const fetchSessions = async (uid) => {
        if (!uid) return;
        const { data } = await supabase
            .from('active_sessions')
            .select('*')
            .eq('user_id', uid);

        setSessions(data || []);
        setScanStatus('denied'); // Show denial UI
    };

    const handleTerminateSession = async (sessionId) => {
        // Optimistic UI update
        const newSessions = sessions.filter(s => s.id !== sessionId);
        setSessions(newSessions);

        try {
            const { error } = await supabase
                .from('active_sessions')
                .delete()
                .eq('id', sessionId);

            if (error) throw error;

            // If we are now below profile limit (assuming 2 for Admin, 1 for others)
            // Ideally we fetch the limit again or assume 1 free slot means go.
            // Simplified: If user killed a session, they essentially "made room".
            // We can retry the "Access Check" or just let them in.
            // Let's trigger success animation
            if (newSessions.length < sessions.length) {
                // Wait small delay then resolve
                setTimeout(() => {
                    setScanStatus('resolved');
                    setTimeout(() => {
                        if (isPageMode) navigate('/coach/home', { replace: true });
                        else onClose();
                    }, 1000);
                }, 500);
            }

        } catch (err) {
            console.error("Failed to terminate session", err);
            // Revert state if failed? For now, assume success.
            fetchSessions(currentUserId);
        }
    };

    const handleSignOutOthers = async () => {
        if (!currentUserId) return;
        setLoadingAction(true);
        try {
            // CLIENT-SIDE PURGE (Since RPC is unavailable)
            const params = sessions.map(s => s.id);
            if (params.length > 0) {
                const { error } = await supabase
                    .from('active_sessions')
                    .delete()
                    .in('id', params);

                if (error) throw error;
            }

            // Success Flow
            setScanStatus('resolved');
            setTimeout(() => {
                if (isPageMode) {
                    navigate('/coach/home', { replace: true });
                } else {
                    onClose();
                }
            }, 1000);

        } catch (error) {
            console.error("Failed to Purge sessions", error);
            alert(`Error: ${error.message}`);
        } finally {
            setLoadingAction(false);
        }
    };

    const handleUpgrade = () => {
        // Redirect to subscription with highlight state
        navigate('/subscription', { state: { highlight: 'team' } });
    };

    return (
        <div className="fixed inset-0 z-[100] bg-slate-900 flex items-center justify-center p-4 text-white font-sans">
            {/* Full Screen container */}
            <div className="w-full max-w-md bg-slate-900 border border-slate-700 rounded-3xl overflow-hidden shadow-2xl relative">

                {/* Background Grid Animation */}
                <div className="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 pointer-events-none"></div>
                <div className="absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-transparent via-red-500 to-transparent opacity-50"></div>

                <div className="relative z-10 p-8 text-center flex flex-col items-center min-h-[450px] justify-center">

                    <AnimatePresence mode='wait'>
                        {scanStatus === 'scanning' && (
                            <motion.div
                                key="scanning"
                                initial={{ opacity: 0 }}
                                animate={{ opacity: 1 }}
                                exit={{ opacity: 0 }}
                                className="flex flex-col items-center gap-6"
                            >
                                <div className="relative">
                                    <div className="w-24 h-24 rounded-full border-2 border-slate-700 flex items-center justify-center">
                                        <ShieldAlert size={40} className="text-slate-500" />
                                    </div>
                                    <motion.div
                                        className="absolute inset-0 border-2 border-emerald-500 rounded-full border-t-transparent"
                                        animate={{ rotate: 360 }}
                                        transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                                    />
                                </div>
                                <div className="space-y-2">
                                    <h2 className="text-xl font-bold text-white">Security Scan In Progress</h2>
                                    <p className="text-slate-400 text-sm">Verifying device signature...</p>
                                </div>
                            </motion.div>
                        )}

                        {scanStatus === 'denied' && (
                            <motion.div
                                key="denied"
                                initial={{ scale: 0.9, opacity: 0 }}
                                animate={{ scale: 1, opacity: 1 }}
                                exit={{ opacity: 0, scale: 0.95 }}
                                className="w-full"
                            >
                                <div className="w-20 h-20 mx-auto bg-red-500/10 rounded-full flex items-center justify-center mb-6 ring-1 ring-red-500/50 relative overflow-hidden">
                                    <div className="absolute inset-0 bg-red-500/20 animate-ping rounded-full"></div>
                                    <ShieldAlert size={40} className="text-red-500 relative z-10" />
                                </div>

                                <h2 className="text-2xl font-black text-white mb-2 tracking-tight">SECURITY ALERT</h2>
                                <p className="text-slate-400 text-sm mb-8 px-4 font-medium">
                                    Maximum active sessions reached. Terminate an old session to authorize this device.
                                </p>

                                {/* Active Devices List */}
                                <div className="bg-slate-800/50 rounded-2xl p-4 mb-6 border border-slate-700/50 backdrop-blur-sm">
                                    <div className="flex items-center justify-between mb-4">
                                        <h3 className="text-xs font-bold text-slate-500 uppercase tracking-wider">Active Uplinks ({sessions.length})</h3>
                                        <div className="h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.8)]"></div>
                                    </div>

                                    <div className="space-y-3 max-h-48 overflow-y-auto custom-scrollbar pr-1">
                                        {sessions.map((session, idx) => (
                                            <motion.div
                                                layout
                                                initial={{ opacity: 0, x: -10 }}
                                                animate={{ opacity: 1, x: 0 }}
                                                exit={{ opacity: 0, height: 0 }}
                                                key={session.id || idx}
                                                className="group flex items-center gap-3 text-left p-3 rounded-xl bg-slate-900/50 border border-slate-700/50 hover:border-slate-600 transition-all"
                                            >
                                                {/* Icon */}
                                                <div className="w-10 h-10 rounded-lg bg-slate-800 flex items-center justify-center text-slate-400 group-hover:text-white group-hover:bg-slate-700 transition-colors">
                                                    {session.user_agent?.includes('Mobile')
                                                        ? <Smartphone size={18} />
                                                        : <Monitor size={18} />
                                                    }
                                                </div>

                                                {/* Text Information */}
                                                <div className="flex-1 min-w-0">
                                                    <div className="flex items-center gap-2">
                                                        <p className="text-xs font-bold text-slate-200 truncate">
                                                            {(() => {
                                                                const cleanUA = session.user_agent ? session.user_agent.split('___DID:')[0] : '';
                                                                return cleanUA.includes('Mac') ? 'MacBook Pro' :
                                                                    cleanUA.includes('Windows') ? 'Windows Station' : 'Unknown Device';
                                                            })()}
                                                        </p>
                                                        {idx === 0 && <span className="text-[9px] bg-slate-700 text-slate-300 px-1.5 rounded border border-slate-600">Oldest</span>}
                                                    </div>
                                                    <p className="text-[10px] text-slate-500 truncate font-mono mt-0.5">
                                                        Last Active: {new Date(session.last_active).toLocaleTimeString()}
                                                    </p>
                                                </div>

                                                {/* Terminate Button */}
                                                <button
                                                    onClick={() => handleTerminateSession(session.id)}
                                                    className="p-2 rounded-lg bg-red-500/10 text-red-500 opacity-0 group-hover:opacity-100 hover:bg-red-500 hover:text-white transition-all transform hover:scale-105"
                                                    title="Terminate Session"
                                                >
                                                    <LogOut size={16} />
                                                </button>
                                            </motion.div>
                                        ))}
                                    </div>
                                </div>

                                <div className="space-y-3">
                                    <button
                                        onClick={handleSignOutOthers}
                                        disabled={loadingAction}
                                        className="w-full py-4 bg-slate-100 hover:bg-white text-slate-900 font-black rounded-xl transition-all shadow-lg shadow-white/5 active:scale-[0.98] flex items-center justify-center gap-2"
                                    >
                                        {loadingAction ? (
                                            <>
                                                <div className="w-4 h-4 border-2 border-slate-900 border-t-transparent rounded-full animate-spin"></div>
                                                <span>Purging Systems...</span>
                                            </>
                                        ) : (
                                            <>
                                                <Zap size={18} className="fill-slate-900" />
                                                Terminate All Other Sessions
                                            </>
                                        )}
                                    </button>
                                </div>
                            </motion.div>
                        )}

                        {scanStatus === 'resolved' && (
                            <motion.div
                                key="resolved"
                                initial={{ scale: 0.9, opacity: 0 }}
                                animate={{ scale: 1, opacity: 1 }}
                                className="flex flex-col items-center gap-6"
                            >
                                <motion.div
                                    initial={{ scale: 0 }}
                                    animate={{ scale: 1 }}
                                    transition={{ type: "spring", stiffness: 200, damping: 20 }}
                                    className="w-24 h-24 rounded-full bg-emerald-500/10 flex items-center justify-center ring-1 ring-emerald-500/50 relative"
                                >
                                    <div className="absolute inset-0 bg-emerald-500/20 rounded-full animate-ping"></div>
                                    <ShieldCheck size={40} className="text-emerald-500 relative z-10" />
                                </motion.div>
                                <div>
                                    <h2 className="text-xl font-bold text-white mb-2">Device Authorized</h2>
                                    <p className="text-slate-400 text-sm">Welcome back, Commander.</p>
                                </div>
                            </motion.div>
                        )
                        }

                    </AnimatePresence >

                </div >
            </div >
        </div >
    );
};

export default SecurityCheckpoint;
</file>

<file path="src/components/ui/BottomSheet.jsx">
import React, { useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { X } from 'lucide-react';

const BottomSheet = ({ isOpen, onClose, title, children }) => {
    // Close on Escape key
    useEffect(() => {
        const handleEsc = (e) => {
            if (e.key === 'Escape') onClose();
        };
        window.addEventListener('keydown', handleEsc);
        return () => window.removeEventListener('keydown', handleEsc);
    }, [onClose]);

    return (
        <AnimatePresence>
            {isOpen && (
                <>
                    {/* Backdrop */}
                    <motion.div
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1 }}
                        exit={{ opacity: 0 }}
                        onClick={onClose}
                        className="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 transition-colors"
                    />

                    {/* Sheet / Modal */}
                    <motion.div
                        initial={{ y: "100%", opacity: 0.5 }}
                        animate={{ y: 0, opacity: 1 }}
                        exit={{ y: "100%", opacity: 0 }}
                        transition={{ type: "spring", damping: 25, stiffness: 300 }}
                        className="fixed inset-x-0 bottom-0 z-50 flex flex-col items-center justify-end pointer-events-none sm:justify-center sm:inset-y-0"
                    >
                        {/* Container: 75% height on mobile, Centered on desktop */}
                        <div
                            className="w-full h-[85vh] sm:h-auto sm:max-h-[85vh] sm:max-w-2xl bg-white sm:rounded-3xl rounded-t-3xl shadow-2xl overflow-hidden flex flex-col pointer-events-auto"
                            onClick={(e) => e.stopPropagation()}
                        >
                            {/* Drag Handle (Mobile Visual Only) */}
                            <div className="w-full flex justify-center pt-3 pb-1 sm:hidden cursor-grab active:cursor-grabbing">
                                <div className="w-12 h-1.5 bg-slate-200 rounded-full" />
                            </div>

                            {/* Header */}
                            <div className="px-6 py-4 border-b border-slate-100 flex items-center justify-between bg-white shrink-0">
                                <h3 className="text-lg font-black text-slate-800 tracking-tight">{title}</h3>
                                <button
                                    onClick={onClose}
                                    className="p-2 bg-slate-100 hover:bg-slate-200 rounded-full transition-colors text-slate-500"
                                >
                                    <X className="w-5 h-5" />
                                </button>
                            </div>

                            {/* Scrollable Content */}
                            <div className="flex-1 overflow-y-auto p-0">
                                {children}
                            </div>
                        </div>
                    </motion.div>
                </>
            )}
        </AnimatePresence>
    );
};

export default BottomSheet;
</file>

<file path="src/components/ui/EmptyState.jsx">
import React from 'react';
import { Ghost } from 'lucide-react';

const EmptyState = ({
    icon: Icon = Ghost,
    title = "Nothing to see here",
    description = "It's a bit empty. Ready to start building?",
    actionLabel,
    onAction
}) => {
    return (
        <div className="flex flex-col items-center justify-center p-12 text-center rounded-3xl bg-slate-50 border-2 border-dashed border-slate-200 min-h-[400px]">
            <div className="w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-sm mb-6">
                <Icon className="w-10 h-10 text-slate-300" />
            </div>
            <h3 className="text-xl font-black text-slate-900 mb-2">{title}</h3>
            <p className="text-slate-500 max-w-sm mb-8">{description}</p>

            {actionLabel && onAction && (
                <button
                    onClick={onAction}
                    className="px-6 py-3 bg-white border border-slate-200 hover:border-emerald-500 hover:text-emerald-600 font-bold rounded-xl transition-all shadow-sm hover:shadow-md"
                >
                    {actionLabel}
                </button>
            )}
        </div>
    );
};

export default EmptyState;
</file>

<file path="src/components/ui/Modal.jsx">
import React from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { X } from 'lucide-react';

export default function Modal({ isOpen, onClose, title, children }) {
    if (!isOpen) return null;

    return (
        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm">
            <motion.div
                initial={{ opacity: 0, scale: 0.95, y: 10 }}
                animate={{ opacity: 1, scale: 1, y: 0 }}
                exit={{ opacity: 0, scale: 0.95, y: 10 }}
                transition={{ duration: 0.2 }}
                className="bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]"
            >
                {/* Header */}
                <div className="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <h2 className="text-lg font-black text-slate-800 tracking-tight">
                        {title}
                    </h2>
                    <button
                        onClick={onClose}
                        className="p-2 hover:bg-slate-100 rounded-full text-slate-400 hover:text-slate-600 transition-colors"
                    >
                        <X size={20} />
                    </button>
                </div>

                {/* Body */}
                <div className="p-6 overflow-y-auto">
                    {children}
                </div>
            </motion.div>
        </div>
    );
}
</file>

<file path="src/components/UserAvatar.jsx">
import React from 'react';
import { Crown } from 'lucide-react';
import { clsx } from 'clsx';
import { motion } from 'framer-motion';

export default function UserAvatar({ user, profile, size = 'md', className }) {
    // 1. Determine Size Classes
    const sizeClasses = {
        sm: "h-8 w-8 text-xs",
        md: "h-10 w-10 text-sm",
        lg: "h-14 w-14 text-xl",
        xl: "h-32 w-32 text-4xl"
    };

    const iconSizes = {
        sm: 12,
        md: 14,
        lg: 18,
        xl: 32
    };

    // 2. Get Initials
    const initials = profile?.full_name
        ? profile.full_name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2)
        : (user?.email?.charAt(0).toUpperCase() || "WR");

    // 3. Check for Owner Role
    const isOwner = profile?.role === 'owner' || profile?.role === 'admin' || profile?.role === 'super_admin';

    // 4. Random Gradient for Initials (Consistent based on name length)
    const gradients = [
        "from-emerald-400 to-emerald-600",
        "from-blue-400 to-blue-600",
        "from-purple-400 to-purple-600",
        "from-amber-400 to-amber-600",
        "from-rose-400 to-rose-600"
    ];
    const gradientIndex = (profile?.full_name?.length || 0) % gradients.length;
    const bgGradient = gradients[gradientIndex];

    return (
        <div className={clsx("relative inline-block", className)}>
            <div className={clsx(
                "rounded-2xl flex items-center justify-center font-black text-white shadow-lg ring-2 ring-white overflow-hidden relative",
                sizeClasses[size],
                profile?.avatar_url ? "bg-slate-100" : `bg-gradient-to-br ${bgGradient}`
            )}>
                {profile?.avatar_url ? (
                    <img
                        src={profile.avatar_url}
                        alt={profile.full_name || "User"}
                        className="h-full w-full object-cover"
                    />
                ) : (
                    <span className="z-10">{initials}</span>
                )}

                {/* Subtle pattern overlay for initials */}
                {!profile?.avatar_url && (
                    <div className="absolute inset-0 bg-white/10 mix-blend-overlay"></div>
                )}
            </div>

            {/* ðŸ‘‘ CROWN BADGE FOR OWNERS */}
            {isOwner && (
                <motion.div
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="absolute -bottom-1 -right-1 bg-gradient-to-b from-yellow-300 to-yellow-500 text-yellow-900 p-1 rounded-full border-2 border-white shadow-sm flex items-center justify-center z-20"
                >
                    <Crown size={iconSizes[size]} strokeWidth={2.5} fill="currentColor" className="text-yellow-900/80" />
                </motion.div>
            )}
        </div>
    );
}
</file>

<file path="src/components/VideoModal.jsx">
import React from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { X } from 'lucide-react';

export default function VideoModal({ isOpen, onClose, videoId = "dQw4w9WgXcQ" }) {
    if (!isOpen) return null;

    return (
        <AnimatePresence>
            {isOpen && (
                <>
                    {/* Backdrop */}
                    <motion.div
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1 }}
                        exit={{ opacity: 0 }}
                        onClick={onClose}
                        className="fixed inset-0 bg-black/80 backdrop-blur-md z-[60]"
                    />

                    {/* Modal Container */}
                    <motion.div
                        initial={{ opacity: 0, scale: 0.95, y: 20 }}
                        animate={{ opacity: 1, scale: 1, y: 0 }}
                        exit={{ opacity: 0, scale: 0.95, y: 20 }}
                        className="fixed inset-0 z-[70] flex items-center justify-center p-4 pointer-events-none"
                    >
                        <div className="bg-black rounded-3xl overflow-hidden shadow-2xl w-full max-w-5xl aspect-video relative pointer-events-auto border border-emerald-500/20">
                            {/* Close Button */}
                            <button
                                onClick={onClose}
                                className="absolute top-4 right-4 z-10 bg-black/50 hover:bg-black/80 text-white p-2 rounded-full backdrop-blur-md transition-colors border border-white/10"
                            >
                                <X className="w-6 h-6" />
                            </button>

                            {/* Embed */}
                            <iframe
                                width="100%"
                                height="100%"
                                src={`https://www.youtube.com/embed/${videoId}?autoplay=1`}
                                title="Wild Robot Demo"
                                frameBorder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowFullScreen
                                className="w-full h-full"
                            ></iframe>
                        </div>
                    </motion.div>
                </>
            )}
        </AnimatePresence>
    );
}
</file>

<file path="src/context/RoleContext.jsx">
import React, { createContext, useContext, useState, useEffect } from 'react';

const RoleContext = createContext();

export const ROLES = {
    SUPER_ADMIN: 'super_admin',
    EMPLOYEE_COACH: 'employee_coach',
    FREELANCE_COACH: 'freelance_coach',
    STUDENT: 'student'
};

export function RoleProvider({ children }) {
    const [currentRole, setCurrentRole] = useState(ROLES.SUPER_ADMIN);
    const [isDevMode, setIsDevMode] = useState(false);

    // Initial check (mock ID check for "Abdulla")
    // In production, we'd check supabase.auth.user().id === 'SPECIFIC_ID'
    useEffect(() => {
        // Automatically enable Dev Mode for this session for demonstration
        setIsDevMode(true);
    }, []);

    const switchRole = (role) => {
        setCurrentRole(role);
        console.log(`[Role Context] Switched to: ${role}`);
        // Here we could also trigger toast notifications or redirects if needed
    };

    return (
        <RoleContext.Provider value={{ currentRole, switchRole, isDevMode, ROLES }}>
            {children}
        </RoleContext.Provider>
    );
}

export function useRole() {
    return useContext(RoleContext);
}
</file>

<file path="src/context/ThemeContext.jsx">
import React, { createContext, useContext, useEffect, useState } from 'react';

const ThemeContext = createContext();

export function ThemeProvider({ children }) {
    const [theme, setTheme] = useState(() => {
        // Check localStorage or system preference
        const storedTheme = localStorage.getItem('theme');
        if (storedTheme) return storedTheme;
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    });

    useEffect(() => {
        const root = window.document.documentElement;

        if (theme === 'dark') {
            root.classList.add('dark');
        } else {
            root.classList.remove('dark');
        }

        localStorage.setItem('theme', theme);
    }, [theme]);

    const toggleTheme = () => {
        setTheme(prev => prev === 'dark' ? 'light' : 'dark');
    };

    return (
        <ThemeContext.Provider value={{ theme, toggleTheme }}>
            {children}
        </ThemeContext.Provider>
    );
}

export function useTheme() {
    return useContext(ThemeContext);
}
</file>

<file path="src/context/UserContext.jsx">
import { createContext, useContext, useEffect, useState } from 'react';
import { supabase } from '../supabaseClient';

const UserContext = createContext();

export const UserProvider = ({ children }) => {
    const [user, setUser] = useState(null);
    const [profile, setProfile] = useState(null);
    const [academy, setAcademy] = useState(null);
    const [loading, setLoading] = useState(true);

    // Function to fetch data and update state
    const fetchUserData = async () => {
        try {
            // 1. Check current session
            const { data: { user: authUser } } = await supabase.auth.getUser();
            setUser(authUser);

            if (authUser) {
                // 2. Fetch Profile (ensuring it exists)
                const { data: userProfile, error: profileError } = await supabase
                    .from('profiles')
                    .select('*')
                    .eq('id', authUser.id)
                    .maybeSingle();

                if (profileError) throw profileError;
                setProfile(userProfile);

                // 3. Fetch Academy (only if user is linked to one)
                if (userProfile?.academy_id) {
                    const { data: userAcademy, error: academyError } = await supabase
                        .from('academies')
                        .select('*')
                        .eq('id', userProfile.academy_id)
                        .maybeSingle();

                    if (academyError) throw academyError;
                    setAcademy(userAcademy);
                } else {
                    setAcademy(null); // New user, setup not done
                }
            }
        } catch (error) {
            console.error('ðŸ”´ Error fetching user data:', error);
        } finally {
            setLoading(false);
        }
    };

    // Monitor auth state automatically
    useEffect(() => {
        fetchUserData();

        const { data: authListener } = supabase.auth.onAuthStateChange((event, session) => {
            if (event === 'SIGNED_IN' || event === 'TOKEN_REFRESHED') {
                // Update data if user changed
                if (session?.user?.id !== user?.id) fetchUserData();
            } else if (event === 'SIGNED_OUT') {
                // Clear data on logout
                setUser(null);
                setProfile(null);
                setAcademy(null);
                setLoading(false);
            }
        });

        return () => {
            authListener.subscription.unsubscribe();
        };
    }, []);

    // Manual refresh function (to use after Setup)
    const refreshProfile = async () => {
        setLoading(true);
        await fetchUserData();
    };

    return (
        <UserContext.Provider value={{ user, profile, academy, loading, refreshProfile }}>
            {children}
        </UserContext.Provider>
    );
};

export const useUser = () => useContext(UserContext);
</file>

<file path="src/hooks/useGeofencing.js">
import { useState, useEffect } from 'react';

export default function useGeofencing(targetLat, targetLng, radiusMeters = 200) {
    const [location, setLocation] = useState(null);
    const [distance, setDistance] = useState(null);
    const [isWithinRange, setIsWithinRange] = useState(false);
    const [error, setError] = useState(null);

    useEffect(() => {
        if (!navigator.geolocation) {
            setError('Geolocation is not supported by your browser');
            return;
        }

        const success = (position) => {
            const currentLat = position.coords.latitude;
            const currentLng = position.coords.longitude;
            setLocation({ lat: currentLat, lng: currentLng });

            if (targetLat && targetLng) {
                const dist = calculateDistance(currentLat, currentLng, targetLat, targetLng);
                setDistance(dist);
                setIsWithinRange(dist <= radiusMeters);
            }
        };

        const handleError = (err) => {
            setError(err.message);
        };

        const options = {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0
        };

        const id = navigator.geolocation.watchPosition(success, handleError, options);

        return () => navigator.geolocation.clearWatch(id);
    }, [targetLat, targetLng, radiusMeters]);

    return { location, distance, isWithinRange, error };
}

// Haversine Formula
function calculateDistance(lat1, lon1, lat2, lon2) {
    const R = 6371e3; // metres
    const Ï†1 = lat1 * Math.PI / 180;
    const Ï†2 = lat2 * Math.PI / 180;
    const Î”Ï† = (lat2 - lat1) * Math.PI / 180;
    const Î”Î» = (lon2 - lon1) * Math.PI / 180;

    const a = Math.sin(Î”Ï† / 2) * Math.sin(Î”Ï† / 2) +
        Math.cos(Ï†1) * Math.cos(Ï†2) *
        Math.sin(Î”Î» / 2) * Math.sin(Î”Î» / 2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

    return R * c;
}
</file>

<file path="src/index.css">
@import url('https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap');
@tailwind base;
@tailwind components;
@tailwind utilities;
</file>

<file path="src/layouts/CoachLayout.jsx">
import React, { useState, useEffect } from 'react';
import { Outlet, NavLink, useNavigate } from 'react-router-dom';
import { clsx } from 'clsx';
import { motion, AnimatePresence } from 'framer-motion';
import { supabase } from '../supabaseClient';
import SafeRoleSwitcher from '../components/SafeRoleSwitcher';
import CommandPalette from '../components/CommandPalette';
import MobileNav from '../components/MobileNav';

export default function CoachLayout() {
    const [isSidebarOpen, setIsSidebarOpen] = useState(false);
    const [isRoleMenuOpen, setIsRoleMenuOpen] = useState(false);
    const [isProfileMenuOpen, setIsProfileMenuOpen] = useState(false);
    const [userProfile, setUserProfile] = useState(null);
    const navigate = useNavigate();

    const handleRoleSwitch = (role) => {
        localStorage.setItem('simulated_role', role);
        window.location.reload();
    };

    const rolesList = [
        { id: 'admin', label: 'Super Admin', color: 'bg-slate-900 text-white' },
        { id: 'manager', label: 'Activity Manager', color: 'bg-indigo-600 text-white' },
        { id: 'head_coach', label: 'Head Coach', color: 'bg-orange-600 text-white' },
        { id: 'hr', label: 'HR Manager', color: 'bg-pink-600 text-white' },
        { id: 'accountant', label: 'Accountant', color: 'bg-green-600 text-white' },
        { id: 'employee', label: 'Coach', color: 'bg-blue-600 text-white' },
        { id: 'freelance', label: 'Freelance', color: 'bg-purple-600 text-white' },
    ];

    // ðŸ›¡ï¸ SECURITY: NO-TRUST POLICY
    // We strictly derive the role. We DO NOT trust localStorage unless the user is confirmed as Admin.
    const realRole = userProfile?.role || 'employee'; // Default to lowest privilege until loaded
    const isSuperAdmin = realRole === 'admin' || realRole === 'super_admin';

    // Only Admins can simulate other roles. Everyone else is locked to their real role.
    const currentRole = isSuperAdmin
        ? (localStorage.getItem('simulated_role') || realRole)
        : realRole;

    // Helper to get Role Badge & Greeting
    const getRoleDetails = (role) => {
        switch (role) {
            case 'admin': return { label: 'Commander', color: 'bg-slate-900 text-white', greeting: 'Commander' };
            case 'manager': return { label: 'Growth Hacker', color: 'bg-indigo-600 text-white', greeting: 'Growth Hacker' };
            case 'head_coach': return { label: 'Technical Director', color: 'bg-orange-600 text-white', greeting: 'Technical Director' };
            case 'hr': return { label: 'People Champion', color: 'bg-pink-600 text-white', greeting: 'People Champion' };
            case 'accountant': return { label: 'Finance Manager', color: 'bg-green-600 text-white', greeting: 'Finance Manager' };
            case 'employee': return { label: 'Coach', color: 'bg-blue-600 text-white', greeting: 'Coach' };
            case 'freelance': return { label: 'Partner', color: 'bg-purple-600 text-white', greeting: 'Partner' };
            default: return { label: 'User', color: 'bg-slate-400 text-white', greeting: 'User' };
        }
    };

    const roleDetails = getRoleDetails(currentRole);

    // Fetch User Profile
    useEffect(() => {
        const fetchProfile = async () => {
            const { data: { user } } = await supabase.auth.getUser();
            if (user) {
                const { data, error } = await supabase
                    .from('profiles')
                    .select('*')
                    .eq('id', user.id)
                    .single();

                if (data) {
                    setUserProfile(data);
                }
            }
        };
        fetchProfile();
    }, []);

    const allNavItems = [
        // 1. Operations
        { id: 'dashboard', name: 'Field Ops', path: '/coach/home', icon: 'dashboard', roles: ['admin', 'manager', 'head_coach', 'hr', 'accountant', 'employee', 'freelance', 'sales_admin'] },
        { id: 'schedule', name: 'My Schedule', path: '/coach/schedule', icon: 'calendar_today', roles: ['admin', 'head_coach', 'employee', 'freelance', 'sales_admin'] },

        // 2. People
        { id: 'roster', name: 'My Athletes', path: '/coach/roster', icon: 'directions_run', roles: ['admin', 'manager', 'head_coach', 'employee', 'freelance', 'sales_admin'] },
        { id: 'skills', name: 'Assessments', path: '/coach/skills', icon: 'assignment_turned_in', roles: ['admin', 'head_coach', 'employee', 'freelance'] },
        { id: 'staff', name: 'Staff & HR', path: '/coach/staff', icon: 'badge', roles: ['admin', 'hr'] },

        // 3. Business
        { id: 'analytics', name: 'Intel', path: '/coach/analytics', icon: 'analytics', roles: ['admin', 'manager'] },
        { id: 'finance', name: 'Treasury', path: '/coach/finance', icon: 'account_balance', roles: ['admin', 'accountant'] },
        { id: 'payments', name: 'Terminal', path: '/coach/payments', icon: 'point_of_sale', roles: ['admin', 'freelance', 'sales_admin'] },
        { id: 'earnings', name: 'My Pay', path: '/coach/earnings', icon: 'monetization_on', roles: ['employee', 'freelance', 'head_coach'] },

        // Utility (Not displayed in hubs directly, maybe bottom?)
        { id: 'settings', name: 'Settings', path: '/coach/settings', icon: 'settings', roles: ['admin', 'manager'] },
    ];

    const navItems = allNavItems.filter(item => item.roles.includes(currentRole));

    const handleLogout = async () => {
        await supabase.auth.signOut();
        navigate('/');
    };

    // Format Data
    const memberSince = userProfile?.created_at
        ? new Date(userProfile.created_at).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })
        : "2024";

    const userInitials = userProfile?.full_name
        ? userProfile.full_name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2)
        : "WR";

    const userName = userProfile?.full_name || "Staff Member";

    return (
        <div className="min-h-screen bg-slate-50 md:flex font-inter">
            {/* Mobile Header (Brand Only, No Hamburger) */}
            <div className="md:hidden bg-slate-900 text-white p-4 flex items-center justify-between sticky top-0 z-30 shadow-md">
                <span className="font-black text-xl tracking-tight text-emerald-400">WR | Wild Robot</span>
                <div className="h-8 w-8 bg-slate-800 rounded-full flex items-center justify-center text-xs font-bold ring-2 ring-emerald-500/50">
                    {userInitials}
                </div>
            </div>

            {/* Sidebar - Desktop Only (hidden on small screens) */}
            <aside className="hidden md:flex flex-col w-72 bg-slate-900 text-white h-screen sticky top-0 shrink-0 border-r border-slate-800 z-40 overflow-y-auto">
                <div className="p-6">
                    {/* Logo Section */}
                    <div className="flex items-center gap-3 mb-8 px-2">
                        <div className="h-10 w-10 bg-gradient-to-br from-emerald-400 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg shadow-emerald-500/20">
                            <span className="material-symbols-outlined text-white text-2xl">smart_toy</span>
                        </div>
                        <div>
                            <h1 className="font-black text-lg leading-tight tracking-tight text-white">WR | Wild Robot</h1>
                            <p className="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Enterprise OS</p>
                        </div>
                    </div>

                    <nav className="space-y-6">
                        {/* 1. OPERATIONS HUB - The core daily driver */}
                        <div>
                            <p className="px-4 text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2 font-mono">Operations</p>
                            <div className="space-y-1">
                                {navItems.filter(i => ['dashboard', 'schedule', 'attendance'].includes(i.id)).map(item => <SidebarItem key={item.path} item={item} />)}
                            </div>
                        </div>

                        {/* 2. PEOPLE HUB - Athletes & Staff */}
                        <div>
                            <p className="px-4 text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2 font-mono">People</p>
                            <div className="space-y-1">
                                {navItems.filter(i => ['roster', 'staff', 'skills'].includes(i.id)).map(item => <SidebarItem key={item.path} item={item} />)}
                            </div>
                        </div>

                        {/* 3. BUSINESS HUB - Money & Growth */}
                        <div>
                            <p className="px-4 text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2 font-mono">Business</p>
                            <div className="space-y-1">
                                {navItems.filter(i => ['analytics', 'finance', 'earnings', 'payments'].includes(i.id)).map(item => <SidebarItem key={item.path} item={item} />)}
                            </div>
                        </div>
                    </nav>
                </div>

                <div className="mt-auto p-8 border-t border-white/5 bg-slate-900/50">
                    <button
                        onClick={handleLogout}
                        className="flex items-center gap-4 text-slate-400 hover:text-red-400 transition-colors w-full px-4 py-2 font-bold text-sm group"
                    >
                        <span className="material-symbols-outlined group-hover:rotate-180 transition-transform">logout</span>
                        Sign Out
                    </button>
                    <p className="text-[10px] text-slate-600 mt-6 text-center font-mono">v3.2.0 | MOBILE FIRST</p>
                </div>
            </aside>

            {/* Main Content */}
            <div className="flex-1 flex flex-col min-h-screen bg-slate-50/50 pb-20 md:pb-0">
                {/* Header (Desktop) - Glassmorphism */}
                <header className="hidden md:flex bg-white/80 backdrop-blur-md border-b border-slate-200 h-20 px-8 items-center justify-between shrink-0 z-20 sticky top-0">
                    <div className="flex items-center gap-8">
                        <div>
                            <div className="flex items-center gap-3 mb-0.5">
                                <h2 className="text-xl font-bold text-slate-800 tracking-tight">
                                    Welcome, <span className="text-emerald-600">{userName.split(' ')[0]}</span>
                                </h2>
                            </div>
                            <p className="text-[11px] text-slate-400 font-bold uppercase tracking-wide">
                                {new Date().toLocaleDateString(undefined, { weekday: 'long', month: 'long', day: 'numeric' })}
                            </p>
                        </div>

                        {/* Dynamic Stats Strip */}
                        <div className="hidden xl:flex items-center gap-3 pl-8 border-l border-slate-200 h-10">
                            {currentRole === 'admin' && (
                                <>
                                    <MetricPill icon="group" label="Staff" value="24" color="text-blue-600" bg="bg-blue-50" />
                                    <MetricPill icon="domain" label="Branches" value="3" color="text-purple-600" bg="bg-purple-50" />
                                    <MetricPill icon="trending_up" label="Revenue" value="+15%" color="text-emerald-600" bg="bg-emerald-50" />
                                </>
                            )}
                            {currentRole === 'manager' && (
                                <>
                                    <MetricPill icon="how_to_reg" label="Signups Today" value="12" color="text-emerald-600" bg="bg-emerald-50" />
                                    <MetricPill icon="person_remove" label="Churn" value="2%" color="text-red-600" bg="bg-red-50" />
                                </>
                            )}
                            {currentRole === 'accountant' && (
                                <>
                                    <MetricPill icon="receipt_long" label="Pending Inv" value="8" color="text-amber-600" bg="bg-amber-50" />
                                    <MetricPill icon="account_balance" label="Cashflow" value="OK" color="text-emerald-600" bg="bg-emerald-50" />
                                </>
                            )}
                            {['head_coach', 'employee', 'freelance'].includes(currentRole) && (
                                <>
                                    <MetricPill icon="sports_gymnastics" label="Athletes" value="115" color="text-blue-600" bg="bg-blue-50" />
                                    <MetricPill icon="timer" label="Hours" value="82" color="text-amber-600" bg="bg-amber-50" />
                                </>
                            )}
                        </div>
                    </div>

                    <div className="flex items-center gap-5">
                        {/* Role Switcher - ADMIN ONLY */}
                        {isSuperAdmin && (
                            <div className="relative">
                                <button
                                    onClick={() => setIsRoleMenuOpen(!isRoleMenuOpen)}
                                    className={clsx(
                                        "text-[10px] font-black uppercase tracking-wider px-4 py-1.5 rounded-full flex items-center gap-2 hover:scale-105 transition-transform cursor-pointer border shadow-sm",
                                        roleDetails.color,
                                        "border-white/20"
                                    )}
                                >
                                    {roleDetails.label}
                                    <span className="material-symbols-outlined text-[14px]">expand_more</span>
                                </button>

                                {/* Dropdown */}
                                <AnimatePresence>
                                    {isRoleMenuOpen && (
                                        <>
                                            <div className="fixed inset-0 z-40" onClick={() => setIsRoleMenuOpen(false)} />
                                            <motion.div
                                                initial={{ opacity: 0, y: 10, scale: 0.95 }}
                                                animate={{ opacity: 1, y: 0, scale: 1 }}
                                                exit={{ opacity: 0, y: 10, scale: 0.95 }}
                                                transition={{ duration: 0.1 }}
                                                className="absolute top-full right-0 mt-3 w-64 bg-white/90 backdrop-blur-xl rounded-2xl shadow-2xl border border-slate-200/50 z-50 overflow-hidden"
                                            >
                                                <div className="p-4 border-b border-slate-100/50 bg-slate-50/50">
                                                    <p className="text-[10px] uppercase font-bold text-slate-400">Select Role Context</p>
                                                </div>
                                                <div className="max-h-72 overflow-y-auto p-2">
                                                    {rolesList.map(role => (
                                                        <button
                                                            key={role.id}
                                                            onClick={() => handleRoleSwitch(role.id)}
                                                            className="w-full text-left px-3 py-2.5 hover:bg-slate-100 rounded-xl flex items-center gap-3 transition-colors group"
                                                        >
                                                            <div className={clsx("h-2.5 w-2.5 rounded-full ring-2 ring-white shadow-sm", role.color.split(' ')[0])} />
                                                            <span className={clsx("text-xs font-bold group-hover:text-slate-900 transition-colors", currentRole === role.id ? "text-slate-900" : "text-slate-500")}>
                                                                {role.label}
                                                            </span>
                                                            {currentRole === role.id && (
                                                                <span className="material-symbols-outlined text-sm text-emerald-500 ml-auto font-bold">check</span>
                                                            )}
                                                        </button>
                                                    ))}
                                                </div>
                                            </motion.div>
                                        </>
                                    )}
                                </AnimatePresence>
                            </div>
                        )}

                        {/* Notification Bell */}
                        <button className="h-10 w-10 bg-white border border-slate-200 rounded-full flex items-center justify-center text-slate-400 hover:text-emerald-500 hover:border-emerald-500 transition-all relative shadow-sm">
                            <span className="material-symbols-outlined">notifications</span>
                            <span className="absolute top-2.5 right-2.5 h-2 w-2 bg-red-500 rounded-full border-2 border-white"></span>
                        </button>

                        {/* User Profile Trigger */}
                        <div className="relative">
                            <button
                                onClick={() => setIsProfileMenuOpen(!isProfileMenuOpen)}
                                className="flex items-center gap-3 focus:outline-none pl-2 group"
                            >
                                <div className="h-10 w-10 bg-slate-900 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-md ring-2 ring-slate-100 group-hover:ring-emerald-500 transition-all overflow-hidden">
                                    {userProfile?.avatar_url ? (
                                        <img src={userProfile.avatar_url} alt="Profile" className="h-full w-full object-cover" />
                                    ) : (
                                        userInitials
                                    )}
                                </div>
                                <div className="hidden md:block text-left">
                                    <p className="text-sm font-black text-slate-800 leading-none group-hover:text-emerald-600 transition-colors">{userName}</p>
                                    <p className="text-[10px] text-slate-400 font-bold uppercase tracking-wider mt-0.5">Member since {memberSince}</p>
                                </div>
                                <span className="material-symbols-outlined text-slate-300 text-sm group-hover:text-emerald-500 transition-colors">expand_more</span>
                            </button>

                            {/* Blur Dropdown Menu */}
                            <AnimatePresence>
                                {isProfileMenuOpen && (
                                    <>
                                        <div className="fixed inset-0 z-[60]" onClick={() => setIsProfileMenuOpen(false)} />
                                        <motion.div
                                            initial={{ opacity: 0, y: 15, scale: 0.95 }}
                                            animate={{ opacity: 1, y: 0, scale: 1 }}
                                            exit={{ opacity: 0, y: 15, scale: 0.95 }}
                                            transition={{ duration: 0.2, type: "spring", stiffness: 300, damping: 25 }}
                                            className="absolute top-[calc(100%+12px)] right-0 w-72 bg-white/90 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/50 z-[70] overflow-hidden"
                                        >
                                            <div className="p-6 border-b border-slate-100/50 bg-gradient-to-b from-slate-50/50 to-transparent">
                                                <div className="flex items-center gap-4 mb-4">
                                                    <div className="h-14 w-14 rounded-2xl bg-slate-900 text-white flex items-center justify-center font-bold text-xl overflow-hidden shadow-lg ring-4 ring-white">
                                                        {userProfile?.avatar_url ? (
                                                            <img src={userProfile.avatar_url} alt="Profile" className="h-full w-full object-cover" />
                                                        ) : (
                                                            userInitials
                                                        )}
                                                    </div>
                                                    <div>
                                                        <p className="font-black text-slate-900 text-lg">{userName}</p>
                                                        <p className="text-xs font-medium text-emerald-600">{roleDetails.label}</p>
                                                    </div>
                                                </div>
                                                <button
                                                    onClick={() => { navigate('/coach/profile'); setIsProfileMenuOpen(false); }}
                                                    className="w-full text-center text-xs font-bold uppercase tracking-wider text-white bg-slate-900 py-2.5 rounded-xl hover:bg-slate-800 transition-all shadow-lg shadow-slate-900/10"
                                                >
                                                    View Personal Profile
                                                </button>
                                            </div>

                                            <div className="p-3 space-y-1">
                                                <MenuLink icon="settings" label="System Settings" onClick={() => { navigate('/coach/settings'); setIsProfileMenuOpen(false); }} />
                                                <MenuLink icon="help" label="Help & Support" onClick={() => alert('Support')} />
                                                <MenuLink icon="lock" label="Lock Screen" onClick={() => alert('Locked')} />
                                            </div>

                                            <div className="p-3 border-t border-slate-100/50">
                                                <button
                                                    onClick={handleLogout}
                                                    className="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold text-red-500 hover:bg-red-50 transition-colors"
                                                >
                                                    <span className="material-symbols-outlined text-[20px]">logout</span>
                                                    Sign Out
                                                </button>
                                            </div>
                                        </motion.div>
                                    </>
                                )}
                            </AnimatePresence>
                        </div>
                    </div>
                </header>

                {/* Content Area */}
                <main className="flex-1 overflow-auto p-4 md:p-8 z-10 scroll-smooth">
                    <Outlet context={{ userProfile }} />
                </main>
            </div>

            {/* Mobile Bottom Navigation */}
            <MobileNav />

            {/* Global Role Switcher - ADMIN ONLY */}
            {isSuperAdmin && <SafeRoleSwitcher />}

            <CommandPalette />
        </div>
    );
}

// Helper Components
function MenuLink({ icon, label, onClick }) {
    return (
        <button
            onClick={onClick}
            className="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-left"
        >
            <span className="material-symbols-outlined text-[20px] text-slate-400">{icon}</span>
            {label}
        </button>
    );
}

// Helper for Header Stats
function MetricPill({ icon, label, value, color, bg }) {
    return (
        <div className={clsx("flex items-center gap-2 px-3 py-1.5 rounded-lg border border-transparent hover:border-slate-200 transition-all cursor-default", bg)}>
            <span className={clsx("material-symbols-outlined text-[18px]", color)}>{icon}</span>
            <div>
                <p className="text-[9px] font-bold text-slate-400 uppercase tracking-wider leading-none mb-0.5">{label}</p>
                <p className={clsx("text-xs font-black leading-none", color)}>{value}</p>
            </div>
        </div>
    );
}

function SidebarItem({ item }) {
    return (
        <NavLink
            to={item.path}
            className={({ isActive }) => clsx(
                "flex items-center gap-3 px-4 py-2.5 rounded-lg transition-all duration-200 font-bold text-[13px]",
                isActive
                    ? "bg-emerald-500 text-white shadow-md shadow-emerald-500/20"
                    : "text-slate-400 hover:bg-white/5 hover:text-white"
            )}
        >
            <span className={clsx("material-symbols-outlined text-[20px]")}>
                {item.icon}
            </span>
            {item.name}
        </NavLink>
    );
}
</file>

<file path="src/layouts/OwnerLayout.jsx">
import React, { useState, useEffect } from 'react';
import { Outlet, NavLink, useNavigate } from 'react-router-dom';
import { supabase } from '../supabaseClient';
import {
    LayoutDashboard, Users, Wallet, Dumbbell,
    Settings, LogOut, UserCircle, Bell, Menu, Shield, Crown, ChevronUp
} from 'lucide-react';

const OwnerLayout = () => {
    const [isSidebarOpen, setSidebarOpen] = useState(true);
    const [subscription, setSubscription] = useState(null);
    const [loading, setLoading] = useState(true);
    const navigate = useNavigate();

    // Mock Data for now, will link to real count later
    const athleteCount = 0;

    useEffect(() => {
        const fetchSubscription = async () => {
            try {
                const { data: { user } } = await supabase.auth.getUser();
                if (!user) return;

                // Fetch Profile -> Academy -> Plan
                const { data: profile } = await supabase
                    .from('profiles')
                    .select('*, academies(*, current_plan:subscription_plans(*))')
                    .eq('id', user.id)
                    .single();

                if (profile?.academies) {
                    setSubscription({
                        plan: profile.academies.current_plan,
                        academyName: profile.academies.name,
                        maxAthletes: profile.academies.current_plan?.max_athletes || Infinity,
                        status: profile.academies.subscription_status
                    });
                }
            } catch (error) {
                console.error("Subscription fetch error:", error);
            } finally {
                setLoading(false);
            }
        };

        fetchSubscription();
    }, []);

    const handleLogout = async () => {
        await supabase.auth.signOut();
        navigate('/login');
    };

    const NavItem = ({ to, icon: Icon, label }) => (
        <NavLink to={to} className={({ isActive }) => `flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${isActive ? 'bg-emerald-600 text-white shadow-lg' : 'text-slate-400 hover:bg-slate-800 hover:text-white'}`}>
            <Icon className="w-5 h-5" />
            {isSidebarOpen && <span className="font-medium">{label}</span>}
        </NavLink>
    );

    return (
        <div className="flex min-h-screen bg-slate-50 font-sans text-slate-900">
            {/* SIDEBAR */}
            <aside className={`${isSidebarOpen ? 'w-64' : 'w-20'} bg-slate-900 text-white flex flex-col transition-all duration-300 fixed h-full z-50 shadow-2xl`}>
                {/* Branding */}
                <div className="h-20 flex items-center justify-center border-b border-slate-800">
                    <Shield className="w-8 h-8 text-emerald-400" />
                    {isSidebarOpen && <span className="ml-3 font-bold text-lg tracking-wider">WILD ROBOT</span>}
                </div>

                {/* OPERATIONS SECTION */}
                <div className="p-4 space-y-2 flex-1 overflow-y-auto">
                    <p className={`text-xs font-bold text-slate-500 uppercase px-4 mb-2 ${!isSidebarOpen && 'hidden'}`}>Operations</p>
                    <NavItem to="/owner/dashboard" icon={LayoutDashboard} label="Live Feed" />
                    <NavItem to="/owner/staff" icon={Users} label="Staff & HR" />
                    <NavItem to="/owner/finance" icon={Wallet} label="Finance" />
                    <NavItem to="/owner/athletes" icon={Dumbbell} label="Roster" />
                </div>

                {/* SUBSCRIPTION WIDGET */}
                {isSidebarOpen && subscription && (
                    <div className="mx-4 mb-4 p-4 bg-slate-800 rounded-xl border border-slate-700">
                        <div className="flex items-center justify-between mb-2">
                            <div className="flex items-center gap-2">
                                <Crown className="w-4 h-4 text-amber-400" />
                                <span className="text-xs font-black text-slate-300 tracking-widest uppercase">
                                    {subscription.plan?.name || 'TRAIL'}
                                </span>
                            </div>
                            {subscription.status === 'past_due' && <span className="w-2 h-2 rounded-full bg-red-500 animate-pulse" />}
                        </div>

                        {/* Progress Bar */}
                        <div className="space-y-1 mb-3">
                            <div className="flex justify-between text-[10px] font-bold text-slate-400">
                                <span>Athletes</span>
                                <span>{athleteCount} / {subscription.maxAthletes === Infinity ? 'âˆž' : subscription.maxAthletes}</span>
                            </div>
                            <div className="h-1.5 bg-slate-700 rounded-full overflow-hidden">
                                <div
                                    className="h-full bg-emerald-500 rounded-full transition-all duration-500"
                                    style={{ width: `${Math.min((athleteCount / (subscription.maxAthletes || 100)) * 100, 100)}%` }}
                                />
                            </div>
                        </div>

                        <button className="w-full py-2 bg-emerald-600/20 hover:bg-emerald-600/30 text-emerald-400 hover:text-emerald-300 border border-emerald-500/30 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2">
                            Upgrade Plan <ChevronUp className="w-3 h-3" />
                        </button>
                    </div>
                )}

                {/* PROFILE SECTION (Bottom) */}
                <div className="p-4 border-t border-slate-800 bg-slate-900/50">
                    <p className={`text-xs font-bold text-slate-500 uppercase px-4 mb-2 ${!isSidebarOpen && 'hidden'}`}>System</p>
                    <NavItem to="/owner/settings" icon={Settings} label="Settings" />
                    <button onClick={handleLogout} className="flex items-center gap-3 px-4 py-3 w-full rounded-xl text-red-400 hover:bg-red-900/20 hover:text-red-200 transition-all mt-2">
                        <LogOut className="w-5 h-5" />
                        {isSidebarOpen && <span className="font-medium">Sign Out</span>}
                    </button>
                </div>
            </aside>

            {/* MAIN CONTENT */}
            <main className={`flex-1 transition-all duration-300 ${isSidebarOpen ? 'ml-64' : 'ml-20'}`}>
                <header className="h-20 bg-white border-b border-slate-200 flex items-center justify-between px-8 sticky top-0 z-40">
                    <button onClick={() => setSidebarOpen(!isSidebarOpen)} className="p-2 hover:bg-slate-100 rounded-lg"><Menu className="w-6 h-6 text-slate-600" /></button>
                    <div className="flex items-center gap-4">
                        <div className="text-right hidden md:block">
                            <p className="text-sm font-bold text-slate-900">The Commander</p>
                            <p className="text-xs text-emerald-600 font-bold">
                                {subscription?.academyName || 'Owner Account'}
                            </p>
                        </div>
                        <div className="w-10 h-10 bg-emerald-100 rounded-full flex items-center justify-center border-2 border-emerald-500">
                            <UserCircle className="w-6 h-6 text-emerald-700" />
                        </div>
                    </div>
                </header>
                <div className="p-8"><Outlet /></div>
            </main>
        </div>
    );
};

export default OwnerLayout;
</file>

<file path="src/layouts/StudentLayout.jsx">
import React, { useState, useRef, useEffect } from 'react';
import { Outlet, NavLink, useLocation } from 'react-router-dom';
import { clsx } from 'clsx';

// Using Material Symbols since lucide-react is not currently installed
// and we want to maintain consistency without adding dependencies unnecessarily
// If strict adherence to lucide is required, user should confirm to run npm install lucide-react

export default function StudentLayout() {
    const [isParentMode, setIsParentMode] = useState(false);
    const [progress, setProgress] = useState(0);
    const location = useLocation();

    // Timer refs
    const pressTimer = useRef(null);
    const inactivityTimer = useRef(null);
    const progressInterval = useRef(null);
    const touchStartPos = useRef({ x: 0, y: 0 });

    // Activity Monitor for Auto-Lock
    useEffect(() => {
        if (isParentMode) {
            resetInactivityTimer();
            window.addEventListener('mousemove', resetInactivityTimer);
            window.addEventListener('touchstart', resetInactivityTimer);
            window.addEventListener('click', resetInactivityTimer);
            window.addEventListener('keypress', resetInactivityTimer);
        } else {
            clearTimeout(inactivityTimer.current);
            window.removeEventListener('mousemove', resetInactivityTimer);
            window.removeEventListener('touchstart', resetInactivityTimer);
            window.removeEventListener('click', resetInactivityTimer);
            window.removeEventListener('keypress', resetInactivityTimer);
        }

        return () => {
            clearTimeout(inactivityTimer.current);
            window.removeEventListener('mousemove', resetInactivityTimer);
            window.removeEventListener('touchstart', resetInactivityTimer);
            window.removeEventListener('click', resetInactivityTimer);
            window.removeEventListener('keypress', resetInactivityTimer);
        };
    }, [isParentMode]);

    const resetInactivityTimer = () => {
        clearTimeout(inactivityTimer.current);
        inactivityTimer.current = setTimeout(() => {
            setIsParentMode(false); // Auto-Lock
        }, 5 * 60 * 1000); // 5 minutes
    };

    // Long Press Logic
    const startPress = () => {
        if (isParentMode) {
            // Instant Lock if already in parent mode
            setIsParentMode(false);
            return;
        }

        setProgress(0);
        let currentProgress = 0;

        progressInterval.current = setInterval(() => {
            currentProgress += 5; // Finish in roughly 2 seconds (5 * 20 = 100) -> interval 100ms
            setProgress(Math.min(currentProgress, 100));

            if (currentProgress >= 100) {
                clearInterval(progressInterval.current);
                setIsParentMode(true);
                setProgress(0);
            }
        }, 100); // 100ms tick * 20 ticks = 2000ms = 2 seconds to unlock
    };

    const handleTouchStart = (e) => {
        const touch = e.touches[0];
        touchStartPos.current = { x: touch.clientX, y: touch.clientY };
        startPress();
    };

    const handleTouchMove = (e) => {
        const touch = e.touches[0];
        const deltaX = touch.clientX - touchStartPos.current.x;
        const deltaY = touch.clientY - touchStartPos.current.y;
        const distance = Math.hypot(deltaX, deltaY);

        // 10px Tolerance
        if (distance > 10) {
            endPress();
        }
    };

    const endPress = () => {
        clearInterval(progressInterval.current);
        setProgress(0);
    };

    // Security Check for Protected Pages
    const protectedRoutes = ['/athlete/billing', '/athlete/settings'];
    const isProtectedPage = protectedRoutes.some(route => location.pathname.startsWith(route));

    return (
        <div className={clsx("min-h-screen flex flex-col transition-colors duration-500", isParentMode ? "bg-slate-900" : "bg-blue-50")}>

            {/* Header */}
            <header className={clsx(
                "fixed top-0 left-0 right-0 h-16 z-50 flex items-center justify-between px-4 transition-colors duration-500 shadow-sm",
                isParentMode ? "bg-slate-800 text-white" : "bg-white text-slate-800"
            )}>
                {/* Logo / Title */}
                <div className="flex items-center gap-2 font-black text-lg">
                    {isParentMode ? (
                        <>
                            <span className="material-symbols-outlined text-emerald-400">admin_panel_settings</span>
                            <span>Parent Mode</span>
                        </>
                    ) : (
                        <>
                            <span className="material-symbols-outlined text-blue-500">face</span>
                            <span>Student Portal</span>
                        </>
                    )}
                </div>

                {/* Parent Gate Lock */}
                <button
                    onMouseDown={startPress}
                    onMouseUp={endPress}
                    onMouseLeave={endPress}
                    onTouchStart={handleTouchStart}
                    onTouchMove={handleTouchMove}
                    onTouchEnd={endPress}
                    className="relative h-10 w-10 flex items-center justify-center rounded-full bg-opacity-10 transition-all select-none focus:outline-none"
                    style={{ backgroundColor: isParentMode ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.05)' }}
                    aria-label={isParentMode ? "Lock Parent Mode" : "Unlock Parent Mode (Hold for 2 seconds)"}
                >
                    {/* Progress Circle SVG */}
                    {!isParentMode && progress > 0 && (
                        <svg className="absolute inset-0 h-full w-full rotate-[-90deg]" viewBox="0 0 36 36">
                            <path
                                className="text-gray-200"
                                d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                                fill="none"
                                stroke="currentColor"
                                strokeWidth="4"
                            />
                            <path
                                className="text-emerald-500 transition-all duration-100 ease-linear"
                                strokeDasharray={`${progress}, 100`}
                                d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                                fill="none"
                                stroke="currentColor"
                                strokeWidth="4"
                            />
                        </svg>
                    )}

                    <span className={clsx("material-symbols-outlined transition-all", isParentMode ? "text-emerald-400" : "text-slate-400")}>
                        {isParentMode ? 'lock_open' : 'lock'}
                    </span>
                </button>
            </header>

            {/* Main Content */}
            <main className="flex-1 pt-16 pb-20 px-4">
                {isProtectedPage && !isParentMode ? (
                    <div className="flex flex-col items-center justify-center h-full text-center animate-in fade-in zoom-in-95">
                        <div className="h-20 w-20 bg-slate-200 rounded-full flex items-center justify-center mb-6 text-slate-400">
                            <span className="material-symbols-outlined text-4xl">lock</span>
                        </div>
                        <h2 className="text-xl font-bold text-slate-500 mb-2">Parent Only Zone</h2>
                        <p className="text-slate-400 max-w-xs mx-auto">Hold the lock button in the top right to access these settings.</p>
                    </div>
                ) : (
                    <Outlet context={{ isParentMode }} />
                )}
            </main>

            {/* Bottom Navigation */}
            <nav className={clsx(
                "fixed bottom-0 left-0 right-0 h-[70px] pb-safe border-t z-50 transition-colors duration-500",
                isParentMode ? "bg-slate-800 border-slate-700" : "bg-white border-blue-100"
            )}>
                <ul className="flex items-center justify-around h-full max-w-md mx-auto">

                    <StudentNavItem
                        to="/athlete"
                        icon="home"
                        label="Home"
                        end
                        isParentMode={isParentMode}
                    />

                    <StudentNavItem
                        to="/athlete/achievements"
                        icon="emoji_events"
                        label="Trophies"
                        isParentMode={isParentMode}
                    />

                    {isParentMode && (
                        <>
                            <StudentNavItem
                                to="/athlete/billing"
                                icon="credit_card"
                                label="Billing"
                                isParentMode={isParentMode}
                            />
                            <StudentNavItem
                                to="/athlete/settings"
                                icon="settings"
                                label="Settings"
                                isParentMode={isParentMode}
                            />
                        </>
                    )}
                </ul>
            </nav>
        </div>
    );
}

function StudentNavItem({ to, icon, label, isParentMode, end = false }) {
    return (
        <li className="flex-1 h-full">
            <NavLink
                to={to}
                end={end}
                className={({ isActive }) => clsx(
                    "flex flex-col items-center justify-center gap-1 w-full h-full transition-colors",
                    isParentMode
                        ? (isActive ? "text-emerald-400" : "text-slate-500 hover:text-slate-300")
                        : (isActive ? "text-blue-500" : "text-slate-400 hover:text-blue-300")
                )}
            >
                <span className={clsx("material-symbols-outlined text-[26px]")}>
                    {icon}
                </span>
                <span className="text-[10px] font-bold">{label}</span>
            </NavLink>
        </li>
    );
}
</file>

<file path="src/pages/Athlete/Achievements.jsx">
import React, { useState } from 'react';
import { clsx } from 'clsx';
// import confetti from 'canvas-confetti'; // Assuming it's installed, otherwise we skip or use mock

export default function Achievements() {
    const [activeTab, setActiveTab] = useState('medals'); // 'medals' | 'badges'
    const [selectedBadge, setSelectedBadge] = useState(null);

    // Mock Data
    const medals = [
        { id: 1, title: 'Gold - Winter Cup', date: 'Dec 2024', type: 'gold', category: 'academy' },
        { id: 2, title: 'Silver - Regional Open', date: 'Nov 2024', type: 'silver', category: 'external' },
        { id: 3, title: 'Bronze - Spring Roll', date: 'Oct 2024', type: 'bronze', category: 'academy' },
    ];

    const badges = [
        { id: 1, title: 'Monkey King', icon: 'ðŸµ', description: 'Mastered the monkey bar walk across the entire gym!', unlocked: true },
        { id: 2, title: 'Early Bird', icon: 'ðŸŒ…', description: 'Attended 5 morning classes in a row.', unlocked: true },
        { id: 3, title: 'Iron Grip', icon: 'âœŠ', description: 'Held a pull-up hang for 60 seconds.', unlocked: false },
        { id: 4, title: 'Speedster', icon: 'âš¡', description: 'Completed the obstacle course in under 30s.', unlocked: false },
        { id: 5, title: 'Team Player', icon: 'ðŸ¤', description: 'Helped a teammate during a drill.', unlocked: true },
    ];

    const handleBadgeClick = (badge) => {
        if (!badge.unlocked) return;

        setSelectedBadge(badge);

        // Trigger Confetti if available
        if (typeof window.confetti === 'function') {
            window.confetti({ zIndex: 9999, particleCount: 100, spread: 70, origin: { y: 0.6 } });
        } else {
            // Fallback or if confetti is imported as module
            try {
                import('canvas-confetti').then((confetti) => {
                    confetti.default({ zIndex: 9999, particleCount: 100, spread: 70, origin: { y: 0.6 } });
                });
            } catch (e) {
                console.log("Confetti not available");
            }
        }
    };

    return (
        <div className="space-y-6">

            {/* Header / Medal Summary */}
            <div className="bg-white rounded-3xl p-6 shadow-sm border border-blue-50">
                <h2 className="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4 text-center">Total Loot</h2>
                <div className="flex justify-center gap-8">
                    <div className="flex flex-col items-center">
                        <div className="h-12 w-12 rounded-full bg-amber-100 text-amber-500 flex items-center justify-center mb-1 shadow-sm">
                            <span className="material-symbols-outlined text-[28px]">military_tech</span>
                        </div>
                        <span className="text-2xl font-black text-slate-800">2</span>
                        <span className="text-[10px] text-slate-400 font-bold">GOLD</span>
                    </div>
                    <div className="flex flex-col items-center">
                        <div className="h-12 w-12 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center mb-1 shadow-sm">
                            <span className="material-symbols-outlined text-[28px]">military_tech</span>
                        </div>
                        <span className="text-2xl font-black text-slate-800">4</span>
                        <span className="text-[10px] text-slate-400 font-bold">SILVER</span>
                    </div>
                    <div className="flex flex-col items-center">
                        <div className="h-12 w-12 rounded-full bg-orange-100 text-orange-700 flex items-center justify-center mb-1 shadow-sm">
                            <span className="material-symbols-outlined text-[28px]">military_tech</span>
                        </div>
                        <span className="text-2xl font-black text-slate-800">1</span>
                        <span className="text-[10px] text-slate-400 font-bold">BRONZE</span>
                    </div>
                </div>
            </div>

            {/* Tabs */}
            <div className="flex p-1 bg-white rounded-xl shadow-sm border border-blue-50">
                <button
                    onClick={() => setActiveTab('medals')}
                    className={clsx(
                        "flex-1 py-3 text-sm font-black rounded-lg transition-all",
                        activeTab === 'medals' ? "bg-amber-100 text-amber-700 shadow-sm" : "text-slate-400 hover:text-slate-600"
                    )}
                >
                    MEDALS ðŸ…
                </button>
                <button
                    onClick={() => setActiveTab('badges')}
                    className={clsx(
                        "flex-1 py-3 text-sm font-black rounded-lg transition-all",
                        activeTab === 'badges' ? "bg-indigo-100 text-indigo-600 shadow-sm" : "text-slate-400 hover:text-slate-600"
                    )}
                >
                    BADGES ðŸ›¡ï¸
                </button>
            </div>

            {/* Content Area */}
            {activeTab === 'medals' ? (
                <div className="space-y-3 animate-in slide-in-from-bottom-5 duration-300">
                    {/* Toggle inside medals if needed, or just list all for now */}
                    {medals.map(medal => (
                        <div key={medal.id} className="bg-white p-4 rounded-2xl flex items-center gap-4 shadow-sm border border-slate-50">
                            <div className={clsx(
                                "h-12 w-12 rounded-xl flex items-center justify-center flex-shrink-0",
                                medal.type === 'gold' ? "bg-amber-100 text-amber-600" :
                                    medal.type === 'silver' ? "bg-slate-100 text-slate-500" :
                                        "bg-orange-100 text-orange-700"
                            )}>
                                <span className="material-symbols-outlined text-[32px]">emoji_events</span>
                            </div>
                            <div>
                                <h3 className="font-bold text-slate-800">{medal.title}</h3>
                                <p className="text-xs text-slate-500 font-medium bg-slate-100 inline-block px-2 py-0.5 rounded-full mt-1 uppercase">
                                    {medal.category}
                                </p>
                            </div>
                            <span className="ml-auto text-xs font-bold text-slate-400">{medal.date}</span>
                        </div>
                    ))}
                </div>
            ) : (
                <div className="grid grid-cols-3 gap-4 animate-in slide-in-from-bottom-5 duration-300">
                    {badges.map(badge => (
                        <button
                            key={badge.id}
                            onClick={() => handleBadgeClick(badge)}
                            className={clsx(
                                "aspect-square rounded-2xl flex flex-col items-center justify-center p-2 transition-all active:scale-95",
                                badge.unlocked
                                    ? "bg-white shadow-sm border-2 border-indigo-100 hover:border-indigo-300 hover:shadow-md cursor-pointer"
                                    : "bg-slate-100 border-2 border-transparent grayscale opacity-50 cursor-not-allowed"
                            )}
                        >
                            <span className="text-4xl mb-2 filter drop-shadow-sm">{badge.icon}</span>
                            <span className="text-[10px] font-bold text-slate-600 text-center leading-tight line-clamp-2">{badge.title}</span>
                        </button>
                    ))}
                </div>
            )}

            {/* Badge Details Modal */}
            {selectedBadge && (
                <div className="fixed inset-0 z-[100] flex items-center justify-center p-6 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200" onClick={() => setSelectedBadge(null)}>
                    <div
                        className="bg-white rounded-3xl w-full max-w-sm p-8 text-center shadow-2xl animate-in zoom-in-95 duration-300 relative overflow-hidden"
                        onClick={e => e.stopPropagation()}
                    >
                        {/* Confetti Burst Background Effect */}
                        <div className="absolute top-0 left-0 w-full h-full bg-gradient-to-br from-indigo-500/10 to-purple-500/10 pointer-events-none"></div>

                        <div className="h-24 w-24 mx-auto bg-indigo-50 rounded-full flex items-center justify-center mb-6 shadow-inner relative z-10">
                            <span className="text-6xl animate-bounce-slow">{selectedBadge.icon}</span>
                        </div>

                        <h2 className="text-2xl font-black text-slate-900 mb-2 relative z-10">{selectedBadge.title}</h2>
                        <p className="text-slate-500 font-medium mb-8 relative z-10">{selectedBadge.description}</p>

                        <button
                            onClick={() => setSelectedBadge(null)}
                            className="w-full py-3 bg-indigo-600 text-white font-bold rounded-xl shadow-lg shadow-indigo-200 hover:bg-indigo-700 active:scale-95 transition-all relative z-10"
                        >
                            Awesome! ðŸš€
                        </button>
                    </div>
                </div>
            )}
        </div>
    );
}
</file>

<file path="src/pages/Athlete/AthleteHome.jsx">
import React from 'react';
import { clsx } from 'clsx';

export default function StudentHome() {
    return (
        <div className="space-y-6">
            <h1 className="text-2xl font-black text-slate-800">Hi, Champ! ðŸ‘‹</h1>

            <div className="bg-gradient-to-br from-blue-500 to-indigo-600 rounded-3xl p-6 text-white shadow-lg shadow-blue-200" role="region" aria-label="Next Session">
                <p className="opacity-80 font-medium mb-1">Next Session</p>
                <div className="flex items-end justify-between">
                    <div>
                        <h2 className="text-3xl font-black">Tomorrow</h2>
                        <p className="text-lg">4:00 PM â€¢ BJJ Fundamentals</p>
                    </div>
                    <div className="h-12 w-12 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-sm" aria-hidden="true">
                        <span className="material-symbols-outlined text-[28px]">calendar_clock</span>
                    </div>
                </div>
            </div>

            <div className="grid grid-cols-2 gap-4">
                <div className="bg-white p-5 rounded-2xl shadow-sm border border-blue-50 flex flex-col items-center text-center">
                    <span className="material-symbols-outlined text-4xl text-amber-500 mb-2" aria-hidden="true">emoji_events</span>
                    <span className="text-2xl font-black text-slate-800">12</span>
                    <span className="text-xs text-slate-400 font-bold uppercase tracking-wide">Medals</span>
                </div>
                <div className="bg-white p-5 rounded-2xl shadow-sm border border-blue-50 flex flex-col items-center text-center">
                    <span className="material-symbols-outlined text-4xl text-emerald-500 mb-2" aria-hidden="true">bolt</span>
                    <span className="text-2xl font-black text-slate-800">95%</span>
                    <span className="text-xs text-slate-400 font-bold uppercase tracking-wide">Attendance</span>
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/Athlete/Billing.jsx">
import React, { useState } from 'react';
import { clsx } from 'clsx';
import InvoiceDetailModal from '../../components/InvoiceDetailModal';

export default function StudentBilling() {
    // Mock Data and Logic
    const [balance, setBalance] = useState(150.00);
    const [showPaymentOverlay, setShowPaymentOverlay] = useState(false);
    const [selectedInvoice, setSelectedInvoice] = useState(null);

    const [invoices, setInvoices] = useState([
        { id: 'INV-001', date: '2024-12-01', description: 'Winter Term Fee', amount: 150.00, status: 'Pending' },
        { id: 'INV-002', date: '2024-11-01', description: 'Uniform Kit', amount: 85.00, status: 'Paid' },
        { id: 'INV-003', date: '2024-10-01', description: 'October Tuition', amount: 120.00, status: 'Paid' },
    ]);

    const handlePayNow = () => {
        setShowPaymentOverlay(true);
        // Simulate gateway interaction
        setTimeout(() => {
            // Success Logic
            setBalance(0);

            // Update Invoices: Mark all 'Pending' as 'Paid'
            setInvoices(prev => prev.map(inv =>
                inv.status === 'Pending' ? { ...inv, status: 'Paid' } : inv
            ));

            // If an invoice is currently open and was pending, update it too so the modal reflects the change immediately
            if (selectedInvoice && selectedInvoice.status === 'Pending') {
                setSelectedInvoice(prev => ({ ...prev, status: 'Paid' }));
            }

            setShowPaymentOverlay(false);

            // Simple toast simulation
            const toast = document.createElement('div');
            toast.textContent = 'Payment Successful! ðŸŽ‰';
            toast.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-emerald-500 text-white px-8 py-4 rounded-2xl shadow-2xl animate-in zoom-in-95 font-black text-xl z-[100]';
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 2500);

            // Ideally update invoice status here too in a real app
        }, 2000);
    };

    return (
        <div className="space-y-6 max-w-2xl mx-auto relative">
            <h1 className="text-2xl font-black text-slate-900">Billing & Payments</h1>

            {/* Status Card */}
            <div className={clsx(
                "rounded-3xl p-8 shadow-sm text-white transition-all duration-500",
                balance > 0 ? "bg-gradient-to-br from-red-500 to-orange-600 shadow-orange-200" : "bg-gradient-to-br from-emerald-500 to-teal-600 shadow-emerald-200"
            )}>
                <div className="flex items-start justify-between mb-8">
                    <div>
                        <p className="text-white/80 font-medium mb-1">Current Balance</p>
                        <h2 className="text-4xl font-black">${balance.toFixed(2)}</h2>
                    </div>
                    <div
                        onClick={() => {
                            const toast = document.createElement('div');
                            toast.textContent = 'Manage Saved Cards feature coming soon! ðŸ’³';
                            toast.className = 'fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-slate-900 text-white px-6 py-3 rounded-xl shadow-2xl animate-in slide-in-from-bottom-5 font-bold z-[200] text-sm';
                            document.body.appendChild(toast);
                            setTimeout(() => toast.remove(), 2500);
                        }}
                        className="h-12 w-12 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center cursor-pointer hover:bg-white/30 transition-colors"
                    >
                        <span className="material-symbols-outlined text-[28px]">account_balance_wallet</span>
                    </div>
                </div>

                {balance > 0 ? (
                    <div>
                        <div className="flex items-center gap-2 mb-6 text-red-50 bg-red-900/20 px-3 py-1.5 rounded-lg w-fit">
                            <span className="material-symbols-outlined text-sm">error</span>
                            <span className="text-xs font-bold uppercase tracking-wide">Payment Due</span>
                        </div>
                        <button
                            onClick={handlePayNow}
                            className="w-full bg-white text-red-600 font-bold py-4 rounded-xl shadow-lg hover:shadow-xl active:scale-95 transition-all flex items-center justify-center gap-2 relative overflow-hidden"
                        >
                            <span>Pay Now</span>
                            <span className="material-symbols-outlined">credit_card</span>
                        </button>
                    </div>
                ) : (
                    <div className="flex items-center gap-2">
                        <span className="material-symbols-outlined text-2xl">check_circle</span>
                        <span className="font-bold text-lg">All caught up! ðŸŽ‰</span>
                    </div>
                )}
            </div>

            {/* Invoices List */}
            <div className="bg-white rounded-3xl shadow-sm border border-slate-100 overflow-hidden">
                <div className="p-6 border-b border-slate-50 flex items-center justify-between">
                    <h3 className="font-bold text-slate-800">Invoice History</h3>
                    {invoices.length >= 5 && (
                        <button className="text-sm text-blue-500 font-bold hover:underline">View All</button>
                    )}
                </div>

                <div className="divide-y divide-slate-50">
                    {invoices.slice(0, 5).map((invoice, index) => (
                        <div
                            key={invoice.id}
                            onClick={() => setSelectedInvoice(invoice)}
                            className="p-4 flex items-center justify-between hover:bg-slate-50 transition-colors cursor-pointer group"
                        >
                            <div className="flex items-center gap-4">
                                <div className={clsx(
                                    "h-10 w-10 rounded-full flex items-center justify-center transition-transform group-hover:scale-110",
                                    invoice.status === 'Paid' ? "bg-emerald-100 text-emerald-600" : "bg-orange-100 text-orange-600"
                                )}>
                                    <span className="material-symbols-outlined text-[20px]">description</span>
                                </div>
                                <div>
                                    <p className="font-bold text-slate-800 text-sm group-hover:text-blue-600 transition-colors">{invoice.description}</p>
                                    <p className="text-xs text-slate-400">{invoice.date}</p>
                                </div>
                            </div>

                            <div className="flex items-center gap-4">
                                <span className={clsx(
                                    "text-xs font-bold px-2 py-1 rounded-md uppercase tracking-wider hidden sm:inline-block",
                                    invoice.status === 'Pending' ? "bg-orange-50 text-orange-600" : "bg-emerald-50 text-emerald-600"
                                )}>
                                    {invoice.status}
                                </span>
                                <span className="font-bold text-slate-800 text-sm w-16 text-right">${invoice.amount}</span>
                                <button className="text-slate-300 group-hover:text-blue-500 transition-colors">
                                    <span className="material-symbols-outlined">visibility</span>
                                </button>
                            </div>
                        </div>
                    ))}
                </div>
            </div>

            <p className="text-center text-xs text-slate-400">
                Payments secured by Stripe. Encrypted via 256-bit SSL.
            </p>

            <InvoiceDetailModal
                invoice={selectedInvoice}
                isOpen={!!selectedInvoice}
                onClose={() => setSelectedInvoice(null)}
            />

            {/* Full Screen Payment Overlay */}
            {showPaymentOverlay && (
                <div className="fixed inset-0 z-[200] flex flex-col items-center justify-center bg-white/95 backdrop-blur-sm animate-in fade-in duration-300">
                    <div className="h-16 w-16 border-4 border-slate-200 border-t-blue-500 rounded-full animate-spin mb-6"></div>
                    <h2 className="text-2xl font-black text-slate-900 mb-2">Connecting to Stripe</h2>
                    <p className="text-slate-500 font-medium">Please verify your payment details...</p>
                </div>
            )}
        </div>
    );
}
</file>

<file path="src/pages/Athlete/Settings.jsx">
import React, { useState } from 'react';
import { clsx } from 'clsx';
import { supabase } from '../../supabaseClient';
import { useNavigate } from 'react-router-dom';

export default function StudentSettings() {
    const navigate = useNavigate();
    const [isSaving, setIsSaving] = useState(false);
    const [showAvatarModal, setShowAvatarModal] = useState(false);

    // Mock User Data
    const [profile, setProfile] = useState({
        displayName: 'Super Student',
        email: 'parent@example.com',
        avatarId: 'wibo_classic',
        notifications: {
            email: true,
            whatsapp: false
        }
    });

    const wiboAvatars = [
        { id: 'wibo_classic', name: 'Wibo Classic', color: 'bg-emerald-500' },
        { id: 'wibo_gymnast', name: 'Wibo Gymnast', color: 'bg-blue-500' },
        { id: 'wibo_hero', name: 'Wibo Hero', color: 'bg-red-500' },
        { id: 'wibo_student', name: 'Wibo Student', color: 'bg-amber-500' },
        { id: 'wibo_ninja', name: 'Wibo Ninja', color: 'bg-slate-800' },
        { id: 'wibo_artist', name: 'Wibo Artist', color: 'bg-purple-500' },
    ];

    const currentAvatar = wiboAvatars.find(a => a.id === profile.avatarId) || wiboAvatars[0];

    const handleLogout = async () => {
        const confirmLogout = window.confirm("Are you sure you want to log out?");
        if (confirmLogout) {
            await supabase.auth.signOut();
            navigate('/');
        }
    };

    const handleSave = () => {
        setIsSaving(true);
        // Simulate save
        setTimeout(() => {
            setIsSaving(false);

            // Success Toast
            const toast = document.createElement('div');
            toast.textContent = 'Settings Saved! âœ…';
            toast.className = 'fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-emerald-600 text-white px-6 py-3 rounded-xl shadow-2xl animate-in slide-in-from-bottom-5 font-bold z-[200]';
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 2500);
        }, 1000);
    };

    return (
        <div className="max-w-xl mx-auto space-y-8 pb-20">
            <div className="flex items-center justify-between">
                <h1 className="text-2xl font-black text-slate-900">Settings & Profile</h1>
                <button
                    onClick={handleLogout}
                    className="text-red-500 font-bold text-sm bg-red-50 px-3 py-1.5 rounded-lg hover:bg-red-100 transition-colors"
                >
                    Log Out
                </button>
            </div>

            {/* Avatar Studio */}
            <section className="bg-white p-6 rounded-3xl shadow-sm border border-slate-100 flex flex-col items-center">
                <div className="relative group cursor-pointer" onClick={() => setShowAvatarModal(true)}>
                    <div className={clsx(
                        "h-24 w-24 rounded-full flex items-center justify-center text-white text-3xl shadow-lg transition-transform group-hover:scale-105",
                        currentAvatar.color
                    )}>
                        <span className="material-symbols-outlined">smart_toy</span>
                    </div>
                    <div className="absolute inset-0 bg-black/20 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity backdrop-blur-[1px]">
                        <span className="material-symbols-outlined text-white">edit</span>
                    </div>
                </div>

                <h2 className="mt-4 text-xs font-bold text-slate-400 uppercase tracking-wider">Current Avatar</h2>
                <p className="font-bold text-slate-700">{currentAvatar.name}</p>

                <div className="w-full mt-6">
                    <label className="block text-sm font-bold text-slate-700 mb-2">Display Name</label>
                    <input
                        type="text"
                        value={profile.displayName}
                        onChange={(e) => setProfile({ ...profile, displayName: e.target.value })}
                        className="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 font-bold text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all"
                    />
                </div>
            </section>

            {/* Account Security */}
            <section className="bg-white p-6 rounded-3xl shadow-sm border border-slate-100 space-y-4">
                <div className="flex items-center gap-2 mb-2">
                    <span className="material-symbols-outlined text-slate-400">security</span>
                    <h3 className="font-black text-slate-800">Security</h3>
                </div>

                <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Email Address</label>
                    <input
                        type="email"
                        value={profile.email}
                        disabled
                        className="w-full px-4 py-3 rounded-xl bg-slate-100 border border-slate-200 text-slate-500 font-medium cursor-not-allowed"
                    />
                    <p className="text-[10px] text-slate-400 mt-1 pl-1">Contact support to change email.</p>
                </div>

                <button className="w-full py-3 border border-slate-200 rounded-xl font-bold text-slate-600 hover:bg-slate-50 transition-colors">
                    Change Password
                </button>
            </section>

            {/* Preferences */}
            <section className="bg-white p-6 rounded-3xl shadow-sm border border-slate-100 space-y-4">
                <div className="flex items-center gap-2 mb-2">
                    <span className="material-symbols-outlined text-slate-400">tune</span>
                    <h3 className="font-black text-slate-800">Preferences</h3>
                </div>

                <div className="flex items-center justify-between py-2">
                    <span className="font-medium text-slate-700">Email Notifications</span>
                    <button
                        onClick={() => setProfile({ ...profile, notifications: { ...profile.notifications, email: !profile.notifications.email } })}
                        className={clsx(
                            "w-12 h-7 rounded-full transition-colors relative",
                            profile.notifications.email ? "bg-emerald-500" : "bg-slate-200"
                        )}
                    >
                        <div className={clsx(
                            "h-5 w-5 bg-white rounded-full shadow-sm absolute top-1 transition-all",
                            profile.notifications.email ? "left-6" : "left-1"
                        )} />
                    </button>
                </div>

                <div className="flex items-center justify-between py-2 border-t border-slate-50">
                    <span className="font-medium text-slate-700">WhatsApp Updates</span>
                    <button
                        onClick={() => setProfile({ ...profile, notifications: { ...profile.notifications, whatsapp: !profile.notifications.whatsapp } })}
                        className={clsx(
                            "w-12 h-7 rounded-full transition-colors relative",
                            profile.notifications.whatsapp ? "bg-emerald-500" : "bg-slate-200"
                        )}
                    >
                        <div className={clsx(
                            "h-5 w-5 bg-white rounded-full shadow-sm absolute top-1 transition-all",
                            profile.notifications.whatsapp ? "left-6" : "left-1"
                        )} />
                    </button>
                </div>
            </section>

            {/* Save Button */}
            <div className="sticky bottom-4 z-10">
                <button
                    onClick={handleSave}
                    disabled={isSaving}
                    className="w-full py-4 bg-slate-900 text-white font-black rounded-2xl shadow-xl shadow-slate-300 hover:bg-slate-800 active:scale-95 transition-all flex items-center justify-center gap-2"
                >
                    {isSaving ? (
                        <>
                            <span className="material-symbols-outlined animate-spin">refresh</span>
                            <span>Saving...</span>
                        </>
                    ) : (
                        <>
                            <span className="material-symbols-outlined">save</span>
                            <span>Save Changes</span>
                        </>
                    )}
                </button>
            </div>

            {/* Avatar Selection Modal */}
            {showAvatarModal && (
                <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200" onClick={() => setShowAvatarModal(false)}>
                    <div
                        className="bg-white rounded-3xl w-full max-w-sm p-6 shadow-2xl animate-in zoom-in-95 duration-300"
                        onClick={e => e.stopPropagation()}
                    >
                        <div className="text-center mb-6">
                            <h2 className="text-xl font-black text-slate-900">Choose Your Wibo</h2>
                            <p className="text-slate-500 text-sm">Pick a style that matches your vibe!</p>
                        </div>

                        <div className="grid grid-cols-3 gap-4 mb-6">
                            {wiboAvatars.map(avatar => (
                                <button
                                    key={avatar.id}
                                    onClick={() => {
                                        setProfile({ ...profile, avatarId: avatar.id });
                                        setShowAvatarModal(false);
                                    }}
                                    className={clsx(
                                        "aspect-square rounded-2xl flex flex-col items-center justify-center transition-all p-2 border-2",
                                        profile.avatarId === avatar.id
                                            ? "border-blue-500 bg-blue-50 scale-105 shadow-md"
                                            : "border-transparent hover:bg-slate-50 hover:border-slate-200"
                                    )}
                                >
                                    <div className={clsx("h-12 w-12 rounded-full flex items-center justify-center text-white mb-2 shadow-sm", avatar.color)}>
                                        <span className="material-symbols-outlined">smart_toy</span>
                                    </div>
                                    <span className="text-[10px] font-bold text-slate-600 text-center leading-tight">{avatar.name}</span>
                                </button>
                            ))}
                        </div>

                        <button
                            onClick={() => setShowAvatarModal(false)}
                            className="w-full py-3 bg-slate-100 text-slate-600 font-bold rounded-xl hover:bg-slate-200 transition-colors"
                        >
                            Cancel
                        </button>
                    </div>
                </div>
            )}
        </div>
    );
}
</file>

<file path="src/pages/AthleteLogin.jsx">
// Ø¯Ø§Ø®Ù„ Ø¯Ø§Ù„Ø© handleLogin
const handleLogin = async (e) => {
    e.preventDefault();
    setLoading(true);

    try {
        // 1. Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
        const { data: { user }, error } = await supabase.auth.signInWithPassword({
            email,
            password,
        });

        if (error) throw error;

        // 2. ðŸ›‘ Ù†Ù‚Ø·Ø© Ø§Ù„ØªÙØªÙŠØ´: Ù…ÙŠÙ† Ø¯Ù‡ØŸ
        const { data: profile } = await supabase
            .from('profiles')
            .select('role')
            .eq('id', user.id)
            .single();

        // 3. Ø·Ø±Ø¯ Ø§Ù„Ù…ØªØ·ÙÙ„ÙŠÙ†
        if (profile?.role !== 'athlete') {
            await supabase.auth.signOut(); // Ø§Ø·Ø±Ø¯Ù‡ ÙÙˆØ±Ø§Ù‹
            throw new Error("â›” Access Denied: This portal is for Athletes only. Coaches please use the Staff Access.");
        }

        // 4. Ù„Ùˆ Ø±ÙŠØ§Ø¶ÙŠ Ø¨Ø¬Ø¯ -> Ø§ØªÙØ¶Ù„
        navigate('/athlete');

    } catch (err) {
        setError(err.message);
    } finally {
        setLoading(false);
    }
};
</file>

<file path="src/pages/auth/AcademyWizard.jsx">
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useNavigate, Link } from 'react-router-dom';
import { supabase } from '../../supabaseClient';
import { Trophy, CheckCircle, Loader2, PlayCircle, Star, ArrowRight } from 'lucide-react';

export default function AcademyWizard() {
    const navigate = useNavigate();
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);

    // Form Data
    const [formData, setFormData] = useState({
        firstName: '',
        lastName: '',
        email: '',
        password: '',
        source: '' // "Where did you hear about us?"
    });

    const handleSignUp = async (e) => {
        e.preventDefault();
        setLoading(true);
        setError(null);

        try {
            const { data, error } = await supabase.auth.signUp({
                email: formData.email,
                password: formData.password,
                options: {
                    data: {
                        first_name: formData.firstName,
                        last_name: formData.lastName,
                        referral_source: formData.source
                    }
                }
            });

            if (error) throw error;

            if (data.session) {
                // If auto-logged in, verify profile exists or create it?
                // The previous wizard had a second step for Academy Name. 
                // For this "Let's Go" flow, we might want to redirect to an onboarding 
                // page inside the dashboard or assume defaults.
                // For now, let's create the basic profile and redirect to home (or a setup page).

                // Note: Triggers usually handle profile creation on signup, 
                // but if we need manual profile creation:
                const { error: profileError } = await supabase
                    .from('profiles')
                    .update({
                        role: 'coach', // Default to coach/admin
                        first_name: formData.firstName,
                        last_name: formData.lastName,
                        onboarding_step: 1 // Indicate they need to finish setup
                    })
                    .eq('id', data.user.id);

                // If update fails (e.g. row doesn't exist yet due to race condition), 
                // we might need an insert or rely on DB triggers. 
                // Assuming DB trigger creates the row, update is fine.

                navigate('/coach/home');
            } else {
                alert("Account created! Please check your email to confirm.");
            }

        } catch (err) {
            console.error("Sign Up Error:", err);
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="min-h-screen flex font-sans bg-white selection:bg-emerald-100">

            {/* --- LEFT SIDE (VISUAL) 50% --- */}
            <div className="hidden lg:flex w-1/2 bg-slate-900 relative overflow-hidden items-center justify-center p-12 text-center">
                {/* Background Image / Gradient */}
                <div className="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1517466787929-bc90951d6dbb?blur=80&q=80')] bg-cover bg-center opacity-40 mix-blend-overlay"></div>
                <div className="absolute inset-0 bg-gradient-to-br from-emerald-900/90 to-slate-900/90"></div>

                <div className="relative z-10 max-w-xl">
                    <div className="inline-flex items-center gap-2 bg-white/10 backdrop-blur-md border border-white/20 px-4 py-1.5 rounded-full text-emerald-300 text-xs font-bold uppercase tracking-widest mb-8">
                        <Star className="w-3 h-3 fill-emerald-300" />
                        Trust the Process
                    </div>

                    <h1 className="text-5xl font-black text-white tracking-tight leading-[1.1] mb-6">
                        "A small step for you, a giant leap for your academy."
                    </h1>

                    <div className="flex flex-col gap-4 text-slate-300 text-lg font-medium">
                        <div className="flex items-center justify-center gap-2">
                            <CheckCircle className="w-5 h-5 text-emerald-500" />
                            <span>Automated Billing & Payments</span>
                        </div>
                        <div className="flex items-center justify-center gap-2">
                            <CheckCircle className="w-5 h-5 text-emerald-500" />
                            <span>Professional Player Evaluations</span>
                        </div>
                        <div className="flex items-center justify-center gap-2">
                            <CheckCircle className="w-5 h-5 text-emerald-500" />
                            <span>Parent Communication Hub</span>
                        </div>
                    </div>
                </div>

                {/* Decorative Circles */}
                <div className="absolute top-10 left-10 w-32 h-32 bg-emerald-500/20 rounded-full blur-3xl"></div>
                <div className="absolute bottom-10 right-10 w-64 h-64 bg-blue-500/20 rounded-full blur-3xl"></div>
            </div>

            {/* --- RIGHT SIDE (FORM) 50% --- */}
            <div className="w-full lg:w-1/2 flex flex-col items-center justify-center p-6 md:p-12 lg:p-24 bg-white relative">

                {/* Mobile Header (Only visible on small screens) */}
                <div className="lg:hidden w-full mb-8 flex items-center gap-2">
                    <div className="bg-emerald-600 rounded-lg p-1.5">
                        <Trophy className="w-5 h-5 text-white" />
                    </div>
                    <span className="font-bold text-xl text-slate-900">Wild Robot</span>
                </div>

                <div className="w-full max-w-md space-y-8">
                    <div className="text-center lg:text-left">
                        <h2 className="text-3xl font-black text-slate-900 mb-2">Get started for free.</h2>
                        <p className="text-slate-500">No credit card required. 14-day free trial.</p>
                    </div>

                    <form onSubmit={handleSignUp} className="space-y-5">

                        {/* Row: First & Last Name */}
                        <div className="grid grid-cols-2 gap-4">
                            <div className="space-y-1.5">
                                <label className="text-xs font-bold text-slate-500 uppercase tracking-wider">First Name</label>
                                <input
                                    type="text"
                                    value={formData.firstName}
                                    onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}
                                    className="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-medium"
                                    placeholder="John"
                                    required
                                />
                            </div>
                            <div className="space-y-1.5">
                                <label className="text-xs font-bold text-slate-500 uppercase tracking-wider">Last Name</label>
                                <input
                                    type="text"
                                    value={formData.lastName}
                                    onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}
                                    className="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-medium"
                                    placeholder="Doe"
                                    required
                                />
                            </div>
                        </div>

                        {/* Email */}
                        <div className="space-y-1.5">
                            <label className="text-xs font-bold text-slate-500 uppercase tracking-wider">Business Email</label>
                            <input
                                type="email"
                                value={formData.email}
                                onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                                className="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-medium"
                                placeholder="coach@academy.com"
                                required
                            />
                        </div>

                        {/* Password */}
                        <div className="space-y-1.5">
                            <label className="text-xs font-bold text-slate-500 uppercase tracking-wider">Create Password</label>
                            <input
                                type="password"
                                value={formData.password}
                                onChange={(e) => setFormData({ ...formData, password: e.target.value })}
                                className="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-medium"
                                placeholder="Min. 8 characters"
                                minLength={8}
                                required
                            />
                        </div>

                        {/* Dropdown: Source */}
                        <div className="space-y-1.5">
                            <label className="text-xs font-bold text-slate-500 uppercase tracking-wider">Where did you hear about us?</label>
                            <div className="relative">
                                <select
                                    value={formData.source}
                                    onChange={(e) => setFormData({ ...formData, source: e.target.value })}
                                    className="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all appearance-none font-medium text-slate-700"
                                    required
                                >
                                    <option value="" disabled>Select an option</option>
                                    <option value="Google">Google Search</option>
                                    <option value="Social Media">Social Media (Instagram/Facebook)</option>
                                    <option value="Referral">Friend / Colleague</option>
                                    <option value="Advertisement">Advertisement</option>
                                    <option value="Other">Other</option>
                                </select>
                                <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400">
                                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7"></path></svg>
                                </div>
                            </div>
                        </div>

                        {error && (
                            <div className="p-3 bg-red-50 text-red-600 text-sm font-bold rounded-lg flex items-center gap-2">
                                <span className="w-1.5 h-1.5 rounded-full bg-red-500"></span>
                                {error}
                            </div>
                        )}

                        <button
                            type="submit"
                            disabled={loading}
                            className="w-full py-4 mt-2 bg-emerald-600 hover:bg-emerald-500 text-white font-black text-lg rounded-xl shadow-xl shadow-emerald-200 transition-all transform active:scale-[0.98] flex items-center justify-center gap-2 uppercase tracking-wide"
                        >
                            {loading ? <Loader2 className="animate-spin" /> : "LET'S GO"}
                            {!loading && <ArrowRight className="w-5 h-5" />}
                        </button>

                        <p className="text-xs text-slate-400 text-center leading-relaxed">
                            By clicking "Let's Go", you agree to our <a href="#" className="underline hover:text-emerald-600">Terms of Service</a> and <a href="#" className="underline hover:text-emerald-600">Privacy Policy</a>.
                        </p>
                    </form>

                    <div className="text-center pt-8 border-t border-slate-100">
                        <p className="text-slate-500 font-medium">
                            Already have an account? <Link to="/login" className="text-emerald-600 font-bold hover:underline">Log in</Link>
                        </p>
                    </div>
                </div>
            </div>

            {/* Top Right Logo (Desktop) */}
            <div className="hidden lg:flex absolute top-8 right-8 items-center gap-2 cursor-pointer opacity-50 hover:opacity-100 transition-opacity" onClick={() => navigate('/')}>
                <div className="bg-emerald-600 rounded-lg p-1.5">
                    <Trophy className="w-4 h-4 text-white" />
                </div>
                <span className="font-bold text-lg text-slate-900">Wild Robot</span>
            </div>

        </div>
    );
}
</file>

<file path="src/pages/auth/AuthCallback.jsx">
import React, { useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { supabase } from '../../supabaseClient';

const AuthCallback = () => {
    const navigate = useNavigate();

    useEffect(() => {
        // The magic happens here. Supabase SDK automatically parses the hash from the URL
        // and establishes the session in local storage.
        // We just need to wait for it and then redirect.

        const handleAuth = async () => {
            const { data: { session }, error } = await supabase.auth.getSession();

            if (error) {
                console.error("Callback Error:", error);
                navigate('/login');
                return;
            }

            if (session) {
                // Check if this is a "Password Recovery" or "Invite" flow
                // Usually indicated by type=recovery or type=invite in the URL, 
                // but simpler to just check if the user needs setup.
                navigate('/auth/setup-account');
            } else {
                // Fallback
                navigate('/login');
            }
        };

        handleAuth();
    }, [navigate]);

    return (
        <div className="min-h-screen flex items-center justify-center bg-slate-50">
            <div className="text-center">
                <div className="w-12 h-12 border-4 border-slate-200 border-t-emerald-500 rounded-full animate-spin mx-auto mb-4"></div>
                <p className="font-bold text-slate-500">Verifying Ticket...</p>
            </div>
        </div>
    );
};

export default AuthCallback;
</file>

<file path="src/pages/auth/FakeCheckout.jsx">
import React, { useState } from 'react';
import { useNavigate, useSearchParams } from 'react-router-dom';
import { supabase } from '../../supabaseClient';

export default function FakeCheckout() {
    const [searchParams] = useSearchParams();
    const plan = searchParams.get('plan') || 'freelance';
    const navigate = useNavigate();

    const [loading, setLoading] = useState(false);
    const [formData, setFormData] = useState({ email: '', password: '', name: '' });

    const handleFakePayment = async (e) => {
        e.preventDefault();
        setLoading(true);

        // 1. Simulate Payment Delay (Makes it feel real) â³
        await new Promise(resolve => setTimeout(resolve, 2000));

        // 2. Real Registration Logic ðŸŸ¢
        try {
            const { data, error } = await supabase.auth.signUp({
                email: formData.email,
                password: formData.password,
                options: {
                    data: {
                        full_name: formData.name,
                        // ðŸ§  SMART LOGIC: Freelance -> Coach | Business -> Super Admin
                        role: plan === 'business' ? 'super_admin' : 'coach',
                        subscription_status: 'active'
                    }
                }
            });

            if (error) throw error;

            // 3. Success! Redirect based on role
            alert(`ðŸŽ‰ Payment Successful! Welcome, ${plan === 'business' ? 'Boss' : 'Captain'}!`);
            navigate(plan === 'business' ? '/coach/staff' : '/coach/schedule');

        } catch (err) {
            alert("âš ï¸ Error: " + err.message);
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="min-h-screen bg-slate-900 flex items-center justify-center p-4 font-inter">
            <div className="bg-white rounded-3xl overflow-hidden max-w-md w-full shadow-2xl flex flex-col">
                {/* Header */}
                <div className="bg-emerald-500 p-6 text-white text-center relative overflow-hidden">
                    <div className="absolute top-0 left-0 w-full h-full bg-white/10 opacity-50 skew-y-6 transform origin-bottom-left"></div>
                    <span className="material-symbols-outlined text-5xl mb-2 relative z-10">lock</span>
                    <h2 className="text-xl font-bold relative z-10">Secure Checkout (Test Mode)</h2>
                    <p className="text-emerald-100 text-xs uppercase tracking-widest font-bold mt-1 relative z-10">Plan: {plan}</p>
                </div>

                {/* Form */}
                <form onSubmit={handleFakePayment} className="p-8 space-y-4">
                    <div>
                        <label className="block text-xs font-bold text-slate-400 uppercase mb-1">Full Name</label>
                        <input required type="text" onChange={e => setFormData({ ...formData, name: e.target.value })} className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 font-bold text-slate-800 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all" placeholder="e.g. Captain John" />
                    </div>
                    <div>
                        <label className="block text-xs font-bold text-slate-400 uppercase mb-1">Email</label>
                        <input required type="email" onChange={e => setFormData({ ...formData, email: e.target.value })} className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 font-bold text-slate-800 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all" placeholder="coach@example.com" />
                    </div>
                    <div>
                        <label className="block text-xs font-bold text-slate-400 uppercase mb-1">Password</label>
                        <input required type="password" onChange={e => setFormData({ ...formData, password: e.target.value })} className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 font-bold text-slate-800 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
                    </div>

                    {/* Fake Card UI */}
                    <div className="p-4 bg-slate-50 rounded-xl border border-slate-200 mt-4 opacity-70 select-none">
                        <div className="flex justify-between items-center mb-2">
                            <span className="text-[10px] font-bold text-slate-400 tracking-widest">CREDIT CARD</span>
                            <div className="flex gap-1">
                                <div className="w-6 h-4 bg-red-400 rounded-sm"></div>
                                <div className="w-6 h-4 bg-yellow-400 rounded-sm"></div>
                            </div>
                        </div>
                        <div className="font-mono text-slate-400 text-sm mb-2 tracking-widest">4242 4242 4242 4242</div>
                        <div className="flex gap-4 font-mono text-xs text-slate-400">
                            <span>12/28</span>
                            <span>123</span>
                        </div>
                    </div>

                    <button
                        type="submit"
                        disabled={loading}
                        className="w-full bg-slate-900 text-white py-4 rounded-xl font-bold text-lg hover:bg-slate-800 transition-all flex items-center justify-center gap-2 mt-4 shadow-lg shadow-slate-300 disabled:opacity-70 disabled:cursor-not-allowed"
                    >
                        {loading ? <div className="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> : `Pay & Join Now`}
                    </button>

                    <p className="text-[10px] text-center text-slate-400 mt-2">
                        *Test Mode: No real payment required.
                    </p>
                </form>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/auth/MobileLogin.jsx">
import React, { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { supabase } from '../../supabaseClient';
import { motion, AnimatePresence } from 'framer-motion';

export default function MobileLogin() {
    const navigate = useNavigate();
    const [step, setStep] = useState(1); // 1: Phone, 2: OTP
    const [phone, setPhone] = useState('');
    const [otp, setOtp] = useState('');
    const [loading, setLoading] = useState(false);

    // Step 1: Send OTP
    const handleSendOtp = async (e) => {
        e.preventDefault();
        setLoading(true);
        try {
            // Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø© Ù„Ùˆ Ù…Ø´ Ù…ÙƒØªÙˆØ¨ (Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª +971)
            const formattedPhone = phone.startsWith('+') ? phone : `+971${phone.replace(/^0+/, '')}`;

            const { error } = await supabase.auth.signInWithOtp({
                phone: formattedPhone,
            });
            if (error) throw error;

            setStep(2); // Move to verify step
        } catch (error) {
            alert(error.message);
        } finally {
            setLoading(false);
        }
    };

    // Step 2: Verify OTP
    const handleVerifyOtp = async (e) => {
        e.preventDefault();
        setLoading(true);
        try {
            const formattedPhone = phone.startsWith('+') ? phone : `+971${phone.replace(/^0+/, '')}`;

            const { data: { session, user }, error } = await supabase.auth.verifyOtp({
                phone: formattedPhone,
                token: otp,
                type: 'sms',
            });

            if (error) throw error;

            // ðŸ›‘ Check Role immediately
            const { data: profile } = await supabase.from('profiles').select('role').eq('id', user.id).single();

            if (profile?.role === 'athlete') {
                navigate('/athlete');
            } else if (profile?.role === 'coach' || profile?.role === 'super_admin') {
                navigate('/coach/home');
            } else {
                // New User? Route to onboarding or default
                navigate('/athlete');
            }

        } catch (error) {
            alert('Invalid Code. Try again.');
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="min-h-screen bg-white flex items-center justify-center p-4 font-inter">
            <div className="w-full max-w-md">
                {/* Logo Area */}
                <div className="text-center mb-8">
                    <div className="w-16 h-16 bg-blue-600 rounded-2xl mx-auto flex items-center justify-center mb-4 shadow-xl shadow-blue-200">
                        <span className="material-symbols-outlined text-white text-3xl">smartphone</span>
                    </div>
                    <h1 className="text-2xl font-black text-slate-900">Welcome Back</h1>
                    <p className="text-slate-500">Log in with your mobile number</p>
                </div>

                <div className="bg-white p-8 rounded-3xl border border-slate-100 shadow-2xl">
                    <AnimatePresence mode="wait">
                        {step === 1 ? (
                            <motion.form
                                key="step1"
                                initial={{ x: -20, opacity: 0 }}
                                animate={{ x: 0, opacity: 1 }}
                                exit={{ x: 20, opacity: 0 }}
                                onSubmit={handleSendOtp}
                                className="space-y-6"
                            >
                                <div>
                                    <label className="block text-xs font-bold text-slate-400 uppercase mb-2">Mobile Number</label>
                                    <div className="flex gap-2">
                                        <span className="bg-slate-50 border border-slate-200 rounded-xl px-3 py-3 font-bold text-slate-500 flex items-center">ðŸ‡¦ðŸ‡ª +971</span>
                                        <input
                                            type="tel"
                                            value={phone}
                                            onChange={(e) => setPhone(e.target.value)}
                                            className="flex-1 bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 font-bold text-slate-900 focus:ring-2 focus:ring-blue-500 outline-none"
                                            placeholder="50 123 4567"
                                            autoFocus
                                        />
                                    </div>
                                </div>
                                <button disabled={loading} className="w-full bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold transition-all shadow-lg shadow-blue-200 flex justify-center">
                                    {loading ? <span className="animate-spin material-symbols-outlined">progress_activity</span> : "Send Code"}
                                </button>
                            </motion.form>
                        ) : (
                            <motion.form
                                key="step2"
                                initial={{ x: 20, opacity: 0 }}
                                animate={{ x: 0, opacity: 1 }}
                                exit={{ x: -20, opacity: 0 }}
                                onSubmit={handleVerifyOtp}
                                className="space-y-6"
                            >
                                <div className="text-center">
                                    <p className="text-sm text-slate-500 mb-4">Enter the code sent to <span className="font-bold text-slate-900">+971 {phone}</span></p>
                                    <div className="flex justify-center gap-2">
                                        <input
                                            type="text"
                                            value={otp}
                                            onChange={(e) => setOtp(e.target.value)}
                                            className="w-full text-center bg-slate-50 border border-slate-200 rounded-xl px-4 py-4 font-black text-2xl tracking-widest text-slate-900 focus:ring-2 focus:ring-blue-500 outline-none"
                                            placeholder="â€¢ â€¢ â€¢ â€¢ â€¢ â€¢"
                                            maxLength={6}
                                            autoFocus
                                        />
                                    </div>
                                </div>
                                <button disabled={loading} className="w-full bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold transition-all shadow-lg shadow-blue-200 flex justify-center">
                                    {loading ? <span className="animate-spin material-symbols-outlined">progress_activity</span> : "Verify & Login"}
                                </button>
                                <button type="button" onClick={() => setStep(1)} className="w-full text-slate-400 text-sm font-bold hover:text-slate-600">
                                    Wrong number? Go back
                                </button>
                            </motion.form>
                        )}
                    </AnimatePresence>
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/auth/Pricing.jsx">
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useNavigate } from 'react-router-dom';
import { Check, X, Trophy, Briefcase, Calculator } from 'lucide-react'; // Using Lucide as it is installed

export default function Pricing() {
    const navigate = useNavigate();
    const [billingCycle, setBillingCycle] = useState('yearly'); // 'monthly' or 'yearly'
    const [activeHub, setActiveHub] = useState('coaching'); // 'coaching' or 'management'

    // The "Math" Logic: 18% discount for yearly
    const calculatePrice = (basePrice) => {
        if (basePrice === 0) return 0;
        return billingCycle === 'yearly' ? Math.round(basePrice * 0.82) : basePrice;
    };

    const plans = [
        {
            name: "Starter",
            description: "Perfect for new independent coaches.",
            price: 0,
            features: {
                coaching: ["Up to 10 Athletes", "Basic Scheduling", "Attendance Tracking", "Mobile App Access"],
                management: ["Basic Revenue Tracking", "1 Staff Member", "Simple Reports"]
            },
            color: "bg-slate-50 text-slate-900 border-slate-200",
            buttonColor: "bg-white border-2 border-slate-200 text-slate-700 hover:bg-slate-50",
            popular: false
        },
        {
            name: "Pro",
            description: "For growing academies needing automation.",
            price: 29, // $29 monthly base
            features: {
                coaching: ["Up to 50 Athletes", "Video Analysis", "Performance Evals", "Parent Portal"],
                management: ["Automated Invoicing", "Up to 5 Staff", "Payroll Integration", "Custom Branding"]
            },
            color: "bg-white text-slate-900 ring-2 ring-blue-600 shadow-xl", // Highlighted
            buttonColor: "bg-blue-600 text-white hover:bg-blue-700 shadow-lg shadow-blue-200",
            popular: true
        },
        {
            name: "Elite",
            description: "Full control for large competitive clubs.",
            price: 99,
            features: {
                coaching: ["Unlimited Athletes", "Advanced Analytics", "Tournament Planner", "Live Streaming Support"],
                management: ["Advanced Financials", "Unlimited Staff", "Multi-Branch Support", "Dedicated Success Manager"]
            },
            color: "bg-slate-900 text-white border-slate-800",
            buttonColor: "bg-white text-slate-900 hover:bg-slate-100",
            popular: false
        }
    ];

    return (
        <div className="min-h-screen bg-white font-sans selection:bg-blue-100">
            {/* --- HEADER --- */}
            <div className="text-center pt-20 pb-12 px-4">
                <motion.div
                    initial={{ opacity: 0, y: -20 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ duration: 0.5 }}
                >
                    <h1 className="text-4xl md:text-6xl font-black text-slate-900 mb-6 tracking-tight">
                        Pricing that grows <br className="hidden md:block" />
                        <span className="text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600">
                            with your ambition.
                        </span>
                    </h1>
                    <p className="text-slate-500 text-lg md:text-xl max-w-2xl mx-auto leading-relaxed">
                        Start for free, upgrade when you win. No hidden fees. <br />
                        <span className="font-semibold text-slate-900">14-day free trial on all paid plans.</span>
                    </p>
                </motion.div>
            </div>

            {/* --- CONTROLS SECTION --- */}
            <div className="sticky top-0 z-30 bg-white/80 backdrop-blur-md py-4 border-b border-slate-100 mb-12">
                <div className="max-w-4xl mx-auto px-4 flex flex-col md:flex-row items-center justify-between gap-6">

                    {/* HUB SWITCHER (Coaching vs Management) */}
                    <div className="flex bg-slate-100 p-1 rounded-xl">
                        <button
                            onClick={() => setActiveHub('coaching')}
                            className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${activeHub === 'coaching'
                                    ? 'bg-white text-blue-600 shadow-sm'
                                    : 'text-slate-500 hover:text-slate-700'
                                }`}
                        >
                            <Trophy className="w-4 h-4" />
                            Coaching Hub
                        </button>
                        <button
                            onClick={() => setActiveHub('management')}
                            className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${activeHub === 'management'
                                    ? 'bg-white text-indigo-600 shadow-sm'
                                    : 'text-slate-500 hover:text-slate-700'
                                }`}
                        >
                            <Briefcase className="w-4 h-4" />
                            Management Hub
                        </button>
                    </div>

                    {/* BILLING TOGGLE */}
                    <div className="flex items-center gap-3">
                        <span className={`text-sm font-bold ${billingCycle === 'monthly' ? 'text-slate-900' : 'text-slate-400'}`}>Monthly</span>
                        <button
                            onClick={() => setBillingCycle(prev => prev === 'monthly' ? 'yearly' : 'monthly')}
                            className={`relative w-14 h-8 rounded-full transition-colors ${billingCycle === 'yearly' ? 'bg-indigo-600' : 'bg-slate-300'}`}
                        >
                            <motion.div
                                layout
                                className="absolute top-1 left-1 bg-white w-6 h-6 rounded-full shadow-md"
                                animate={{ x: billingCycle === 'yearly' ? 24 : 0 }}
                            />
                        </button>
                        <span className={`text-sm font-bold flex items-center gap-1 ${billingCycle === 'yearly' ? 'text-slate-900' : 'text-slate-400'}`}>
                            Yearly
                            <span className="bg-emerald-100 text-emerald-700 text-[10px] px-2 py-0.5 rounded-full font-black uppercase tracking-wider">
                                -18%
                            </span>
                        </span>
                    </div>
                </div>
            </div>

            {/* --- PRICING CARDS --- */}
            <div className="max-w-7xl mx-auto px-4 pb-24 grid grid-cols-1 md:grid-cols-3 gap-8 items-stretch">
                {plans.map((plan, index) => (
                    <motion.div
                        key={plan.name}
                        initial={{ opacity: 0, y: 20 }}
                        animate={{ opacity: 1, y: 0 }}
                        transition={{ delay: index * 0.1 }}
                        className={`relative rounded-3xl p-8 flex flex-col ${plan.color} ${plan.popular ? 'z-10 transform md:-translate-y-4' : 'border'}`}
                    >
                        {plan.popular && (
                            <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-blue-600 text-white px-6 py-1.5 rounded-full text-xs font-black uppercase tracking-widest shadow-lg border-4 border-white">
                                Most Popular
                            </div>
                        )}

                        <div className="mb-8">
                            <h3 className="text-xl font-bold mb-2">{plan.name}</h3>
                            <p className={`text-sm leading-relaxed opacity-80 h-10`}>{plan.description}</p>
                        </div>

                        {/* PRICE DISPLAY */}
                        <div className="mb-8 pl-2 border-l-4 border-current/20">
                            <div className="flex items-end gap-2">
                                {/* Strikethrough Logic */}
                                {billingCycle === 'yearly' && plan.price > 0 && (
                                    <span className="text-xl line-through decoration-red-500 decoration-2 opacity-50 font-bold mb-1">
                                        ${plan.price}
                                    </span>
                                )}
                                <span className="text-5xl font-black tracking-tight">
                                    ${calculatePrice(plan.price)}
                                </span>
                            </div>
                            <span className="text-sm font-bold opacity-60 block mt-1">
                                per seat / month
                                {billingCycle === 'yearly' && ' (billed annually)'}
                            </span>
                        </div>

                        {/* CTA BUTTON */}
                        <button
                            onClick={() => navigate('/setup')}
                            className={`w-full py-4 rounded-xl font-bold mb-8 transition-transform active:scale-95 text-sm uppercase tracking-wide flex items-center justify-center gap-2 ${plan.buttonColor}`}
                        >
                            Start Free Trial
                            <motion.span animate={{ x: [0, 5, 0] }} transition={{ repeat: Infinity, duration: 1.5 }}>â†’</motion.span>
                        </button>

                        {/* FEATURES LIST */}
                        <div className="space-y-4 flex-1">
                            <p className="text-xs font-bold uppercase opacity-60 tracking-wider mb-4 border-b border-current/10 pb-2">
                                What's included in {activeHub}:
                            </p>

                            <AnimatePresence mode='wait'>
                                <motion.div
                                    key={activeHub}
                                    initial={{ opacity: 0, x: -10 }}
                                    animate={{ opacity: 1, x: 0 }}
                                    exit={{ opacity: 0, x: 10 }}
                                    transition={{ duration: 0.2 }}
                                    className="space-y-3"
                                >
                                    {(activeHub === 'coaching' ? plan.features.coaching : plan.features.management).map((feature, i) => (
                                        <div key={i} className="flex items-start gap-3">
                                            <div className={`p-1 rounded-full ${plan.popular ? 'bg-blue-100 text-blue-700' : 'bg-slate-200 text-slate-700'}`}>
                                                <Check className="w-3 h-3" strokeWidth={3} />
                                            </div>
                                            <span className="text-sm font-medium opacity-90">{feature}</span>
                                        </div>
                                    ))}
                                </motion.div>
                            </AnimatePresence>
                        </div>
                    </motion.div>
                ))}
            </div>

            {/* TRUST INDICATORS */}
            <div className="bg-slate-50 py-16 border-t border-slate-200">
                <div className="max-w-5xl mx-auto px-4 text-center">
                    <p className="text-sm font-bold text-slate-400 mb-8 tracking-widest uppercase">Trusted by 500+ top academies</p>
                    <div className="flex flex-wrap justify-center gap-12 opacity-40 grayscale mix-blend-multiply">
                        {/* Placeholder Company Logos */}
                        {['ACME Sport', 'Elite Training', 'Global Soccer', 'Pro Tennis', 'Jump Start'].map(company => (
                            <span key={company} className="text-xl font-black text-slate-800">{company}</span>
                        ))}
                    </div>
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/auth/SetupAccount.jsx">
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { supabase } from '../../supabaseClient';
import { Lock, User, ArrowRight, ShieldCheck } from 'lucide-react';
import { toast } from 'sonner';

const SetupAccount = () => {
    const navigate = useNavigate();
    const [loading, setLoading] = useState(true);
    const [submitting, setSubmitting] = useState(false);

    const [formData, setFormData] = useState({
        firstName: '',
        lastName: '',
        password: '',
        confirmPassword: ''
    });

    useEffect(() => {
        const checkSession = async () => {
            const { data: { session } } = await supabase.auth.getSession();
            if (!session) {
                navigate('/login');
                return;
            }

            // Check if already setup
            const { data: profile } = await supabase
                .from('profiles')
                .select('setup_completed, role')
                .eq('id', session.user.id)
                .single();

            if (profile?.setup_completed) {
                toast.info("Account already setup. Redirecting...");
                navigate(profile.role === 'owner' ? '/owner/dashboard' : '/coach/home');
            } else {
                setLoading(false);
            }
        };
        checkSession();
    }, []);

    const handleSubmit = async (e) => {
        e.preventDefault();
        if (formData.password !== formData.confirmPassword) {
            toast.error("Passwords do not match!");
            return;
        }
        if (formData.password.length < 6) {
            toast.error("Password must be at least 6 characters.");
            return;
        }

        setSubmitting(true);
        const toastId = toast.loading("Securing your account...");

        try {
            // 1. Update Authentication Password
            const { error: authError } = await supabase.auth.updateUser({
                password: formData.password
            });
            if (authError) throw authError;

            const { data: { user } } = await supabase.auth.getUser();

            // 2. Update Profile
            const { error: profileError } = await supabase
                .from('profiles')
                .update({
                    first_name: formData.firstName,
                    last_name: formData.lastName,
                    setup_completed: true
                })
                .eq('id', user.id);

            if (profileError) throw profileError;

            toast.success("Welcome aboard, Commander!", { id: toastId });

            // 3. Redirect based on role
            // We fetch role again to be safe
            const { data: profile } = await supabase.from('profiles').select('role').eq('id', user.id).single();
            const target = profile?.role === 'owner' ? '/owner/dashboard' : '/coach'; // Simplified coach route for now

            // Artificial delay for UX
            setTimeout(() => {
                navigate(target);
            }, 1000);

        } catch (err) {
            console.error("Setup Error:", err);
            toast.error(err.message, { id: toastId });
        } finally {
            setSubmitting(false);
        }
    };

    if (loading) return null;

    return (
        <div className="min-h-screen bg-slate-50 flex items-center justify-center p-4">
            <div className="w-full max-w-md bg-white rounded-3xl shadow-xl border border-slate-100 overflow-hidden">
                <div className="bg-emerald-500 p-8 text-center">
                    <div className="w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-4 text-white backdrop-blur-sm">
                        <ShieldCheck className="w-8 h-8" />
                    </div>
                    <h1 className="text-2xl font-black text-white">Welcome to Wild Robot</h1>
                    <p className="text-emerald-100 font-medium">Let's secure your account.</p>
                </div>

                <form onSubmit={handleSubmit} className="p-8 space-y-6">
                    <div className="grid grid-cols-2 gap-4">
                        <div>
                            <label className="block text-xs font-bold text-slate-400 uppercase mb-1">First Name</label>
                            <input
                                required
                                value={formData.firstName}
                                onChange={e => setFormData({ ...formData, firstName: e.target.value })}
                                className="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:border-emerald-500 outline-none font-bold text-slate-800"
                                placeholder="John"
                            />
                        </div>
                        <div>
                            <label className="block text-xs font-bold text-slate-400 uppercase mb-1">Last Name</label>
                            <input
                                required
                                value={formData.lastName}
                                onChange={e => setFormData({ ...formData, lastName: e.target.value })}
                                className="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:border-emerald-500 outline-none font-bold text-slate-800"
                                placeholder="Doe"
                            />
                        </div>
                    </div>

                    <div>
                        <label className="block text-xs font-bold text-slate-400 uppercase mb-1">Create New Password</label>
                        <div className="relative">
                            <Lock className="absolute left-3 top-3 w-5 h-5 text-slate-300" />
                            <input
                                type="password"
                                required
                                value={formData.password}
                                onChange={e => setFormData({ ...formData, password: e.target.value })}
                                className="w-full pl-10 p-3 bg-slate-50 border border-slate-200 rounded-xl focus:border-emerald-500 outline-none font-bold text-slate-800"
                                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                            />
                        </div>
                    </div>

                    <div>
                        <label className="block text-xs font-bold text-slate-400 uppercase mb-1">Confirm Password</label>
                        <div className="relative">
                            <Lock className="absolute left-3 top-3 w-5 h-5 text-slate-300" />
                            <input
                                type="password"
                                required
                                value={formData.confirmPassword}
                                onChange={e => setFormData({ ...formData, confirmPassword: e.target.value })}
                                className="w-full pl-10 p-3 bg-slate-50 border border-slate-200 rounded-xl focus:border-emerald-500 outline-none font-bold text-slate-800"
                                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                            />
                        </div>
                    </div>

                    <button
                        type="submit"
                        disabled={submitting}
                        className="w-full bg-slate-900 text-white py-4 rounded-xl font-bold hover:bg-slate-800 shadow-lg shadow-slate-900/20 active:scale-95 transition-all flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed"
                    >
                        {submitting ? 'Setting up...' : 'Complete Setup'}
                        <ArrowRight className="w-5 h-5" />
                    </button>
                </form>
            </div>
        </div>
    );
};

export default SetupAccount;
</file>

<file path="src/pages/Chat.jsx">
import React, { useState } from 'react';
import clsx from 'clsx';

// Mock Data
const MOCK_CHATS = [
    { id: 1, name: 'Coach Sarah', message: 'See you at practice!', time: '10:30 AM', unread: 2, status: 'online', avatar: 'S' },
    { id: 2, name: 'Admin Office', message: 'Invoice #1024 is ready.', time: 'Yesterday', unread: 0, status: 'offline', avatar: 'A' },
    { id: 3, name: 'Ajman Team', message: 'Great job everyone!', time: 'Tue', unread: 0, status: 'online', avatar: 'T' },
];

export default function Chat() {
    const [selectedChat, setSelectedChat] = useState(MOCK_CHATS[0]);
    const [mobileView, setMobileView] = useState('list'); // 'list' or 'thread'

    return (
        <div className="h-screen bg-white flex overflow-hidden">
            {/* Sidebar (List) */}
            <div className={clsx(
                "w-full md:w-4/12 lg:w-3/12 flex flex-col border-r border-gray-100 bg-white z-10 transition-transform",
                mobileView === 'thread' ? "hidden md:flex" : "flex"
            )}>
                {/* Header */}
                <div className="p-4 border-b border-gray-100 sticky top-0 bg-white z-20">
                    <div className="flex justify-between items-center mb-4">
                        <h1 className="text-2xl font-black text-slate-900 tracking-tight">Messages</h1>
                        <button className="flex items-center gap-1 text-emerald-600 text-xs font-bold hover:bg-emerald-50 px-2 py-1 rounded-lg transition-colors">
                            <span className="material-symbols-outlined text-[16px]">campaign</span>
                            Broadcast
                        </button>
                    </div>
                    <div className="relative">
                        <span className="material-symbols-outlined absolute left-3 top-2.5 text-slate-400 text-[18px]">search</span>
                        <input
                            type="text"
                            placeholder="Search messages..."
                            className="w-full pl-9 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500"
                        />
                    </div>
                </div>

                {/* List */}
                <div className="flex-1 overflow-y-auto">
                    {MOCK_CHATS.map(chat => (
                        <button
                            key={chat.id}
                            onClick={() => {
                                setSelectedChat(chat);
                                setMobileView('thread');
                            }}
                            className={clsx(
                                "w-full flex items-center gap-3 p-4 border-b border-gray-50 hover:bg-gray-50 transition-colors text-left relative",
                                selectedChat?.id === chat.id && "bg-emerald-50/50 border-r-4 border-r-emerald-500"
                            )}
                        >
                            <div className="relative">
                                <div className="h-12 w-12 rounded-full bg-slate-100 flex items-center justify-center font-bold text-slate-600">
                                    {chat.avatar}
                                </div>
                                {chat.status === 'online' && (
                                    <div className="absolute bottom-0 right-0 h-3 w-3 bg-emerald-500 border-2 border-white rounded-full"></div>
                                )}
                            </div>
                            <div className="flex-1 min-w-0">
                                <div className="flex justify-between items-baseline mb-0.5">
                                    <h3 className={clsx("text-sm truncate", chat.unread ? "font-bold text-slate-900" : "font-medium text-slate-700")}>
                                        {chat.name}
                                    </h3>
                                    <span className="text-[10px] text-slate-400 font-medium">{chat.time}</span>
                                </div>
                                <p className={clsx("text-xs truncate", chat.unread ? "font-bold text-slate-800" : "text-slate-500")}>
                                    {chat.message}
                                </p>
                            </div>
                            {chat.unread > 0 && (
                                <div className="h-5 w-5 rounded-full bg-emerald-500 text-white text-[10px] font-bold flex items-center justify-center">
                                    {chat.unread}
                                </div>
                            )}
                        </button>
                    ))}
                </div>
            </div>

            {/* Main Thread Area */}
            <div className={clsx(
                "flex-1 flex flex-col bg-gray-50",
                mobileView === 'list' ? "hidden md:flex" : "flex fixed inset-0 z-30 md:static"
            )}>
                {selectedChat ? (
                    <>
                        {/* Thread Header */}
                        <div className="bg-white px-4 py-3 border-b border-gray-100 flex items-center justify-between shadow-sm">
                            <div className="flex items-center gap-3">
                                <button
                                    className="md:hidden p-1 -ml-2 text-slate-500"
                                    onClick={() => setMobileView('list')}
                                >
                                    <span className="material-symbols-outlined">arrow_back</span>
                                </button>
                                <div className="h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center font-bold text-slate-700">
                                    {selectedChat.avatar}
                                </div>
                                <div>
                                    <h2 className="font-bold text-slate-900 text-sm">{selectedChat.name}</h2>
                                    <p className="text-xs text-emerald-500 font-bold flex items-center gap-1">
                                        <span className="h-1.5 w-1.5 rounded-full bg-emerald-500"></span>
                                        Online
                                    </p>
                                </div>
                            </div>
                            <div className="flex gap-2">
                                <button className="h-9 w-9 bg-gray-50 rounded-full flex items-center justify-center text-emerald-600 hover:bg-emerald-50 transition-colors">
                                    <span className="material-symbols-outlined text-[20px]">call</span>
                                </button>
                                <button className="h-9 w-9 bg-gray-50 rounded-full flex items-center justify-center text-slate-400 hover:bg-gray-100 transition-colors">
                                    <span className="material-symbols-outlined text-[20px]">more_vert</span>
                                </button>
                            </div>
                        </div>

                        {/* Messages */}
                        <div className="flex-1 overflow-y-auto p-4 space-y-4">
                            <div className="text-center text-xs text-slate-300 font-bold uppercase tracking-wider my-4">Today</div>

                            {/* Their Message */}
                            <div className="flex items-end gap-2">
                                <div className="h-8 w-8 rounded-full bg-slate-200 flex-shrink-0"></div>
                                <div className="bg-white p-3 rounded-2xl rounded-tl-none shadow-sm max-w-[75%] text-slate-700 text-sm leading-relaxed border border-gray-100">
                                    <p>Hello! Just checking in on the schedule.</p>
                                    <span className="text-[10px] text-slate-300 mt-1 block">10:00 AM</span>
                                </div>
                            </div>

                            {/* My Message */}
                            <div className="flex items-end gap-2 justify-end">
                                <div className="bg-emerald-500 p-3 rounded-2xl rounded-tr-none shadow-md shadow-emerald-200 max-w-[75%] text-white text-sm leading-relaxed">
                                    <p>Hi! Yes, everything is updated in the Master Schedule.</p>
                                    <span className="text-[10px] text-emerald-200 mt-1 block text-right">10:05 AM</span>
                                </div>
                            </div>
                        </div>

                        {/* Input Area */}
                        <div className="p-4 bg-white border-t border-gray-100">
                            <div className="flex items-center gap-2">
                                <button className="p-2 text-slate-400 hover:text-emerald-500 transition-colors">
                                    <span className="material-symbols-outlined">add_circle</span>
                                </button>
                                <input
                                    type="text"
                                    placeholder="Type a message..."
                                    className="flex-1 bg-gray-50 text-slate-900 placeholder-slate-400 px-4 py-3 rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 border-transparent"
                                />
                                <button className="h-11 w-11 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full flex items-center justify-center shadow-lg shadow-emerald-200 transition-all active:scale-95">
                                    <span className="material-symbols-outlined text-[20px] ml-0.5">send</span>
                                </button>
                            </div>
                        </div>
                    </>
                ) : (
                    <div className="flex-1 flex flex-col items-center justify-center text-slate-300 p-8">
                        <span className="material-symbols-outlined text-6xl mb-4">chat_bubble_outline</span>
                        <p className="font-bold text-lg">Select a conversation</p>
                    </div>
                )}
            </div>
        </div>
    );
}
</file>

<file path="src/pages/ChatDetail.jsx">
import React, { useState, useEffect, useRef } from 'react';
import { useNavigate, useParams } from 'react-router-dom';
import { supabase } from '../supabaseClient';
import { formatDistanceToNow } from 'date-fns';
import clsx from 'clsx';

export default function ChatDetail() {
    const navigate = useNavigate();
    const { id } = useParams(); // This could be a Group ID or User ID based on your route
    const [messages, setMessages] = useState([]);
    const [inputText, setInputText] = useState('');
    const [loading, setLoading] = useState(true);
    const [currentUserId, setCurrentUserId] = useState(null);
    const messagesEndRef = useRef(null);

    // 1. Identify "Who am I?" & Fetch Messages
    useEffect(() => {
        const initChat = async () => {
            // Get current user
            const { data: { user } } = await supabase.auth.getUser();
            if (user) setCurrentUserId(user.id);

            fetchMessages();
        };

        initChat();

        // ðŸŸ¢ Real-time Subscription (Magic!)
        const channel = supabase
            .channel('public:messages')
            .on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'messages' }, (payload) => {
                // If the new message belongs to this chat view, add it
                // Note: In a real complex app, filter by chat/group ID. 
                // For now, we show all (Global Chat Logic) or filter if needed.
                const newMsg = payload.new;
                setMessages(prev => [...prev, newMsg]);
            })
            .subscribe();

        return () => {
            supabase.removeChannel(channel);
        };
    }, [id]);

    // Auto-scroll to bottom
    useEffect(() => {
        messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
    }, [messages]);

    async function fetchMessages() {
        try {
            setLoading(true);
            // Fetch messages populated with sender info
            // Note: Supabase JS select with relation requires setup, for speed we fetch plain messages first
            // Or use a join if sender_id foreign key is set up to profiles
            const { data, error } = await supabase
                .from('messages')
                .select(`
                    *,
                    sender:profiles(full_name, avatar_url)
                `)
                .order('created_at', { ascending: true });

            if (error) throw error;
            setMessages(data || []);
        } catch (err) {
            console.error('Error fetching messages:', err);
        } finally {
            setLoading(false);
        }
    }

    const handleSendMessage = async (e) => {
        e.preventDefault();
        if (!inputText.trim() || !currentUserId) return;

        const textToSend = inputText;
        setInputText(''); // Optimistic clear

        try {
            const { error } = await supabase
                .from('messages')
                .insert([
                    {
                        content: textToSend,
                        sender_id: currentUserId,
                        // receiver_id: id // Uncomment if 1-on-1 chat
                    }
                ]);

            if (error) throw error;
            // No need to setMessages manually if Subscription is on, 
            // but for instant feedback you can do it optimistically.
        } catch (err) {
            console.error('Send failed:', err);
            alert('Failed to send message');
        }
    };

    return (
        <div className="flex flex-col h-screen bg-slate-50">
            {/* Header */}
            <header className="bg-white p-4 shadow-sm flex items-center gap-4 sticky top-0 z-10">
                <button onClick={() => navigate(-1)} className="p-2 hover:bg-slate-100 rounded-full transition-colors">
                    <span className="material-symbols-outlined text-slate-600">arrow_back</span>
                </button>
                <div className="flex items-center gap-3">
                    <div className="w-10 h-10 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-600 font-bold">
                        T
                    </div>
                    <div>
                        <h2 className="font-bold text-slate-800">Team Chat</h2>
                        <p className="text-xs text-green-500 flex items-center gap-1">
                            <span className="w-2 h-2 bg-green-500 rounded-full"></span> Online
                        </p>
                    </div>
                </div>
            </header>

            {/* Chat Area */}
            <div className="flex-1 overflow-y-auto p-4 space-y-4">
                {loading ? (
                    <div className="flex justify-center pt-10">
                        <div className="animate-spin h-8 w-8 border-4 border-emerald-500 rounded-full border-t-transparent"></div>
                    </div>
                ) : messages.length === 0 ? (
                    <div className="text-center text-slate-400 mt-10">
                        <p>No messages yet. Say hello! ðŸ‘‹</p>
                    </div>
                ) : (
                    messages.map((msg) => {
                        const isMe = msg.sender_id === currentUserId;
                        return (
                            <div
                                key={msg.id}
                                className={clsx("flex w-full", isMe ? "justify-end" : "justify-start")}
                            >
                                <div className={clsx(
                                    "max-w-[75%] rounded-2xl p-4 shadow-sm relative group transition-all",
                                    isMe
                                        ? "bg-emerald-500 text-white rounded-tr-sm"
                                        : "bg-white text-slate-800 rounded-tl-sm border border-slate-100"
                                )}>
                                    {!isMe && (
                                        <p className="text-[10px] font-bold text-slate-400 mb-1">
                                            {msg.sender?.full_name || 'User'}
                                        </p>
                                    )}
                                    <p className="text-sm leading-relaxed">{msg.content}</p>
                                    <span className={clsx(
                                        "text-[9px] block mt-1 text-right opacity-70",
                                        isMe ? "text-emerald-100" : "text-slate-300"
                                    )}>
                                        {formatDistanceToNow(new Date(msg.created_at), { addSuffix: true })}
                                    </span>
                                </div>
                            </div>
                        );
                    })
                )}
                <div ref={messagesEndRef} />
            </div>

            {/* Input Area */}
            <footer className="p-4 bg-white border-t border-slate-100">
                <form onSubmit={handleSendMessage} className="flex gap-2 max-w-4xl mx-auto">
                    <input
                        type="text"
                        value={inputText}
                        onChange={(e) => setInputText(e.target.value)}
                        placeholder="Type a message..."
                        className="flex-1 bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all"
                    />
                    <button
                        type="submit"
                        disabled={!inputText.trim()}
                        className="bg-emerald-500 text-white p-3 rounded-xl hover:bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg shadow-emerald-200"
                    >
                        <span className="material-symbols-outlined">send</span>
                    </button>
                </form>
            </footer>
        </div>
    );
}
</file>

<file path="src/pages/coach/CoachHome.jsx">
import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useNavigate } from 'react-router-dom';
import {
    Plus, Users, DollarSign, Clock, Calendar,
    UserPlus, ClipboardCheck, MessageSquare, CreditCard,
    Bot, TrendingUp, TrendingDown, Bell, ArrowRight, Shield, X
} from 'lucide-react';
import { supabase } from '../../supabaseClient';
import Modal from '../../components/ui/Modal';
import AddAthleteModal from '../../components/AddAthleteModal';

export default function CoachHome() {
    const navigate = useNavigate();
    const [loading, setLoading] = useState(true);
    const [profile, setProfile] = useState(null);
    const [stats, setStats] = useState({
        activeAthletes: 0,
        monthlyRevenue: 0,
        staffCount: 0,
        todaySessions: 0
    });

    // Modals
    const [showAddAthleteModal, setShowAddAthleteModal] = useState(false);
    const [showAddStaffModal, setShowAddStaffModal] = useState(false);

    useEffect(() => {
        const fetchDashboardData = async () => {
            try {
                // 1. Get User & Profile
                const { data: { user } } = await supabase.auth.getUser();
                if (!user) return;

                let userProfile = null;
                const { data: profileData } = await supabase
                    .from('profiles')
                    .select('first_name, last_name, academy_name')
                    .eq('id', user.id)
                    .single();

                if (profileData) {
                    userProfile = profileData;
                    setProfile(profileData);
                } else {
                    // Fallback
                    userProfile = {
                        first_name: user.user_metadata?.first_name || 'Coach',
                        academy_name: user.user_metadata?.academy_name || 'Wild Robot Academy'
                    };
                    setProfile(userProfile);
                }

                // 2. Fetch Real Counts (if academy_name exists)
                if (userProfile.academy_name) {
                    // Count Athletes
                    const { count: athleteCount } = await supabase
                        .from('profiles')
                        .select('*', { count: 'exact', head: true })
                        .eq('academy_name', userProfile.academy_name)
                        .eq('role', 'athlete');

                    // Count Staff
                    const { count: staffCount } = await supabase
                        .from('profiles')
                        .select('*', { count: 'exact', head: true })
                        .eq('academy_name', userProfile.academy_name)
                        .neq('role', 'athlete');

                    setStats(prev => ({
                        ...prev,
                        activeAthletes: athleteCount || 0,
                        staffCount: staffCount || 1
                    }));
                }

            } catch (error) {
                console.error('Error loading dashboard:', error);
            } finally {
                setLoading(false);
            }
        };

        fetchDashboardData();
    }, []);

    // --- SUB-COMPONENTS ---

    const QuickActionButton = ({ icon: Icon, label, variant = 'secondary', onClick }) => {
        const baseStyle = "flex items-center gap-2 px-4 py-3 rounded-xl font-bold text-sm transition-all shadow-sm hover:shadow-md active:scale-95";
        const variants = {
            primary: "bg-emerald-600 text-white hover:bg-emerald-500",
            secondary: "bg-white text-slate-700 border border-slate-200 hover:bg-slate-50"
        };

        return (
            <button onClick={onClick} className={`${baseStyle} ${variants[variant]}`}>
                <Icon size={18} />
                {label}
            </button>
        );
    };

    const StatCard = ({ title, value, subtext, trend, icon: Icon, trendUp }) => (
        <div className="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm flex flex-col justify-between h-full">
            <div className="flex items-start justify-between mb-4">
                <div className="p-2 bg-slate-50 rounded-lg text-slate-500">
                    <Icon size={20} />
                </div>
                {trend && (
                    <div className={`flex items-center gap-1 text-xs font-bold px-2 py-1 rounded-full ${trendUp ? 'bg-emerald-50 text-emerald-600' : 'bg-red-50 text-red-600'}`}>
                        {trendUp ? <TrendingUp size={12} /> : <TrendingDown size={12} />}
                        {trend}
                    </div>
                )}
            </div>
            <div>
                <h3 className="text-3xl font-black text-slate-900 mb-1">{value}</h3>
                <p className="text-sm font-medium text-slate-500">{title}</p>
                {subtext && <p className="text-xs text-slate-400 mt-2">{subtext}</p>}
            </div>
        </div>
    );

    // --- LOADING STATE ---
    if (loading) {
        return (
            <div className="min-h-screen flex items-center justify-center bg-slate-50">
                <div className="w-10 h-10 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"></div>
            </div>
        );
    }

    // --- MAIN RENDER ---
    return (
        <div className="min-h-screen bg-slate-50 pb-24 font-sans selection:bg-emerald-100 relative">

            {/* Header */}
            <header className="bg-white border-b border-slate-200 sticky top-0 z-20">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between">
                    <div>
                        <h1 className="text-2xl font-black text-slate-900">
                            Good Morning, {profile?.first_name || 'Coach'}! ðŸ‘‹
                        </h1>
                        <p className="text-sm text-slate-500 font-medium hidden sm:block">
                            <span className="text-emerald-600 font-bold">{profile?.academy_name}</span> Command Center
                        </p>
                    </div>

                    <div className="flex items-center gap-4">
                        <button className="p-2 text-slate-400 hover:text-slate-600 transition-colors relative">
                            <Bell size={20} />
                            <span className="absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full border border-white"></span>
                        </button>
                    </div>
                </div>
            </header>

            <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8">

                {/* --- 1. QUICK ACTIONS --- */}
                <section className="flex flex-wrap gap-4">
                    <QuickActionButton
                        icon={UserPlus}
                        label="Add Athlete"
                        variant="primary"
                        onClick={() => setShowAddAthleteModal(true)}
                    />
                    <QuickActionButton
                        icon={Shield}
                        label="Add Staff"
                        variant="secondary"
                        onClick={() => navigate('/coach/staff')} // Redirect to Staff Management for adding/promoting
                    />
                    <QuickActionButton
                        icon={Calendar}
                        label="Schedule Session"
                        variant="secondary"
                        onClick={() => navigate('/coach/schedule')}
                    />
                </section>

                {/* --- 2. BUSINESS PULSE --- */}
                <section>
                    <div className="flex items-center justify-between mb-4">
                        <h2 className="text-lg font-bold text-slate-900">Business Pulse</h2>
                        {stats.activeAthletes > 0 && (
                            <button className="text-emerald-600 text-sm font-bold hover:underline">View Analytics</button>
                        )}
                    </div>

                    {stats.activeAthletes === 0 ? (
                        /* --- EMPTY STATE / WELCOME SLATE --- */
                        /* --- SETUP GUIDE WIDGET (Gamified Onboarding) --- */
                        <div className="bg-white rounded-2xl border border-slate-200 p-6 shadow-sm overflow-hidden relative">
                            <div className="absolute top-0 left-0 w-full h-1 bg-slate-100">
                                <div className="h-full bg-emerald-500 w-[25%]"></div>
                            </div>

                            <div className="flex flex-col md:flex-row gap-8 items-start pt-4">
                                <div className="flex-1">
                                    <div className="flex items-center gap-3 mb-2">
                                        <div className="p-2 bg-emerald-100 text-emerald-700 rounded-lg">
                                            <TrendingUp size={20} />
                                        </div>
                                        <div>
                                            <h3 className="text-lg font-bold text-slate-900">Let's set up your academy</h3>
                                            <p className="text-sm text-slate-500">Complete these steps to unlock your dashboard.</p>
                                        </div>
                                    </div>

                                    <div className="mt-6 space-y-4">
                                        {/* Step 1: Account (Done) */}
                                        <div className="flex items-center gap-4 opacity-50">
                                            <div className="w-6 h-6 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center">
                                                <ClipboardCheck size={14} />
                                            </div>
                                            <span className="text-slate-900 font-bold line-through decoration-emerald-500">Create Academy Account</span>
                                        </div>

                                        {/* Step 2: Add Athlete (Active) */}
                                        <div className="flex items-center gap-4 bg-emerald-50/50 p-3 rounded-xl border border-emerald-100">
                                            <div className="w-6 h-6 rounded-full bg-emerald-600 text-white flex items-center justify-center shadow-lg shadow-emerald-200 animate-pulse">
                                                <ArrowRight size={14} />
                                            </div>
                                            <div className="flex-1">
                                                <p className="text-slate-900 font-bold">Add your first athlete</p>
                                                <p className="text-xs text-slate-500">Start building your roster.</p>
                                            </div>
                                            <button
                                                onClick={() => setShowAddAthleteModal(true)}
                                                className="px-4 py-2 bg-emerald-600 hover:bg-emerald-500 text-white text-xs font-bold rounded-lg transition-colors"
                                            >
                                                Add Now
                                            </button>
                                        </div>

                                        {/* Step 3: Add Staff */}
                                        <div className="flex items-center gap-4">
                                            <div className="w-6 h-6 rounded-full border-2 border-slate-200 flex items-center justify-center">
                                                <div className="w-2 h-2 rounded-full bg-slate-200"></div>
                                            </div>
                                            <span className="text-slate-500 font-medium">Invite Staff Members</span>
                                            <button
                                                onClick={() => navigate('/coach/staff')}
                                                className="ml-auto text-xs font-bold text-emerald-600 hover:underline"
                                            >
                                                Go to Staff
                                            </button>
                                        </div>

                                        {/* Step 4: Schedule */}
                                        <div className="flex items-center gap-4">
                                            <div className="w-6 h-6 rounded-full border-2 border-slate-200 flex items-center justify-center">
                                                <div className="w-2 h-2 rounded-full bg-slate-200"></div>
                                            </div>
                                            <span className="text-slate-500 font-medium">Create your first class</span>
                                            <button
                                                onClick={() => navigate('/coach/schedule')}
                                                className="ml-auto text-xs font-bold text-emerald-600 hover:underline"
                                            >
                                                Go to Schedule
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                {/* Visual Side */}
                                <div className="hidden md:flex w-1/3 bg-slate-50 rounded-xl p-6 flex-col items-center justify-center text-center border border-slate-100">
                                    <div className="relative w-24 h-24 mb-4">
                                        <svg className="w-full h-full -rotate-90" viewBox="0 0 36 36">
                                            <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#e2e8f0" strokeWidth="4" />
                                            <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#10b981" strokeWidth="4" strokeDasharray="25, 100" />
                                        </svg>
                                        <div className="absolute inset-0 flex items-center justify-center flex-col">
                                            <span className="text-2xl font-black text-slate-900">25%</span>
                                        </div>
                                    </div>
                                    <p className="text-sm font-bold text-slate-700">Setup Progress</p>
                                    <p className="text-xs text-slate-400 mt-1">Complete steps to level up!</p>
                                </div>
                            </div>
                        </div>
                    ) : (
                        /* --- REAL STATS GRID --- */
                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                            <StatCard
                                title="Active Athletes"
                                value={stats.activeAthletes}
                                trend="-- vs last month"
                                trendUp={true}
                                icon={Users}
                            />
                            <StatCard
                                title="Monthly Revenue"
                                value={`AED ${stats.monthlyRevenue.toLocaleString()}`}
                                trend="-- vs last month"
                                trendUp={true}
                                icon={DollarSign}
                            />
                            <StatCard
                                title="Staff Count"
                                value={stats.staffCount}
                                subtext={`Including you`}
                                icon={Shield}
                            />
                            <StatCard
                                title="Today's Sessions"
                                value={stats.todaySessions}
                                subtext="Scheduled today"
                                icon={Calendar}
                            />
                        </div>
                    )}
                </section>

                {/* --- 3. RECENT ACTIVITY --- */}
                {stats.activeAthletes > 0 && (
                    <section>
                        <h2 className="text-lg font-bold text-slate-900 mb-4">Recent Activity</h2>
                        <div className="bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden">
                            {[1].map((_, i) => (
                                <div key={i} className="p-4 border-b border-slate-50 last:border-0 hover:bg-slate-50 transition-colors flex items-center justify-between group">
                                    <div className="flex items-center gap-4">
                                        <div className="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 font-bold">
                                            sys
                                        </div>
                                        <div>
                                            <p className="text-sm font-bold text-slate-900">System initialized for {profile?.academy_name}</p>
                                            <p className="text-xs text-slate-500">Just now</p>
                                        </div>
                                    </div>
                                    <button className="text-slate-300 group-hover:text-emerald-600">
                                        <ArrowRight size={16} />
                                    </button>
                                </div>
                            ))}
                        </div>
                    </section>
                )}

            </main>

            {/* --- WIBO Floating Action Button --- */}
            <motion.button
                whileHover={{ scale: 1.05 }}
                whileTap={{ scale: 0.95 }}
                className="fixed bottom-8 right-8 w-16 h-16 bg-emerald-600 text-white rounded-full shadow-2xl flex items-center justify-center z-40 hover:bg-emerald-500 transition-colors group border-4 border-emerald-200"
                onClick={() => alert("WIBO: How can I help you manage your academy today?")}
            >
                <Bot size={32} className="group-hover:rotate-12 transition-transform" />
                <span className="absolute -top-2 -right-2 w-4 h-4 bg-red-500 rounded-full border-2 border-white"></span>
            </motion.button>

            {/* --- MODALS --- */}

            <AddAthleteModal
                isOpen={showAddAthleteModal}
                onClose={() => setShowAddAthleteModal(false)}
                academyName={profile?.academy_name}
                onSuccess={() => {
                    // Refresh data logic if needed
                    window.location.reload();
                }}
            />

            <Modal
                isOpen={showAddStaffModal}
                title="Add Staff Member"
                onClose={() => setShowAddStaffModal(false)}
            >
                <div className="text-center py-8">
                    <p className="text-lg font-bold text-slate-800">Coming Soon</p>
                    <p className="text-slate-500 text-sm mt-2">Staff invites will be sent via email.</p>
                </div>
            </Modal>

        </div>
    );
}
</file>

<file path="src/pages/coach/Earnings.jsx">
import React from 'react';

const MyEarnings = () => {
    // Mock Data (Future: Link to payrolls table)
    const earnings = {
        total: 5850,
        currency: 'AED',
        breakdown: {
            hours_worked: 82,
            hourly_rate: 50,
            base_pay: 4100, // 82 * 50
        },
        private_sessions: {
            count: 7, // Count of private sessions
            rate: 250, // Rate per private session
            total: 1750 // 7 * 250
        }
    };

    return (
        <div className="p-6 bg-slate-50 min-h-screen">
            <h1 className="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                <span className="material-symbols-outlined text-emerald-600">account_balance_wallet</span>
                My Financial Hub
            </h1>

            {/* 1. Main Balance Card */}
            <div className="bg-gradient-to-r from-slate-900 to-slate-800 rounded-2xl p-6 text-white shadow-xl mb-8 relative overflow-hidden">
                <div className="relative z-10">
                    <p className="text-slate-400 text-sm font-medium mb-1">Estimated Payout (This Month)</p>
                    <div className="text-5xl font-bold mb-4 flex items-baseline gap-2">
                        {earnings.total.toLocaleString()} <span className="text-lg text-emerald-400">{earnings.currency}</span>
                    </div>
                    <div className="flex gap-4">
                        <div className="bg-white/10 px-3 py-1 rounded-lg text-xs font-medium backdrop-blur">
                            Next Payout: <span className="text-white font-bold">01 Jan 2026</span>
                        </div>
                    </div>
                </div>
                {/* Decor */}
                <span className="material-symbols-outlined absolute right-4 bottom-4 text-emerald-500/20 text-[120px] leading-none select-none">trending_up</span>
            </div>

            <div className="grid gap-6 md:grid-cols-2">

                {/* 2. Regular Classes Breakdown */}
                <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                    <div className="flex items-center gap-3 mb-4">
                        <div className="bg-blue-100 p-2 rounded-lg flex items-center justify-center">
                            <span className="material-symbols-outlined text-blue-600">calendar_today</span>
                        </div>
                        <h3 className="font-bold text-slate-700">Regular Classes</h3>
                    </div>
                    <div className="flex justify-between items-end mb-2">
                        <div>
                            <p className="text-3xl font-bold text-slate-800">{earnings.breakdown.hours_worked}</p>
                            <p className="text-xs text-slate-500">Hours Logged</p>
                        </div>
                        <div className="text-right">
                            <p className="text-lg font-bold text-emerald-600">+{earnings.breakdown.base_pay} AED</p>
                            <p className="text-xs text-slate-400">@ {earnings.breakdown.hourly_rate} AED/hr</p>
                        </div>
                    </div>
                    <div className="w-full bg-slate-100 h-2 rounded-full overflow-hidden">
                        <div className="bg-blue-500 h-full w-[75%]"></div>
                    </div>
                </div>

                {/* 3. Private Sessions (The Gold Mine) */}
                <div className="bg-amber-50 p-6 rounded-xl border border-amber-200 shadow-sm relative overflow-hidden">
                    <div className="absolute top-0 right-0 bg-amber-200 px-3 py-1 rounded-bl-xl text-[10px] font-bold text-amber-800">
                        HIGH VALUE
                    </div>

                    <div className="flex items-center gap-3 mb-4">
                        <div className="bg-amber-200 p-2 rounded-lg flex items-center justify-center">
                            <span className="material-symbols-outlined text-amber-700">workspace_premium</span>
                        </div>
                        <div>
                            <h3 className="font-bold text-amber-900">Private Commissions</h3>
                            <p className="text-xs text-amber-600">Personal Training Bonus</p>
                        </div>
                    </div>

                    <div className="flex justify-between items-center bg-white/50 p-3 rounded-lg border border-amber-100 mb-2">
                        <div className="flex items-center gap-2">
                            <span className="material-symbols-outlined text-amber-500 text-[20px]">bolt</span>
                            <span className="font-bold text-slate-700">{earnings.private_sessions.count} Sessions</span>
                        </div>
                        <span className="font-bold text-emerald-600">+{earnings.private_sessions.total} AED</span>
                    </div>

                    <p className="text-xs text-center text-amber-700/70 mt-2">
                        Keep it up! Each private session adds significant value.
                    </p>
                </div>

            </div>
        </div>
    );
};

export default MyEarnings;
</file>

<file path="src/pages/coach/management/Analytics.jsx">
import React from 'react';
import { clsx } from 'clsx';

export default function Analytics() {
    return (
        <div className="p-8 space-y-8">
            <header>
                <h1 className="text-3xl font-black text-slate-900 tracking-tight">Analytics Dashboard</h1>
                <p className="text-slate-500 font-medium">Platform Growth & Performance Metrics</p>
            </header>

            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                {[
                    { label: 'Active Students', value: '1,240', trend: '+12%', color: 'bg-indigo-500' },
                    { label: 'Monthly Revenue', value: 'AED 450k', trend: '+8%', color: 'bg-emerald-500' },
                    { label: 'Retention Rate', value: '94%', trend: '-1%', color: 'bg-orange-500' }
                ].map((stat, i) => (
                    <div key={i} className="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm relative overflow-hidden group hover:shadow-md transition-all">
                        <div className={clsx("absolute top-0 right-0 w-24 h-24 rounded-bl-full opacity-10 transition-transform group-hover:scale-110", stat.color)} />
                        <p className="text-slate-400 font-bold text-xs uppercase tracking-wider mb-2">{stat.label}</p>
                        <div className="flex items-end gap-3">
                            <span className="text-3xl font-black text-slate-800">{stat.value}</span>
                            <span className={clsx("text-xs font-bold px-2 py-1 rounded-full", stat.trend.startsWith('+') ? "bg-emerald-50 text-emerald-600" : "bg-red-50 text-red-600")}>
                                {stat.trend}
                            </span>
                        </div>
                    </div>
                ))}
            </div>

            <div className="bg-white rounded-2xl border border-slate-200 p-12 text-center">
                <div className="h-20 w-20 bg-indigo-50 rounded-full flex items-center justify-center mx-auto mb-6">
                    <span className="material-symbols-outlined text-4xl text-indigo-500">bar_chart</span>
                </div>
                <h3 className="text-xl font-bold text-slate-900 mb-2">Detailed Charts Coming Soon</h3>
                <p className="text-slate-500 max-w-md mx-auto">
                    We are building enhanced visualization tools to track growth per branch and discipline.
                </p>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/coach/management/FinanceDashboard.jsx">
import React from 'react';

export default function FinanceDashboard() {
    return (
        <div className="p-8 space-y-8">
            <header className="flex items-center justify-between">
                <div>
                    <h1 className="text-3xl font-black text-slate-900 tracking-tight">Finance Overview</h1>
                    <p className="text-slate-500 font-medium">Accounting & Payroll</p>
                </div>
                <div className="flex gap-2">
                    <button className="bg-white text-slate-600 px-4 py-2 rounded-lg font-bold border border-slate-200 hover:bg-slate-50 text-sm">
                        Export Report
                    </button>
                    <button className="bg-slate-900 text-white px-4 py-2 rounded-lg font-bold hover:bg-slate-800 text-sm flex items-center gap-2">
                        <span className="material-symbols-outlined text-sm">add</span>
                        New Invoice
                    </button>
                </div>
            </header>

            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                {/* Revenue Card */}
                <div className="bg-white p-8 rounded-2xl border border-slate-200 shadow-sm">
                    <h3 className="font-bold text-slate-800 mb-6 flex items-center gap-2">
                        <span className="material-symbols-outlined text-emerald-500">payments</span>
                        Revenue Stream
                    </h3>
                    <div className="h-48 bg-slate-50 rounded-xl flex items-center justify-center border border-slate-100 border-dashed">
                        <p className="text-slate-400 text-sm font-medium">Chart Visualization Placeholder</p>
                    </div>
                </div>

                {/* Payroll Card */}
                <div className="bg-white p-8 rounded-2xl border border-slate-200 shadow-sm">
                    <h3 className="font-bold text-slate-800 mb-6 flex items-center gap-2">
                        <span className="material-symbols-outlined text-blue-500">badge</span>
                        Pending Payroll
                    </h3>
                    <div className="space-y-4">
                        {[1, 2, 3].map(i => (
                            <div key={i} className="flex items-center justify-between p-4 bg-slate-50 rounded-xl">
                                <div className="flex items-center gap-3">
                                    <div className="h-10 w-10 bg-slate-200 rounded-full" />
                                    <div>
                                        <p className="font-bold text-slate-700 text-sm">Coach Employee #{i}</p>
                                        <p className="text-xs text-slate-400">Mar 2025 Salary</p>
                                    </div>
                                </div>
                                <span className="font-mono font-bold text-slate-700">AED 8,500</span>
                            </div>
                        ))}
                    </div>
                    <button className="w-full mt-6 bg-blue-50 text-blue-600 font-bold py-3 rounded-xl hover:bg-blue-100 transition-colors">
                        Process All Payments
                    </button>
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/coach/management/SalesAdminDashboard.jsx">
import React, { useState } from 'react';
import { clsx } from 'clsx';
import { format } from 'date-fns';

export default function SalesAdminDashboard() {
    // --- Mock Data ---
    const [tasks, setTasks] = useState([
        { id: 1, title: 'Follow up Payment: Sarah S.', priority: 'high', status: 'todo' },
        { id: 2, title: 'Order Water Bottles', priority: 'medium', status: 'todo' },
        { id: 3, title: 'Birthday Gift: Ali M.', priority: 'low', status: 'in_progress' }
    ]);
    const [attendanceQuery, setAttendanceQuery] = useState('');
    const [studentStatus, setStudentStatus] = useState(null);

    // --- Gatekeeper Logic ---
    const handleSearch = (e) => {
        const q = e.target.value;
        setAttendanceQuery(q);
        if (q.toLowerCase() === 'sarah') {
            setStudentStatus({ name: 'Sarah Smith', status: 'expired', level: 'Gold' });
        } else if (q.toLowerCase() === 'ali') {
            setStudentStatus({ name: 'Ali Mansoor', status: 'active', level: 'Silver' });
        } else {
            setStudentStatus(null);
        }
    };

    return (
        <div className="max-w-7xl mx-auto min-h-full space-y-6">
            <div className="flex items-center justify-between">
                <div>
                    <h1 className="text-3xl font-black text-slate-900">Operations Commander</h1>
                    <p className="text-slate-500 font-bold">Front Desk & Sales Control</p>
                </div>
                <div className="bg-emerald-100 text-emerald-700 px-4 py-2 rounded-xl font-bold flex items-center gap-2">
                    <span className="material-symbols-outlined">payments</span>
                    Today: AED 4,250
                </div>
            </div>

            {/* --- The Gatekeeper Module --- */}
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 h-[400px]">
                {/* Scanner / Search */}
                <div className="bg-slate-900 rounded-3xl p-8 flex flex-col justify-center relative overflow-hidden">
                    <div className="absolute top-0 right-0 p-4 opacity-10">
                        <span className="material-symbols-outlined text-9xl text-white">qr_code_scanner</span>
                    </div>
                    <label className="text-slate-400 font-bold uppercase text-xs tracking-wider mb-2">Live Scanner</label>
                    <div className="flex gap-4">
                        <input
                            type="text"
                            placeholder="Type Name or Scan ID..."
                            value={attendanceQuery}
                            onChange={handleSearch}
                            className="bg-slate-800 border-none text-white placeholder-slate-500 text-xl font-bold rounded-xl px-6 py-4 w-full focus:ring-2 focus:ring-emerald-500 outline-none"
                            autoFocus
                        />
                    </div>
                    {/* Recent Scans */}
                    <div className="mt-8 space-y-3">
                        <p className="text-slate-500 text-xs font-bold uppercase">Recent Check-ins</p>
                        <div className="flex items-center gap-3 text-slate-300 bg-slate-800/50 p-3 rounded-lg border border-slate-700">
                            <span className="material-symbols-outlined text-emerald-400">check_circle</span>
                            <span className="font-bold text-sm">John Doe</span>
                            <span className="text-xs text-slate-500 ml-auto">16:02</span>
                        </div>
                    </div>
                </div>

                {/* Status Result */}
                <div className="bg-white rounded-3xl border border-slate-200 p-8 flex flex-col items-center justify-center text-center shadow-sm relative">
                    {!studentStatus ? (
                        <div className="text-slate-300 flex flex-col items-center">
                            <span className="material-symbols-outlined text-6xl mb-4">person_search</span>
                            <h3 className="text-xl font-bold">Waiting for input...</h3>
                        </div>
                    ) : (
                        studentStatus.status === 'active' ? (
                            <div className="animate-in fade-in zoom-in duration-300">
                                <div className="h-24 w-24 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-600 mb-6 mx-auto">
                                    <span className="material-symbols-outlined text-5xl">check</span>
                                </div>
                                <h2 className="text-3xl font-black text-slate-900 mb-1">{studentStatus.name}</h2>
                                <span className="bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full text-xs font-black uppercase tracking-wider">Subscription Active</span>
                                <p className="text-slate-500 mt-4 font-medium">Enjoy your session!</p>
                            </div>
                        ) : (
                            <div className="animate-in fade-in zoom-in duration-300 w-full">
                                <div className="h-24 w-24 bg-red-100 rounded-full flex items-center justify-center text-red-600 mb-6 mx-auto">
                                    <span className="material-symbols-outlined text-5xl">block</span>
                                </div>
                                <h2 className="text-3xl font-black text-slate-900 mb-1">{studentStatus.name}</h2>
                                <span className="bg-red-100 text-red-700 px-3 py-1 rounded-full text-xs font-black uppercase tracking-wider">Payment Overdue</span>

                                <div className="mt-8 grid grid-cols-2 gap-4">
                                    <button className="bg-slate-100 hover:bg-slate-200 text-slate-700 py-3 rounded-xl font-bold text-sm transition-colors">
                                        View Profile
                                    </button>
                                    <button className="bg-emerald-500 hover:bg-emerald-600 text-white py-3 rounded-xl font-bold text-sm shadow-lg shadow-emerald-200 transition-colors flex items-center justify-center gap-2">
                                        <span className="material-symbols-outlined text-lg">payments</span>
                                        Pay & Unlock
                                    </button>
                                </div>
                            </div>
                        )
                    )}
                </div>
            </div>

            {/* --- Lower Section: Task Matrix & Pro POS --- */}
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">

                {/* Task Matrix (Kanban-lite) */}
                <div className="lg:col-span-2 bg-white rounded-3xl border border-slate-200 p-6 shadow-sm">
                    <div className="flex items-center justify-between mb-6">
                        <h3 className="text-lg font-black text-slate-900 flex items-center gap-2">
                            <span className="material-symbols-outlined text-slate-400">view_kanban</span>
                            Task Matrix
                        </h3>
                        <button className="text-indigo-600 text-xs font-bold hover:underline">+ New Task</button>
                    </div>
                    <div className="space-y-3">
                        {tasks.map(task => (
                            <div key={task.id} className="flex items-center gap-4 p-4 rounded-xl border border-slate-100 bg-slate-50 hover:bg-white hover:border-indigo-200 hover:shadow-md transition-all group cursor-move">
                                <span className={clsx("h-3 w-3 rounded-full",
                                    task.priority === 'high' ? 'bg-red-500' :
                                        task.priority === 'medium' ? 'bg-amber-500' : 'bg-blue-500'
                                )}></span>
                                <span className="font-bold text-slate-700">{task.title}</span>
                                <span className="text-xs font-bold uppercase text-slate-400 ml-auto group-hover:hidden">{task.status.replace('_', ' ')}</span>
                                <div className="ml-auto hidden group-hover:flex gap-2">
                                    <button className="p-1 hover:bg-emerald-100 text-emerald-600 rounded"><span className="material-symbols-outlined text-lg">check</span></button>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>

                {/* Pro POS Widget */}
                <div className="bg-indigo-900 text-white rounded-3xl p-6 shadow-xl relative overflow-hidden">
                    <div className="absolute -right-10 -top-10 h-40 w-40 bg-indigo-800 rounded-full opacity-50 blur-3xl"></div>
                    <h3 className="text-lg font-black mb-6 relative z-10 flex items-center gap-2">
                        <span className="material-symbols-outlined">point_of_sale</span>
                        Pro POS
                    </h3>

                    <div className="grid grid-cols-2 gap-3 mb-6 relative z-10">
                        <button className="bg-white/10 hover:bg-white/20 border border-white/10 p-4 rounded-xl flex flex-col items-center gap-2 transition-all">
                            <span className="text-2xl">ðŸ‘•</span>
                            <span className="text-xs font-bold">Uniform</span>
                        </button>
                        <button className="bg-white/10 hover:bg-white/20 border border-white/10 p-4 rounded-xl flex flex-col items-center gap-2 transition-all">
                            <span className="text-2xl">ðŸ’§</span>
                            <span className="text-xs font-bold">Water</span>
                        </button>
                        <button className="bg-white/10 hover:bg-white/20 border border-white/10 p-4 rounded-xl flex flex-col items-center gap-2 transition-all">
                            <span className="text-2xl">ðŸ“…</span>
                            <span className="text-xs font-bold">Monthly</span>
                        </button>
                        <button className="bg-emerald-500 hover:bg-emerald-400 text-white border-none p-4 rounded-xl flex flex-col items-center gap-2 transition-all shadow-lg shadow-emerald-900/20">
                            <span className="material-symbols-outlined text-2xl">add</span>
                            <span className="text-xs font-bold">Custom</span>
                        </button>
                    </div>

                    <div className="flex items-center justify-between text-xs font-bold text-indigo-200 relative z-10">
                        <span>Auto-Receipt (WhatsApp)</span>
                        <div className="w-8 h-4 bg-emerald-500 rounded-full relative cursor-pointer">
                            <div className="absolute right-0.5 top-0.5 h-3 w-3 bg-white rounded-full shadow-sm"></div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    );
}
</file>

<file path="src/pages/coach/management/StaffManagement.jsx">
import React, { useState, useEffect } from 'react';
import { motion } from 'framer-motion';
import { Shield, UserPlus, MoreHorizontal, CheckCircle, AlertCircle, Search, Filter, Briefcase } from 'lucide-react';
import { supabase } from '../../../supabaseClient';
import Modal from '../../../components/ui/Modal';

export default function StaffManagement() {
    const [loading, setLoading] = useState(true);
    const [staff, setStaff] = useState([]);
    const [currentUser, setCurrentUser] = useState(null);
    const [profile, setProfile] = useState(null);
    const [searchQuery, setSearchQuery] = useState('');

    // Modal State
    const [isPromoteModalOpen, setIsPromoteModalOpen] = useState(false);
    const [selectedMember, setSelectedMember] = useState(null);
    const [selectedRole, setSelectedRole] = useState('coach');
    const [actionLoading, setActionLoading] = useState(false);

    const STAFF_ROLES = [
        { id: 'admin', label: 'Admin / Owner', color: 'bg-slate-900 text-white' },
        { id: 'manager', label: 'Manager', color: 'bg-indigo-600 text-white' },
        { id: 'head_coach', label: 'Head Coach', color: 'bg-orange-600 text-white' },
        { id: 'coach', label: 'Coach', color: 'bg-blue-600 text-white' },
        { id: 'hr', label: 'HR', color: 'bg-pink-600 text-white' },
        { id: 'sales', label: 'Sales', color: 'bg-emerald-600 text-white' },
    ];

    useEffect(() => {
        fetchStaff();
    }, []);

    const fetchStaff = async () => {
        setLoading(true);
        try {
            const { data: { user } } = await supabase.auth.getUser();
            if (!user) return;
            setCurrentUser(user);

            // Get Current User Profile to know Academy Name
            const { data: userProfile } = await supabase
                .from('profiles')
                .select('*')
                .eq('id', user.id)
                .single();

            setProfile(userProfile);

            if (userProfile?.academy_name) {
                // Fetch All Non-Athletes for this Academy
                const { data: staffData, error } = await supabase
                    .from('profiles')
                    .select('*')
                    .eq('academy_name', userProfile.academy_name)
                    .neq('role', 'athlete')
                    .order('role', { ascending: true });

                if (error) throw error;
                setStaff(staffData || []);
            }
        } catch (err) {
            console.error("Error fetching staff:", err);
        } finally {
            setLoading(false);
        }
    };

    const handlePromoteClick = (member) => {
        setSelectedMember(member);
        setSelectedRole(member.role);
        setIsPromoteModalOpen(true);
    };

    const handleSaveRole = async () => {
        if (!selectedMember || !selectedRole) return;
        setActionLoading(true);

        try {
            const { error } = await supabase
                .from('profiles')
                .update({ role: selectedRole })
                .eq('id', selectedMember.id);

            if (error) throw error;

            // Optimistic Update
            setStaff(prev => prev.map(m => m.id === selectedMember.id ? { ...m, role: selectedRole } : m));
            setIsPromoteModalOpen(false);

        } catch (err) {
            alert("Failed to update role: " + err.message);
        } finally {
            setActionLoading(false);
        }
    };

    // Filter Logic
    const filteredStaff = staff.filter(m =>
        (m.full_name || '').toLowerCase().includes(searchQuery.toLowerCase()) ||
        (m.email || '').toLowerCase().includes(searchQuery.toLowerCase())
    );

    const getRoleBadge = (roleId) => {
        const role = STAFF_ROLES.find(r => r.id === roleId) || { label: roleId, color: 'bg-slate-400 text-white' };
        return (
            <span className={`px-2 py-1 rounded-md text-xs font-bold uppercase tracking-wide ${role.color}`}>
                {role.label}
            </span>
        );
    };

    return (
        <div className="min-h-screen bg-slate-50 font-sans p-4 sm:p-6 lg:p-8">

            {/* Header */}
            <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8">
                <div>
                    <h1 className="text-2xl font-black text-slate-900 flex items-center gap-3">
                        <Shield className="text-indigo-600" size={28} />
                        Team Directory
                    </h1>
                    <p className="text-slate-500 font-medium mt-1">
                        managing {staff.length} team members for <span className="text-indigo-600 font-bold">{profile?.academy_name}</span>
                    </p>
                </div>
                <button
                    onClick={() => alert("Invite Logic would go here (Send Email via Edge Function)")}
                    className="bg-indigo-600 hover:bg-indigo-500 text-white px-5 py-3 rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all hover:-translate-y-0.5 flex items-center gap-2"
                >
                    <UserPlus size={20} />
                    Invite Staff
                </button>
            </div>

            {/* Toolbar */}
            <div className="bg-white p-4 rounded-2xl border border-slate-200 shadow-sm mb-6 flex gap-4">
                <div className="relative flex-1">
                    <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" size={20} />
                    <input
                        type="text"
                        placeholder="Search team by name or email..."
                        value={searchQuery}
                        onChange={(e) => setSearchQuery(e.target.value)}
                        className="w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500/20 font-medium"
                    />
                </div>
            </div>

            {/* List */}
            {loading ? (
                <div className="py-20 flex justify-center">
                    <div className="w-10 h-10 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div>
                </div>
            ) : filteredStaff.length === 0 ? (
                <div className="text-center py-20 bg-white rounded-3xl border border-slate-200 border-dashed">
                    <div className="w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4">
                        <Shield className="text-slate-300" size={32} />
                    </div>
                    <h3 className="text-lg font-bold text-slate-900">No Staff Found</h3>
                    <p className="text-slate-500">Try adjusting your search terms.</p>
                </div>
            ) : (
                <div className="bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden">
                    <table className="w-full text-left border-collapse">
                        <thead>
                            <tr className="bg-slate-50 border-b border-slate-200 text-xs font-bold text-slate-500 uppercase tracking-wider">
                                <th className="px-6 py-4">Profile</th>
                                <th className="px-6 py-4">Role context</th>
                                <th className="px-6 py-4 hidden sm:table-cell">Joined</th>
                                <th className="px-6 py-4 text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-slate-100">
                            {filteredStaff.map((member) => (
                                <tr key={member.id} className="hover:bg-slate-50 transition-colors group">
                                    <td className="px-6 py-4">
                                        <div className="flex items-center gap-3">
                                            <div className="w-10 h-10 rounded-full bg-slate-900 text-white flex items-center justify-center font-bold text-sm">
                                                {member.full_name?.charAt(0) || member.email?.charAt(0) || 'U'}
                                            </div>
                                            <div>
                                                <p className="font-bold text-slate-900">{member.full_name || 'Staff Member'}</p>
                                                <p className="text-xs text-slate-500 font-medium">{member.email}</p>
                                            </div>
                                        </div>
                                    </td>
                                    <td className="px-6 py-4">
                                        {getRoleBadge(member.role)}
                                    </td>
                                    <td className="px-6 py-4 hidden sm:table-cell text-sm text-slate-500 font-medium">
                                        {new Date(member.created_at || Date.now()).toLocaleDateString()}
                                    </td>
                                    <td className="px-6 py-4 text-right">
                                        <button
                                            onClick={() => handlePromoteClick(member)}
                                            className="text-slate-400 hover:text-indigo-600 font-bold text-xs border border-slate-200 hover:border-indigo-200 px-3 py-1.5 rounded-lg transition-all"
                                        >
                                            Manage Role
                                        </button>
                                    </td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            )}

            {/* Empty State Logic for One-Man Army */}
            {!loading && staff.length === 1 && (
                <div className="mt-8 p-6 bg-gradient-to-r from-indigo-50 to-blue-50 rounded-2xl border border-indigo-100 flex items-center justify-between">
                    <div>
                        <h4 className="text-indigo-900 font-bold mb-1 flex items-center gap-2">
                            <AlertCircle size={18} />
                            One-Man Army?
                        </h4>
                        <p className="text-sm text-indigo-700">You are currently the only staff member. Add coaches to split the workload.</p>
                    </div>
                </div>
            )}

            {/* Promotion Modal */}
            <Modal
                isOpen={isPromoteModalOpen}
                onClose={() => setIsPromoteModalOpen(false)}
                title="Manage Staff Role"
            >
                <div className="space-y-6">
                    <div className="flex items-center gap-4 p-4 bg-slate-50 rounded-xl border border-slate-100">
                        <div className="w-12 h-12 rounded-full bg-slate-900 text-white flex items-center justify-center font-bold text-lg">
                            {selectedMember?.full_name?.charAt(0) || 'U'}
                        </div>
                        <div>
                            <h3 className="font-bold text-slate-900">{selectedMember?.full_name || selectedMember?.email}</h3>
                            <p className="text-xs text-slate-500">Current: {getRoleBadge(selectedMember?.role)}</p>
                        </div>
                    </div>

                    <div className="grid gap-3">
                        <label className="text-xs font-bold text-slate-500 uppercase tracking-wide">Select New Role</label>
                        {STAFF_ROLES.map(role => (
                            <button
                                key={role.id}
                                onClick={() => setSelectedRole(role.id)}
                                className={`flex items-center justify-between p-3 rounded-xl border transition-all text-left ${selectedRole === role.id
                                    ? 'border-indigo-500 bg-indigo-50 ring-1 ring-indigo-500/20'
                                    : 'border-slate-200 hover:border-slate-300 hover:bg-slate-50'}`}
                            >
                                <div className="flex items-center gap-3">
                                    <div className={`p-1.5 rounded-lg ${role.color.replace('text-white', 'bg-opacity-20 text-current')}`}>
                                        <Briefcase size={16} />
                                    </div>
                                    <span className={`text-sm font-bold ${selectedRole === role.id ? 'text-indigo-900' : 'text-slate-700'}`}>
                                        {role.label}
                                    </span>
                                </div>
                                {selectedRole === role.id && <CheckCircle size={18} className="text-indigo-600" />}
                            </button>
                        ))}
                    </div>

                    <div className="pt-4 flex gap-3">
                        <button
                            onClick={() => setIsPromoteModalOpen(false)}
                            className="flex-1 py-3 border border-slate-200 rounded-xl font-bold text-slate-600 hover:bg-slate-50"
                        >
                            Cancel
                        </button>
                        <button
                            onClick={handleSaveRole}
                            disabled={actionLoading}
                            className="flex-1 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2"
                        >
                            {actionLoading ? 'Updating...' : 'Save Role'}
                        </button>
                    </div>
                </div>
            </Modal>

        </div>
    );
}
</file>

<file path="src/pages/coach/MasterCalendar.jsx">
import React, { useState, useEffect, useMemo } from 'react';
import { clsx } from 'clsx';
import { startOfMonth, endOfMonth, startOfWeek, endOfWeek, eachDayOfInterval, format, isSameMonth, isSameDay, addDays } from 'date-fns';

export default function MasterCalendar() {
    const [currentDate, setCurrentDate] = useState(new Date());
    const [selectedClass, setSelectedClass] = useState(null);
    const [groups, setGroups] = useState([]);
    const [competitions, setCompetitions] = useState([]);
    const [isLoading, setIsLoading] = useState(true);
    const [error, setError] = useState(null);

    // Filters State
    const [filters, setFilters] = useState({
        branch: 'All',
        coach: 'All',
        activity: 'All'
    });

    // Simulated Role (In real app, get from Context/Auth)
    const currentRole = localStorage.getItem('simulated_role') || 'admin';
    const isHeadCoach = currentRole === 'head_coach';

    // 1. Fetch Data
    useEffect(() => {
        const fetchData = async () => {
            setIsLoading(true);
            setError(null);
            try {
                // Simulate network request
                await new Promise(resolve => setTimeout(resolve, 800));

                // Expanded Mock Data
                setGroups([
                    { id: 1, title: 'Winter Camp', date: '2025-12-16', type: 'Camp', branch: 'Dubai', coach: 'Sarah', time: '09:00 - 12:00', color: 'bg-blue-100 text-blue-700 border-blue-200' },
                    { id: 2, title: 'Elite Boys', date: '2025-12-16', type: 'Gymnastics', branch: 'Ajman', coach: 'Abdulla', time: '16:00 - 18:00', color: 'bg-indigo-100 text-indigo-700 border-indigo-200' },
                    { id: 3, title: 'Ajman Squad', date: '2025-12-17', type: 'Gymnastics', branch: 'Ajman', coach: 'Abdulla', time: '17:00 - 19:00', color: 'bg-indigo-100 text-indigo-700 border-indigo-200' },
                    { id: 4, title: 'Judo Basics', date: '2025-12-20', type: 'Judo', branch: 'Dubai', coach: 'Mike', time: '09:00 - 10:30', color: 'bg-orange-100 text-orange-700 border-orange-200' },
                    { id: 5, title: 'Winter Camp', date: '2025-12-17', type: 'Camp', branch: 'Dubai', coach: 'Sarah', time: '09:00 - 12:00', color: 'bg-blue-100 text-blue-700 border-blue-200' },
                    { id: 6, title: 'Winter Camp', date: '2025-12-18', type: 'Camp', branch: 'Dubai', coach: 'Sarah', time: '09:00 - 12:00', color: 'bg-blue-100 text-blue-700 border-blue-200' },
                ]);

                setCompetitions([
                    { id: 1, title: 'ðŸ† Academy Cup Prep', startDate: '2025-12-15', endDate: '2025-12-20', color: 'bg-amber-100 text-amber-800 border-amber-200' },
                ]);

            } catch (err) {
                console.error("Error fetching calendar data:", err);
                setError("Failed to load schedule. Please check your connection.");
            } finally {
                setIsLoading(false);
            }
        };

        fetchData();
    }, []);

    // 2. Filter Logic
    const filteredGroups = useMemo(() => {
        return groups.filter(g => {
            // Role Lock: Head Coach sees Gymnastics Only (Example Logic)
            if (isHeadCoach && g.type !== 'Gymnastics') return false;

            // Manual Filters
            if (filters.branch !== 'All' && g.branch !== filters.branch) return false;
            if (filters.coach !== 'All' && g.coach !== filters.coach) return false;
            if (filters.activity !== 'All' && g.type !== filters.activity) return false;

            return true;
        });
    }, [groups, filters, isHeadCoach]);

    // 3. Calendar Grid Calculations
    const monthStart = startOfMonth(currentDate);
    const monthEnd = endOfMonth(monthStart);
    const startDate = startOfWeek(monthStart);
    const endDate = endOfWeek(monthEnd);
    const calendarDays = eachDayOfInterval({ start: startDate, end: endDate });
    const weekDays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

    const getBannersForDay = (day) => {
        return competitions?.filter(comp => {
            const start = new Date(comp.startDate);
            const end = new Date(comp.endDate);
            return day >= start && day <= end;
        }) || [];
    };

    // --- Loading & Error UI ---
    if (isLoading) {
        return (
            <div className="h-[calc(100vh-140px)] flex flex-col items-center justify-center space-y-4">
                <div className="h-12 w-12 border-4 border-slate-200 border-t-slate-900 rounded-full animate-spin"></div>
                <p className="text-slate-500 font-bold animate-pulse">Loading Schedule...</p>
            </div>
        );
    }

    if (error) {
        return (
            <div className="h-[calc(100vh-140px)] flex flex-col items-center justify-center space-y-4 text-center">
                <div className="h-16 w-16 bg-red-100 rounded-full flex items-center justify-center text-red-500 mb-4">
                    <span className="material-symbols-outlined text-3xl">wifi_off</span>
                </div>
                <h3 className="text-xl font-bold text-slate-800">Connection Error</h3>
                <p className="text-slate-500">{error}</p>
                <button
                    onClick={() => window.location.reload()}
                    className="mt-4 px-6 py-2 bg-slate-900 text-white rounded-lg font-bold hover:bg-slate-800"
                >
                    Try Again
                </button>
            </div>
        );
    }

    return (
        <div className="h-[calc(100vh-140px)] flex flex-col space-y-4">
            {/* --- Header & Filters --- */}
            <div className="flex flex-col xl:flex-row xl:items-center justify-between gap-4 shrink-0">
                <div>
                    <h1 className="text-2xl md:text-3xl font-black text-slate-900 flex items-center gap-2">
                        Master Calendar
                        {isHeadCoach && <span className="text-xs bg-orange-100 text-orange-700 px-2 py-0.5 rounded-full border border-orange-200 uppercase tracking-wide">Head Coach Mode</span>}
                    </h1>
                    <p className="text-slate-500 font-medium text-sm md:text-base">
                        {isHeadCoach ? "Overseeing Gymnastics Operations" : "Full Operational Command"}
                    </p>
                </div>

                {/* Filter Bar */}
                <div className="flex flex-wrap items-center gap-2 md:gap-3 bg-white p-2 rounded-2xl shadow-sm border border-slate-100">
                    {/* Branch Filter */}
                    <select
                        className="bg-slate-50 border-0 rounded-xl text-sm font-bold text-slate-600 focus:ring-0 cursor-pointer hover:bg-slate-100 py-2 pl-3 pr-8"
                        value={filters.branch}
                        onChange={(e) => setFilters(prev => ({ ...prev, branch: e.target.value }))}
                    >
                        <option value="All">All Branches</option>
                        <option value="Dubai">Dubai Campus</option>
                        <option value="Ajman">Ajman Campus</option>
                    </select>

                    {/* Coach Filter (Hidden for Head Coach if strict) */}
                    <select
                        className="bg-slate-50 border-0 rounded-xl text-sm font-bold text-slate-600 focus:ring-0 cursor-pointer hover:bg-slate-100 py-2 pl-3 pr-8"
                        value={filters.coach}
                        onChange={(e) => setFilters(prev => ({ ...prev, coach: e.target.value }))}
                    >
                        <option value="All">All Coaches</option>
                        <option value="Abdulla">Abdulla</option>
                        <option value="Sarah">Sarah</option>
                        <option value="Mike">Mike</option>
                    </select>

                    {/* Date Navigation */}
                    <div className="flex items-center gap-2 border-l border-slate-200 pl-3">
                        <button className="h-8 w-8 flex items-center justify-center hover:bg-slate-100 rounded-lg transition-colors"><span className="material-symbols-outlined text-lg">chevron_left</span></button>
                        <span className="text-sm font-black text-slate-800 min-w-[100px] text-center">{format(currentDate, 'MMMM yyyy')}</span>
                        <button className="h-8 w-8 flex items-center justify-center hover:bg-slate-100 rounded-lg transition-colors"><span className="material-symbols-outlined text-lg">chevron_right</span></button>
                    </div>
                </div>
            </div>

            {/* --- Mobile View: Agenda List (Fallback) --- */}
            <div className="md:hidden flex-1 bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden flex flex-col">
                <div className="p-4 bg-slate-50 border-b border-slate-200 font-bold text-slate-500 uppercase tracking-wider text-xs">
                    Upcoming Agenda
                </div>
                <div className="flex-1 overflow-y-auto p-2 space-y-2">
                    {filteredGroups.length === 0 ? (
                        <div className="flex flex-col items-center justify-center py-10 opacity-50">
                            <span className="material-symbols-outlined text-4xl mb-2">event_busy</span>
                            <p className="text-sm font-bold">No events found</p>
                        </div>
                    ) : (
                        filteredGroups.map(event => (
                            <div key={event.id} className="flex gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100">
                                <div className="flex flex-col items-center justify-center w-12 bg-white rounded-lg border border-slate-200 shrink-0 h-14">
                                    <span className="text-[10px] text-red-500 font-bold uppercase">{format(new Date(event.date), 'MMM')}</span>
                                    <span className="text-xl font-black text-slate-900">{format(new Date(event.date), 'd')}</span>
                                </div>
                                <div>
                                    <h4 className="font-bold text-slate-900">{event.title}</h4>
                                    <p className="text-xs text-slate-500">{event.time} â€¢ {event.coach}</p>
                                    <span className={clsx("text-[10px] px-1.5 py-0.5 rounded-md border mt-1 inline-block", event.color)}>
                                        {event.type}
                                    </span>
                                </div>
                            </div>
                        ))
                    )}
                </div>
            </div>

            {/* --- Desktop View: Dense Grid --- */}
            <div className="hidden md:flex flex-1 bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden flex-col">
                {/* Weekday Headers */}
                <div className="grid grid-cols-7 border-b border-slate-200 bg-slate-50 h-10">
                    {weekDays.map(day => (
                        <div key={day} className="flex items-center justify-center text-xs font-bold text-slate-400 uppercase tracking-wider">
                            {day}
                        </div>
                    ))}
                </div>

                {/* Grid */}
                <div className="flex-1 grid grid-cols-7 grid-rows-5 bg-slate-100 gap-px">
                    {calendarDays.map((day) => {
                        const dayStr = format(day, 'yyyy-MM-dd');
                        const dayEvents = filteredGroups.filter(g => g.date === dayStr);
                        const dayBanners = getBannersForDay(day);
                        const isCurrentMonth = isSameMonth(day, monthStart);
                        const isToday = isSameDay(day, new Date());

                        return (
                            <div
                                key={day.toString()}
                                className={clsx(
                                    "bg-white relative p-1 flex flex-col gap-0.5 transition-all hover:bg-blue-50/30",
                                    !isCurrentMonth && "bg-slate-50 text-slate-300"
                                )}
                            >
                                {/* Date Number */}
                                <span className={clsx(
                                    "absolute top-1 right-1 text-[10px] font-bold h-5 w-5 flex items-center justify-center rounded-full z-10",
                                    isToday ? "bg-red-500 text-white" : "text-slate-400"
                                )}>
                                    {format(day, 'd')}
                                </span>

                                {/* Banners (Full Width) */}
                                {dayBanners.map(banner => (
                                    <div key={banner.id} className={clsx("text-[9px] font-bold px-1 rounded-sm truncate border", banner.color)}>
                                        {banner.title}
                                    </div>
                                ))}

                                {/* Events (Dense) */}
                                <div className="mt-5 flex flex-col gap-0.5 overflow-y-auto max-h-[120px] scrollbar-hide">
                                    {dayEvents.map(event => (
                                        <button
                                            key={event.id}
                                            onClick={() => setSelectedClass(event)}
                                            className={clsx(
                                                "text-left text-[9px] font-medium px-1.5 py-1 rounded border leading-tight transition-all hover:scale-[1.02] active:scale-95",
                                                event.color
                                            )}
                                        >
                                            <div className="flex justify-between items-center">
                                                <span className="font-bold truncate">{event.time}</span>
                                            </div>
                                            <div className="truncate font-bold opacity-90">{event.title}</div>
                                            <div className="opacity-75 truncate">{event.coach}</div>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        );
                    })}
                </div>
            </div>

            {/* --- Class Detail Modal --- */}
            {selectedClass && (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200" onClick={() => setSelectedClass(null)}>
                    <div className="bg-white rounded-2xl w-full max-w-lg shadow-2xl overflow-hidden animate-in zoom-in-95 duration-300" onClick={e => e.stopPropagation()}>
                        <div className="p-5 border-b border-slate-100 flex justify-between items-start bg-slate-50/50">
                            <div>
                                <h3 className="text-xl font-black text-slate-800">{selectedClass.title}</h3>
                                <p className="text-sm text-slate-500 font-medium">{selectedClass.time} â€¢ {selectedClass.branch}</p>
                            </div>
                            <span className={clsx("text-xs font-bold px-2 py-1 rounded-lg uppercase", selectedClass.color)}>
                                {selectedClass.type}
                            </span>
                        </div>
                        <div className="p-6">
                            <div className="flex items-center gap-4 mb-6">
                                <div className="h-12 w-12 bg-slate-100 rounded-full flex items-center justify-center">
                                    <span className="material-symbols-outlined text-slate-400">sports_gymnastics</span>
                                </div>
                                <div>
                                    <p className="text-sm font-bold text-slate-900">Coach: {selectedClass.coach}</p>
                                    <p className="text-xs text-slate-400">12 Students Enrolled</p>
                                </div>
                            </div>
                            <div className="grid grid-cols-2 gap-3">
                                <button className="w-full py-3 bg-slate-900 text-white rounded-xl font-bold hover:bg-slate-800 transition-colors">
                                    Take Attendance
                                </button>
                                <button className="w-full py-3 border-2 border-slate-100 text-slate-600 rounded-xl font-bold hover:border-slate-300 hover:text-slate-800 transition-colors">
                                    View Skills
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            )}
        </div>
    );
}
</file>

<file path="src/pages/coach/Profile.jsx">
import React, { useState, useEffect } from 'react';
import { clsx } from 'clsx';
import { useNavigate } from 'react-router-dom';

export default function Profile() {
    const navigate = useNavigate();
    const [isLoading, setIsLoading] = useState(true);

    // Simulated Data
    const user = {
        name: "Coach John",
        role: "Head Coach",
        branch: "Sharjah Elite",
        joinDate: "September 2023",
        stats: [
            { label: "Active Athletes", value: "124", trend: "+12%", icon: "groups", color: "from-blue-500 to-blue-600" },
            { label: "Training Hours", value: "86h", trend: "This Month", icon: "timer", color: "from-emerald-500 to-emerald-600" },
            { label: "Performance Score", value: "9.8", trend: "Top 5%", icon: "star", color: "from-amber-500 to-amber-600" },
            { label: "Revenue Generated", value: "AED 45k", trend: "+8.5%", icon: "payments", color: "from-purple-500 to-purple-600" },
        ],
        activity: [
            { action: "Updated Attendance", target: "Elite Squad", time: "2 hours ago", icon: "edit_calendar" },
            { action: "New Registration", target: "Sarah Connor", time: "5 hours ago", icon: "person_add" },
            { action: "Generated Invoice", target: "#INV-2024-001", time: "1 day ago", icon: "receipt_long" },
            { action: "Syllabus Update", target: "Gymnastics Level 3", time: "2 days ago", icon: "menu_book" },
        ]
    };

    useEffect(() => {
        setTimeout(() => setIsLoading(false), 800);
    }, []);

    if (isLoading) return <LoadingSkeleton />;

    return (
        <div className="min-h-screen bg-slate-50/50 pb-20 md:pb-8">
            {/* Banner Section */}
            <div className="relative h-64 bg-slate-900 overflow-hidden">
                <div className="absolute inset-0 bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900"></div>
                {/* Abstract Shapes */}
                <div className="absolute top-0 right-0 w-96 h-96 bg-emerald-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"></div>
                <div className="absolute bottom-0 left-0 w-72 h-72 bg-blue-500/10 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2"></div>

                <div className="relative h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col justify-end pb-6">
                    <div className="flex items-end gap-6 translate-y-8">
                        {/* Avatar */}
                        <div className="relative group">
                            <div className="h-32 w-32 rounded-2xl bg-gradient-to-br from-emerald-400 to-emerald-600 p-1 shadow-2xl shadow-emerald-900/20 ring-4 ring-white">
                                <div className="h-full w-full rounded-xl bg-slate-800 flex items-center justify-center text-white text-4xl font-black overflow-hidden relative">
                                    {/* Placeholder Image or Initials */}
                                    <span className="z-10">JP</span>
                                    <div className="absolute inset-0 bg-[url('https://api.dicebear.com/7.x/avataaars/svg?seed=John')] bg-cover opacity-20"></div>
                                </div>
                            </div>
                            <div className="absolute -bottom-2 -right-2 bg-white rounded-full p-1.5 shadow-lg border border-slate-100 cursor-pointer hover:bg-slate-50 transition-colors">
                                <span className="material-symbols-outlined text-slate-600 text-sm">photo_camera</span>
                            </div>
                        </div>

                        {/* Identity */}
                        <div className="mb-2 text-white">
                            <div className="flex items-center gap-3 mb-1">
                                <h1 className="text-3xl font-black tracking-tight">{user.name}</h1>
                                <span className="bg-emerald-500/20 text-emerald-300 border border-emerald-500/30 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider backdrop-blur-md">
                                    {user.role}
                                </span>
                            </div>
                            <p className="text-slate-400 font-medium flex items-center gap-2 text-sm">
                                <span className="material-symbols-outlined text-[16px]">apartment</span>
                                {user.branch}
                                <span className="h-1 w-1 rounded-full bg-slate-600"></span>
                                Member since {user.joinDate}
                            </p>
                        </div>

                        {/* Actions */}
                        <div className="ml-auto hidden md:flex items-center gap-3 mb-2">
                            <button onClick={() => navigate('/coach/settings')} className="bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-lg font-bold text-sm backdrop-blur-md transition-all border border-white/10 flex items-center gap-2">
                                <span className="material-symbols-outlined text-[18px]">settings</span>
                                Settings
                            </button>
                            <button className="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-2 rounded-lg font-bold text-sm shadow-lg shadow-emerald-900/20 transition-all flex items-center gap-2">
                                <span className="material-symbols-outlined text-[18px]">edit</span>
                                Edit Profile
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            {/* Spacer for overlapping avatar */}
            <div className="h-12 md:h-16"></div>

            {/* Main Content */}
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-8">

                {/* KPI Grid */}
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                    {user.stats.map((stat, idx) => (
                        <div key={idx} className="bg-white rounded-xl p-5 border border-slate-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden group">
                            <div className="relative z-10">
                                <div className="flex items-center justify-between mb-4">
                                    <div className={clsx("h-10 w-10 rounded-lg bg-gradient-to-br flex items-center justify-center shadow-lg text-white", stat.color)}>
                                        <span className="material-symbols-outlined">{stat.icon}</span>
                                    </div>
                                    {stat.trend && (
                                        <span className={clsx("text-xs font-bold px-2 py-1 rounded-full", stat.trend.includes('+') ? "bg-emerald-50 text-emerald-600" : "bg-slate-50 text-slate-500")}>
                                            {stat.trend}
                                        </span>
                                    )}
                                </div>
                                <p className="text-slate-500 text-xs font-bold uppercase tracking-wider mb-1">{stat.label}</p>
                                <p className="text-2xl font-black text-slate-800">{stat.value}</p>
                            </div>
                            {/* Decorative Blur */}
                            <div className={clsx("absolute -right-4 -bottom-4 w-24 h-24 rounded-full opacity-10 blur-2xl group-hover:opacity-20 transition-opacity bg-gradient-to-br", stat.color)}></div>
                        </div>
                    ))}
                </div>

                {/* Split Section: Details & Activity */}
                <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">

                    {/* Left: ID Card style details */}
                    <div className="lg:col-span-2 space-y-6">
                        <div className="bg-white rounded-2xl border border-slate-100 shadow-sm p-6 md:p-8">
                            <div className="flex items-center justify-between mb-6">
                                <h3 className="text-lg font-black text-slate-900">Professional Identity</h3>
                                <button
                                    onClick={() => alert("Public Profile Preview: Coming soon in Phase 2!")}
                                    className="text-emerald-500 text-sm font-bold hover:underline"
                                >
                                    View Public Profile
                                </button>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <InfoField label="Full Name" value={user.name} icon="id_card" />
                                <InfoField label="Email Address" value="john.p@wildrobot.com" icon="mail" />
                                <InfoField label="Phone Number" value="+971 50 123 4567" icon="call" />
                                <InfoField label="Employee ID" value="WR-2023-884" icon="badge" />
                                <InfoField label="Department" value="Coaching & Athletics" icon="domain" />
                                <InfoField label="Location" value="Sharjah, UAE" icon="location_on" />
                            </div>

                            <div className="mt-8 pt-6 border-t border-slate-100">
                                <h4 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4">Certifications & Skills</h4>
                                <div className="flex flex-wrap gap-2">
                                    {['FIG Level 2', 'First Aid Certified', 'Child Safety', 'Team Management', 'Swimming L3'].map(tag => (
                                        <span key={tag} className="px-3 py-1 bg-slate-50 text-slate-600 border border-slate-200 rounded-lg text-xs font-bold hover:bg-slate-100 cursor-default transition-colors">
                                            {tag}
                                        </span>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Right: Activity Log */}
                    <div className="space-y-6">
                        <div className="bg-white rounded-2xl border border-slate-100 shadow-sm p-6 h-full">
                            <h3 className="text-lg font-black text-slate-900 mb-6 flex items-center gap-2">
                                <span className="material-symbols-outlined text-slate-400">history</span>
                                Recent Activity
                            </h3>

                            <div className="relative border-l-2 border-slate-100 ml-3 space-y-8 pl-6 pb-2">
                                {user.activity.map((item, i) => (
                                    <div key={i} className="relative">
                                        <div className="absolute -left-[31px] bg-white border-2 border-slate-100 p-1 rounded-full h-8 w-8 flex items-center justify-center">
                                            <span className="material-symbols-outlined text-[14px] text-slate-400">{item.icon}</span>
                                        </div>
                                        <div>
                                            <p className="text-sm font-bold text-slate-800">{item.action}</p>
                                            <p className="text-xs text-slate-500 mb-1">{item.target}</p>
                                            <p className="text-[10px] bg-slate-50 inline-block px-2 py-0.5 rounded text-slate-400 font-medium">{item.time}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>

                            <button className="w-full mt-6 py-2 text-xs font-bold text-slate-400 hover:text-slate-600 border border-dashed border-slate-200 rounded-lg hover:border-slate-300 transition-all">
                                View Full History
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    );
}

function InfoField({ label, value, icon }) {
    return (
        <div className="flex items-start gap-4">
            <div className="h-10 w-10 rounded-lg bg-slate-50 flex items-center justify-center shrink-0">
                <span className="material-symbols-outlined text-slate-400 text-[20px]">{icon}</span>
            </div>
            <div>
                <p className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-0.5">{label}</p>
                <p className="text-sm font-bold text-slate-800">{value}</p>
            </div>
        </div>
    );
}

function LoadingSkeleton() {
    return (
        <div className="min-h-screen bg-slate-50 animate-pulse">
            <div className="h-64 bg-slate-200"></div>
            <div className="max-w-7xl mx-auto px-4 -mt-16 space-y-8">
                <div className="h-32 w-32 bg-slate-300 rounded-2xl border-4 border-white"></div>
                <div className="grid grid-cols-4 gap-4">
                    {[1, 2, 3, 4].map(i => <div key={i} className="h-32 bg-white rounded-xl"></div>)}
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/coach/Schedule.jsx">
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { ChevronLeft, ChevronRight, MapPin, Clock, Calendar as CalIcon, Coffee, Plus } from 'lucide-react';
import { supabase } from '../../supabaseClient';
import { supabaseService } from '../../services/supabaseService';

const Schedule = () => {
    const navigate = useNavigate();
    const [currentDate, setCurrentDate] = useState(new Date());
    const [selectedDate, setSelectedDate] = useState(new Date());
    const [sessions, setSessions] = useState([]);
    const [activeFilter, setActiveFilter] = useState('All');
    const [loading, setLoading] = useState(true);
    const [branches, setBranches] = useState([]);

    // 1. Dynamic Color Generator (Hash string to color)
    const getColorForBranch = (str) => {
        if (!str) return 'bg-slate-500';
        const colors = [
            'bg-red-500', 'bg-orange-500', 'bg-amber-500', 'bg-yellow-500',
            'bg-lime-500', 'bg-green-500', 'bg-emerald-500', 'bg-teal-500',
            'bg-cyan-500', 'bg-sky-500', 'bg-blue-500', 'bg-indigo-500',
            'bg-violet-500', 'bg-purple-500', 'bg-fuchsia-500', 'bg-pink-500', 'bg-rose-500'
        ];
        let hash = 0;
        for (let i = 0; i < str.length; i++) hash = str.charCodeAt(i) + ((hash << 5) - hash);
        return colors[Math.abs(hash) % colors.length];
    };

    // 2. Fetch Real Data
    useEffect(() => {
        const fetchSessions = async () => {
            setLoading(true);
            const startOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const endOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);

            // Fetch from Supabase Service (which needs to be V3 compliant)
            // For now, we assume it returns { id, date, time, branch, level ... }
            const data = await supabaseService.fetchCoachSchedule(startOfMonth, endOfMonth);
            setSessions(data || []);

            // Extract unique branches for filter
            const uniqueBranches = [...new Set((data || []).map(s => s.branch).filter(Boolean))];
            setBranches(uniqueBranches);

            setLoading(false);
        };

        fetchSessions();
    }, [currentDate]);

    // Helpers
    const getDaysInMonth = (date) => {
        const year = date.getFullYear();
        const month = date.getMonth();
        const days = new Date(year, month + 1, 0).getDate();
        return Array.from({ length: days }, (_, i) => i + 1);
    };

    const daysInMonth = getDaysInMonth(currentDate);

    // Filter Logic
    const selectedDaySessions = sessions.filter(s => {
        const d = new Date(s.date);
        const isDateMatch = d.getDate() === selectedDate.getDate() &&
            d.getMonth() === selectedDate.getMonth() &&
            d.getFullYear() === selectedDate.getFullYear();
        const isBranchMatch = activeFilter === 'All' || s.branch === activeFilter;
        return isDateMatch && isBranchMatch;
    });

    const handleManageSession = (session) => {
        navigate('/coach/session/' + session.id); // Updated route
    };

    return (
        <div className="flex flex-col md:flex-row h-[calc(100vh-80px)] bg-white overflow-hidden font-sans">

            {/* ---------------- LEFT PANEL: CALENDAR ---------------- */}
            <div className="flex-1 flex flex-col border-r border-slate-200 overflow-hidden">

                {/* Header */}
                <div className="p-6 border-b border-slate-100 bg-white">
                    <div className="flex justify-between items-center mb-4">
                        <div>
                            <h1 className="text-2xl font-black text-slate-800">Schedule</h1>
                            <p className="text-slate-500 text-sm font-medium">
                                {currentDate.toLocaleString('default', { month: 'long', year: 'numeric' })}
                            </p>
                        </div>
                        <div className="flex gap-2">
                            <button
                                onClick={() => setCurrentDate(new Date(currentDate.setMonth(currentDate.getMonth() - 1)))}
                                className="p-2 hover:bg-slate-50 rounded-lg border border-slate-200 transition-colors"
                            >
                                <ChevronLeft size={20} className="text-slate-600" />
                            </button>
                            <button
                                onClick={() => setCurrentDate(new Date(currentDate.setMonth(currentDate.getMonth() + 1)))}
                                className="p-2 hover:bg-slate-50 rounded-lg border border-slate-200 transition-colors"
                            >
                                <ChevronRight size={20} className="text-slate-600" />
                            </button>
                        </div>
                    </div>

                    {/* Dynamic Filters */}
                    {branches.length > 0 && (
                        <div className="flex gap-2 overflow-x-auto no-scrollbar pb-2">
                            <button
                                onClick={() => setActiveFilter('All')}
                                className={`px-3 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border ${activeFilter === 'All'
                                    ? 'bg-slate-800 text-white border-slate-800'
                                    : 'bg-white text-slate-500 border-slate-200 hover:border-slate-300'}`}
                            >
                                All
                            </button>
                            {branches.map(branch => (
                                <button
                                    key={branch}
                                    onClick={() => setActiveFilter(branch)}
                                    className={`px-3 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border flex items-center gap-2 ${activeFilter === branch
                                        ? 'bg-white text-slate-800 border-slate-300 shadow-sm ring-1 ring-slate-200'
                                        : 'bg-white text-slate-400 border-slate-200 opacity-60 hover:opacity-100'}`}
                                >
                                    <div className={`w-2 h-2 rounded-full ${getColorForBranch(branch)}`}></div>
                                    {branch.replace('_', ' ')}
                                </button>
                            ))}
                        </div>
                    )}
                </div>

                {/* Grid */}
                <div className="flex-1 overflow-y-auto p-6">
                    <div className="grid grid-cols-7 mb-4">
                        {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
                            <div key={day} className="text-center text-xs font-bold text-slate-400 uppercase tracking-wider">{day}</div>
                        ))}
                    </div>

                    <div className="grid grid-cols-7 border-t border-l border-slate-100">
                        {daysInMonth.map(day => {
                            const dateStr = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;

                            const daySessions = sessions.filter(s => {
                                const isDateMatch = s.date === dateStr;
                                const isBranchMatch = activeFilter === 'All' || s.branch === activeFilter;
                                return isDateMatch && isBranchMatch;
                            });

                            const isSelected = selectedDate.getDate() === day && selectedDate.getMonth() === currentDate.getMonth();

                            return (
                                <div
                                    key={day}
                                    onClick={() => setSelectedDate(new Date(currentDate.getFullYear(), currentDate.getMonth(), day))}
                                    className={`
                                        min-h-[100px] border-b border-r border-slate-100 p-2 cursor-pointer transition-all relative
                                        ${isSelected ? 'bg-emerald-50/30' : 'hover:bg-slate-50'}
                                    `}
                                >
                                    <span className={`
                                        text-sm font-bold block mb-2 w-7 h-7 flex items-center justify-center rounded-full
                                        ${isSelected ? 'bg-emerald-600 text-white shadow-md' : 'text-slate-700'}
                                    `}>
                                        {day}
                                    </span>

                                    <div className="flex flex-wrap gap-1">
                                        {daySessions.map((session, idx) => (
                                            <div
                                                key={idx}
                                                className={`w-2 h-2 rounded-full ${getColorForBranch(session.branch)}`}
                                                title={session.branch}
                                            />
                                        ))}
                                    </div>

                                    {isSelected && <div className="absolute inset-0 border-2 border-emerald-500 pointer-events-none opacity-50"></div>}
                                </div>
                            );
                        })}
                    </div>
                </div>
            </div>

            {/* ---------------- RIGHT PANEL: AGENDA ---------------- */}
            <div className="w-full md:w-[350px] bg-slate-50 border-l border-slate-200 flex flex-col shadow-xl z-10">
                <div className="p-6 bg-white border-b border-slate-100 sticky top-0 z-20">
                    <h2 className="text-xl font-black text-slate-800">
                        {selectedDate.toLocaleDateString('en-US', { weekday: 'long' })}
                    </h2>
                    <p className="text-emerald-600 font-bold">
                        {selectedDate.toLocaleDateString('en-US', { day: 'numeric', month: 'long' })}
                    </p>
                </div>

                <div className="flex-1 overflow-y-auto p-4 space-y-4">
                    {selectedDaySessions.length > 0 ? (
                        selectedDaySessions.map(session => (
                            <div key={session.id} className="bg-white p-4 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow">
                                <div className="flex justify-between items-start mb-2">
                                    <span className={`px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wide bg-slate-100 text-slate-600`}>
                                        {session.level || 'Session'}
                                    </span>
                                </div>
                                <h3 className="font-bold text-slate-800 text-lg mb-1">{session.branch}</h3>
                                <div className="flex items-center gap-2 text-sm text-slate-500 mb-4">
                                    <Clock size={14} className="text-emerald-500" />
                                    {session.time}
                                </div>
                                <button
                                    onClick={() => handleManageSession(session)}
                                    className="w-full py-2 border border-slate-200 text-slate-700 rounded-lg text-sm font-bold hover:bg-slate-800 hover:text-white transition-all flex items-center justify-center gap-2"
                                >
                                    Manage Class
                                </button>
                            </div>
                        ))
                    ) : (
                        <div className="h-full flex flex-col items-center justify-center text-center opacity-60 mt-10">
                            <div className="bg-slate-200 p-4 rounded-full mb-4">
                                <Coffee size={32} className="text-slate-500" />
                            </div>
                            <h3 className="text-lg font-bold text-slate-700">No Classes Scheduled</h3>
                            <p className="text-sm text-slate-500 max-w-[200px] mb-6">
                                Enjoy your free time! Select another date to view sessions.
                            </p>
                            <button className="bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2 shadow-lg">
                                <Plus size={16} /> Schedule Class
                            </button>
                        </div>
                    )}
                </div>
            </div>

        </div>
    );
};

export default Schedule;
</file>

<file path="src/pages/coach/SessionCommander.jsx">
import React, { useState, useEffect } from 'react';
import { useParams, useNavigate, useLocation } from 'react-router-dom';
import { clsx } from 'clsx';
import { motion, AnimatePresence } from 'framer-motion';
import { supabase } from '../../supabaseClient'; // ØªØ£ÙƒØ¯ Ø¥Ù† Ø§Ù„Ù…Ø³Ø§Ø± ØµØ­

export default function SessionCommander() {
    const { sessionId } = useParams();
    const navigate = useNavigate();
    const location = useLocation();

    // metadata coming from Schedule Page
    const sessionMeta = location.state || { branch: 'Unknown', level: 'Class', title: 'Session' };

    // --- State ---\
    const [mode, setMode] = useState('attendance'); // 'attendance' | 'skills' | 'planning'
    const [students, setStudents] = useState([]);
    const [loading, setLoading] = useState(true);
    const [saving, setSaving] = useState(false);

    // 1. Fetch Real Roster ðŸŸ¢ + Real-time Subscription âš¡
    useEffect(() => {
        if (!sessionId) return;

        fetchRoster();

        // ðŸŸ¢ REAL-TIME SUBSCRIPTION
        const channel = supabase
            .channel(`session_roster_${sessionId}`)
            .on('postgres_changes',
                { event: 'UPDATE', schema: 'public', table: 'enrollments', filter: `session_id=eq.${sessionId}` },
                (payload) => {
                    console.log('Real-time update received!', payload);
                    setStudents(currentStudents => currentStudents.map(s => {
                        if (s.enrollmentId === payload.new.id) {
                            return { ...s, status: payload.new.status };
                        }
                        return s;
                    }));
                }
            )
            .subscribe();

        return () => {
            supabase.removeChannel(channel);
        };
    }, [sessionId]);

    const fetchRoster = async () => {
        setLoading(true);
        try {
            // Join enrollments with profiles to get student names
            const { data, error } = await supabase
                .from('enrollments')
                .select(`
                    id,
                    status,
                    student:profiles (id, full_name, avatar_url)
                `)
                .eq('session_id', sessionId);

            if (error) throw error;

            // Format data for UI
            const formattedStudents = data.map(record => ({
                enrollmentId: record.id, // Important for updates
                studentId: record.student.id,
                name: record.student.full_name,
                avatar: record.student.avatar_url,
                status: record.status // 'present', 'absent', etc.
            }));

            setStudents(formattedStudents);
        } catch (err) {
            console.error('Roster Fetch Error:', err);
        } finally {
            setLoading(false);
        }
    };

    // 2. Real-time Attendance Update (The "Wire") âš¡
    const updateAttendance = async (enrollmentId, newStatus) => {
        // 1. Snapshot: Keep old state for rollback
        const previousStudents = [...students];

        // 2. Optimistic Update: Instant feedback
        setStudents(prev => prev.map(s =>
            s.enrollmentId === enrollmentId ? { ...s, status: newStatus } : s
        ));

        // 3. Network Request
        try {
            const { error } = await supabase
                .from('enrollments')
                .update({ status: newStatus })
                .eq('id', enrollmentId);

            if (error) throw error;
        } catch (err) {
            console.error('Update Failed:', err);

            // 4. ðŸš¨ ROLLBACK: Revert immediately
            setStudents(previousStudents);

            // 5. Alert: Notify coach
            alert("âš ï¸ Connection Failed! Attendance was NOT saved.");
        }
    };

    const handleBulkAction = async (actionType) => {
        if (actionType === 'mark_all_present') {
            setSaving(true);
            const updates = students.map(s => updateAttendance(s.enrollmentId, 'present'));
            await Promise.all(updates);
            setSaving(false);
        }
    };

    // --- UI Components ---

    const renderHeader = () => (
        <div className="bg-white sticky top-0 z-20 border-b border-gray-100 shadow-sm">
            <div className="max-w-3xl mx-auto px-4 py-4 flex items-center justify-between">
                <div className="flex items-center gap-3">
                    <button onClick={() => navigate(-1)} className="h-10 w-10 rounded-full bg-slate-50 flex items-center justify-center hover:bg-slate-100 transition-colors">
                        <span className="material-symbols-outlined text-slate-600">arrow_back</span>
                    </button>
                    <div>
                        <h1 className="font-black text-slate-800 text-lg leading-tight">{sessionMeta.title}</h1>
                        <p className="text-xs text-slate-500 font-bold">{sessionMeta.branch} â€¢ {sessionMeta.level}</p>
                    </div>
                </div>
                {saving && <div className="text-xs font-bold text-emerald-500 animate-pulse">Saving...</div>}
            </div>

            {/* Tri-Mode Switcher */}
            <div className="px-4 pb-4 max-w-3xl mx-auto">
                <div className="bg-slate-100 p-1 rounded-xl flex font-bold text-xs relative">
                    {/* Sliding Background */}
                    <motion.div
                        className="absolute top-1 bottom-1 bg-white rounded-lg shadow-sm z-0"
                        layoutId="tab-bg"
                        initial={false}
                        animate={{
                            left: mode === 'attendance' ? '4px' : mode === 'skills' ? '33.33%' : '66.66%',
                            width: '32%'
                        }}
                        transition={{ type: "spring", stiffness: 300, damping: 30 }}
                    />

                    {['attendance', 'skills', 'planning'].map((m) => (
                        <button
                            key={m}
                            onClick={() => setMode(m)}
                            className={clsx(
                                "flex-1 py-2.5 rounded-lg z-10 transition-colors capitalize relative",
                                mode === m ? "text-slate-800" : "text-slate-400 hover:text-slate-600"
                            )}
                        >
                            {m}
                        </button>
                    ))}
                </div>
            </div>
        </div>
    );

    // MODE 1: ATTENDANCE
    const renderAttendance = () => (
        <div className="space-y-4">
            <div className="flex justify-between items-center mb-2 px-2">
                <p className="text-xs font-bold text-slate-400 uppercase tracking-wider">
                    {students.length} Athletes Listed
                </p>
                <button
                    onClick={() => handleBulkAction('mark_all_present')}
                    className="text-emerald-600 text-xs font-bold hover:bg-emerald-50 px-3 py-1.5 rounded-lg transition-colors"
                >
                    Mark All Present
                </button>
            </div>

            {loading ? (
                <div className="flex justify-center py-10"><div className="animate-spin h-8 w-8 border-4 border-emerald-500 rounded-full border-t-transparent"></div></div>
            ) : students.length === 0 ? (
                <div className="text-center py-10 text-slate-400">
                    <span className="material-symbols-outlined text-4xl mb-2">person_off</span>
                    <p>No students enrolled yet.</p>
                </div>
            ) : (
                students.map((student) => (
                    <motion.div
                        layout
                        key={student.enrollmentId}
                        className={clsx(
                            "bg-white p-4 rounded-2xl border transition-all flex items-center justify-between",
                            student.status === 'present' ? "border-emerald-500 shadow-md shadow-emerald-100" : "border-slate-100"
                        )}
                    >
                        <div className="flex items-center gap-3">
                            {student.avatar ? (
                                <img src={student.avatar} alt={student.name} className="w-12 h-12 rounded-full object-cover bg-slate-100" />
                            ) : (
                                <div className="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center text-slate-400 font-bold text-lg">
                                    {student.name.charAt(0)}
                                </div>
                            )}
                            <div>
                                <h3 className="font-bold text-slate-800">{student.name}</h3>
                                <p className={clsx("text-xs font-bold", student.status === 'present' ? "text-emerald-600" : "text-slate-400")}>
                                    {student.status ? student.status.toUpperCase() : 'PENDING'}
                                </p>
                            </div>
                        </div>

                        <div className="flex gap-2">
                            <button
                                onClick={() => updateAttendance(student.enrollmentId, 'absent')}
                                className={clsx(
                                    "h-10 w-10 rounded-xl flex items-center justify-center transition-all",
                                    student.status === 'absent' ? "bg-red-100 text-red-600" : "bg-slate-50 text-slate-300 hover:bg-red-50 hover:text-red-400"
                                )}
                            >
                                <span className="material-symbols-outlined">close</span>
                            </button>
                            <button
                                onClick={() => updateAttendance(student.enrollmentId, 'present')}
                                className={clsx(
                                    "h-10 w-10 rounded-xl flex items-center justify-center transition-all shadow-sm",
                                    student.status === 'present' ? "bg-emerald-500 text-white" : "bg-slate-50 text-slate-300 hover:bg-emerald-500 hover:text-white"
                                )}
                            >
                                <span className="material-symbols-outlined">check</span>
                            </button>
                        </div>
                    </motion.div>
                ))
            )}
        </div>
    );

    // Placeholder for other modes
    const renderPlaceholder = (title) => (
        <div className="flex flex-col items-center justify-center py-20 opacity-50">
            <span className="material-symbols-outlined text-6xl text-slate-300 mb-4">construction</span>
            <h3 className="font-bold text-slate-600">{title} Mode</h3>
            <p className="text-sm text-slate-400">Coming in Phase 3</p>
        </div>
    );

    return (
        <div className="min-h-screen bg-slate-50 font-inter pb-20">
            {renderHeader()}
            <main className="max-w-3xl mx-auto px-4 py-6">
                {mode === 'attendance' && renderAttendance()}
                {mode === 'skills' && renderPlaceholder("Skills Assessment")}
                {mode === 'planning' && renderPlaceholder("Session Planning")}
            </main>
        </div>
    );
}
</file>

<file path="src/pages/coach/Settings.jsx">
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { clsx } from 'clsx';
import { useOutletContext } from 'react-router-dom';
import { useTheme } from '../../context/ThemeContext';

export default function Settings() {
    const role = localStorage.getItem('simulated_role') || 'admin';
    const [activeTab, setActiveTab] = useState('personal');
    const { userProfile } = useOutletContext() || {};

    const tabs = [
        { id: 'personal', label: 'Personal Info', icon: 'person' },
        { id: 'security', label: 'Security', icon: 'lock' },
        ...(role === 'admin' ? [{ id: 'system', label: 'System Control', icon: 'admin_panel_settings' }] : []),
    ];

    const userName = userProfile?.full_name || "Coach Sarah";
    const userRole = userProfile?.coach_type ? userProfile.coach_type.replace('_', ' ').replace(/\b\w/g, c => c.toUpperCase()) : (role === 'admin' ? 'Super Administrator' : 'Head Gymnastics Coach');
    const userInitials = userProfile?.full_name
        ? userProfile.full_name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2)
        : "CS";

    return (
        <div className="min-h-screen bg-slate-50/50 pb-20">
            {/* 1. Hero Banner Section */}
            <div className="bg-white border-b border-slate-200">
                <div className="relative h-48 bg-slate-900 overflow-hidden">
                    <div className="absolute inset-0 bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900"></div>
                    {/* Decorative Elements */}
                    <div className="absolute top-0 right-0 w-96 h-96 bg-emerald-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"></div>

                    <div className="max-w-7xl mx-auto px-6 h-full flex flex-col justify-end pb-8 relative z-10">
                        <div className="flex items-end gap-6">
                            <div className="relative">
                                <div className="h-32 w-32 rounded-2xl bg-white p-1 shadow-2xl ring-4 ring-white/10 translate-y-1/2">
                                    <div className="h-full w-full rounded-xl bg-slate-800 flex items-center justify-center text-white text-3xl font-black overflow-hidden">
                                        {userProfile?.avatar_url ? (
                                            <img src={userProfile.avatar_url} alt="Profile" className="h-full w-full object-cover" />
                                        ) : (
                                            userInitials
                                        )}
                                    </div>
                                </div>
                                <div className="absolute bottom-[-10px] right-[-10px] bg-emerald-500 text-white p-1.5 rounded-full border-4 border-white shadow-sm">
                                    <span className="material-symbols-outlined text-[16px] block">verified</span>
                                </div>
                            </div>
                            <div className="mb-2 text-white/90">
                                <h1 className="text-3xl font-black tracking-tight text-white">{userName}</h1>
                                <p className="text-emerald-400 font-bold uppercase text-xs tracking-wider flex items-center gap-2">
                                    <span className="h-1.5 w-1.5 rounded-full bg-emerald-400"></span>
                                    {userRole}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                {/* Navigation Tabs (Integrated in Hero) */}
                <div className="max-w-7xl mx-auto px-6 pt-20 pb-0">
                    <div className="flex items-center gap-8 border-b border-slate-100">
                        {tabs.map((tab) => (
                            <button
                                key={tab.id}
                                onClick={() => setActiveTab(tab.id)}
                                className={clsx(
                                    "pb-4 text-sm font-bold flex items-center gap-2 border-b-2 transition-all",
                                    activeTab === tab.id
                                        ? "text-emerald-600 border-emerald-500"
                                        : "text-slate-500 border-transparent hover:text-slate-800 hover:border-slate-200"
                                )}
                            >
                                <span className="material-symbols-outlined text-[18px]">{tab.icon}</span>
                                {tab.label}
                            </button>
                        ))}
                    </div>
                </div>
            </div>

            {/* Main Content Area */}
            <div className="max-w-7xl mx-auto px-6 py-8 space-y-8">

                {/* 2. Achievement Cards (Persistent) */}
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <KPICard
                        label="Active Athletes"
                        value="115"
                        trend="+12%"
                        icon="sports_gymnastics"
                        color="text-blue-600"
                        bg="bg-blue-50"
                    />
                    <KPICard
                        label="Hours This Month"
                        value="82h"
                        trend="On Track"
                        icon="timer"
                        color="text-amber-600"
                        bg="bg-amber-50"
                    />
                    <KPICard
                        label="Total Revenue"
                        value="AED 45k"
                        trend="+8%"
                        icon="payments"
                        color="text-emerald-600"
                        bg="bg-emerald-50"
                    />
                </div>

                {/* 3. Tab Content (Animated) */}
                <div className="bg-white rounded-2xl border border-slate-200 shadow-sm p-8 min-h-[400px] relative overflow-hidden">
                    <AnimatePresence mode="wait">
                        <motion.div
                            key={activeTab}
                            initial={{ opacity: 0, y: 10 }}
                            animate={{ opacity: 1, y: 0 }}
                            exit={{ opacity: 0, y: -10 }}
                            transition={{ duration: 0.2 }}
                        >
                            {activeTab === 'personal' && <PersonalInfoTab />}
                            {activeTab === 'security' && <SecurityTab />}
                            {activeTab === 'system' && <SystemTab />}
                        </motion.div>
                    </AnimatePresence>
                </div>
            </div>
        </div>
    );
}

// --- Components ---

function KPICard({ label, value, trend, icon, color, bg }) {
    return (
        <div className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow flex items-center justify-between group">
            <div>
                <p className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-1">{label}</p>
                <div className="flex items-baseline gap-2">
                    <h3 className="text-2xl font-black text-slate-900">{value}</h3>
                    <span className="text-[10px] font-bold bg-slate-50 px-2 py-0.5 rounded text-slate-500">{trend}</span>
                </div>
            </div>
            <div className={clsx("h-12 w-12 rounded-xl flex items-center justify-center transition-transform group-hover:scale-110", bg)}>
                <span className={clsx("material-symbols-outlined text-2xl", color)}>{icon}</span>
            </div>
        </div>
    );
}

function PersonalInfoTab() {
    return (
        <div className="max-w-2xl space-y-8">
            <div>
                <h2 className="text-xl font-black text-slate-900">Personal Information</h2>
                <p className="text-slate-500 text-sm">Manage your coach profile details.</p>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <InputGroup label="Full Name" defaultValue="Coach Sarah" />
                <InputGroup label="Email Address" defaultValue="sarah.c@wildrobot.com" />
                <InputGroup label="Phone Number" defaultValue="+971 55 123 4567" />
                <InputGroup label="Designation" defaultValue="Head Coach" disabled />
            </div>

            <div className="space-y-4 pt-4">
                <h3 className="text-sm font-bold text-slate-900">Bio / Expertise</h3>
                <textarea
                    className="w-full h-32 bg-slate-50 border border-slate-200 rounded-xl p-4 text-sm font-medium focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none resize-none"
                    defaultValue="Specialized in Artistic Gymnastics with over 8 years of experience coaching competitive squads."
                />
            </div>

            <div className="pt-6 border-t border-slate-100 flex justify-end">
                <button className="bg-slate-900 text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-slate-800 transition-all shadow-lg shadow-slate-900/10">
                    Save Changes
                </button>
            </div>
        </div>
    );
}

function SecurityTab() {
    return (
        <div className="max-w-2xl space-y-8">
            <div>
                <h2 className="text-xl font-black text-slate-900">Security & Login</h2>
                <p className="text-slate-500 text-sm">Protect your account.</p>
            </div>

            <div className="p-6 bg-slate-50 rounded-xl border border-slate-200 flex items-center justify-between">
                <div className="flex items-center gap-4">
                    <div className="h-10 w-10 bg-white rounded-full flex items-center justify-center shadow-sm text-emerald-500">
                        <span className="material-symbols-outlined">verified_user</span>
                    </div>
                    <div>
                        <p className="font-bold text-slate-900 text-sm">Two-Factor Authentication</p>
                        <p className="text-xs text-slate-500">Currently disabled.</p>
                    </div>
                </div>
                <button className="text-emerald-600 font-bold text-sm hover:underline">Enable</button>
            </div>

            <div className="space-y-4">
                <InputGroup label="Current Password" type="password" />
                <InputGroup label="New Password" type="password" />
                <InputGroup label="Confirm New Password" type="password" />
            </div>

            <div className="pt-6 border-t border-slate-100 flex justify-end">
                <button className="bg-white border-2 border-slate-200 text-slate-600 px-8 py-3 rounded-xl font-bold text-sm hover:border-slate-300 transition-all">
                    Update Password
                </button>
            </div>
        </div>
    );
}

function SystemTab() {
    return (
        <div className="max-w-2xl space-y-8">
            <div>
                <h2 className="text-xl font-black text-slate-900 flex items-center gap-2">
                    <span className="material-symbols-outlined text-amber-500">admin_panel_settings</span>
                    System Control
                </h2>
                <p className="text-slate-500 text-sm">Global configurations for the workspace.</p>
            </div>

            <div className="grid grid-cols-2 gap-4">
                <div className="p-6 rounded-2xl border border-slate-200 hover:border-emerald-500/50 hover:shadow-md transition-all cursor-pointer group">
                    <span className="material-symbols-outlined text-3xl text-slate-400 group-hover:text-emerald-500 mb-4">domain</span>
                    <h3 className="font-bold text-slate-900">Branch Management</h3>
                    <p className="text-xs text-slate-500 mt-1">Add or remove locations.</p>
                </div>
                <div className="p-6 rounded-2xl border border-slate-200 hover:border-blue-500/50 hover:shadow-md transition-all cursor-pointer group">
                    <span className="material-symbols-outlined text-3xl text-slate-400 group-hover:text-blue-500 mb-4">group_add</span>
                    <h3 className="font-bold text-slate-900">User Roles</h3>
                    <p className="text-xs text-slate-500 mt-1">Manage permissions.</p>
                </div>
            </div>
        </div>
    );
}

function InputGroup({ label, defaultValue, type = "text", disabled = false }) {
    return (
        <div className="space-y-1.5">
            <label className="text-xs font-bold text-slate-500 uppercase tracking-wider">{label}</label>
            <input
                type={type}
                defaultValue={defaultValue}
                disabled={disabled}
                className="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-slate-900 font-medium focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all disabled:opacity-60 disabled:cursor-not-allowed"
            />
        </div>
    );
}
</file>

<file path="src/pages/coach/Support.jsx">
import React, { useState } from 'react';
import { motion } from 'framer-motion';
import { Mail, Phone, MapPin, Send, MessageSquare } from 'lucide-react';

export default function Support() {
    const [sent, setSent] = useState(false);

    const handleSubmit = (e) => {
        e.preventDefault();
        setSent(true);
        setTimeout(() => setSent(false), 3000);
    };

    return (
        <div className="max-w-4xl mx-auto space-y-8">
            <div className="flex items-center gap-4">
                <div className="h-12 w-12 bg-emerald-100 text-emerald-600 rounded-xl flex items-center justify-center shadow-sm">
                    <MessageSquare size={24} />
                </div>
                <div>
                    <h1 className="text-2xl font-black text-slate-800 tracking-tight">Support Center</h1>
                    <p className="text-slate-500 font-medium">We're here to help. Send us a message.</p>
                </div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                {/* Contact Form */}
                <motion.div
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    className="md:col-span-2 bg-white rounded-3xl p-8 border border-slate-200 shadow-sm"
                >
                    <form onSubmit={handleSubmit} className="space-y-6">
                        <div className="grid grid-cols-2 gap-6">
                            <div className="space-y-2">
                                <label className="text-xs font-bold text-slate-400 uppercase tracking-wider">Name</label>
                                <input type="text" className="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 font-bold text-slate-700 outline-none focus:ring-2 focus:ring-emerald-500 transition-all" placeholder="John Doe" required />
                            </div>
                            <div className="space-y-2">
                                <label className="text-xs font-bold text-slate-400 uppercase tracking-wider">Subject</label>
                                <select className="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 font-bold text-slate-700 outline-none focus:ring-2 focus:ring-emerald-500 transition-all">
                                    <option>General Inquiry</option>
                                    <option>Technical Issue</option>
                                    <option>Billing Question</option>
                                    <option>Feature Request</option>
                                </select>
                            </div>
                        </div>

                        <div className="space-y-2">
                            <label className="text-xs font-bold text-slate-400 uppercase tracking-wider">Message</label>
                            <textarea className="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 font-bold text-slate-700 outline-none focus:ring-2 focus:ring-emerald-500 transition-all min-h-[150px]" placeholder="How can we help you?" required></textarea>
                        </div>

                        <button
                            disabled={sent}
                            className={`w-full py-4 rounded-xl font-black text-white shadow-lg transition-all flex items-center justify-center gap-2 ${sent ? 'bg-green-500' : 'bg-slate-900 hover:bg-slate-800 active:scale-[0.98]'}`}
                        >
                            {sent ? (
                                <>Message Sent!</>
                            ) : (
                                <>
                                    <Send size={18} /> Send Message
                                </>
                            )}
                        </button>
                    </form>
                </motion.div>

                {/* Contact Info */}
                <div className="space-y-6">
                    <ContactCard
                        icon={<Mail size={20} />}
                        label="Email Us"
                        value="support@wildrobot.com"
                        color="bg-blue-50 text-blue-600"
                    />
                    <ContactCard
                        icon={<Phone size={20} />}
                        label="Call Us"
                        value="+971 50 123 4567"
                        color="bg-purple-50 text-purple-600"
                    />
                    <ContactCard
                        icon={<MapPin size={20} />}
                        label="Visit Us"
                        value="Dubai Silicon Oasis, HQ"
                        color="bg-orange-50 text-orange-600"
                    />

                    <div className="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-3xl p-6 text-white shadow-lg shadow-emerald-500/20 relative overflow-hidden">
                        <div className="relative z-10">
                            <h3 className="font-black text-lg mb-2">Need immediate help?</h3>
                            <p className="text-sm text-emerald-100 mb-4">Check our knowledge base for quick answers to common questions.</p>
                            <button className="bg-white text-emerald-600 px-4 py-2 rounded-lg text-xs font-bold hover:bg-emerald-50 transition-colors">
                                View Docs
                            </button>
                        </div>
                        {/* Decorative Circles */}
                        <div className="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full translate-x-1/2 -translate-y-1/2 blur-2xl"></div>
                        <div className="absolute bottom-0 left-0 w-24 h-24 bg-black/10 rounded-full -translate-x-1/2 translate-y-1/2 blur-2xl"></div>
                    </div>
                </div>
            </div>
        </div>
    );
}

function ContactCard({ icon, label, value, color }) {
    return (
        <div className="bg-white rounded-2xl p-4 border border-slate-100 shadow-sm flex items-center gap-4 hover:border-slate-200 transition-colors">
            <div className={`h-12 w-12 rounded-xl flex items-center justify-center ${color}`}>
                {icon}
            </div>
            <div>
                <p className="text-xs font-bold text-slate-400 uppercase tracking-wider">{label}</p>
                <p className="font-bold text-slate-800">{value}</p>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/CoachProfile.jsx">
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import clsx from 'clsx';

export default function CoachProfile() {
    const [loading, setLoading] = useState(true);
    const navigate = useNavigate();

    // Mock Loading Effect
    useEffect(() => {
        const timer = setTimeout(() => setLoading(false), 1500);
        return () => clearTimeout(timer);
    }, []);

    const stats = [
        { label: 'Active Athletes', value: '115', icon: 'group', color: 'text-emerald-500' },
        { label: 'This Month', value: '82h', icon: 'schedule', color: 'text-blue-500' },
        { label: 'Invoiced', value: 'AED 12k', icon: 'payments', color: 'text-amber-500' },
    ];

    if (loading) return <ProfileSkeleton />;

    return (
        <div className="min-h-screen bg-gray-50 pb-24">
            {/* Hero Section */}
            <div className="relative bg-gradient-to-r from-emerald-500 to-teal-600 p-8 pb-16 shadow-lg">
                <div className="flex items-center gap-6 relative z-10">
                    <div className="h-24 w-24 rounded-full border-4 border-white/30 shadow-xl overflow-hidden bg-white/10 backdrop-blur-sm">
                        <div className="h-full w-full flex items-center justify-center text-white text-3xl font-black">
                            JP
                        </div>
                    </div>
                    <div className="text-white">
                        <h1 className="text-3xl font-black tracking-tight mb-1">Coach John</h1>
                        <p className="font-medium text-emerald-100 flex items-center gap-1">
                            <span className="material-symbols-outlined text-[18px]">verified</span>
                            Head Coach
                        </p>
                        <p className="text-xs text-emerald-200 mt-1 uppercase tracking-wider font-bold opacity-80">Sharjah Branch</p>
                    </div>
                </div>
                {/* Background Decor */}
                <div className="absolute top-0 right-0 p-3">
                    <button className="text-white/50 hover:text-white transition-colors">
                        <span className="material-symbols-outlined">edit</span>
                    </button>
                </div>
            </div>

            {/* Main Content (Overlapping Hero) */}
            <div className="px-4 -mt-8 relative z-20 space-y-6">

                {/* Stats Grid */}
                <div className="grid grid-cols-3 gap-3">
                    {stats.map((stat, idx) => (
                        <div key={idx} className="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col items-center justify-center text-center">
                            <span className={clsx("material-symbols-outlined text-[24px] mb-2", stat.color)}>{stat.icon}</span>
                            <span className="text-xl font-black text-slate-900 leading-none mb-1">{stat.value}</span>
                            <span className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{stat.label}</span>
                        </div>
                    ))}
                </div>

                {/* Tools & Settings */}
                <div className="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                    <ProfileLink icon="settings" label="App Settings" onClick={() => navigate('/settings')} />
                    <div className="h-[1px] bg-gray-50 mx-4"></div>
                    <ProfileLink icon="calendar_month" label="My Schedule" onClick={() => navigate('/schedule')} />
                    <div className="h-[1px] bg-gray-50 mx-4"></div>
                    <ProfileLink icon="description" label="My Payslips" onClick={() => alert("Payslips PDF")} />
                    <div className="h-[1px] bg-gray-50 mx-4"></div>
                    <ProfileLink icon="help" label="Support" onClick={() => alert("Support Chat")} />
                </div>

                {/* Logout */}
                <button
                    onClick={() => console.log('Logging out...')}
                    className="w-full bg-white text-red-500 font-bold py-4 rounded-2xl shadow-sm border border-red-100 hover:bg-red-50 transition-colors flex items-center justify-center gap-2"
                >
                    <span className="material-symbols-outlined">logout</span>
                    Log Out
                </button>

                <p className="text-center text-[10px] text-slate-400 font-bold tracking-widest uppercase">
                    Wild Robot System v3.1.0
                </p>
            </div>
        </div>
    );
}

function ProfileLink({ icon, label, onClick }) {
    return (
        <button onClick={onClick} className="w-full flex items-center gap-4 p-4 hover:bg-gray-50 transition-colors text-left group">
            <div className="h-10 w-10 rounded-full bg-gray-100 text-slate-500 flex items-center justify-center group-hover:bg-emerald-100 group-hover:text-emerald-600 transition-colors">
                <span className="material-symbols-outlined">{icon}</span>
            </div>
            <span className="flex-1 font-bold text-slate-700">{label}</span>
            <span className="material-symbols-outlined text-slate-300">chevron_right</span>
        </button>
    );
}

function ProfileSkeleton() {
    return (
        <div className="min-h-screen bg-gray-50 pb-24 animate-pulse">
            <div className="h-48 bg-gray-200"></div>
            <div className="px-4 -mt-8 space-y-6">
                <div className="grid grid-cols-3 gap-3">
                    {[1, 2, 3].map(i => <div key={i} className="h-24 bg-gray-300 rounded-2xl"></div>)}
                </div>
                <div className="h-64 bg-gray-300 rounded-2xl"></div>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/ComingSoon.jsx">
import React from 'react';
import { useNavigate } from 'react-router-dom';

export default function ComingSoon() {
    const navigate = useNavigate();

    return (
        <div className="min-h-[80vh] flex flex-col items-center justify-center text-center p-6 bg-slate-50/50 rounded-3xl border border-slate-200 border-dashed">
            <div className="bg-slate-100 p-6 rounded-full mb-6 relative">
                <span className="material-symbols-outlined text-6xl text-slate-300">construction</span>
                <div className="absolute bottom-0 right-0 bg-amber-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-sm">WIP</div>
            </div>
            <h2 className="text-3xl font-black text-slate-800 mb-2">Work in Progress</h2>
            <p className="text-slate-500 max-w-md mb-8 text-lg font-medium">
                We're building something amazing here. This feature will be available in the next major update.
            </p>
            <button
                onClick={() => navigate(-1)}
                className="bg-white border-2 border-slate-200 text-slate-600 px-6 py-3 rounded-xl font-bold hover:bg-slate-50 hover:border-slate-300 transition-colors shadow-sm flex items-center gap-2"
            >
                <span className="material-symbols-outlined">arrow_back</span>
                Go Back
            </button>
        </div>
    );
}
</file>

<file path="src/pages/Home.jsx">
import React, { useState, useEffect } from 'react';
import { format } from 'date-fns';
import { useNavigate } from 'react-router-dom';
import { supabase } from '../supabaseClient';
import clsx from 'clsx';

export default function Home() {
    const navigate = useNavigate();
    const [stats, setStats] = useState({ classes: 4, students: 32, checkedIn: 12 });
    const [announcements, setAnnouncements] = useState([]);
    const [loading, setLoading] = useState(true);

    const currentDate = new Date(); // Use real date
    const greeting = getGreeting(currentDate);

    // Mock "Live" Class
    const liveClass = {
        name: "Elite Boys (Sharjah)",
        time: "16:00 - 17:30",
        location: "Main Hall",
        attendees: 15,
        total: 18
    };

    // Mock "Up Next" Classes
    const upcomingClasses = [
        { id: 1, name: "Level 2 Girls", time: "17:30 - 18:30", branch: "Sharjah", students: 12 },
        { id: 2, name: "Intro to Gym", time: "18:30 - 19:30", branch: "Sharjah", students: 8 },
    ];

    useEffect(() => {
        // Simulate fetching stats
        setTimeout(() => setLoading(false), 1000);
        fetchAnnouncements();
    }, []);

    async function fetchAnnouncements() {
        const { data, error } = await supabase
            .from('announcements')
            .select('*')
            .order('created_at', { ascending: false })
            .limit(5);

        if (error || !data || data.length === 0) {
            // Mock Data Fallback
            setAnnouncements([
                {
                    id: 1,
                    type: 'celebration',
                    author_name: 'Patrick Nehemtallah',
                    author_avatar: '',
                    title: 'Employee of the Month',
                    content: 'Job well done! Patricia, you have truly shined this month! From chasing every lead to providing excellent customer support ðŸ¤, you showed consistency.',
                    image_url: 'https://images.unsplash.com/photo-1531545514256-b1400bc00f31?ixlib=rb-4.0.3&auto=format&fit=crop&w=1674&q=80',
                    created_at: new Date().toISOString()
                },
                {
                    id: 2,
                    type: 'news',
                    author_name: 'Head Office',
                    title: 'New Beam Rotation Schedule',
                    content: 'The updated rotation for Term 1 has been uploaded. Please review before Sunday to ensure all coaches are aligned.',
                    created_at: new Date(Date.now() - 7200000).toISOString() // 2 hours ago
                }
            ]);
        } else {
            setAnnouncements(data);
        }
    }

    function getGreeting(date) {
        const hour = date.getHours();
        if (hour < 12) return 'Good Morning';
        if (hour < 18) return 'Good Afternoon';
        return 'Good Evening';
    }

    return (
        <div className="min-h-screen bg-gray-50 pb-[100px]">
            {/* 1. Hero / Header */}
            <header className="bg-white px-6 pt-12 pb-6 flex justify-between items-center sticky top-0 z-10 border-b border-gray-100/50 backdrop-blur-md bg-white/90">
                <div>
                    <p className="text-xs font-bold text-slate-400 uppercase tracking-widest">{format(currentDate, 'EEEE, d MMM yyyy')}</p>
                    <h1 className="text-2xl font-black text-slate-900 mt-1">{greeting},<br /><span className="text-emerald-500">Coach Abdulla ðŸ‘‹</span></h1>
                </div>
                <button
                    onClick={() => navigate('/profile')}
                    className="h-12 w-12 rounded-full border-2 border-gray-100 p-0.5 hover:border-emerald-500 transition-colors"
                >
                    <div className="h-full w-full rounded-full bg-slate-200 flex items-center justify-center overflow-hidden">
                        {/* Placeholder Avatar */}
                        <div className="bg-emerald-100 text-emerald-600 font-bold h-full w-full flex items-center justify-center">CA</div>
                    </div>
                </button>
            </header>

            <main className="p-4 space-y-8">
                {/* 2. Live Now Card */}
                {/* Check if it's within "Live" hours or just show mock for demo */}
                <section>
                    <div className="relative overflow-hidden rounded-3xl bg-gradient-to-br from-[#064e3b] to-[#047857] shadow-xl shadow-emerald-900/20 text-white p-6">
                        {/* Background Decor */}
                        <div className="absolute -right-10 -top-10 h-40 w-40 rounded-full bg-white/5 blur-3xl"></div>
                        <div className="absolute -left-10 -bottom-10 h-40 w-40 rounded-full bg-emerald-400/10 blur-3xl"></div>

                        <div className="relative z-10">
                            <div className="flex justify-between items-start mb-6">
                                <div className="flex items-center gap-2 bg-white/10 backdrop-blur-md px-3 py-1 rounded-full border border-white/10">
                                    <span className="relative flex h-2.5 w-2.5">
                                        <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                                        <span className="relative inline-flex rounded-full h-2.5 w-2.5 bg-red-500"></span>
                                    </span>
                                    <span className="text-[10px] font-bold tracking-wider uppercase">Live Now</span>
                                </div>
                                <span className="text-emerald-200 text-sm font-medium bg-emerald-900/30 px-2 py-0.5 rounded-md">
                                    {liveClass.time}
                                </span>
                            </div>

                            <h2 className="text-2xl font-black tracking-tight mb-1">{liveClass.name}</h2>
                            <p className="text-emerald-100 text-sm font-medium flex items-center gap-1 mb-6">
                                <span className="material-symbols-outlined text-[16px]">location_on</span>
                                {liveClass.location}
                            </p>

                            <button
                                onClick={() => navigate('/schedule')} // Or specific class view
                                className="w-full bg-white text-emerald-900 font-bold py-3.5 rounded-xl shadow-lg hover:bg-emerald-50 active:scale-95 transition-all flex items-center justify-center gap-2 group"
                            >
                                Enter Class & Attendance
                                <span className="material-symbols-outlined transition-transform group-hover:translate-x-1">arrow_forward</span>
                            </button>
                        </div>
                    </div>
                </section>

                {/* 3. Today's Overview */}
                <section>
                    <h3 className="text-lg font-bold text-slate-900 mb-4 px-2">Today's Overview</h3>
                    <div className="grid grid-cols-3 gap-3">
                        <OverviewCard
                            icon="calendar_today"
                            value={stats.classes}
                            label="Classes"
                            color="text-blue-500"
                        />
                        <OverviewCard
                            icon="groups"
                            value={stats.students}
                            label="Expected"
                            color="text-amber-500"
                        />
                        <OverviewCard
                            icon="check_circle"
                            value={stats.checkedIn}
                            label="Checked In"
                            color="text-emerald-500"
                        />
                    </div>
                </section>

                {/* 4. Up Next Timeline */}
                <section>
                    <h3 className="text-lg font-bold text-slate-900 mb-4 px-2">Up Next</h3>
                    <div className="space-y-0">
                        {upcomingClasses.map((item, index) => (
                            <div key={item.id} className="flex gap-4 relative">
                                {/* Timeline Line */}
                                <div className="flex flex-col items-center">
                                    <div className="h-3 w-3 rounded-full border-2 border-emerald-500 bg-emerald-50 z-10"></div>
                                    {index !== upcomingClasses.length - 1 && (
                                        <div className="w-0.5 flex-1 bg-gray-200 my-1"></div>
                                    )}
                                </div>
                                {/* Content */}
                                <div className="pb-6 flex-1">
                                    <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:border-emerald-300 transition-colors cursor-pointer group">
                                        <div className="flex justify-between items-start mb-2">
                                            <h4 className="font-bold text-slate-800 group-hover:text-emerald-600 transition-colors">{item.name}</h4>
                                            <span className="text-xs font-bold text-slate-400 bg-gray-50 px-2 py-0.5 rounded-md">{item.time}</span>
                                        </div>
                                        <div className="flex items-center gap-2 text-xs text-slate-500">
                                            <span className="flex items-center gap-1">
                                                <span className="material-symbols-outlined text-[14px]">apartment</span>
                                                {item.branch}
                                            </span>
                                            <span className="h-1 w-1 rounded-full bg-gray-300"></span>
                                            <span className="flex items-center gap-1">
                                                <span className="material-symbols-outlined text-[14px]">group</span>
                                                {item.students} Students
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </section>

                {/* 5. Community Feed (Connecteam Style) */}
                <section>
                    <div className="flex justify-between items-center mb-4 px-2">
                        <h3 className="text-lg font-bold text-slate-900">Latest Updates</h3>
                        <button className="text-emerald-600 text-xs font-bold">View All</button>
                    </div>

                    <div className="space-y-4">
                        {announcements.length === 0 ? (
                            <div className="text-center py-8 text-slate-400 text-sm">
                                No updates yet. Check back later!
                            </div>
                        ) : (
                            announcements.map(item => (
                                <FeedCard key={item.id} item={item} />
                            ))
                        )}
                    </div>
                </section>
            </main>
        </div>
    );
}

function OverviewCard({ icon, value, label, color }) {
    return (
        <div className="bg-white p-3 rounded-2xl shadow-sm border border-gray-100 flex flex-col items-center justify-center text-center py-5">
            <span className={clsx("material-symbols-outlined text-[20px] mb-2", color)}>{icon}</span>
            <span className="text-xl font-black text-slate-900 leading-none mb-1">{value}</span>
            <span className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{label}</span>
        </div>
    );
}

function FeedCard({ item }) {
    const isCelebration = item.type === 'celebration';
    const dateStr = format(new Date(item.created_at), 'MMM d, h:mm a');

    return (
        <div className={clsx(
            "rounded-2xl shadow-sm border overflow-hidden transition-all hover:shadow-md",
            isCelebration ? "bg-purple-50 border-purple-100" : "bg-white border-gray-100"
        )}>
            {/* Header */}
            <div className="p-4 pb-2 flex items-center gap-3">
                <div className={clsx("h-10 w-10 rounded-full flex items-center justify-center font-bold text-sm", isCelebration ? "bg-purple-200 text-purple-700" : "bg-gray-100 text-slate-500")}>
                    {item.author_name ? item.author_name.charAt(0) : 'A'}
                </div>
                <div>
                    <h4 className="text-sm font-bold text-slate-900">{item.title}</h4>
                    <p className="text-xs text-slate-500">{item.author_name} â€¢ {dateStr}</p>
                </div>
            </div>

            {/* Content */}
            <div className="px-4 pb-4">
                <p className="text-sm text-slate-600 mb-3 whitespace-pre-wrap leading-relaxed">{item.content}</p>

                {/* Image Attachment */}
                {item.image_url && (
                    <div className="rounded-xl overflow-hidden mt-2 border border-gray-100/50">
                        <img src={item.image_url} alt="Post attachment" className="w-full h-48 object-cover" />
                    </div>
                )}
            </div>

            {/* Celebration Footer Overlay (Optional visual touch) */}
            {isCelebration && (
                <div className="h-1 w-full bg-gradient-to-r from-purple-300 via-pink-300 to-purple-300 opacity-50"></div>
            )}
        </div>
    );
}
</file>

<file path="src/pages/JoinTeam.jsx">
import React, { useState, useEffect } from 'react';
import { useSearchParams, useNavigate } from 'react-router-dom';
import { supabase } from '../supabaseClient';
import { Lock, User, ArrowRight, Loader2 } from 'lucide-react';

const JoinTeam = () => {
    const [searchParams] = useSearchParams();
    const navigate = useNavigate();
    const token = searchParams.get('token');

    const [loading, setLoading] = useState(true);
    const [invitation, setInvitation] = useState(null);
    const [formData, setFormData] = useState({ fullName: '', password: '' });
    const [error, setError] = useState(null);

    // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ØªÙˆÙƒÙ† Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
    useEffect(() => {
        const checkToken = async () => {
            if (!token) {
                setError("Invalid invitation link.");
                setLoading(false);
                return;
            }

            const { data, error } = await supabase
                .from('invitations')
                .select('*, academies(name)') // Ù†Ø¬ÙŠØ¨ Ø§Ø³Ù… Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø¨Ø§Ù„Ù…Ø±Ø©
                .eq('token', token)
                .eq('status', 'pending')
                .single();

            if (error || !data) {
                setError("This invitation has expired or is invalid.");
            } else {
                setInvitation(data);
            }
            setLoading(false);
        };

        checkToken();
    }, [token]);

    // 2. Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„
    const handleJoin = async (e) => {
        e.preventDefault();
        setLoading(true);

        try {
            // A. Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Auth
            const { data: authData, error: authError } = await supabase.auth.signUp({
                email: invitation.email,
                password: formData.password,
                options: {
                    data: {
                        full_name: formData.fullName,
                        role: invitation.role, // Ù†Ø£Ø®Ø° Ø§Ù„Ø¯ÙˆØ± Ù…Ù† Ø§Ù„Ø¯Ø¹ÙˆØ©
                    },
                },
            });

            if (authError) throw authError;

            const userId = authData.user?.id;

            if (userId) {
                // B. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ ÙˆØ±Ø¨Ø·Ù‡ Ø¨Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©
                const { error: profileError } = await supabase
                    .from('profiles')
                    .update({
                        academy_id: invitation.academy_id, // Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ø³Ø­Ø±ÙŠ
                        role: invitation.role,
                        full_name: formData.fullName,
                        setup_completed: true
                    })
                    .eq('id', userId);

                if (profileError) throw profileError;

                // C. Ø­Ø±Ù‚ Ø§Ù„Ø¯Ø¹ÙˆØ© (Ø¹Ø´Ø§Ù† Ù…ØªØ³ØªØ®Ø¯Ù…Ø´ ØªØ§Ù†ÙŠ)
                await supabase
                    .from('invitations')
                    .update({ status: 'accepted' })
                    .eq('id', invitation.id);

                // Redirect Coach to Dashboard
                navigate('/coach/home');
            }

        } catch (err) {
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };

    if (loading) return <div className="min-h-screen flex items-center justify-center bg-slate-50"><Loader2 className="animate-spin text-emerald-600 w-8 h-8" /></div>;

    if (error) return (
        <div className="min-h-screen flex items-center justify-center bg-slate-50 p-4">
            <div className="bg-white p-8 rounded-2xl shadow-sm text-center max-w-md">
                <div className="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 text-red-600 text-2xl">âš ï¸</div>
                <h2 className="text-xl font-bold text-slate-900 mb-2">Invitation Error</h2>
                <p className="text-slate-500">{error}</p>
            </div>
        </div>
    );

    return (
        <div className="min-h-screen bg-slate-900 flex flex-col justify-center items-center p-4">
            <div className="w-full max-w-md bg-white rounded-3xl shadow-2xl overflow-hidden">

                {/* Header */}
                <div className="bg-emerald-600 p-8 text-center">
                    <h1 className="text-2xl font-bold text-white mb-2">Welcome to the Team!</h1>
                    <p className="text-emerald-100">
                        You have been invited to join <br />
                        <span className="font-black text-white text-lg">{invitation?.academies?.name}</span>
                    </p>
                </div>

                {/* Form */}
                <div className="p-8">
                    <div className="mb-6 bg-emerald-50 p-4 rounded-xl border border-emerald-100">
                        <span className="text-xs font-bold text-emerald-600 uppercase tracking-wide">Role Assigned</span>
                        <div className="text-lg font-bold text-slate-800 capitalize">{invitation?.role.replace('_', ' ')}</div>
                        <div className="text-sm text-slate-500 mt-1">{invitation?.email}</div>
                    </div>

                    <form onSubmit={handleJoin} className="space-y-4">
                        <div>
                            <label className="text-sm font-bold text-slate-700 ml-1">Set Your Name</label>
                            <div className="relative mt-1">
                                <User className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                                <input
                                    type="text"
                                    required
                                    className="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none"
                                    placeholder="Captain Name"
                                    value={formData.fullName}
                                    onChange={(e) => setFormData({ ...formData, fullName: e.target.value })}
                                />
                            </div>
                        </div>

                        <div>
                            <label className="text-sm font-bold text-slate-700 ml-1">Create Password</label>
                            <div className="relative mt-1">
                                <Lock className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                                <input
                                    type="password"
                                    required
                                    className="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none"
                                    placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                                    value={formData.password}
                                    onChange={(e) => setFormData({ ...formData, password: e.target.value })}
                                />
                            </div>
                        </div>

                        <button className="w-full py-4 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 transition-all flex items-center justify-center gap-2 mt-4">
                            Accept & Login <ArrowRight className="w-5 h-5" />
                        </button>
                    </form>
                </div>
            </div>
        </div>
    );
};

export default JoinTeam;
</file>

<file path="src/pages/Landing.jsx">
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { motion, AnimatePresence } from 'framer-motion';
import { ArrowRight, Trophy, CheckCircle, Clock, Zap, Users, BarChart, LayoutDashboard, Shield, Play } from 'lucide-react';
import { supabase } from '../supabaseClient';

export default function Landing() {
    const navigate = useNavigate();
    const [activeHub, setActiveHub] = useState('coaching'); // 'coaching' or 'management'
    const [session, setSession] = useState(null);

    useEffect(() => {
        supabase.auth.getSession().then(({ data: { session } }) => {
            setSession(session);
        });

        const {
            data: { subscription },
        } = supabase.auth.onAuthStateChange((_event, session) => {
            setSession(session);
        });

        return () => subscription.unsubscribe();
    }, []);

    // Feature Lists
    const features = {
        coaching: [
            { icon: <Clock className="w-5 h-5 text-emerald-600" />, text: "Automated Scheduling & Check-ins" },
            { icon: <Trophy className="w-5 h-5 text-emerald-600" />, text: "Skill Tracking & Gamification" },
            { icon: <Zap className="w-5 h-5 text-emerald-600" />, text: "Video Analysis & Feedback" }
        ],
        management: [
            { icon: <Users className="w-5 h-5 text-blue-600" />, text: "Staff Payroll & Hours" },
            { icon: <BarChart className="w-5 h-5 text-blue-600" />, text: "Real-time Financial Reports" },
            { icon: <CheckCircle className="w-5 h-5 text-blue-600" />, text: "Automated Subscription Billing" }
        ]
    };

    return (
        <div className="min-h-screen bg-white font-sans text-slate-900 selection:bg-emerald-100">

            {/* --- 1. NAVBAR --- */}
            <nav className="fixed top-0 w-full bg-white/90 backdrop-blur-xl border-b border-slate-100 z-50">
                <div className="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
                    {/* Logo */}
                    <div className="flex items-center gap-2 cursor-pointer group" onClick={() => navigate('/')}>
                        <div className="bg-emerald-600 rounded-xl p-2 transition-transform group-hover:scale-105 group-hover:rotate-3 shadow-lg shadow-emerald-200">
                            <Trophy className="w-6 h-6 text-white" />
                        </div>
                        <span className="font-extrabold text-2xl tracking-tight text-slate-900">
                            Wild Robot
                        </span>
                    </div>

                    {/* Links */}
                    <div className="hidden md:flex items-center gap-10 text-sm font-bold text-slate-500">
                        <a href="#" className="hover:text-emerald-600 transition-colors">Platform</a>
                        <a href="#" className="hover:text-emerald-600 transition-colors">Solutions</a>
                        <button onClick={() => navigate('/pricing')} className="hover:text-emerald-600 transition-colors">Pricing</button>
                    </div>

                    {/* Actions */}
                    <div className="flex items-center gap-4">
                        {session ? (
                            <button
                                onClick={() => navigate('/coach/home')}
                                className="bg-slate-900 text-white px-6 py-3 rounded-xl text-sm font-bold hover:bg-black transition-all shadow-xl hover:shadow-2xl flex items-center gap-2 hover:-translate-y-0.5"
                            >
                                <LayoutDashboard className="w-4 h-4" />
                                Dashboard
                            </button>
                        ) : (
                            <>
                                <button
                                    onClick={() => navigate('/login')}
                                    className="text-sm font-bold text-slate-600 hover:text-emerald-600 transition-colors px-4 py-2"
                                >
                                    Log in
                                </button>
                                <button
                                    onClick={() => navigate('/signup')}
                                    className="bg-emerald-600 text-white px-6 py-3 rounded-xl text-sm font-bold hover:bg-emerald-500 transition-all shadow-lg shadow-emerald-200 hover:-translate-y-0.5"
                                >
                                    Start for free
                                </button>
                            </>
                        )}
                    </div>
                </div>
            </nav>

            {/* --- 2. HERO SECTION --- */}
            <main className="pt-40 pb-20 px-6 text-center max-w-7xl mx-auto">
                <motion.div
                    initial={{ opacity: 0, y: 30 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ duration: 0.8, ease: "easeOut" }}
                >
                    <div className="inline-flex items-center gap-2 bg-emerald-50 border border-emerald-100 text-emerald-700 px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-widest mb-8">
                        <span className="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                        New v3.0 Release
                    </div>

                    <h1 className="text-5xl md:text-7xl font-black text-slate-900 mb-8 tracking-tight leading-[1.1]">
                        The All-in-One OS for <br className="hidden md:block" />
                        <span className="text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-teal-500">
                            Deskless Sports Teams.
                        </span>
                    </h1>

                    <p className="text-xl md:text-2xl text-slate-500 max-w-3xl mx-auto mb-12 leading-relaxed font-medium">
                        Manage schedules, track athlete progress, and automate billing.
                        Give your coaches the tools to build champions.
                    </p>

                    <div className="flex flex-col md:flex-row items-center justify-center gap-4 mb-24">
                        <button
                            onClick={() => navigate('/setup')}
                            className="w-full md:w-auto px-10 py-5 bg-emerald-600 text-white rounded-2xl font-bold text-lg hover:bg-emerald-500 transition-all shadow-xl shadow-emerald-200 flex items-center justify-center gap-3 hover:-translate-y-1"
                        >
                            Start 14-Day Free Trial
                            <ArrowRight className="w-6 h-6" />
                        </button>
                        <button
                            onClick={() => navigate('/login')} // Demo flow usually
                            className="w-full md:w-auto px-10 py-5 bg-white text-slate-700 border border-slate-200 rounded-2xl font-bold text-lg hover:bg-slate-50 transition-all flex items-center justify-center gap-3 hover:-translate-y-1"
                        >
                            <Play className="w-6 h-6 fill-slate-700" />
                            Watch Demo
                        </button>
                    </div>
                </motion.div>

                {/* --- 3. HUB SWITCHER (Interactive Demo) --- */}
                <div className="bg-white rounded-[2.5rem] shadow-2xl border border-slate-200 overflow-hidden max-w-6xl mx-auto relative ring-1 ring-black/5">

                    {/* Toolbar */}
                    <div className="border-b border-slate-100 bg-slate-50/80 backdrop-blur p-4 flex justify-between items-center">
                        <div className="flex gap-2">
                            <div className="w-3 h-3 rounded-full bg-red-400"></div>
                            <div className="w-3 h-3 rounded-full bg-yellow-400"></div>
                            <div className="w-3 h-3 rounded-full bg-green-400"></div>
                        </div>
                        <div className="bg-slate-200/50 p-1 rounded-xl flex gap-1">
                            <button
                                onClick={() => setActiveHub('coaching')}
                                className={`px-5 py-2 rounded-lg text-sm font-bold transition-all duration-300 ${activeHub === 'coaching'
                                    ? 'bg-white shadow-sm text-emerald-700'
                                    : 'text-slate-500 hover:text-slate-700'
                                    }`}
                            >
                                Coaching Hub
                            </button>
                            <button
                                onClick={() => setActiveHub('management')}
                                className={`px-5 py-2 rounded-lg text-sm font-bold transition-all duration-300 ${activeHub === 'management'
                                    ? 'bg-white shadow-sm text-blue-700'
                                    : 'text-slate-500 hover:text-slate-700'
                                    }`}
                            >
                                Business Hub
                            </button>
                        </div>
                        <div className="w-16"></div> {/* Spacer */}
                    </div>

                    {/* Content Area */}
                    <div className="p-8 md:p-16 min-h-[500px] flex items-center bg-slate-50">
                        <AnimatePresence mode="wait">
                            <motion.div
                                key={activeHub}
                                initial={{ opacity: 0, x: 20 }}
                                animate={{ opacity: 1, x: 0 }}
                                exit={{ opacity: 0, x: -20 }}
                                transition={{ duration: 0.4 }}
                                className="grid md:grid-cols-2 gap-16 items-center w-full"
                            >
                                {/* Left: Text Content */}
                                <div className="text-left space-y-8">
                                    <div className={`inline-flex items-center gap-2 px-3 py-1 rounded-lg text-xs font-bold uppercase tracking-wider ${activeHub === 'coaching' ? 'bg-emerald-100 text-emerald-700' : 'bg-blue-100 text-blue-700'}`}>
                                        <Shield className="w-4 h-4" />
                                        {activeHub === 'coaching' ? 'For Coaches' : 'For Owners'}
                                    </div>

                                    <h3 className="text-4xl md:text-5xl font-black text-slate-900 leading-tight">
                                        {activeHub === 'coaching' ? 'Build Better Athletes.' : 'Run a Profitable Empire.'}
                                    </h3>

                                    <p className="text-slate-500 text-lg leading-relaxed font-medium">
                                        {activeHub === 'coaching'
                                            ? 'Everything your coaches need on the field. Plan sessions, track attendance, and evaluate skills in real-time.'
                                            : 'Streamline operations with automated billing, payroll, and powerful financial reporting tools.'}
                                    </p>

                                    <div className="space-y-4">
                                        {features[activeHub].map((feature, i) => (
                                            <motion.div
                                                key={i}
                                                initial={{ opacity: 0, x: -10 }}
                                                animate={{ opacity: 1, x: 0 }}
                                                transition={{ delay: i * 0.1 }}
                                                className="flex items-center gap-4 bg-white p-4 rounded-2xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow"
                                            >
                                                <div className={`p-2 rounded-lg ${activeHub === 'coaching' ? 'bg-emerald-50' : 'bg-blue-50'}`}>
                                                    {feature.icon}
                                                </div>
                                                <span className="font-bold text-slate-700">{feature.text}</span>
                                            </motion.div>
                                        ))}
                                    </div>
                                </div>

                                {/* Right: Visual Placeholder */}
                                <div className="relative group perspective-1000">
                                    {/* Abstract Background */}
                                    <div className={`aspect-[4/3] rounded-3xl shadow-2xl flex items-center justify-center relative overflow-hidden transition-all duration-500 transform group-hover:rotate-y-2 group-hover:scale-105 ${activeHub === 'coaching'
                                        ? 'bg-gradient-to-br from-emerald-500 to-teal-400 shadow-emerald-500/30'
                                        : 'bg-gradient-to-br from-blue-600 to-indigo-500 shadow-blue-500/30'
                                        }`}>

                                        {/* Mock UI Card */}
                                        <div className="absolute inset-x-8 inset-y-10 bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 p-6 flex flex-col gap-4 shadow-inner">
                                            {/* Header */}
                                            <div className="flex items-center justify-between mb-4">
                                                <div className="w-1/3 h-6 bg-white/40 rounded-full" />
                                                <div className="w-10 h-10 rounded-full bg-white/40" />
                                            </div>

                                            {/* Chart/Content Area */}
                                            <div className="flex-1 bg-white/20 rounded-xl w-full relative overflow-hidden flex items-end justify-around pb-4 px-4 gap-2">
                                                {[40, 70, 50, 90, 60, 80].map((h, idx) => (
                                                    <div key={idx} className="w-full bg-white/30 rounded-t-lg" style={{ height: `${h}%` }}></div>
                                                ))}
                                            </div>

                                            {/* Stats Row */}
                                            <div className="flex gap-3">
                                                <div className="flex-1 h-14 rounded-xl bg-white/20" />
                                                <div className="flex-1 h-14 rounded-xl bg-white/20" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </motion.div>
                        </AnimatePresence>
                    </div>
                </div>

                {/* --- 4. FOOTER / TRUST --- */}
                <div className="mt-24 text-slate-400 text-sm font-bold uppercase tracking-widest text-center">
                    Powering Next-Gen Academies
                </div>
            </main>
        </div>
    );
}
</file>

<file path="src/pages/LoginSelection.jsx">
import React, { useEffect } from 'react';
import { Link, useNavigate } from 'react-router-dom';
import { supabase } from '../supabaseClient';

export default function LoginSelection() {
    const navigate = useNavigate();

    useEffect(() => {
        // Check if user is already logged in, redirect to home if so
        supabase.auth.getSession().then(({ data: { session } }) => {
            if (session) {
                navigate('/coach/home');
            }
        });
    }, [navigate]);

    return (
        <div className="min-h-screen bg-gray-50 flex items-center justify-center p-4">
            <div className="max-w-4xl w-full">

                {/* Header */}
                <div className="text-center mb-12">
                    <div className="inline-flex items-center justify-center h-16 w-16 rounded-2xl bg-slate-900 text-white shadow-xl shadow-slate-300 mb-6">
                        <span className="material-symbols-outlined text-[36px]">smart_toy</span>
                    </div>
                    <h1 className="text-4xl font-black text-slate-900 tracking-tight mb-2">
                        Welcome to Wild Robot ðŸ¤–
                    </h1>
                    <p className="text-lg text-slate-500 font-medium">
                        Select your portal to continue.
                    </p>
                </div>

                {/* Cards Grid */}
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-3xl mx-auto">

                    {/* Staff Card */}
                    <Link
                        to="/coach/home" // Redirecting to new Coach Portal
                        className="group relative flex flex-col items-center text-center p-8 bg-white rounded-3xl border-2 border-transparent hover:border-emerald-500 shadow-sm hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer"
                    >
                        <div className="h-20 w-20 rounded-full bg-emerald-50 text-emerald-600 flex items-center justify-center mb-6 group-hover:bg-emerald-500 group-hover:text-white transition-colors">
                            <span className="material-symbols-outlined text-[40px]">business_center</span>
                        </div>
                        <h2 className="text-2xl font-bold text-slate-900 mb-2">Staff & Coaches</h2>
                        <p className="text-slate-500 mb-6">Manage academy, schedule, and revenue.</p>
                        <span className="mt-auto inline-flex items-center text-sm font-bold text-emerald-600 group-hover:translate-x-1 transition-transform">
                            Enter Portal <span className="material-symbols-outlined text-[16px] ml-1">arrow_forward</span>
                        </span>
                    </Link>

                    {/* Student Card */}
                    <Link
                        to="/student"
                        className="group relative flex flex-col items-center text-center p-8 bg-white rounded-3xl border-2 border-transparent hover:border-blue-500 shadow-sm hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer focus:outline-none focus:ring-4 focus:ring-blue-500/30"
                        aria-label="Student Portal: Book classes, view attendance, and pay fees."
                        role="listitem"
                    >
                        <div className="h-20 w-20 rounded-full bg-blue-50 text-blue-600 flex items-center justify-center mb-6 group-hover:bg-blue-500 group-hover:text-white transition-colors">
                            <span className="material-symbols-outlined text-[40px]">backpack</span>
                        </div>
                        <h2 className="text-2xl font-bold text-slate-900 mb-2">Student Portal</h2>
                        <p className="text-slate-500 mb-6">Book classes, view attendance, and pay fees.</p>
                        <span className="mt-auto inline-flex items-center text-sm font-bold text-blue-600 group-hover:translate-x-1 transition-transform">
                            Enter Portal <span className="material-symbols-outlined text-[16px] ml-1">arrow_forward</span>
                        </span>
                    </Link>

                </div>

                <div className="mt-12 text-center text-slate-400 text-sm">
                    &copy; {new Date().getFullYear()} Wild Robot Academy. All rights reserved.
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/MasterSchedule.jsx">
import React, { useState, useEffect } from 'react';
import {
    format,
    addDays,
    subDays,
    isSameDay,
} from 'date-fns';
import { clsx } from 'clsx';
import { supabase } from '../supabaseClient';

export default function MasterSchedule() {
    const [selectedDate, setSelectedDate] = useState(new Date());
    const [sessions, setSessions] = useState([]);
    const [loading, setLoading] = useState(false);
    const [players, setPlayers] = useState([]);
    const [showQuickAdd, setShowQuickAdd] = useState(false);

    const [error, setError] = useState(null);

    const isAdmin = true; // Mock role

    useEffect(() => {
        fetchSessions(selectedDate);
    }, [selectedDate]);

    useEffect(() => {
        if (showQuickAdd) {
            fetchPlayers();
        }
    }, [showQuickAdd]);

    const fetchSessions = async (date) => {
        setLoading(true);
        setError(null);
        // Format date to YYYY-MM-DD for exact match
        const todayStr = format(date, 'yyyy-MM-dd');

        // Fetch Sessions with Enrollments
        const { data: sessionData, error: sessionError } = await supabase
            .from('sessions')
            .select(`
                *,
                session_enrollments (
                    player:players ( id, name, level, parent_name, phone )
                )
            `)
            .eq('date', todayStr)
            .order('start_time', { ascending: true });

        if (sessionError) {
            console.error('Error fetching sessions:', sessionError);
            setError(sessionError.message); // Show error to user
            setLoading(false);
            return;
        }

        // Transform nested data to flat roster for UI
        const sessionsWithRoster = (sessionData || []).map(session => ({
            ...session,
            // TRANSFORM: Extract 'player' from 'session_enrollments' array
            roster: session.session_enrollments
                ? session.session_enrollments.map(enrollment => enrollment.player).filter(Boolean)
                : []
        }));

        setSessions(sessionsWithRoster);
        setLoading(false);
    };

    const fetchPlayers = async () => {
        const { data } = await supabase.from('players').select('*');
        if (data) setPlayers(data);
    };

    const handleDateChange = (direction) => {
        setSelectedDate(curr => direction === 'next' ? addDays(curr, 1) : subDays(curr, 1));
    };

    return (
        <div className="min-h-screen bg-gray-50 font-sans text-slate-600 pb-20">
            {/* Header */}
            <div className="bg-white border-b border-gray-100 px-4 py-3 sticky top-0 z-20 flex items-center justify-between shadow-sm">
                <div className="flex items-center gap-4">
                    <button onClick={() => handleDateChange('prev')} className="p-1 hover:bg-gray-100 rounded-lg text-slate-400 hover:text-slate-700">
                        <span className="material-symbols-outlined">chevron_left</span>
                    </button>
                    <div className="text-center">
                        <h2 className="text-lg font-bold text-slate-900 leading-none">{format(selectedDate, 'EEEE')}</h2>
                        <p className="text-xs font-medium text-emerald-500">{format(selectedDate, 'MMMM d, yyyy')}</p>
                    </div>
                    <button onClick={() => handleDateChange('next')} className="p-1 hover:bg-gray-100 rounded-lg text-slate-400 hover:text-slate-700">
                        <span className="material-symbols-outlined">chevron_right</span>
                    </button>
                </div>

                <button
                    onClick={() => setShowQuickAdd(true)}
                    className="flex items-center gap-2 bg-emerald-500 hover:bg-emerald-600 text-white px-4 py-2 rounded-xl text-sm font-bold shadow-sm transition-all active:scale-95"
                >
                    <span className="material-symbols-outlined text-[18px]">person_add</span>
                    Quick Add Athlete
                </button>
            </div>

            {/* Main Content */}
            <div className="max-w-3xl mx-auto p-4 space-y-6">
                {error ? (
                    <div className="bg-red-50 text-red-600 p-4 rounded-xl border border-red-200 text-center">
                        <p className="font-bold">Error loading schedule</p>
                        <p className="text-sm">{error}</p>
                        <p className="text-xs mt-2 text-red-400">Please check your database schema matches the query.</p>
                    </div>
                ) : loading ? (
                    <div className="text-center py-20 text-slate-400">Loading schedule...</div>
                ) : sessions.length === 0 ? (
                    <div className="text-center py-20">
                        <div className="inline-flex h-16 w-16 items-center justify-center rounded-full bg-gray-100 mb-4 text-slate-300">
                            <span className="material-symbols-outlined text-3xl">calendar_today</span>
                        </div>
                        <h3 className="text-xl font-bold text-slate-900">No sessions today</h3>
                    </div>
                ) : (
                    sessions.map(session => (
                        <SessionCard key={session.id} session={session} isAdmin={isAdmin} />
                    ))
                )}
            </div>

            {/* Quick Add Modal */}
            {showQuickAdd && (
                <QuickAddModal
                    players={players}
                    sessions={sessions}
                    onClose={() => setShowQuickAdd(false)}
                />
            )}
        </div>
    );
}

function SessionCard({ session, isAdmin }) {
    const capacity = session.capacity || 15;
    // Mock Roster
    const roster = session.roster || [];
    const progress = (roster.length / capacity) * 100;

    return (
        <div className="bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden group">
            {/* Header */}
            <div className="p-5 border-b border-gray-50">
                <div className="flex justify-between items-start mb-4">
                    <div className="flex items-center gap-3">
                        <div className={clsx(
                            "h-12 w-12 rounded-xl flex items-center justify-center font-bold text-white shadow-md",
                            session.branch === 'Ajman' ? 'bg-emerald-500' : 'bg-blue-500'
                        )}>
                            {session.branch ? session.branch.charAt(0) : 'G'}
                        </div>
                        <div>
                            <div className="flex items-center gap-2 mb-0.5">
                                <span className="px-2 py-0.5 rounded-md bg-gray-100 text-slate-600 text-[10px] font-bold uppercase tracking-wide">
                                    {session.time_start} - {session.time_end}
                                </span>
                            </div>
                            <h3 className="font-bold text-slate-900 text-lg">{session.title || 'Gymnastics Session'}</h3>
                        </div>
                    </div>
                    <div className="text-right">
                        <div className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-1">Coach</div>
                        <span className="text-sm font-semibold text-slate-700">{session.coach_name || 'Abdulla'}</span>
                    </div>
                </div>

                {/* Progress */}
                <div className="flex items-center gap-3">
                    <div className="flex-1 h-2 bg-gray-100 rounded-full overflow-hidden">
                        <div
                            className={clsx("h-full rounded-full transition-all", roster.length >= capacity ? "bg-red-500" : "bg-emerald-500")}
                            style={{ width: `${progress}%` }}
                        ></div>
                    </div>
                    <span className="text-xs font-bold text-slate-500 whitespace-nowrap">
                        {roster.length} / {capacity}
                    </span>
                </div>
            </div>

            {/* Roster Table */}
            <div className="bg-white">
                {roster.length === 0 ? (
                    <div className="p-6 text-center text-slate-400 italic text-sm">
                        No students enrolled.
                    </div>
                ) : (
                    <table className="w-full text-left border-collapse">
                        {/* Similar table code as in Schedule.jsx for roster */}
                        <tbody>
                            {roster.map(student => (
                                <tr key={student.id} className="border-b border-gray-50 last:border-0 hover:bg-gray-50">
                                    <td className="pl-5 py-3">
                                        <span className="font-bold text-slate-700 text-sm">{student.name}</span>
                                    </td>
                                    {/* Additional columns... */}
                                </tr>
                            ))}
                        </tbody>
                    </table>
                )}
            </div>
        </div>
    );
}

function QuickAddModal({ players, sessions, onClose }) {
    const [selectedPlayer, setSelectedPlayer] = useState(null);

    // Smart Logic to find recommended sessions for the selected player
    const getRecommendedSessions = (player) => {
        if (!player) return [];
        const isYoung = player.age < 7;
        const isAdvanced = ['Silver', 'Gold'].includes(player.level);

        if (isYoung) {
            return sessions.filter(s => parseInt(s.start_time.split(':')[0]) < 18);
        } else if (isAdvanced) {
            return sessions.filter(s => parseInt(s.start_time.split(':')[0]) >= 18);
        }
        return [];
    };

    const recommended = getRecommendedSessions(selectedPlayer);

    return (
        <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm p-4">
            <div className="bg-white rounded-2xl shadow-xl w-full max-w-lg overflow-hidden flex flex-col max-h-[80vh]">
                <div className="p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50">
                    <h3 className="font-bold text-lg text-slate-900">
                        {selectedPlayer ? `Assign ${selectedPlayer.name}` : 'Select Player'}
                    </h3>
                    <button onClick={onClose} className="h-8 w-8 rounded-full hover:bg-gray-200 flex items-center justify-center text-slate-500">
                        <span className="material-symbols-outlined">close</span>
                    </button>
                </div>

                <div className="flex-1 overflow-y-auto p-2">
                    {!selectedPlayer ? (
                        players.map(player => (
                            <button
                                key={player.id}
                                onClick={() => setSelectedPlayer(player)}
                                className="w-full flex items-center gap-3 p-3 hover:bg-gray-50 rounded-xl transition-colors text-left"
                            >
                                <div className="h-10 w-10 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center font-bold text-sm">
                                    {player.name.charAt(0)}
                                </div>
                                <div>
                                    <p className="font-bold text-slate-900">{player.name}</p>
                                    <p className="text-xs text-slate-500">{player.level} â€¢ {player.age} yrs</p>
                                </div>
                            </button>
                        ))
                    ) : (
                        <div className="space-y-2 p-2">
                            <button onClick={() => setSelectedPlayer(null)} className="text-sm text-emerald-600 hover:underline mb-2 flex items-center gap-1">
                                <span className="material-symbols-outlined text-sm">arrow_back</span> Back to players
                            </button>
                            <h4 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Available Sessions</h4>
                            {sessions.map(session => {
                                const isRecommended = recommended.find(r => r.id === session.id);
                                return (
                                    <button
                                        key={session.id}
                                        className={clsx(
                                            "w-full p-4 rounded-xl border text-left transition-all relative overflow-hidden",
                                            isRecommended
                                                ? "border-emerald-500 bg-emerald-50 ring-1 ring-emerald-500 shadow-sm"
                                                : "border-gray-100 bg-white hover:border-gray-300"
                                        )}
                                        onClick={() => {
                                            alert(`Assigned to ${session.start_time}!`);
                                            onClose();
                                        }}
                                    >
                                        {isRecommended && (
                                            <div className="absolute top-0 right-0 bg-emerald-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-bl-lg">
                                                RECOMMENDED
                                            </div>
                                        )}
                                        <div className="flex justify-between items-center">
                                            <div>
                                                <p className="font-bold text-slate-900">{session.title}</p>
                                                <p className="text-xs text-slate-500">{session.start_time} - {session.end_time} â€¢ {session.branch}</p>
                                            </div>
                                            {isRecommended && <span className="material-symbols-outlined text-emerald-600">check_circle</span>}
                                        </div>
                                    </button>
                                );
                            })}
                        </div>
                    )}
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/NotFound.jsx">
import React from 'react';
import { useNavigate } from 'react-router-dom';

export default function NotFound() {
    const navigate = useNavigate();

    return (
        <div className="min-h-screen flex flex-col items-center justify-center text-center p-6 bg-slate-50">
            <div className="bg-white p-8 rounded-3xl shadow-xl border border-slate-100 max-w-lg w-full">
                <div className="text-8xl mb-4 transform rotate-12 inline-block">ðŸ›¸</div>
                <h1 className="text-6xl font-black text-slate-900 mb-2">404</h1>
                <h2 className="text-2xl font-bold text-slate-800 mb-4">Lost in Space?</h2>
                <p className="text-slate-500 mb-8 font-medium">
                    The page you are looking for has drifted away or doesn't exist.
                </p>
                <div className="flex flex-col gap-3">
                    <button
                        onClick={() => navigate('/coach/home')}
                        className="w-full bg-slate-900 text-white px-6 py-4 rounded-xl font-bold hover:bg-slate-800 transition-colors shadow-lg flex items-center justify-center gap-2"
                    >
                        <span className="material-symbols-outlined">dashboard</span>
                        Return to Dashboard
                    </button>
                    <button
                        onClick={() => navigate(-1)}
                        className="w-full bg-white border-2 border-slate-200 text-slate-600 px-6 py-4 rounded-xl font-bold hover:bg-slate-50 hover:border-slate-300 transition-colors flex items-center justify-center gap-2"
                    >
                        <span className="material-symbols-outlined">arrow_back</span>
                        Go Back
                    </button>
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/pages/onboarding/SetupWizard.jsx">
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useNavigate } from 'react-router-dom';
import { supabase } from '../../supabaseClient';
import { Trophy, ArrowRight, Check, Building2, Dumbbell, MapPin, Loader2 } from 'lucide-react';

export default function SetupWizard() {
    const navigate = useNavigate();
    const [step, setStep] = useState(1);
    const [loading, setLoading] = useState(false);

    const [formData, setFormData] = useState({
        academyName: '',
        sport: '',
        branches: '1'
    });

    const handleNext = () => {
        if (step < 3) setStep(step + 1);
    };

    const handleBack = () => {
        if (step > 1) setStep(step - 1);
    };

    const handleSubmit = async () => {
        setLoading(true);
        try {
            // 1. Get Fresh User directly from Supabase
            const { data: { user }, error: authError } = await supabase.auth.getUser();
            if (authError || !user) {
                // Redirect immediately if session is dead
                window.location.href = '/login';
                return;
            }

            // 2. Insert Academy
            const { data: academy, error: academyError } = await supabase
                .from('academies')
                .insert([{
                    name: formData.academyName,
                    owner_id: user.id,
                    sport_type: formData.sport,
                    branch_count_tier: formData.branches
                }])
                .select()
                .single();

            if (academyError) throw academyError;

            // 3. Link Profile
            const { error: profileError } = await supabase
                .from('profiles')
                .update({
                    academy_id: academy.id,
                    role: 'owner',
                    onboarding_step: 4,
                    academy_name: formData.academyName
                })
                .eq('id', user.id);

            if (profileError) throw profileError;

            // 4. Force Token Refresh (Critical for RLS to update immediately)
            await supabase.auth.refreshSession();

            // 5. Redirect (Force Reload to ensure clean state)
            window.location.href = '/coach/home';

        } catch (error) {
            console.error("Setup Error:", error);
            alert("Setup failed: " + error.message);
        } finally {
            setLoading(false);
        }
    };

    const stepVariants = {
        hidden: { opacity: 0, x: 50 },
        visible: { opacity: 1, x: 0 },
        exit: { opacity: 0, x: -50 }
    };

    return (
        <div className="min-h-screen bg-slate-50 flex flex-col items-center justify-center p-6 text-slate-900 font-sans">

            {/* Progress Bar */}
            <div className="w-full max-w-lg mb-8">
                <div className="flex justify-between text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">
                    <span>Step {step} of 3</span>
                    <span>{Math.round((step / 3) * 100)}%</span>
                </div>
                <div className="h-2 bg-slate-200 rounded-full overflow-hidden">
                    <motion.div
                        className="h-full bg-emerald-500"
                        initial={{ width: 0 }}
                        animate={{ width: `${(step / 3) * 100}%` }}
                        transition={{ duration: 0.5 }}
                    />
                </div>
            </div>

            <motion.div
                className="bg-white w-full max-w-lg rounded-3xl shadow-xl border border-slate-100 overflow-hidden"
                initial={{ scale: 0.9, opacity: 0 }}
                animate={{ scale: 1, opacity: 1 }}
            >
                <div className="p-8 md:p-12">
                    <AnimatePresence mode="wait">

                        {/* STEP 1: NAME */}
                        {step === 1 && (
                            <motion.div key="step1" variants={stepVariants} initial="hidden" animate="visible" exit="exit">
                                <div className="w-14 h-14 bg-indigo-50 rounded-2xl flex items-center justify-center text-indigo-600 mb-6">
                                    <Building2 size={28} />
                                </div>
                                <h2 className="text-3xl font-black mb-3">Name your Academy</h2>
                                <p className="text-slate-500 mb-8 font-medium">This will be displayed on your branded certificates and reports.</p>

                                <input
                                    autoFocus
                                    type="text"
                                    value={formData.academyName}
                                    onChange={(e) => setFormData({ ...formData, academyName: e.target.value })}
                                    placeholder="e.g. Elite Sports Club"
                                    className="w-full text-xl font-bold border-b-2 border-slate-200 py-3 focus:outline-none focus:border-emerald-500 transition-colors placeholder:text-slate-300"
                                />
                                <div className="mt-8 flex justify-end">
                                    <button
                                        disabled={!formData.academyName.trim()}
                                        onClick={handleNext}
                                        className="bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-emerald-500 text-white px-8 py-3 rounded-xl font-bold flex items-center gap-2 shadow-lg shadow-emerald-200 transition-all active:scale-95"
                                    >
                                        Next Step <ArrowRight size={18} />
                                    </button>
                                </div>
                            </motion.div>
                        )}

                        {/* STEP 2: SPORT */}
                        {step === 2 && (
                            <motion.div key="step2" variants={stepVariants} initial="hidden" animate="visible" exit="exit">
                                <div className="w-14 h-14 bg-orange-50 rounded-2xl flex items-center justify-center text-orange-600 mb-6">
                                    <Dumbbell size={28} />
                                </div>
                                <h2 className="text-3xl font-black mb-3">What's your main sport?</h2>
                                <p className="text-slate-500 mb-8 font-medium">We'll tailor the experience to your training style.</p>

                                <div className="space-y-3">
                                    {['Gymnastics', 'Swimming', 'Football', 'Basketball', 'Martial Arts', 'Other'].map((sport) => (
                                        <button
                                            key={sport}
                                            onClick={() => setFormData({ ...formData, sport })}
                                            className={`w-full p-4 rounded-xl border-2 text-left font-bold transition-all flex items-center justify-between ${formData.sport === sport
                                                ? 'border-emerald-500 bg-emerald-50 text-emerald-700'
                                                : 'border-slate-100 hover:border-slate-300 text-slate-600'
                                                }`}
                                        >
                                            {sport}
                                            {formData.sport === sport && <Check size={20} className="text-emerald-600" />}
                                        </button>
                                    ))}
                                </div>
                                <div className="mt-8 flex justify-between">
                                    <button onClick={handleBack} className="text-slate-400 font-bold hover:text-slate-600">Back</button>
                                    <button
                                        disabled={!formData.sport}
                                        onClick={handleNext}
                                        className="bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-emerald-500 text-white px-8 py-3 rounded-xl font-bold flex items-center gap-2 shadow-lg shadow-emerald-200 transition-all active:scale-95"
                                    >
                                        Next Step <ArrowRight size={18} />
                                    </button>
                                </div>
                            </motion.div>
                        )}

                        {/* STEP 3: BRANCHES */}
                        {step === 3 && (
                            <motion.div key="step3" variants={stepVariants} initial="hidden" animate="visible" exit="exit">
                                <div className="w-14 h-14 bg-blue-50 rounded-2xl flex items-center justify-center text-blue-600 mb-6">
                                    <MapPin size={28} />
                                </div>
                                <h2 className="text-3xl font-black mb-3">How big is your team?</h2>
                                <p className="text-slate-500 mb-8 font-medium">This helps us set up your branch management.</p>

                                <div className="grid grid-cols-1 gap-4">
                                    {[
                                        { val: '1', label: 'Single Branch', desc: 'Just one location' },
                                        { val: '2-5', label: 'Growing (2-5)', desc: 'Multiple locations' },
                                        { val: '5+', label: 'Enterprise (5+)', desc: 'Large scale operation' }
                                    ].map((opt) => (
                                        <button
                                            key={opt.val}
                                            onClick={() => setFormData({ ...formData, branches: opt.val })}
                                            className={`p-5 rounded-2xl border-2 text-left transition-all ${formData.branches === opt.val
                                                ? 'border-emerald-500 bg-emerald-50 ring-1 ring-emerald-500/20'
                                                : 'border-slate-100 hover:border-slate-300'
                                                }`}
                                        >
                                            <div className="font-bold text-slate-900">{opt.label}</div>
                                            <div className="text-xs text-slate-500 font-medium">{opt.desc}</div>
                                        </button>
                                    ))}
                                </div>

                                <div className="mt-8 flex justify-between items-center">
                                    <button onClick={handleBack} className="text-slate-400 font-bold hover:text-slate-600">Back</button>
                                    <button
                                        onClick={handleSubmit}
                                        disabled={loading}
                                        className="bg-emerald-600 hover:bg-emerald-500 text-white px-8 py-3 rounded-xl font-bold flex items-center gap-2 shadow-lg shadow-emerald-200 transition-all active:scale-95 min-w-[140px] justify-center"
                                    >
                                        {loading ? <Loader2 className="animate-spin" /> : 'Launch Academy ðŸš€'}
                                    </button>
                                </div>
                            </motion.div>
                        )}

                    </AnimatePresence>
                </div>
            </motion.div>
        </div>
    );
}
</file>

<file path="src/pages/owner/AcademySetup.jsx">
import React, { useState, useEffect } from 'react';
import { supabase } from '../../supabaseClient';
import {
    Building2, MapPin, ArrowRight, CheckCircle,
    GraduationCap, BicepsFlexed, Banknote, Palette,
    ChevronLeft, Sparkles, AlertTriangle
} from 'lucide-react';

const AcademySetup = () => {
    // State
    const [step, setStep] = useState(1);
    const [loading, setLoading] = useState(true);
    const [submitting, setSubmitting] = useState(false);
    const [error, setError] = useState(null);
    const [debugLog, setDebugLog] = useState([]);

    // Data
    const [formData, setFormData] = useState({
        name: '',
        location: '',
        businessType: 'academy',
        sport: 'Gymnastics',
        scale: '1-50',
        currency: 'AED',
        brandColor: '#10b981'
    });

    const totalSteps = 4;

    // Helper to log debug info safely
    const log = (msg, data = null) => {
        const timestamp = new Date().toLocaleTimeString();
        const line = `[${timestamp}] ${msg} ${data ? JSON.stringify(data) : ''}`;
        console.log(line);
        setDebugLog(prev => [...prev.slice(-4), line]);
    };

    // 1. Initial Check on Mount (HOTFIXED: Uses maybeSingle to avoid 406)
    useEffect(() => {
        const checkExistingAcademy = async () => {
            log("Checking existing academy...");
            try {
                const { data: { user } } = await supabase.auth.getUser();
                if (!user) {
                    log("No user session.");
                    return;
                }

                // Use maybeSingle to avoid 406 error on empty rows
                const { data, error } = await supabase
                    .from('academies')
                    .select('*')
                    .eq('owner_id', user.id)
                    .maybeSingle();

                if (error) throw error;

                if (data) {
                    log("Academy found, redirecting...", data.id);
                    // Academy exists, redirect
                    window.location.href = '/owner/dashboard';
                } else {
                    log("No academy found. Ready for setup.");
                }

            } catch (err) {
                console.error('Check failed:', err);
                log("Check error (ignoring):", err.message);
                // Don't alert on 406/Not found, just let them setup
            } finally {
                setLoading(false); // CRITICAL: Must run to remove white screen
            }
        };
        checkExistingAcademy();
    }, []);

    // 2. Field Updates
    const updateField = (field, value) => {
        setFormData(prev => ({ ...prev, [field]: value }));
    };

    const handleNext = () => setStep(prev => Math.min(prev + 1, totalSteps));
    const handleBack = () => setStep(prev => Math.max(prev - 1, 1));

    // 3. SUBMISSION LOGIC
    const handleSubmit = async () => {
        setSubmitting(true);
        setError(null);
        log("ðŸš€ Starting Submission...");

        try {
            const { data: { user } } = await supabase.auth.getUser();
            if (!user) throw new Error("Session expired. Please copy your data and refresh.");

            const subscriptionModel = formData.businessType === 'academy' ? 'term_based' : 'monthly_recurring';

            // B. Insert Academy
            log("Upserting Academy...");
            const { data: academy, error: upsertError } = await supabase
                .from('academies')
                .upsert({
                    owner_id: user.id,
                    name: formData.name,
                    location: formData.location,
                    business_type: formData.businessType,
                    type: formData.sport,
                    currency: formData.currency,
                    subscription_model: subscriptionModel,
                    brand_color: formData.brandColor,
                    setup_completed: true,
                    subscription_status: 'trial'
                }, { onConflict: 'owner_id' })
                .select()
                .single();

            if (upsertError) throw upsertError;
            log("âœ… Academy Created:", academy.id);

            // C. Link Profile
            log("Linking Profile...");
            const { error: profileError } = await supabase
                .from('profiles')
                .update({
                    academy_id: academy.id,
                    role: 'owner'
                })
                .eq('id', user.id);

            if (profileError) throw profileError;
            log("âœ… Profile Linked.");

            // D. Success
            window.location.href = '/owner/dashboard';

        } catch (err) {
            console.error("SETUP ERROR:", err);
            setError(err.message); // Show visible error
            log("ðŸ’¥ ERROR:", err.message);
        } finally {
            setSubmitting(false);
        }
    };

    if (loading) {
        return (
            <div className="min-h-screen flex items-center justify-center bg-slate-50">
                <div className="text-center">
                    <div className="w-12 h-12 border-4 border-slate-200 border-t-emerald-500 rounded-full animate-spin mx-auto mb-4"></div>
                    <p className="font-bold text-slate-500">Initializing Setup...</p>
                    <div className="mt-4 text-xs font-mono text-slate-300 max-w-xs mx-auto text-left opacity-50">
                        {debugLog.map((l, i) => <div key={i}>{l}</div>)}
                    </div>
                </div>
            </div>
        );
    }

    return (
        <div className="min-h-screen bg-slate-50 flex items-center justify-center p-4 font-sans text-slate-900">
            <div className="w-full max-w-xl">

                {/* Header */}
                <div className="mb-8 text-center animate-fade-in-down">
                    <h1 className="text-2xl font-black text-slate-900 mb-2">Setup Your Kingdom</h1>
                    <div className="flex items-center justify-center gap-2 mb-4">
                        {[1, 2, 3, 4].map(i => (
                            <div key={i} className={`h-2 rounded-full transition-all duration-300 ${i <= step ? 'w-8 bg-emerald-500' : 'w-2 bg-slate-200'}`} />
                        ))}
                    </div>
                    <p className="text-slate-400 text-sm font-bold uppercase tracking-wider">Step {step} of 4</p>
                </div>

                {/* Main Card */}
                <div className="bg-white rounded-3xl shadow-xl border border-slate-100 overflow-hidden relative transition-all duration-300">

                    {/* Error Display */}
                    {error && (
                        <div className="bg-red-50 text-red-700 p-4 text-sm font-bold border-b border-red-100 animate-pulse">
                            <div className="flex items-center gap-2 mb-1">
                                <AlertTriangle className="w-5 h-5 text-red-600" />
                                <span>Something went wrong!</span>
                            </div>
                            <p className="font-normal opacity-90">{error}</p>
                        </div>
                    )}

                    {/* Step Content */}
                    <div className="p-8">
                        {step === 1 && (
                            <StepIdentity formData={formData} updateField={updateField} />
                        )}
                        {step === 2 && (
                            <StepBusiness formData={formData} updateField={updateField} />
                        )}
                        {step === 3 && (
                            <StepScale formData={formData} updateField={updateField} />
                        )}
                        {step === 4 && (
                            <StepBranding formData={formData} updateField={updateField} />
                        )}
                    </div>

                    {/* Footer Actions */}
                    <div className="bg-slate-50 p-6 border-t border-slate-100 flex items-center justify-between">
                        {step > 1 ? (
                            <button
                                onClick={handleBack}
                                disabled={submitting}
                                className="text-slate-500 font-bold hover:text-slate-800 disabled:opacity-50 flex items-center gap-2 px-4 py-2"
                            >
                                <ChevronLeft className="w-4 h-4" /> Back
                            </button>
                        ) : <div />}

                        {step < totalSteps ? (
                            <button
                                onClick={handleNext}
                                disabled={!formData.name}
                                className="bg-slate-900 text-white px-8 py-3 rounded-xl font-bold hover:bg-slate-800 disabled:opacity-50 transition-all flex items-center gap-2"
                            >
                                Next Step <ArrowRight className="w-4 h-4" />
                            </button>
                        ) : (
                            <button
                                onClick={handleSubmit}
                                disabled={submitting}
                                className="bg-emerald-500 text-white px-8 py-3 rounded-xl font-bold hover:bg-emerald-600 shadow-lg shadow-emerald-500/30 transition-all flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed"
                            >
                                {submitting ? (
                                    <>
                                        <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                                        Building...
                                    </>
                                ) : (
                                    <>
                                        Launch Kingdom <Sparkles className="w-4 h-4" />
                                    </>
                                )}
                            </button>
                        )}
                    </div>
                </div>
            </div>
        </div>
    );
};

// --- SUB-COMPONENTS ---

const StepIdentity = ({ formData, updateField }) => (
    <div className="space-y-6 animate-fade-in-up">
        <div className="text-center mb-6">
            <div className="w-14 h-14 bg-emerald-100 rounded-2xl flex items-center justify-center mx-auto mb-4 text-emerald-600">
                <Building2 className="w-7 h-7" />
            </div>
            <h2 className="text-xl font-bold">Name your Kingdom</h2>
        </div>
        <div>
            <label className="block text-sm font-bold text-slate-700 mb-1">Academy Name</label>
            <input
                autoFocus
                value={formData.name}
                onChange={e => updateField('name', e.target.value)}
                className="w-full p-4 bg-white border-2 border-slate-200 rounded-xl focus:border-emerald-500 outline-none font-bold text-lg transition-colors"
                placeholder="Ex: Wild Robot Gym"
            />
        </div>
        <div>
            <label className="block text-sm font-bold text-slate-700 mb-1">Location</label>
            <div className="relative">
                <MapPin className="absolute left-4 top-4 w-5 h-5 text-slate-400" />
                <input
                    value={formData.location}
                    onChange={e => updateField('location', e.target.value)}
                    className="w-full pl-12 p-4 bg-white border-2 border-slate-200 rounded-xl focus:border-emerald-500 outline-none font-bold transition-colors"
                    placeholder="City, Country"
                />
            </div>
        </div>
    </div>
);

const StepBusiness = ({ formData, updateField }) => (
    <div className="space-y-6 animate-fade-in-up">
        <div className="text-center mb-6">
            <h2 className="text-xl font-bold">Select Operation Mode</h2>
        </div>
        <div className="grid grid-cols-2 gap-4">
            <div
                onClick={() => updateField('businessType', 'academy')}
                className={`cursor-pointer p-4 rounded-xl border-2 transition-all ${formData.businessType === 'academy' ? 'border-emerald-500 bg-emerald-50' : 'border-slate-100 hover:border-emerald-200'}`}
            >
                <GraduationCap className={`w-8 h-8 mb-2 ${formData.businessType === 'academy' ? 'text-emerald-600' : 'text-slate-400'}`} />
                <h3 className="font-bold text-slate-900">Academy</h3>
                <p className="text-xs text-slate-500 mt-1">Term-based</p>
            </div>
            <div
                onClick={() => updateField('businessType', 'club')}
                className={`cursor-pointer p-4 rounded-xl border-2 transition-all ${formData.businessType === 'club' ? 'border-blue-500 bg-blue-50' : 'border-slate-100 hover:border-blue-200'}`}
            >
                <BicepsFlexed className={`w-8 h-8 mb-2 ${formData.businessType === 'club' ? 'text-blue-600' : 'text-slate-400'}`} />
                <h3 className="font-bold text-slate-900">Club</h3>
                <p className="text-xs text-slate-500 mt-1">Membership</p>
            </div>
        </div>
        <div>
            <label className="block text-sm font-bold text-slate-700 mb-2">Primary Sport</label>
            <select
                value={formData.sport}
                onChange={e => updateField('sport', e.target.value)}
                className="w-full p-4 bg-white border-2 border-slate-200 rounded-xl focus:border-emerald-500 outline-none font-bold"
            >
                {['Gymnastics', 'Swimming', 'CrossFit', 'Martial Arts', 'Football', 'General Fitness'].map(s => (
                    <option key={s} value={s}>{s}</option>
                ))}
            </select>
        </div>
    </div>
);

const StepScale = ({ formData, updateField }) => (
    <div className="space-y-6 animate-fade-in-up">
        <div className="text-center mb-6">
            <h2 className="text-xl font-bold">Scale & Currency</h2>
        </div>
        <div>
            <label className="block text-sm font-bold text-slate-700 mb-2">Athlete Check</label>
            <div className="grid grid-cols-3 gap-3">
                {['1-50', '51-200', '200+'].map(opt => (
                    <button
                        key={opt}
                        onClick={() => updateField('scale', opt)}
                        className={`py-3 rounded-xl border-2 font-bold text-sm ${formData.scale === opt ? 'border-emerald-500 bg-emerald-50 text-emerald-700' : 'border-slate-100 text-slate-500 hover:border-emerald-200'}`}
                    >
                        {opt}
                    </button>
                ))}
            </div>
        </div>
        <div>
            <label className="block text-sm font-bold text-slate-700 mb-2">Operating Currency</label>
            <div className="relative">
                <Banknote className="absolute left-4 top-4 w-5 h-5 text-slate-400" />
                <select
                    value={formData.currency}
                    onChange={e => updateField('currency', e.target.value)}
                    className="w-full pl-12 p-4 bg-white border-2 border-slate-200 rounded-xl focus:border-emerald-500 outline-none font-bold"
                >
                    <option value="AED">AED (Emirati Dirham)</option>
                    <option value="USD">USD (US Dollar)</option>
                    <option value="SAR">SAR (Saudi Riyal)</option>
                    <option value="EUR">EUR (Euro)</option>
                </select>
            </div>
        </div>
    </div>
);

const StepBranding = ({ formData, updateField }) => (
    <div className="space-y-6 animate-fade-in-up">
        <div className="text-center mb-6">
            <div className="w-14 h-14 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-4 text-purple-600">
                <Palette className="w-7 h-7" />
            </div>
            <h2 className="text-xl font-bold">Theme Color</h2>
        </div>
        <div className="grid grid-cols-2 gap-4">
            {[
                { name: 'Emerald', hex: '#10b981', bg: 'bg-emerald-500' },
                { name: 'Blue', hex: '#3b82f6', bg: 'bg-blue-500' },
                { name: 'Purple', hex: '#8b5cf6', bg: 'bg-purple-500' },
                { name: 'Orange', hex: '#f97316', bg: 'bg-orange-500' }
            ].map(color => (
                <button
                    key={color.name}
                    onClick={() => updateField('brandColor', color.hex)}
                    className={`p-4 rounded-xl border-2 flex items-center gap-3 transition-all ${formData.brandColor === color.hex ? 'border-slate-900 bg-slate-50' : 'border-slate-100'}`}
                >
                    <div className={`w-8 h-8 rounded-full ${color.bg} shadow-sm`} />
                    <span className="font-bold text-slate-700">{color.name}</span>
                    {formData.brandColor === color.hex && <CheckCircle className="ml-auto w-5 h-5 text-slate-900" />}
                </button>
            ))}
        </div>
    </div>
);

export default AcademySetup;
</file>

<file path="src/pages/owner/AthletesRoster.jsx">
import React, { useState, useEffect } from 'react';
import {
    Users, Search, Filter, Plus, Trophy
} from 'lucide-react';
import { supabase } from '../../supabaseClient';
import EmptyState from '../../components/ui/EmptyState';
import BottomSheet from '../../components/ui/BottomSheet';
import AthleteCard from '../../components/cards/AthleteCard';
import AthleteInviteForm from '../../components/forms/AthleteInviteForm';

const AthletesRoster = () => {
    const [athletes, setAthletes] = useState([]);
    const [loading, setLoading] = useState(true);
    const [isSheetOpen, setIsSheetOpen] = useState(false);
    const [searchQuery, setSearchQuery] = useState('');

    const fetchHeroes = async () => {
        setLoading(true);
        try {
            const { data: { user } } = await supabase.auth.getUser();
            // Get academy first
            const { data: profile } = await supabase.from('profiles').select('academy_id').eq('id', user.id).single();

            if (profile?.academy_id) {
                const { data, error } = await supabase
                    .from('athletes')
                    .select('*')
                    .eq('academy_id', profile.academy_id)
                    .ilike('name', `%${searchQuery}%`)
                    .order('created_at', { ascending: false });

                if (error) throw error;
                setAthletes(data || []);
            }
        } catch (err) {
            console.error("Fetch errors:", err);
        } finally {
            setLoading(false);
        }
    };

    useEffect(() => {
        fetchHeroes();
    }, [searchQuery]); // Re-fetch on search

    const handleSuccess = () => {
        setIsSheetOpen(false);
        fetchHeroes(); // Refresh grid
    };

    return (
        <div className="max-w-7xl mx-auto space-y-6 animate-fade-in-up">

            {/* Header */}
            <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <h1 className="text-3xl font-bold text-slate-900 flex items-center gap-2">
                        <Trophy className="w-8 h-8 text-emerald-500" />
                        Heroes Roster
                    </h1>
                    <p className="text-slate-500">Manage your athletes and their performance cards.</p>
                </div>

                {athletes.length > 0 && (
                    <div className="flex items-center gap-2">
                        <div className="relative">
                            <Search className="absolute left-3 top-3 w-4 h-4 text-slate-400" />
                            <input
                                value={searchQuery}
                                onChange={e => setSearchQuery(e.target.value)}
                                placeholder="Search heroes..."
                                className="pl-9 pr-4 py-2 bg-white border border-slate-200 rounded-xl outline-none focus:border-emerald-500 text-sm font-bold w-full md:w-64"
                            />
                        </div>
                        <button
                            onClick={() => setIsSheetOpen(true)}
                            className="bg-slate-900 text-white px-4 py-2 rounded-xl font-bold flex items-center gap-2 hover:bg-slate-800 transition active:scale-95 shadow-lg shadow-slate-900/10"
                        >
                            <Plus className="w-4 h-4" /> New Hero
                        </button>
                    </div>
                )}
            </div>

            {/* Content */}
            {loading ? (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    {[1, 2, 3, 4].map(i => (
                        <div key={i} className="h-64 bg-slate-100 rounded-3xl animate-pulse" />
                    ))}
                </div>
            ) : athletes.length === 0 ? (
                <EmptyState
                    icon={Trophy}
                    title="No Heroes Founded"
                    description="Your roster is empty. Recruit your first athlete to start the journey."
                    actionLabel="Recruit First Hero"
                    onAction={() => setIsSheetOpen(true)}
                />
            ) : (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    {athletes.map(athlete => (
                        <AthleteCard key={athlete.id} athlete={athlete} />
                    ))}
                </div>
            )}

            {/* Sheet */}
            <BottomSheet
                isOpen={isSheetOpen}
                onClose={() => setIsSheetOpen(false)}
                title="Recruit New Hero"
            >
                <AthleteInviteForm
                    onSuccess={handleSuccess}
                    onCancel={() => setIsSheetOpen(false)}
                />
            </BottomSheet>
        </div>
    );
};

export default AthletesRoster;
</file>

<file path="src/pages/owner/Dashboard.jsx">
import React from 'react';
import { useUser } from '../../context/UserContext';
import { PlusCircle, ArrowRight } from 'lucide-react';
import { Link } from 'react-router-dom';

const Dashboard = () => {
    const { profile } = useUser();
    const firstName = profile?.full_name?.split(' ')[0] || 'Owner';

    // SAFE MODE: Fallback execution if data is missing
    const academyName = profile?.academy_name || "Test Kingdom";

    return (
        <div className="space-y-8 animate-fade-in-up">
            {/* Header / Welcome */}
            <div className="bg-gradient-to-r from-emerald-600 to-teal-600 rounded-3xl p-8 text-white shadow-lg shadow-emerald-200">
                <h1 className="text-3xl font-bold mb-2">Welcome, {firstName}.</h1>
                <p className="opacity-90 font-medium text-lg">Ready to manage {academyName}?</p>
            </div>

            {/* DASHBOARD CONTENT (Forced Render) */}
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div className="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm">
                    <h3 className="font-bold text-slate-400 text-xs uppercase tracking-wider mb-2">Total Staff</h3>
                    <p className="text-3xl font-black text-slate-800">12</p>
                </div>
                <div className="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm">
                    <h3 className="font-bold text-slate-400 text-xs uppercase tracking-wider mb-2">Active Athletes</h3>
                    <p className="text-3xl font-black text-slate-800">148</p>
                </div>
                <div className="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm">
                    <h3 className="font-bold text-slate-400 text-xs uppercase tracking-wider mb-2">Monthly Revenue</h3>
                    <p className="text-3xl font-black text-emerald-600">AED 45.2k</p>
                </div>
            </div>
        </div>
    );
};

export default Dashboard;
</file>

<file path="src/pages/owner/OwnerDashboard.jsx">
import React, { useState } from 'react';
import {
    UserPlus, Megaphone, Clock, Activity,
    Rocket, Calendar, Users
} from 'lucide-react';
import { useNavigate } from 'react-router-dom';
import ActionCard from '../../components/dashboard/ActionCard';
import ChecklistWidget from '../../components/dashboard/ChecklistWidget';
import BottomSheet from '../../components/ui/BottomSheet';
import StaffInviteForm from '../../components/forms/StaffInviteForm';

const OwnerDashboard = () => {
    const navigate = useNavigate();
    // Sheet State
    const [isStaffSheetOpen, setIsStaffSheetOpen] = useState(false);

    // MOCK STATE: Toggle this to 1 to see the "Operations Center"
    const athleteCount = 0;
    const isNewAccount = athleteCount === 0;

    const handleStaffSuccess = () => {
        setIsStaffSheetOpen(false);
        // Ideally show a toast or notification here
    };

    if (isNewAccount) {
        return (
            <div className="max-w-7xl mx-auto space-y-8 animate-fade-in-up">
                {/* Header */}
                <div className="bg-slate-900 rounded-3xl p-8 md:p-12 text-white relative overflow-hidden">
                    <div className="absolute top-0 right-0 w-64 h-64 bg-emerald-500/20 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"></div>
                    <div className="relative z-10">
                        <div className="flex items-center gap-3 mb-4">
                            <span className="px-3 py-1 rounded-full bg-emerald-500/20 border border-emerald-500/30 text-emerald-400 text-xs font-bold uppercase tracking-wider">
                                Getting Started
                            </span>
                        </div>
                        <h1 className="text-4xl md:text-5xl font-black mb-4">Welcome, Commander.</h1>
                        <p className="text-slate-400 text-lg max-w-2xl">
                            Your kingdom is ready. Complete these essential missions to activate your operations center.
                        </p>

                        {/* Progress */}
                        <div className="mt-8 max-w-sm">
                            <div className="flex justify-between text-sm font-bold mb-2">
                                <span className="text-emerald-400">Setup Progress</span>
                                <span>25%</span>
                            </div>
                            <div className="h-2 bg-slate-800 rounded-full overflow-hidden">
                                <div className="h-full w-1/4 bg-emerald-500 rounded-full shadow-[0_0_15px_rgba(16,185,129,0.5)]"></div>
                            </div>
                        </div>
                    </div>
                </div>

                {/* Checklist Grid */}
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <ChecklistWidget
                        title="Create Account"
                        desc="Your secure owner profile is active."
                        icon={Rocket}
                        isCompleted={true}
                    />
                    <ChecklistWidget
                        title="Add First Staff"
                        desc="Invite a coach or manager to help."
                        icon={UserPlus}
                        isCompleted={false}
                        onClick={() => setIsStaffSheetOpen(true)}
                    />
                    <ChecklistWidget
                        title="Add First Athlete"
                        desc="Register your first member."
                        icon={Users}
                        isCompleted={false}
                        onClick={() => navigate('/owner/athletes')}
                    />
                    <ChecklistWidget
                        title="Setup Schedule"
                        desc="Create a class or training session."
                        icon={Calendar}
                        isCompleted={false}
                        onClick={() => navigate('/owner/schedule')}
                    />
                </div>

                {/* Sheets */}
                <BottomSheet
                    isOpen={isStaffSheetOpen}
                    onClose={() => setIsStaffSheetOpen(false)}
                    title="Invite New Staff"
                >
                    <StaffInviteForm
                        onSuccess={handleStaffSuccess}
                        onCancel={() => setIsStaffSheetOpen(false)}
                    />
                </BottomSheet>
            </div>
        );
    }

    // --- STANDARD OPERATIONS VIEW (Existing) ---
    return (
        <div className="max-w-7xl mx-auto space-y-8 animate-fade-in-up">

            {/* Header */}
            <div>
                <h1 className="text-3xl font-bold text-slate-900">Operations Center</h1>
                <p className="text-slate-500">Welcome back. Here is what's happening in your kingdom.</p>
            </div>

            {/* 1. OPERATIONS GRID (Quick Actions) */}
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <ActionCard title="Add New Staff" desc="Invite coaches or managers." icon={UserPlus} color="bg-emerald-600" onClick={() => setIsStaffSheetOpen(true)} />
                <ActionCard title="Send Announcement" desc="Notify all staff & athletes." icon={Megaphone} color="bg-blue-600" onClick={() => { }} />
                <ActionCard title="Review Payroll" desc="Check salaries & treasury." icon={Clock} color="bg-purple-600" onClick={() => navigate('/owner/finance')} />
            </div>

            {/* 2. THE FEED (Activity Log) */}
            <div className="bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden">
                <div className="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <h2 className="text-lg font-bold text-slate-900 flex items-center gap-2">
                        <Activity className="w-5 h-5 text-emerald-600" />
                        Live Activity Feed
                    </h2>
                    <span className="px-3 py-1 rounded-full bg-emerald-100 text-emerald-700 text-xs font-bold animate-pulse">LIVE</span>
                </div>

                <div className="divide-y divide-slate-100">
                    {[1, 2, 3].map((i) => (
                        <div key={i} className="p-5 hover:bg-slate-50 transition flex gap-4">
                            <div className="w-10 h-10 rounded-full bg-slate-200 flex-shrink-0 flex items-center justify-center font-bold text-slate-600">
                                {i === 1 ? 'AH' : i === 2 ? 'MK' : 'WR'}
                            </div>
                            <div>
                                <p className="text-sm text-slate-800">
                                    <span className="font-bold">Coach Ahmed</span> marked attendance for <span className="font-bold">Level 2 Gymnastics</span>.
                                </p>
                                <p className="text-xs text-slate-400 mt-1">2 minutes ago â€¢ Via Mobile App</p>
                            </div>
                        </div>
                    ))}
                </div>
                <div className="p-4 text-center border-t border-slate-100">
                    <button className="text-sm font-bold text-emerald-600 hover:text-emerald-700">View All Activity</button>
                </div>
            </div>

            {/* Sheets */}
            <BottomSheet
                isOpen={isStaffSheetOpen}
                onClose={() => setIsStaffSheetOpen(false)}
                title="Invite New Staff"
            >
                <StaffInviteForm
                    onSuccess={handleStaffSuccess}
                    onCancel={() => setIsStaffSheetOpen(false)}
                />
            </BottomSheet>
        </div>
    );
};

export default OwnerDashboard;
</file>

<file path="src/pages/owner/StaffRoster.jsx">
import React, { useState } from 'react';
import { Users, UserPlus } from 'lucide-react';
import EmptyState from '../../components/ui/EmptyState';
import BottomSheet from '../../components/ui/BottomSheet';
import StaffInviteForm from '../../components/forms/StaffInviteForm';

const StaffRoster = () => {
    const [staff, setStaff] = useState([]); // Mock: Empty initially
    const [isSheetOpen, setIsSheetOpen] = useState(false);

    const handleSuccess = () => {
        setIsSheetOpen(false);
        // In real app, we'd refetch staff list here
        setStaff([{ id: 1, name: 'New Guy' }]); // Optimistic update simulation
    };

    return (
        <div className="max-w-7xl mx-auto space-y-6 animate-fade-in-up">
            <div className="flex justify-between items-center">
                <div>
                    <h1 className="text-3xl font-bold text-slate-900">Staff Roster</h1>
                    <p className="text-slate-500">Manage your team and assignments.</p>
                </div>
                {staff.length > 0 && (
                    <button
                        onClick={() => setIsSheetOpen(true)}
                        className="bg-slate-900 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 hover:bg-slate-800 transition"
                    >
                        <UserPlus className="w-4 h-4" /> Add Staff
                    </button>
                )}
            </div>

            {staff.length === 0 ? (
                <EmptyState
                    icon={Users}
                    title="No Staff Found"
                    description="You haven't added any team members yet. Build your dream team now."
                    actionLabel="Invite First Member"
                    onAction={() => setIsSheetOpen(true)}
                />
            ) : (
                <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <p className="text-center text-slate-400 py-12">Staff list mock...</p>
                </div>
            )}

            <BottomSheet
                isOpen={isSheetOpen}
                onClose={() => setIsSheetOpen(false)}
                title="Invite New Staff"
            >
                <StaffInviteForm
                    onSuccess={handleSuccess}
                    onCancel={() => setIsSheetOpen(false)}
                />
            </BottomSheet>
        </div>
    );
};

export default StaffRoster;
</file>

<file path="src/pages/ParentPortal.jsx">
import React from 'react';
import { NavLink } from 'react-router-dom';
import { clsx } from 'clsx';

export default function ParentPortal() {
    // Mock Data
    const child = { name: "Ahmed", level: "Silver", nextClass: "Monday, 5:00 PM", location: "Sharjah Branch" };
    const paymentStatus = "unpaid"; // or 'paid'

    return (
        <div className="min-h-screen bg-gray-50 pb-24">
            {/* Header */}
            <div className="bg-emerald-500 pt-12 pb-24 px-6 rounded-b-[40px] shadow-lg shadow-emerald-200">
                <div className="flex items-center justify-between text-white">
                    <div>
                        <h1 className="text-3xl font-black mb-1">{child.name}</h1>
                        <span className="bg-white/20 px-3 py-1 rounded-full text-xs font-bold tracking-wide backdrop-blur-sm border border-white/30">
                            {child.level} Gymnast
                        </span>
                    </div>
                    <div className="h-14 w-14 bg-white rounded-full flex items-center justify-center text-emerald-500 font-bold text-xl shadow-inner">
                        {child.name.charAt(0)}
                    </div>
                </div>
            </div>

            {/* Widgets Grid */}
            <div className="px-6 -mt-16 space-y-4">

                {/* Progress Card */}
                <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                    <div className="flex items-center justify-between mb-4">
                        <h3 className="font-bold text-slate-900">Progress</h3>
                        <span className="text-emerald-500 text-xs font-bold bg-emerald-50 px-2 py-1 rounded-md mb-0">Top 10%</span>
                    </div>
                    <div className="flex items-center gap-4">
                        <div className="relative h-20 w-20">
                            <svg className="h-full w-full -rotate-90" viewBox="0 0 36 36">
                                <path className="text-gray-100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" strokeWidth="3" />
                                <path className="text-emerald-500" strokeDasharray="85, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" strokeWidth="3" />
                            </svg>
                            <div className="absolute inset-0 flex items-center justify-center font-black text-slate-900 text-lg">85%</div>
                        </div>
                        <div className="flex-1">
                            <p className="text-sm font-medium text-slate-500 italic">"Great improvement in balance beam dismounts this week!"</p>
                            <div className="mt-2 text-xs font-bold text-slate-400 uppercase tracking-wider">Coach Sarah</div>
                        </div>
                    </div>
                </div>

                {/* Schedule Card */}
                <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex items-center gap-4">
                    <div className="h-12 w-12 bg-blue-50 text-blue-500 rounded-xl flex items-center justify-center">
                        <span className="material-symbols-outlined">calendar_month</span>
                    </div>
                    <div>
                        <h3 className="font-bold text-slate-900 text-sm">Next Class</h3>
                        <p className="text-slate-600 font-medium">{child.nextClass}</p>
                        <p className="text-xs text-slate-400">@ {child.location}</p>
                    </div>
                </div>

                {/* Payment Status */}
                <div className={clsx("p-6 rounded-2xl shadow-sm border flex items-center justify-between", paymentStatus === 'paid' ? "bg-white border-emerald-500/20" : "bg-red-50 border-red-100")}>
                    <div>
                        <h3 className={clsx("font-bold text-sm", paymentStatus === 'paid' ? "text-slate-900" : "text-red-700")}>
                            {paymentStatus === 'paid' ? 'Active Membership' : 'Renewal Due'}
                        </h3>
                        <p className={clsx("text-xs mt-1", paymentStatus === 'paid' ? "text-slate-500" : "text-red-500")}>
                            {paymentStatus === 'paid' ? 'Valid until March 30, 2026' : 'Term 1 Fees Pending'}
                        </p>
                    </div>
                    {paymentStatus === 'unpaid' ? (
                        <NavLink to="/payment" className="bg-red-500 text-white px-4 py-2 rounded-lg text-xs font-bold shadow-md shadow-red-200 hover:bg-red-600 transition-colors">
                            Pay Now
                        </NavLink>
                    ) : (
                        <span className="material-symbols-outlined text-emerald-500">verified</span>
                    )}
                </div>

            </div>
        </div>
    );
}
</file>

<file path="src/pages/PaymentGateway.jsx">
import React from 'react';
import { clsx } from 'clsx';

export default function PaymentGateway() {
    return (
        <div className="min-h-screen bg-gray-50 flex flex-col md:flex-row">
            {/* Left Side: Invoice */}
            <div className="w-full md:w-5/12 bg-white p-8 border-r border-gray-100">
                <div className="max-w-md mx-auto h-full flex flex-col">
                    <div className="mb-8">
                        <div className="h-12 w-12 bg-emerald-100 rounded-xl flex items-center justify-center text-emerald-600 mb-4">
                            <span className="material-symbols-outlined text-2xl">receipt_long</span>
                        </div>
                        <h2 className="text-2xl font-black text-slate-900 mb-1">Wild Robot Invoice #1024</h2>
                        <p className="text-slate-500 text-sm">Issued Date: Dec 15, 2025</p>
                    </div>

                    <div className="flex-1 space-y-4">
                        <div className="flex justify-between items-center p-4 rounded-xl bg-gray-50 border border-gray-100">
                            <div>
                                <h3 className="font-bold text-slate-800">Gymnastics Term 1</h3>
                                <p className="text-xs text-slate-500">Membership Fee (Jan - Mar)</p>
                            </div>
                            <span className="font-bold text-slate-900">500 AED</span>
                        </div>
                        <div className="flex justify-between items-center p-4 rounded-xl bg-gray-50 border border-gray-100">
                            <div>
                                <h3 className="font-bold text-slate-800">Uniform Kit</h3>
                                <p className="text-xs text-slate-500">Premium Leotard (Size M)</p>
                            </div>
                            <span className="font-bold text-slate-900">150 AED</span>
                        </div>
                    </div>

                    <div className="mt-8 pt-8 border-t border-gray-100">
                        <div className="flex justify-between items-end mb-6">
                            <span className="text-slate-500 font-medium">Total Amount</span>
                            <span className="text-3xl font-black text-slate-900">650 AED</span>
                        </div>

                        <div className="relative">
                            <input
                                type="text"
                                placeholder="Have a promo code?"
                                className="w-full pl-4 pr-12 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 text-sm font-bold placeholder-slate-400 text-slate-800"
                            />
                            <button className="absolute right-2 top-2 bottom-2 px-3 bg-slate-200 text-slate-600 rounded-lg text-xs font-bold hover:bg-slate-300 transition-colors">Apply</button>
                        </div>
                    </div>
                </div>
            </div>

            {/* Right Side: Checkout */}
            <div className="w-full md:w-7/12 bg-gray-50 p-8">
                <div className="max-w-md mx-auto">
                    <h2 className="text-xl font-bold text-slate-900 mb-6">Select Payment Method</h2>

                    <div className="space-y-4 mb-8">
                        <PaymentMethodCard icon="credit_card" title="Credit / Debit Card" sub="Visa, Mastercard, Amex" active />
                        <PaymentMethodCard icon="phone_iphone" title="Apple Pay" sub="Faster checkout" />
                        <PaymentMethodCard icon="pie_chart" title="Tabby" sub="Split in 4 payments" color="text-green-600" />
                    </div>

                    <div className="mb-8">
                        <h3 className="text-sm font-bold text-slate-400 uppercase tracking-wider mb-3">Saved Cards</h3>
                        <div className="p-4 bg-white border border-emerald-500 ring-4 ring-emerald-500/10 rounded-xl flex items-center justify-between shadow-sm">
                            <div className="flex items-center gap-3">
                                <div className="h-10 w-16 bg-blue-900 rounded-lg flex items-center justify-center text-white italic font-serif font-bold text-xs">VISA</div>
                                <div>
                                    <p className="font-bold text-slate-900">â€¢â€¢â€¢â€¢ 4242</p>
                                    <p className="text-xs text-slate-500">Expires 12/28</p>
                                </div>
                            </div>
                            <span className="material-symbols-outlined text-emerald-500">check_circle</span>
                        </div>
                    </div>

                    <button className="w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-emerald-200 transition-all transform active:scale-[0.98] flex items-center justify-center gap-2">
                        <span className="material-symbols-outlined text-[20px]">lock</span>
                        Pay AED 650
                    </button>

                    <p className="text-center text-xs text-slate-400 mt-4 flex items-center justify-center gap-1">
                        <span className="material-symbols-outlined text-[14px]">verified_user</span>
                        Payments are secure and encrypted.
                    </p>
                </div>
            </div>
        </div>
    );
}

function PaymentMethodCard({ icon, title, sub, active, color }) {
    return (
        <button className={clsx(
            "w-full text-left p-4 rounded-xl border flex items-center gap-4 transition-all",
            active ? "bg-white border-emerald-500 shadow-md ring-1 ring-emerald-500" : "bg-white border-gray-100 hover:border-gray-300 text-slate-400"
        )}>
            <div className={clsx("h-12 w-12 rounded-full bg-gray-50 flex items-center justify-center", active ? "text-emerald-600" : "text-slate-400")}>
                <span className="material-symbols-outlined">{icon}</span>
            </div>
            <div className="flex-1">
                <h3 className={clsx("font-bold", active ? "text-slate-900" : "text-slate-500", color)}>{title}</h3>
                <p className="text-xs text-slate-400">{sub}</p>
            </div>
            <div className={clsx("h-5 w-5 rounded-full border-2 flex items-center justify-center", active ? "border-emerald-500" : "border-gray-200")}>
                {active && <div className="h-2.5 w-2.5 rounded-full bg-emerald-500"></div>}
            </div>
        </button>
    );
}
</file>

<file path="src/pages/PlayerDetail.jsx">
import React, { useState, useEffect } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { supabase } from '../supabaseClient';
import clsx from 'clsx';
import { format } from 'date-fns';

export default function PlayerDetail() {
    const { id } = useParams();
    const navigate = useNavigate();
    const [player, setPlayer] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);

    useEffect(() => {
        fetchPlayer();
    }, [id]);

    async function fetchPlayer() {
        try {
            setLoading(true);
            const { data, error } = await supabase
                .from('players')
                .select('*')
                .eq('id', id)
                .single();

            if (error) throw error;
            setPlayer(data);
        } catch (err) {
            console.error('Error fetching player:', err);
            // Fallback for demo if no real data found given ID might be string
            if (id === 'demo') {
                setPlayer({
                    name: 'Adam Ali',
                    branch: 'Ajman',
                    level: 'Level 2',
                    subscription_total: 12,
                    subscription_used: 7,
                    expiry: '2023-12-31'
                })
            } else {
                setError(err.message);
            }
        } finally {
            setLoading(false);
        }
    }

    if (loading) {
        return (
            <div className="flex bg-background-light dark:bg-background-dark min-h-screen items-center justify-center">
                <span className="material-symbols-outlined animate-spin text-primary text-4xl">progress_activity</span>
            </div>
        );
    }

    if (error && !player) {
        return (
            <div className="flex flex-col bg-background-light dark:bg-background-dark min-h-screen items-center justify-center gap-4">
                <p className="text-red-500">Player not found</p>
                <button onClick={() => navigate(-1)} className="text-primary">Go Back</button>
            </div>
        );
    }

    // Logic: Calculate Remaining Classes
    const total = player.subscription_total || 12; // Default to 12 if null
    const used = player.subscription_used || 0;
    const remaining = total - used;
    const progressPercentage = Math.min(100, (used / total) * 100);

    return (
        <div className="relative flex min-h-screen w-full flex-col overflow-x-hidden max-w-md mx-auto bg-white dark:bg-[#111816] shadow-xl font-display">
            {/* Header */}
            <header className="sticky top-0 z-10 flex items-center bg-white dark:bg-[#111816] p-4 pb-2 justify-between border-b border-gray-100 dark:border-gray-800">
                <button
                    onClick={() => navigate(-1)}
                    className="text-[#111816] dark:text-white flex size-12 shrink-0 items-center justify-center rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                >
                    <span className="material-symbols-outlined" style={{ fontSize: '24px' }}>arrow_back_ios_new</span>
                </button>
                <h1 className="text-[#111816] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center pr-12">
                    {player.name}
                </h1>
            </header>

            <main className="flex-1 flex flex-col p-4 gap-6 pb-32">
                {/* Headline */}
                <div>
                    <h2 className="text-[#111816] dark:text-white tracking-tight text-xl font-bold leading-tight">Current Package</h2>
                </div>

                {/* Subscription Card */}
                <div className="relative overflow-hidden rounded-xl shadow-[0_8px_30px_rgb(0,0,0,0.12)] bg-gradient-to-br from-[#10221c] to-[#1a3830] text-white">
                    {/* Background Image Overlay */}
                    <div className="absolute inset-0 opacity-20 bg-cover bg-center mix-blend-overlay" style={{ backgroundImage: 'url("https://lh3.googleusercontent.com/aida-public/AB6AXuCyAvkFuAZx6X57ZSvwePZAnU9EL4DTYZUQoGE3t_vnCYNBcQOhupSdqVg44mNzNci_4DBHOjzSIvfnqzqzmoea7o-MnHds2XfJFolnVs_4L6IDrvttUXVHrlzT-31pdhTLTi88VvtkQwApPBHb-r5z6ung8CVTpgSzbxDjdrdL6OiO7pQsIp86-KLslvvtVXBOZvSQ6k9zUDBHofc0QwVkSymr1vBP2zOVdNRrvfIM2qbO8pi4_3gsw-B9tr6XQfRprWNaG6OqoXip")' }}>
                    </div>

                    <div className="relative p-6 flex flex-col gap-6">
                        <div className="flex justify-between items-start">
                            <div>
                                <p className="text-white/60 text-sm font-medium uppercase tracking-wider mb-1">Membership</p>
                                <h3 className="text-2xl font-bold leading-tight">{player.level || 'General'} Term 1</h3>
                            </div>
                            <span className="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-primary text-white shadow-sm">
                                Active
                            </span>
                        </div>

                        <div className="flex flex-col gap-2 mt-4">
                            <div className="flex justify-between items-end">
                                <p className="text-white/90 text-sm font-medium">Progress</p>
                                <p className="text-primary font-bold text-lg">{used}<span className="text-white/60 text-sm font-normal">/{total} Classes</span></p>
                            </div>

                            {/* Progress Bar */}
                            <div className="h-2.5 w-full bg-white/10 rounded-full overflow-hidden backdrop-blur-sm">
                                <div
                                    className="h-full bg-primary rounded-full transition-all duration-500 ease-out"
                                    style={{ width: `${progressPercentage}%` }}
                                ></div>
                            </div>
                            <p className="text-white/40 text-xs text-right mt-1">
                                expires {player.expiry || 'Dec 31, 2025'}
                            </p>
                        </div>
                    </div>
                </div>

                {/* Attendance Section */}
                <div className="flex flex-col gap-4">
                    <h2 className="text-[#111816] dark:text-white tracking-tight text-xl font-bold leading-tight pt-2">Attendance History</h2>
                    <div className="flex flex-col gap-3">
                        {/* Mock History Items for now */}
                        <AttendanceItem status="present" date="Dec 12" time="04:30 PM â€¢ Level 2" />
                        <AttendanceItem status="absent" date="Dec 10" time="04:30 PM â€¢ Level 2" />
                        <AttendanceItem status="excused" date="Dec 08" time="Sick Leave" />
                    </div>
                </div>
            </main>

            {/* Action Footer */}
            <footer className="fixed bottom-0 left-0 right-0 z-20 bg-white/90 dark:bg-[#111816]/90 backdrop-blur-md border-t border-gray-100 dark:border-gray-800 p-4 max-w-md mx-auto pb-safe">
                <div className="flex flex-col gap-3">
                    <button className="flex w-full items-center justify-center gap-2 rounded-xl bg-primary px-6 py-3.5 text-base font-bold text-white shadow-lg shadow-primary/30 transition-transform active:scale-[0.98]">
                        <span className="material-symbols-outlined">autorenew</span>
                        Renew Subscription
                    </button>
                    <button className="flex w-full items-center justify-center gap-2 rounded-xl bg-background-light dark:bg-gray-800 px-6 py-3.5 text-base font-bold text-[#111816] dark:text-white transition-transform active:scale-[0.98] border border-gray-200 dark:border-gray-700">
                        <span className="material-symbols-outlined">ac_unit</span>
                        Freeze Membership
                    </button>
                </div>
            </footer>
        </div>
    );
}

function AttendanceItem({ status, date, time }) {
    const statusConfig = {
        present: { color: 'text-success', bg: 'bg-success/10', icon: 'check_circle', label: 'Present' },
        absent: { color: 'text-error', bg: 'bg-error/10', icon: 'cancel', label: 'Absent (Billable)' },
        excused: { color: 'text-warning', bg: 'bg-warning/10', icon: 'warning', label: 'Excused' },
    };

    const config = statusConfig[status];

    return (
        <div className="flex items-center justify-between p-4 rounded-lg bg-background-light dark:bg-gray-800/50 border border-transparent dark:border-gray-700">
            <div className="flex items-center gap-4">
                <div className={`flex h-10 w-10 items-center justify-center rounded-full ${config.bg} ${config.color}`}>
                    <span className="material-symbols-outlined">{config.icon}</span>
                </div>
                <div className="flex flex-col">
                    <span className="text-sm font-semibold text-[#111816] dark:text-white">{date}</span>
                    <span className="text-xs text-gray-500 dark:text-gray-400">{time}</span>
                </div>
            </div>
            <span className={`text-sm font-medium ${config.color}`}>{config.label}</span>
        </div>
    );
}
</file>

<file path="src/pages/Schedule.jsx">
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import {
    ChevronLeft, ChevronRight, MapPin,
    Calendar as CalIcon, Coffee, User, WifiOff, RefreshCw
} from 'lucide-react';
import { format, addDays, subDays, isSameDay, parseISO } from 'date-fns';
import { clsx } from 'clsx';
import { supabase } from '../supabaseClient';

export default function Schedule() {
    const navigate = useNavigate();
    const [selectedDate, setSelectedDate] = useState(new Date());
    const [sessions, setSessions] = useState([]);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null); // ðŸ”´ New: Error State
    const [activeFilter, setActiveFilter] = useState('All');

    // 1. Branch Colors
    const BRANCH_COLORS = {
        'Ajman Academy': 'bg-pink-500 border-pink-500',
        'VISS Tilal': 'bg-blue-500 border-blue-500',
        'Sharjah Branch': 'bg-rose-500 border-rose-500',
        'default': 'bg-emerald-500 border-emerald-500'
    };

    // 2. Fetch Logic
    useEffect(() => {
        fetchSessions(selectedDate);
    }, [selectedDate]);

    const fetchSessions = async (date) => {
        setLoading(true);
        setError(null); // Reset error before fetching
        try {
            const startOfDay = new Date(date);
            startOfDay.setHours(0, 0, 0, 0);
            const endOfDay = new Date(date);
            endOfDay.setHours(23, 59, 59, 999);

            const { data, error: dbError } = await supabase
                .from('sessions')
                .select(`
                    *,
                    coach:profiles (full_name, avatar_url),
                    enrollments (count)
                `)
                .gte('start_time', startOfDay.toISOString())
                .lte('start_time', endOfDay.toISOString())
                .order('start_time', { ascending: true });

            if (dbError) throw dbError;
            setSessions(data || []);

        } catch (err) {
            console.error('Fetch Error:', err);
            // ðŸ”´ UX Improvement: User-friendly error message
            setError('Failed to load schedule. Check your connection.');
        } finally {
            setLoading(false);
        }
    };

    const handlePrevDay = () => setSelectedDate(prev => subDays(prev, 1));
    const handleNextDay = () => setSelectedDate(prev => addDays(prev, 1));

    const handleManageSession = (session) => {
        navigate(`/session/${session.id}`, {
            state: {
                branch: session.branch,
                level: session.level,
                title: session.title
            }
        });
    };

    const filteredSessions = activeFilter === 'All'
        ? sessions
        : sessions.filter(s => s.branch === activeFilter);

    return (
        <div className="min-h-screen bg-slate-50 pb-24">
            {/* Header */}
            <div className="sticky top-0 z-10 bg-white/80 backdrop-blur-md border-b border-slate-200 shadow-sm">
                <div className="max-w-md mx-auto px-4 py-4">
                    <div className="flex items-center justify-between bg-slate-100 rounded-2xl p-1.5">
                        <button onClick={handlePrevDay} className="p-3 bg-white rounded-xl shadow-sm hover:scale-105 transition-transform text-slate-600">
                            <ChevronLeft size={20} />
                        </button>
                        <div className="flex flex-col items-center">
                            <h2 className="text-lg font-black text-slate-800">
                                {isSameDay(selectedDate, new Date()) ? 'Today' : format(selectedDate, 'EEEE')}
                            </h2>
                            <span className="text-xs font-bold text-slate-400 uppercase tracking-wider">
                                {format(selectedDate, 'MMM do, yyyy')}
                            </span>
                        </div>
                        <button onClick={handleNextDay} className="p-3 bg-white rounded-xl shadow-sm hover:scale-105 transition-transform text-slate-600">
                            <ChevronRight size={20} />
                        </button>
                    </div>
                </div>
            </div>

            {/* Content Area */}
            <div className="max-w-md mx-auto px-4 mt-6">

                {/* ðŸ”´ ERROR STATE (The Fix) */}
                {error ? (
                    <div className="flex flex-col items-center justify-center py-12 text-center">
                        <div className="w-16 h-16 bg-red-50 text-red-500 rounded-full flex items-center justify-center mb-4">
                            <WifiOff size={32} />
                        </div>
                        <h3 className="text-lg font-bold text-slate-800">Connection Failed</h3>
                        <p className="text-sm text-slate-500 mb-6 max-w-[200px]">{error}</p>
                        <button
                            onClick={() => fetchSessions(selectedDate)}
                            className="flex items-center gap-2 px-6 py-3 bg-slate-900 text-white rounded-xl font-bold active:scale-95 transition-transform"
                        >
                            <RefreshCw size={18} /> Retry
                        </button>
                    </div>
                ) : loading ? (
                    <div className="flex flex-col items-center justify-center py-20 gap-4">
                        <div className="w-10 h-10 border-4 border-emerald-200 border-t-emerald-500 rounded-full animate-spin"></div>
                    </div>
                ) : filteredSessions.length > 0 ? (
                    <div className="space-y-4">
                        {/* Filters */}
                        <div className="overflow-x-auto hide-scrollbar flex gap-2 mb-4">
                            {['All', 'Ajman Academy', 'Sharjah Branch'].map(filter => (
                                <button
                                    key={filter}
                                    onClick={() => setActiveFilter(filter)}
                                    className={clsx(
                                        "px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all",
                                        activeFilter === filter
                                            ? "bg-slate-800 text-white shadow-md"
                                            : "bg-white text-slate-500 border border-slate-200"
                                    )}
                                >
                                    {filter}
                                </button>
                            ))}
                        </div>

                        {filteredSessions.map((session) => {
                            const startTime = format(parseISO(session.start_time), 'h:mm a');
                            const endTime = format(parseISO(session.end_time), 'h:mm a');
                            const branchColor = BRANCH_COLORS[session.branch] || BRANCH_COLORS['default'];

                            return (
                                <div key={session.id} className="group bg-white rounded-3xl p-5 border border-slate-100 shadow-sm hover:shadow-md transition-all relative overflow-hidden">
                                    <div className={clsx("absolute top-0 left-0 bottom-0 w-1.5", branchColor)}></div>
                                    <div className="flex justify-between items-start mb-3 pl-2">
                                        <div>
                                            <span className="inline-flex items-center gap-1 px-2 py-1 rounded-md bg-slate-50 text-slate-500 text-[10px] font-black uppercase tracking-wider mb-1">
                                                <MapPin size={10} /> {session.branch}
                                            </span>
                                            <h3 className="text-xl font-black text-slate-800 leading-tight">{session.title}</h3>
                                            <p className="text-xs font-bold text-emerald-600 mt-1">{session.level || 'Open Level'}</p>
                                        </div>
                                        <div className="text-right">
                                            <div className="bg-slate-900 text-white px-3 py-1.5 rounded-xl font-bold text-xs shadow-lg shadow-slate-200">
                                                {startTime}
                                            </div>
                                            <p className="text-[10px] font-bold text-slate-400 mt-1 text-center">to {endTime}</p>
                                        </div>
                                    </div>
                                    <div className="flex items-center justify-between border-t border-slate-50 pt-3 mt-2 pl-2">
                                        <div className="flex items-center gap-2">
                                            {session.coach?.avatar_url ? (
                                                <img src={session.coach.avatar_url} alt="Coach" className="w-6 h-6 rounded-full object-cover" />
                                            ) : (
                                                <div className="w-6 h-6 rounded-full bg-slate-100 flex items-center justify-center text-slate-400">
                                                    <User size={12} />
                                                </div>
                                            )}
                                            <span className="text-xs font-bold text-slate-500">
                                                {session.coach?.full_name || 'Assigned Coach'}
                                            </span>
                                        </div>
                                        <div className="flex items-center gap-1 text-slate-400">
                                            <span className="material-symbols-outlined text-[16px]">group</span>
                                            <span className="text-xs font-bold">{session.enrollments?.[0]?.count || 0}/{session.max_capacity || 20}</span>
                                        </div>
                                    </div>
                                    <button
                                        onClick={() => handleManageSession(session)}
                                        className="w-full mt-4 bg-slate-50 text-slate-600 font-bold py-3 rounded-xl hover:bg-slate-900 hover:text-white transition-colors flex items-center justify-center gap-2 group-hover:bg-slate-900 group-hover:text-white"
                                    >
                                        Manage Class
                                    </button>
                                </div>
                            );
                        })}
                    </div>
                ) : (
                    // Empty State (No Classes)
                    <div className="flex flex-col items-center justify-center text-center opacity-60 mt-10">
                        <div className="bg-slate-100 p-6 rounded-full mb-4">
                            <Coffee size={40} className="text-slate-400" />
                        </div>
                        <h3 className="text-lg font-bold text-slate-700">No Classes Found</h3>
                        <p className="text-sm text-slate-500 max-w-[200px]">
                            Looks like a rest day! Try selecting another date.
                        </p>
                    </div>
                )}
            </div>
        </div>
    );
}
</file>

<file path="src/pages/Settings.jsx">
import React from 'react';
import { useNavigate } from 'react-router-dom';
import { useTheme } from '../context/ThemeContext';
import clsx from 'clsx';

export default function Settings() {
    const navigate = useNavigate();
    const { theme, toggleTheme } = useTheme();
    console.log("Current Theme Context:", theme);

    return (
        <div className="flex flex-col min-h-screen bg-background-light dark:bg-background-dark text-slate-900 dark:text-white pb-[80px]">
            {/* Header */}
            <header className="sticky top-0 z-10 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-sm px-4 py-4 border-b border-gray-100 dark:border-gray-800 flex items-center gap-4">
                <button onClick={() => navigate(-1)} className="text-slate-900 dark:text-white p-1 -ml-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800">
                    <span className="material-symbols-outlined">arrow_back_ios_new</span>
                </button>
                <h1 className="text-xl font-bold">Settings</h1>
            </header>

            <main className="flex-1 p-4 flex flex-col gap-6">
                {/* Appearance Section */}
                <section>
                    <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 px-2">Appearance</h2>
                    <div className="bg-white dark:bg-card-dark rounded-xl border border-slate-100 dark:border-slate-800 overflow-hidden">
                        <div className="flex items-center justify-between p-4">
                            <div className="flex items-center gap-3">
                                <div className="h-8 w-8 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-500">
                                    <span className="material-symbols-outlined text-[20px]">dark_mode</span>
                                </div>
                                <span className="font-semibold text-sm">Dark Mode</span>
                            </div>

                            {/* Toggle Switch */}
                            <button
                                onClick={toggleTheme}
                                className={clsx(
                                    "w-12 h-6 rounded-full relative transition-colors duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-primary/20",
                                    theme === 'dark' ? "bg-primary" : "bg-slate-200"
                                )}
                            >
                                <div className={clsx(
                                    "absolute top-0.5 left-0.5 w-5 h-5 rounded-full bg-white shadow-sm transition-transform duration-300 ease-in-out",
                                    theme === 'dark' ? "translate-x-6" : "translate-x-0"
                                )}></div>
                            </button>
                        </div>
                    </div>
                </section>

                {/* Account Section */}
                <section>
                    <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 px-2">Account</h2>
                    <div className="bg-white dark:bg-card-dark rounded-xl border border-slate-100 dark:border-slate-800 overflow-hidden divide-y divide-slate-100 dark:divide-slate-800">
                        <button className="w-full flex items-center justify-between p-4 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors">
                            <div className="flex items-center gap-3">
                                <span className="material-symbols-outlined text-slate-500">person</span>
                                <span className="font-semibold text-sm">Edit Profile</span>
                            </div>
                            <span className="material-symbols-outlined text-slate-300 text-[20px]">chevron_right</span>
                        </button>

                        <div className="flex items-center justify-between p-4">
                            <div className="flex items-center gap-3">
                                <span className="material-symbols-outlined text-slate-500">notifications</span>
                                <span className="font-semibold text-sm">Notifications</span>
                            </div>
                            {/* Simple Toggle - Visual Only for now */}
                            <div className="w-12 h-6 rounded-full bg-primary relative cursor-pointer">
                                <div className="absolute top-0.5 left-0.5 w-5 h-5 rounded-full bg-white shadow-sm translate-x-6"></div>
                            </div>
                        </div>
                    </div>
                </section>

                {/* Logout Button */}
                <div className="mt-8">
                    <button className="w-full py-3 text-red-500 font-bold text-sm bg-red-50 dark:bg-red-900/10 rounded-xl hover:bg-red-100 dark:hover:bg-red-900/20 transition-colors">
                        Log Out
                    </button>
                    <p className="text-center text-[10px] text-slate-400 mt-4">Version 1.0.2 (Build 240)</p>
                </div>
            </main>
        </div>
    );
}
</file>

<file path="src/pages/SkillEvaluation.jsx">
import React, { useState, useEffect } from 'react';
import { supabase } from '../supabaseClient';
import EvaluationCard from '../components/evaluation/EvaluationCard';

const SessionCommander = () => {
    const [loading, setLoading] = useState(true);
    const [students, setStudents] = useState([]);
    const [profile, setProfile] = useState(null);

    // Batch Logic - DYNAMIC NOW (or empty state)
    // Initially null, filled if we have dynamic sessions.
    // For MVP, if no sessions, show empty state.
    const [selectedBatch, setSelectedBatch] = useState(null);

    // Lifted States for "Session Commander"
    const [attendance, setAttendance] = useState({});
    const [trainingPlans, setTrainingPlans] = useState({});

    useEffect(() => {
        fetchSessionData();
    }, []);

    const fetchSessionData = async () => {
        setLoading(true);
        try {
            // 1. Get Coach Profile for Academy Name
            const { data: { user } } = await supabase.auth.getUser();
            if (!user) return;

            const { data: profileData } = await supabase
                .from('profiles')
                .select('academy_name')
                .eq('id', user.id)
                .single();

            setProfile(profileData);

            // 2. Fetch Sessions/Batches (Future Implementation)
            // For now, if we don't have a schedule system fully hooked up to "Batches",
            // we will simulate an EMPTY state for new users, rather than showing "Ajman Batch A".
            // If you want to show ALL athletes as a single "Open Session":

            if (profileData?.academy_name) {
                const { data: playersData } = await supabase
                    .from('profiles')
                    .select('*')
                    .eq('academy_name', profileData.academy_name)
                    .eq('role', 'athlete'); // Only athletes

                if (playersData && playersData.length > 0) {
                    // Create a pseudo-batch for "All Athletes"
                    const allBatch = { id: 'all', label: 'Open Session', time: 'Now', level: 'Mixed' };
                    setSelectedBatch(allBatch);

                    // Initialize Local State
                    const initialAttendance = {};
                    const initialPlans = {};
                    playersData.forEach(p => {
                        initialAttendance[p.id] = true;
                        initialPlans[p.id] = [];
                    });
                    setAttendance(initialAttendance);
                    setTrainingPlans(initialPlans);

                    // Enrich
                    const enriched = playersData.map(p => ({
                        ...p,
                        full_name: p.full_name || p.email,
                        skillsMap: [] // Empty skills for now
                    }));
                    setStudents(enriched);
                }
            }

        } catch (error) {
            console.error('Error fetching session data:', error);
        } finally {
            setLoading(false);
        }
    };

    // Actions
    const handleMarkAllPresent = () => {
        const newAttendance = { ...attendance };
        students.forEach(s => newAttendance[s.id] = true);
        setAttendance(newAttendance);
    };

    const toggleAttendance = (studentId) => {
        setAttendance(prev => ({ ...prev, [studentId]: !prev[studentId] }));
    };

    const updateTrainingPlan = (studentId, newPlan) => {
        setTrainingPlans(prev => ({ ...prev, [studentId]: newPlan }));
    };

    if (loading) {
        return (
            <div className="flex justify-center items-center h-screen bg-slate-50">
                <span className="material-symbols-outlined text-5xl animate-spin text-emerald-600">progress_activity</span>
            </div>
        );
    }

    if (!selectedBatch || students.length === 0) {
        return (
            <div className="p-6 bg-slate-50 min-h-screen flex flex-col items-center justify-center text-center">
                <div className="w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mb-6">
                    <span className="material-symbols-outlined text-4xl text-emerald-600">checklist</span>
                </div>
                <h2 className="text-2xl font-black text-slate-900 mb-2">No Active Session</h2>
                <p className="text-slate-500 max-w-md mb-8">
                    {profile?.academy_name ? `No athletes found for ${profile.academy_name}.` : "You haven't set up your academy yet."}
                    Start by adding athletes to your roster.
                </p>
                {/* Could link to Roster/Add Athlete */}
            </div>
        );
    }

    return (
        <div className="p-6 bg-slate-50 min-h-screen pb-32">
            {/* Header / Command Center */}
            <div className="sticky top-0 z-20 bg-slate-50/95 backdrop-blur-md py-4 border-b border-slate-200 mb-8">
                <div className="flex flex-col xl:flex-row justify-between xl:items-center gap-6">
                    <div>
                        <div className="flex items-center gap-3 mb-1">
                            <h1 className="text-3xl font-black text-slate-800 tracking-tight flex items-center gap-2">
                                <span className="material-symbols-outlined text-emerald-600 text-4xl">checklist_rtl</span>
                                Session Commander
                            </h1>
                            <span className="px-3 py-1 rounded-full bg-emerald-100 text-emerald-700 text-xs font-bold uppercase tracking-wider border border-emerald-200">
                                Live
                            </span>
                        </div>
                        <p className="text-slate-500 font-medium">{profile?.academy_name} â€¢ {selectedBatch.level} Squad</p>
                    </div>

                    <div className="flex flex-col sm:flex-row items-center gap-4">
                        {/* Quick Actions */}
                        <button
                            onClick={handleMarkAllPresent}
                            className="bg-white border-2 border-emerald-100 text-emerald-700 hover:bg-emerald-50 hover:border-emerald-200 px-4 py-2.5 rounded-xl font-bold text-sm flex items-center gap-2 transition-all shadow-sm"
                        >
                            <span className="material-symbols-outlined">done_all</span>
                            Mark All Present
                        </button>
                    </div>
                </div>
            </div>

            {/* Student Grid */}
            <div className="grid gap-6 md:grid-cols-1 lg:grid-cols-2 max-w-7xl mx-auto">
                {students.map(student => (
                    <EvaluationCard
                        key={student.id}
                        student={{
                            id: student.id,
                            name: student.full_name,
                            level: student.level || 'General',
                            age: student.age || 'N/A'
                        }}
                        levelData={student.skillsMap}
                        isPresent={!!attendance[student.id]}
                        onToggleAttendance={() => toggleAttendance(student.id)}
                        trainingPlan={trainingPlans[student.id] || []}
                        onUpdatePlan={(newPlan) => updateTrainingPlan(student.id, newPlan)}
                    />
                ))}
            </div>
        </div>
    );
};

export default SessionCommander;
</file>

<file path="src/pages/SubscriptionPlans.jsx">
import React, { useState, useEffect } from 'react';
import { clsx } from 'clsx';
import { useLocation } from 'react-router-dom';

export default function SubscriptionPlans() {
    const [billingCycle, setBillingCycle] = useState('monthly'); // 'monthly' | 'yearly'
    const location = useLocation();
    const shouldHighlightTeam = location.state?.highlight === 'team';

    useEffect(() => {
        if (shouldHighlightTeam) {
            // Optional: Scroll to team plan on mobile
            const teamElement = document.getElementById('plan-team');
            if (teamElement) teamElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    }, [shouldHighlightTeam]);

    const plans = [
        {
            id: 'freelancer',
            name: "Freelancer",
            // ... (rest of code logic remains similar, but need to be careful with replace)
            // Actually, easier to simple replace the start of function and where 'recommended' is defined

            price: 0,
            period: '/mo',
            description: "Perfect for solo coaches starting out.",
            features: [
                "Up to 50 Athletes",
                "Basic Schedule Management",
                "Personal Coach Profile",
                "Standard Support"
            ],
            buttonLabel: "Current Plan",
            buttonStyle: "secondary",
            recommended: false
        },
        {
            id: 'team',
            name: "Team",
            price: billingCycle === 'monthly' ? 49 : 470,
            period: billingCycle === 'monthly' ? '/mo' : '/yr',
            description: "For growing academies & small clubs.",
            features: [
                "Unlimited Athletes",
                "5 Staff Accounts",
                "Financial Reports & Invoicing",
                "Attendance Tracking",
                "Priority Support"
            ],
            buttonLabel: "Upgrade Now",
            buttonStyle: "primary",
            recommended: true, // Always recommended, but we can check shouldHighlightTeam for extra effects in the render
            isHighlightTarget: shouldHighlightTeam // Custom flag for extra visual flair
        },
        {
            id: 'enterprise',
            name: "Enterprise",
            price: "Custom",
            period: '',
            description: "For large clubs & franchises.",
            features: [
                "Multi-Branch Management",
                "White Labeling (Custom Branding)",
                "Dedicated Account Manager",
                "API Access",
                "SSO & Advanced Security"
            ],
            buttonLabel: "Contact Sales",
            buttonStyle: "outline",
            recommended: false
        }
    ];

    return (
        <div className="min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8">
            <div className="max-w-7xl mx-auto">

                {/* Header */}
                <div className="text-center mb-16">
                    <h1 className="text-4xl font-black text-slate-900 tracking-tight mb-4">
                        Choose the plan that fits your growth.
                    </h1>
                    <p className="text-lg text-slate-600 max-w-2xl mx-auto">
                        Scale your academy with tools designed for every stage of your journey. No hidden fees. Cancel anytime.
                    </p>

                    {/* Billing Toggle */}
                    <div className="mt-8 flex justify-center items-center gap-3">
                        <span className={clsx("text-sm font-bold", billingCycle === 'monthly' ? "text-slate-900" : "text-slate-400")}>Monthly</span>
                        <button
                            onClick={() => setBillingCycle(prev => prev === 'monthly' ? 'yearly' : 'monthly')}
                            className={clsx(
                                "relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none",
                                billingCycle === 'yearly' ? "bg-emerald-500" : "bg-slate-300"
                            )}
                        >
                            <span
                                className={clsx(
                                    "inline-block h-6 w-6 transform rounded-full bg-white transition-transform shadow-sm",
                                    billingCycle === 'yearly' ? "translate-x-7" : "translate-x-1"
                                )}
                            />
                        </button>
                        <span className={clsx("text-sm font-bold flex items-center gap-2", billingCycle === 'yearly' ? "text-slate-900" : "text-slate-400")}>
                            Yearly
                            <span className="bg-emerald-100 text-emerald-700 text-[10px] uppercase font-black px-2 py-0.5 rounded-full">Save 20%</span>
                        </span>
                    </div>
                </div>

                {/* Plans Grid */}
                <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                    {plans.map((plan) => (
                        <div
                            key={plan.id}
                            id={`plan-${plan.id}`}
                            className={clsx(
                                "relative flex flex-col p-8 bg-white rounded-3xl shadow-sm border transition-all hover:shadow-xl",
                                plan.recommended ? "border-emerald-500 ring-4 ring-emerald-500/10 z-10 scale-105" : "border-gray-100 hover:border-emerald-200",
                                plan.isHighlightTarget && "animate-pulse-border ring-emerald-500/50 shadow-2xl shadow-emerald-500/20"
                            )}
                        >
                            {plan.recommended && (
                                <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-emerald-500 text-white text-xs font-black uppercase tracking-wider px-4 py-1.5 rounded-full shadow-lg shadow-emerald-200">
                                    Most Popular
                                </div>
                            )}

                            <div className="mb-6">
                                <h3 className="text-xl font-bold text-slate-900">{plan.name}</h3>
                                <p className="text-sm text-slate-500 mt-2 h-10">{plan.description}</p>
                            </div>

                            <div className="mb-6 flex items-baseline gap-1">
                                {typeof plan.price === 'number' ? (
                                    <>
                                        <span className="text-5xl font-black text-slate-900">${plan.price}</span>
                                        <span className="text-slate-500 font-medium">{plan.period}</span>
                                    </>
                                ) : (
                                    <span className="text-4xl font-black text-slate-900">{plan.price}</span>
                                )}
                            </div>

                            <ul className="mb-8 space-y-4 flex-1">
                                {plan.features.map((feature, idx) => (
                                    <li key={idx} className="flex items-start gap-3">
                                        <div className="h-5 w-5 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center flex-shrink-0 mt-0.5">
                                            <span className="material-symbols-outlined text-[14px] font-bold">check</span>
                                        </div>
                                        <span className="text-sm text-slate-600 font-medium">{feature}</span>
                                    </li>
                                ))}
                            </ul>

                            <button
                                className={clsx(
                                    "w-full py-3.5 rounded-xl font-bold transition-all flex items-center justify-center gap-2",
                                    plan.buttonStyle === 'primary'
                                        ? "bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-lg shadow-emerald-200 hover:shadow-xl hover:scale-[1.02]"
                                        : plan.buttonStyle === 'outline'
                                            ? "bg-white border-2 border-slate-900 text-slate-900 hover:bg-slate-50"
                                            : "bg-gray-100 text-slate-500 cursor-default"
                                )}
                                disabled={plan.buttonStyle === 'secondary'}
                            >
                                {plan.buttonLabel}
                                {plan.buttonStyle !== 'secondary' && (
                                    <span className="material-symbols-outlined text-[18px]">arrow_forward</span>
                                )}
                            </button>
                        </div>
                    ))}
                </div>

                {/* FAQ / Trust Hints (Optional) */}
                <div className="mt-16 border-t border-gray-200 pt-8 text-center">
                    <p className="text-slate-400 text-sm font-medium">
                        Trusted by 500+ academies worldwide.
                        <span className="mx-2">â€¢</span>
                        Secure payments by Stripe.
                    </p>
                </div>
            </div>
        </div>
    );
}
</file>

<file path="src/services/supabaseService.js">
import { supabase } from '../supabaseClient';

export const supabaseService = {
    /**
     * Fetch sessions for a specific date range
     */
    async fetchCoachSchedule(startDate, endDate) {
        try {
            const { data, error } = await supabase
                .from('sessions')
                .select('*')
                .gte('date', startDate.toISOString())
                .lte('date', endDate.toISOString())
                .order('time', { ascending: true });

            if (error) throw error;
            return data;
        } catch (error) {
            console.error('Error fetching schedule:', error);
            return [];
        }
    },

    /**
     * Fetch the roster (students) for a specific session
     * Assumes a 'session_enrollments' or similar join table exists, 
     * or players have a 'session_id'. 
     * For V1/Simple systems: checks 'players' table where 'session_id' matches.
     */
    async fetchSessionRoster(sessionId) {
        try {
            // Join with profiles/players to get names/avatars
            // Adjust table names based on your actual schema
            const { data, error } = await supabase
                .from('enrollments')
                .select(`
                    id,
                    status,
                    student:students (
                        id,
                        full_name,
                        level,
                        avatar_url
                    )
                `)
                .eq('session_id', sessionId);

            if (error) throw error;

            // Transform to friendly format
            return data.map(record => ({
                id: record.student.id,
                name: record.student.full_name,
                avatar: record.student.avatar_url,
                level: record.student.level,
                status: record.status || 'unknown'
            }));
        } catch (error) {
            console.warn('Error fetching roster (MOCK FALLBACK applied):', error);
            // Fallback for demo if table missing
            return null;
        }
    },

    /**
     * Update attendance status
     */
    async updateAttendance(enrollmentId, status) {
        const { error } = await supabase
            .from('enrollments')
            .update({ status })
            .eq('id', enrollmentId);

        if (error) throw error;
    }
};
</file>

<file path="src/supabaseClient.js">
import { createClient } from '@supabase/supabase-js'

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY

export const supabase = createClient(supabaseUrl, supabaseAnonKey)
</file>

<file path="src/utils/auth-guard.ts">
import { SupabaseClient } from '@supabase/supabase-js'

/**
 * Checks if the current user is allowed to access the system based on device limits.
 * Implements "Smart Displacement" (Newest Session Wins).
 */
export async function checkDeviceAccess(
    supabase: SupabaseClient,
    userId: string,
    isLoginAction: boolean = false
): Promise<{ allowed: boolean; reason?: string }> {
    try {
        // 1. IDENTIFY DEVICE (Fingerprint)
        let deviceId = localStorage.getItem('wibo_device_id');
        if (!deviceId) {
            deviceId = crypto.randomUUID();
            localStorage.setItem('wibo_device_id', deviceId);
        }

        const uniqueSignature = `${navigator.userAgent}___DID:${deviceId}`;

        // 2. REGISTER HEARTBEAT (Newest Wins Upsert)
        // We just insert. The DB trigger 'trigger_smart_displacement' handles cleanup.
        const { error } = await supabase
            .from('active_sessions')
            .upsert({
                user_id: userId,
                device_id: deviceId,
                user_agent: uniqueSignature,
                last_active: new Date().toISOString()
            }, { onConflict: 'device_id' }); // Conflict on unique device_id

        if (error) {
            console.error("Session Register Error (Non-Critical):", error);
        }

        return { allowed: true, reason: 'Session Registered' };

    } catch (err) {
        console.error('Session Manager Error:', err);
        // Fail open to avoid blocking reliable users
        return { allowed: true, reason: 'Fail Open' };
    }
}
</file>

<file path="src/utils/constants.js">
export const BRANCHES = [
    { id: 'Ajman_Academy', label: 'Ajman Academy', lat: 25.4052, lng: 55.5136 },
    { id: 'VISS_Tilal', label: 'VISS Tilal', lat: 25.3213, lng: 55.5946 },
    { id: 'Karama', label: 'Dubai Karama', lat: 25.2427, lng: 55.3056 },
    { id: 'Sharjah_Ladies', label: 'Sharjah Ladies Club', lat: 25.3705, lng: 55.3957 } // Added for completeness
];

export const LOCATIONS = BRANCHES;

export const ROLES = {
    ADMIN: 'admin',
    MANAGER: 'manager',
    HEAD_COACH: 'head_coach',
    COACH: 'employee',
    ACCOUNTANT: 'accountant',
    SALES_ADMIN: 'sales_admin'
};
</file>

<file path="src/utils/pdfUtils.js">
import jsPDF from 'jspdf';
import 'jspdf-autotable';

// --- Assets ---
// In a real app, import Base64 logos or fetch them.
// For now, using text/shapes placeholders.

/**
 * Generates a detailed Progress Report PDF
 * @param {Object} student - Student Info { name, level, age }
 * @param {Object} skillsData - Skill Ratings matches the structure used in EvaluationCard
 */
export const generateProgressReport = (student, skillsData) => {
    const doc = new jsPDF();

    // Brand Colors
    const NAVY = [15, 23, 42]; // #0f172a
    const EMERALD = [16, 185, 129]; // #10b981

    // Header Background
    doc.setFillColor(...NAVY);
    doc.rect(0, 0, 210, 40, 'F');

    // Header Text
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(22);
    doc.setFont('helvetica', 'bold');
    doc.text("WILD ROBOT | GYMNASTICS", 15, 20);

    doc.setFontSize(16);
    doc.setFont('helvetica', 'normal');
    doc.text("Progress Report", 15, 30);

    // Student Info
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(12);
    doc.text(`Student: ${student.name}`, 15, 55);
    doc.text(`Level: ${student.level}`, 15, 62);
    doc.text(`Date: ${new Date().toLocaleDateString()}`, 150, 55);

    // Prepare Table Data
    let tableRows = [];

    // skillsData corresponds to the structure:
    // { Floor: [{name: 'Handstand', rating: 4, note: 'Good form'}], Vault: ... }

    Object.keys(skillsData).forEach(apparatus => {
        // Section Header Row
        tableRows.push([{ content: apparatus.toUpperCase(), colSpan: 3, styles: { fillColor: [241, 245, 249], fontStyle: 'bold' } }]);

        skillsData[apparatus].forEach(skill => {
            const stars = "â˜…".repeat(skill.rating) + "â˜†".repeat(5 - skill.rating);
            tableRows.push([
                skill.name,
                stars,
                skill.note || '-'
            ]);
        });
    });

    // Auto Table
    doc.autoTable({
        startY: 70,
        head: [['Skill', 'Rating', 'Coach Note']],
        body: tableRows,
        theme: 'grid',
        headStyles: { fillColor: EMERALD, textColor: 255, fontStyle: 'bold' },
        styles: { fontSize: 10, cellPadding: 3 },
        columnStyles: {
            0: { cellWidth: 80 },
            1: { cellWidth: 40 },
            2: { cellWidth: 'auto' }
        }
    });

    // Footer
    const pageHeight = doc.internal.pageSize.height;
    doc.setFontSize(10);
    doc.setTextColor(150);
    doc.text("Generated by Wild Robot System", 15, pageHeight - 10);

    doc.save(`${student.name.replace(' ', '_')}_Report.pdf`);
};

/**
 * Generates a Gold Certificate for completing a level
 * @param {Object} student 
 */
export const generateCertificate = (student) => {
    const doc = new jsPDF({ orientation: 'landscape' });

    // Decorative Border (Gold)
    doc.setDrawColor(212, 175, 55); // Gold
    doc.setLineWidth(5);
    doc.rect(10, 10, 277, 190);

    // Inner Border (Navy)
    doc.setDrawColor(15, 23, 42); // Navy
    doc.setLineWidth(1);
    doc.rect(15, 15, 267, 180);

    // Title
    doc.setTextColor(15, 23, 42);
    doc.setFont('helvetica', 'bold');
    doc.setFontSize(40);
    doc.text("CERTIFICATE OF ACHIEVEMENT", 148.5, 60, { align: 'center' });

    // Body
    doc.setFontSize(20);
    doc.setFont('helvetica', 'normal');
    doc.text("This certifies that", 148.5, 85, { align: 'center' });

    // Name
    doc.setFontSize(50);
    doc.setTextColor(16, 185, 129); // Emerald
    doc.setFont('times', 'bolditalic');
    doc.text(student.name, 148.5, 110, { align: 'center' });

    // Description
    doc.setFontSize(20);
    doc.setTextColor(15, 23, 42);
    doc.setFont('helvetica', 'normal');
    doc.text(`Has successfully mastered Level: ${student.level}`, 148.5, 140, { align: 'center' });

    // Signature Area
    doc.setLineWidth(0.5);
    doc.line(70, 170, 130, 170); // Line 1
    doc.line(170, 170, 230, 170); // Line 2

    doc.setFontSize(12);
    doc.text("Head Coach", 100, 175, { align: 'center' });
    doc.text("Director", 200, 175, { align: 'center' });

    // Date
    doc.text(`Date: ${new Date().toLocaleDateString()}`, 148.5, 185, { align: 'center' });

    doc.save(`${student.name.replace(' ', '_')}_Certificate.pdf`);
};
</file>

<file path="src/utils/supabase/server.ts">
import { createServerClient, type CookieOptions } from '@supabase/ssr'

export const createClient = (cookieStore: any) => {
    return createServerClient(
        process.env.NEXT_PUBLIC_SUPABASE_URL!,
        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
        {
            cookies: {
                get(name: string) {
                    return cookieStore.get(name)?.value
                },
                set(name: string, value: string, options: CookieOptions) {
                    try {
                        cookieStore.set({ name, value, ...options })
                    } catch (error) {
                        // The `set` method was called from a Server Component. 
                        // This can be ignored if you have middleware refreshing the user session.
                    }
                },
                remove(name: string, options: CookieOptions) {
                    try {
                        cookieStore.set({ name, value: '', ...options })
                    } catch (error) {
                        // The `delete` method was called from a Server Component.
                        // This can be ignored if you have middleware refreshing the user session.
                    }
                },
            },
        }
    )
}
</file>

<file path="supabase/assign_roles.sql">
-- 1. Finance (Accountant)
-- Email: abdulla.smozy+finance@gmail.com
UPDATE public.profiles
SET coach_type = 'accountant'
WHERE id = '127de1b5-157f-4ff5-a794-cd3f495d27fb';

-- 2. Head Coach (Technical Director)
-- Email: abdulla.smozy+headcoach@gmail.com
UPDATE public.profiles
SET coach_type = 'head_coach'
WHERE id = 'ae0b0f08-dbba-4ee7-8586-16b926b20712';

-- 3. HR Manager (Staff)
-- Email: abdulla.smozy+hr@gmail.com
UPDATE public.profiles
SET coach_type = 'hr'
WHERE id = '3d8cac5b-7867-4639-9d2f-c4b84657d008';

-- 4. Activity Manager (Operations)
-- Email: abdulla.smozy+manager@gmail.com
UPDATE public.profiles
SET coach_type = 'manager'
WHERE id = 'c318b10d-d8c0-4c18-9e0a-ff029a6e868d';

-- 5. Super Admin (Your Main Account)
-- Ensures you always have full access
UPDATE public.profiles
SET coach_type = 'super_admin'
WHERE email = 'abdulla.smozy@gmail.com'; 
-- (Assuming this is your main email)

-- Verify Changes
SELECT email, coach_type, id FROM public.profiles;
</file>

<file path="supabase/create_invitations.sql">
-- ---------------------------------------------------------
-- MIGRATION: INVITATIONS TABLE ðŸ“©
-- ---------------------------------------------------------

-- 1. Create Invitations Table
CREATE TABLE IF NOT EXISTS public.invitations (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    token UUID DEFAULT gen_random_uuid() NOT NULL, -- The secret link token
    email TEXT NOT NULL,
    role public.app_role NOT NULL,
    academy_id UUID, -- Will link to academies table once created (Audit Priority 1)
    status TEXT DEFAULT 'pending' CHECK (status IN ('pending', 'accepted', 'expired')),
    expires_at TIMESTAMPTZ DEFAULT (now() + interval '7 days'),
    created_at TIMESTAMPTZ DEFAULT now(),
    UNIQUE(token)
);

-- 2. Enable RLS
ALTER TABLE public.invitations ENABLE ROW LEVEL SECURITY;

-- 3. RLS Policies
-- Allow anyone to read an invitation if they have the token (for validation on JoinTeam page)
CREATE POLICY "Public read by token" 
ON public.invitations FOR SELECT 
USING (true); -- Ideally: token = current_setting('request.jwt.claim.sub', true) OR true for public endpoint check? 
-- Since the user isn't logged in yet, we need public read access, but we should restrict it?
-- For now, allow public read so the Page can validate the token.
-- A better approach is a Postgres Function `check_invite(token)` to avoid exposing the whole table.

-- Policy for Coaches/Admins to CREATE invitations
CREATE POLICY "Admins can create invitations"
ON public.invitations FOR INSERT
TO authenticated
WITH CHECK (true); -- TODO: Refine to check if user is admin of the academy
</file>

<file path="supabase/emergency_fix.sql">
-- EMERGENCY FIX FOR ACADEMY SETUP FLOW
-- Run this in the Supabase SQL Editor to unblock the "Get Started" button.

-- 1. Schema: Ensure 'type' column exists (used for Sport selection)
DO $$ 
BEGIN 
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'type') THEN 
        ALTER TABLE public.academies ADD COLUMN type text; 
    END IF;
END $$;

-- 2. RLS: Allow ANY authenticated user to INSERT a new academy
-- (Previous policies might have required an existing academy_id, creating a deadlock)
DROP POLICY IF EXISTS "Allow authenticated users to create academies" ON public.academies;
DROP POLICY IF EXISTS "Enable insert for authenticated users only" ON public.academies;
DROP POLICY IF EXISTS "Enable read access for all users" ON public.academies;

CREATE POLICY "Allow authenticated users to create academies" 
ON public.academies 
FOR INSERT 
TO authenticated 
WITH CHECK (true);

CREATE POLICY "Allow owners to view their own academy" 
ON public.academies 
FOR SELECT 
TO authenticated 
USING (owner_id = auth.uid());

-- 3. RLS: Allow users to UPDATE their own profile (to save the new academy_id)
DROP POLICY IF EXISTS "Users can update own profile" ON public.profiles;

CREATE POLICY "Users can update own profile" 
ON public.profiles 
FOR UPDATE 
TO authenticated 
USING (auth.uid() = id)
WITH CHECK (auth.uid() = id);

-- 4. Permissions: Grant explicit access
GRANT USAGE ON SCHEMA public TO anon, authenticated;
GRANT ALL ON TABLE public.academies TO authenticated;
GRANT ALL ON TABLE public.profiles TO authenticated;

-- Confirmation
SELECT 'Use this output to confirm execution: Fix Applied Successfully' as result;
</file>

<file path="supabase/emergency_rls_fix.sql">
-- EMERGENCY RLS FIX script
-- DIAGNOSIS: The current RLS policies on 'profiles' are causing an infinite recursion loop.
-- FIX: Wipe all policies and implement a simplified, non-recursive "Blind Read" policy.

BEGIN;

-- 1. Disable RLS temporarily to allow admin operations without blocking
ALTER TABLE public.profiles DISABLE ROW LEVEL SECURITY;

-- 2. NUCLEAR OPTION: Drop ALL existing policies on profiles to ensure a clean slate
DROP POLICY IF EXISTS "Public profiles are viewable by everyone." ON public.profiles;
DROP POLICY IF EXISTS "Users can insert their own profile." ON public.profiles;
DROP POLICY IF EXISTS "Users can update own profile." ON public.profiles;
DROP POLICY IF EXISTS "Allow individual read access" ON public.profiles;
DROP POLICY IF EXISTS "Allow individual update access" ON public.profiles;
DROP POLICY IF EXISTS "Allow individual insert access" ON public.profiles;
DROP POLICY IF EXISTS "Enable read access for all users" ON public.profiles;
DROP POLICY IF EXISTS "Enable insert for authenticated users only" ON public.profiles;
DROP POLICY IF EXISTS "Enable update for users based on email" ON public.profiles;
-- (Attempt to drop *any* other potential policy names found in common templates)
DROP POLICY IF EXISTS "profiles_select_policy" ON public.profiles;
DROP POLICY IF EXISTS "profiles_insert_policy" ON public.profiles;
DROP POLICY IF EXISTS "profiles_update_policy" ON public.profiles;

-- 3. IMPLEMENT "BLIND READ" POLICY
-- This policy allows ANY authenticated user to SELECT ANY row in profiles.
-- CRITICAL: It uses (true) to avoid querying the table itself, preventing recursion.
CREATE POLICY "blind_read_all_profiles"
ON public.profiles FOR SELECT
TO authenticated
USING (true);

-- 4. SECURE UPDATE POLICY
-- Users can only update their OWN profile.
CREATE POLICY "update_own_profile"
ON public.profiles FOR UPDATE
TO authenticated
USING (auth.uid() = id);

-- 5. INSERT POLICY
-- Users can insert their own profile (standard for checks during sign-up).
CREATE POLICY "insert_own_profile"
ON public.profiles FOR INSERT
TO authenticated
WITH CHECK (auth.uid() = id);

-- 6. RE-ENABLE RLS
ALTER TABLE public.profiles ENABLE ROW LEVEL SECURITY;

-- 7. UPSERT COACH PROFILE (FAILSAFE)
-- Ensure the coach account exists and has super_admin privileges.
-- We use ON CONFLICT to update the role if the user already exists.
-- NOTE: We are assuming the coach ID is known or we rely on email lookup which is harder in pure SQL if auth.users is restricted.
-- HOWEVER, we can update based on the specific UUID if known, OR we can try to insert into public.profiles if we know the ID.
-- Since we might not have the exact UUID handy in this script context without querying auth.users (which might be restricted),
-- we will focus on the RLS fix which allows the "Profile Not Found" error to resolve naturally if the record exists.
-- BUT, if you need to force a role for a specific email, you can try this (requires permissions to read auth.users usually):

DO $$
DECLARE
  v_user_id uuid;
BEGIN
  -- Attempt to find the specific coach user by email in auth.users
  -- NOTE: This often requires postgres superuser execution context in Supabase SQL Editor
  SELECT id INTO v_user_id FROM auth.users WHERE email = 'coach@wildrobot.com';

  IF v_user_id IS NOT NULL THEN
    INSERT INTO public.profiles (id, email, role, full_name)
    VALUES (v_user_id, 'coach@wildrobot.com', 'super_admin', 'Head Coach')
    ON CONFLICT (id) DO UPDATE
    SET role = 'super_admin';
  END IF;
END $$;

COMMIT;

-- VERIFICATION QUERY
SELECT * FROM public.profiles LIMIT 5;
</file>

<file path="supabase/enterprise_foundation.sql">
-- ðŸ—ï¸ ENTERPRISE FOUNDATION SCRIPT
-- Objective: Create the data layer for Staff Management and Athlete Gamification.

-- ==========================================
-- 1. STAFF OPERATIONAL TABLES
-- ==========================================

-- 1.1 Staff Details (Extended Profile)
CREATE TABLE IF NOT EXISTS public.staff_details (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    profile_id UUID REFERENCES public.profiles(id) ON DELETE CASCADE,
    academy_id UUID REFERENCES public.academies(id) ON DELETE CASCADE,
    job_title TEXT,
    salary_config JSONB DEFAULT '{}'::jsonb, -- e.g. { "rate": 5000, "type": "monthly" }
    custom_fields JSONB DEFAULT '{}'::jsonb, -- Dynamic fields like "T-Shirt Size"
    created_at TIMESTAMPTZ DEFAULT NOW(),
    UNIQUE(profile_id)
);

-- 1.2 Staff Shifts (Time Tracking)
CREATE TABLE IF NOT EXISTS public.staff_shifts (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    staff_id UUID REFERENCES public.profiles(id) ON DELETE CASCADE,
    academy_id UUID REFERENCES public.academies(id) ON DELETE CASCADE,
    clock_in TIMESTAMPTZ DEFAULT NOW(),
    clock_out TIMESTAMPTZ,
    status TEXT DEFAULT 'active', -- 'active', 'completed'
    gps_check_in JSONB,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 1.3 Staff Tasks (To-Do List)
CREATE TABLE IF NOT EXISTS public.staff_tasks (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    academy_id UUID REFERENCES public.academies(id) ON DELETE CASCADE,
    assigned_to UUID REFERENCES public.profiles(id) ON DELETE SET NULL,
    assigned_by UUID REFERENCES public.profiles(id) ON DELETE SET NULL,
    title TEXT NOT NULL,
    description TEXT,
    priority TEXT DEFAULT 'medium', -- 'low', 'medium', 'high', 'critical'
    status TEXT DEFAULT 'pending', -- 'pending', 'in_progress', 'done', 'archived'
    due_date TIMESTAMPTZ,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- ==========================================
-- 2. THE HERO SYSTEM (Athletes & Guardians)
-- ==========================================

-- 2.1 Guardians (The Family Wallet)
CREATE TABLE IF NOT EXISTS public.guardians (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    academy_id UUID REFERENCES public.academies(id) ON DELETE CASCADE,
    profile_id UUID REFERENCES public.profiles(id) ON DELETE SET NULL, -- Can exist without App Login initially
    name TEXT NOT NULL,
    email TEXT,
    phone TEXT,
    relationship_type TEXT DEFAULT 'parent',
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 2.2 Athletes (The Heroes)
CREATE TABLE IF NOT EXISTS public.athletes (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    academy_id UUID REFERENCES public.academies(id) ON DELETE CASCADE,
    profile_id UUID REFERENCES public.profiles(id) ON DELETE SET NULL, -- Optional (for older athletes)
    name TEXT NOT NULL,
    dob DATE,
    gender TEXT, -- 'male', 'female'
    bio TEXT,
    medical_info JSONB DEFAULT '{}'::jsonb, -- e.g. { "allergies": ["nuts"], "blood_type": "O+" }
    stats JSONB DEFAULT '{"pace": 60, "shooting": 60, "passing": 60, "dribbling": 60, "defense": 60, "physical": 60}'::jsonb, -- FIFA Stats
    status TEXT DEFAULT 'active', -- 'active', 'inactive', 'injured'
    photo_url TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 2.3 Athlete <-> Guardian (Many-to-Many Junction)
CREATE TABLE IF NOT EXISTS public.athlete_guardians (
    athlete_id UUID REFERENCES public.athletes(id) ON DELETE CASCADE,
    guardian_id UUID REFERENCES public.guardians(id) ON DELETE CASCADE,
    PRIMARY KEY (athlete_id, guardian_id)
);

-- ==========================================
-- 3. SECURITY (RLS Policies)
-- ==========================================

-- Enable RLS
ALTER TABLE public.staff_details ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.staff_shifts ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.staff_tasks ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.guardians ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.athletes ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.athlete_guardians ENABLE ROW LEVEL SECURITY;

-- Helper Function: Check if user owns the academy related to the record
-- Note: Optimizing strictly for Owner CRUD right now.
-- In production, we'd add 'Manager' role checks here too.

-- 3.1 Staff Details Policies
CREATE POLICY "Owners can manage staff details" ON public.staff_details
    USING (academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid()))
    WITH CHECK (academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid()));

CREATE POLICY "Staff can view own details" ON public.staff_details
    FOR SELECT USING (profile_id = auth.uid());

-- 3.2 Staff Shifts Policies
CREATE POLICY "Owners manage shifts" ON public.staff_shifts
    USING (academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid()))
    WITH CHECK (academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid()));

CREATE POLICY "Staff manage own shifts" ON public.staff_shifts
    USING (staff_id = auth.uid())
    WITH CHECK (staff_id = auth.uid());

-- 3.3 Staff Tasks Policies
CREATE POLICY "Owners manage tasks" ON public.staff_tasks
    USING (academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid()))
    WITH CHECK (academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid()));

CREATE POLICY "Staff view assigned tasks" ON public.staff_tasks
    FOR SELECT USING (assigned_to = auth.uid());

CREATE POLICY "Staff update assigned task status" ON public.staff_tasks
    FOR UPDATE USING (assigned_to = auth.uid());

-- 3.4 Athletes & Guardians Policies (Owner Only for Phase 3)
CREATE POLICY "Owners manage athletes" ON public.athletes
    USING (academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid()))
    WITH CHECK (academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid()));

CREATE POLICY "Owners manage guardians" ON public.guardians
    USING (academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid()))
    WITH CHECK (academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid()));

CREATE POLICY "Owners manage athlete links" ON public.athlete_guardians
    USING (athlete_id IN (SELECT id FROM athletes WHERE academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid())))
    WITH CHECK (athlete_id IN (SELECT id FROM athletes WHERE academy_id IN (SELECT id FROM academies WHERE owner_id = auth.uid())));

-- ==========================================
-- 4. GRANT PERMISSIONS
-- ==========================================
GRANT ALL ON public.staff_details TO authenticated;
GRANT ALL ON public.staff_shifts TO authenticated;
GRANT ALL ON public.staff_tasks TO authenticated;
GRANT ALL ON public.guardians TO authenticated;
GRANT ALL ON public.athletes TO authenticated;
GRANT ALL ON public.athlete_guardians TO authenticated;

-- Refresh schema cache
NOTIFY pgrst, 'reload config';
</file>

<file path="supabase/express_setup_fix.sql">
-- EXPRESS SETUP FIX
-- Adds missing columns to 'academies' table to prevent setup errors.

DO $$ 
BEGIN 
    -- 1. Check and Add 'location'
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'location') THEN 
        ALTER TABLE public.academies ADD COLUMN location text; 
    END IF;

    -- 2. Check and Add 'type' (for Sport Focus)
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'type') THEN 
        ALTER TABLE public.academies ADD COLUMN type text; 
    END IF;

    -- 3. Check and Add 'currency' with default AED
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'currency') THEN 
        ALTER TABLE public.academies ADD COLUMN currency text DEFAULT 'AED'; 
    END IF;

END $$;

-- 4. Reload Schema Cache (notify PostgREST)
NOTIFY pgrst, 'reload config';

SELECT 'Schema Updated Successfully: location, type, and currency columns checked/added.' as result;
</file>

<file path="supabase/fix_academy_rls_and_schema.sql">
-- EMERGENCY FIX: Academy Setup Permissions & Schema
-- 1. Ensure 'type' column exists (legacy fallback)
ALTER TABLE public.academies 
ADD COLUMN IF NOT EXISTS type text DEFAULT 'General';

-- 2. Ensure RLS enabled (security best practice)
ALTER TABLE public.academies ENABLE ROW LEVEL SECURITY;

-- 3. NUCLEAR OPTION: Drop existing Academy policies to prevent conflicts
DROP POLICY IF EXISTS "Enable insert for authenticated users only" ON public.academies;
DROP POLICY IF EXISTS "Owners can update their own academy" ON public.academies;
DROP POLICY IF EXISTS "Everyone can read academies" ON public.academies;

-- 4. Create PERMISSIVE Policy for first-time creation
-- This allows ANY authenticated user to insert a row (Start of setup)
CREATE POLICY "Allow authenticated users to create academy"
ON public.academies FOR INSERT 
TO authenticated 
WITH CHECK (auth.uid() = owner_id);

-- 5. Standard policies for later
CREATE POLICY "Owners can update their own academy"
ON public.academies FOR UPDATE
USING (auth.uid() = owner_id);

CREATE POLICY "Everyone can read academies"
ON public.academies FOR SELECT
USING (true);

-- 6. Ensure Profiles are updateable
DROP POLICY IF EXISTS "Users can update own profile" ON public.profiles;
CREATE POLICY "Users can update own profile"
ON public.profiles FOR UPDATE
USING (auth.uid() = id);

-- 7. Grant permissions explicitly (just in case)
GRANT ALL ON public.academies TO authenticated;
GRANT USAGE, SELECT ON SEQUENCE academies_id_seq TO authenticated;
</file>

<file path="supabase/fix_academy_setup.sql">
-- 1. Ensure 'type' column exists (and 'sport' just in case, or we stick to 'type')
DO $$ 
BEGIN 
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'type') THEN 
        ALTER TABLE public.academies ADD COLUMN type text; 
    END IF;
END $$;

-- 2. Drop existing INSERT policy if it exists to avoid conflicts
DROP POLICY IF EXISTS "Allow authenticated users to create academies" ON public.academies;
DROP POLICY IF EXISTS "Enable insert for authenticated users only" ON public.academies;

-- 3. Create a permissive INSERT policy for authenticated users
-- This is necessary because a new owner doesn't have an academy_id yet, 
-- so they can't match against an existing row.
CREATE POLICY "Allow authenticated users to create academies" 
ON public.academies 
FOR INSERT 
TO authenticated 
WITH CHECK (true);

-- 4. Ensure Owners can UPDATE their own profile to link the academy
DROP POLICY IF EXISTS "Users can update own profile" ON public.profiles;

CREATE POLICY "Users can update own profile" 
ON public.profiles 
FOR UPDATE 
TO authenticated 
USING (auth.uid() = id)
WITH CHECK (auth.uid() = id);

-- 5. Grant permissions just in case
GRANT INSERT ON public.academies TO authenticated;
GRANT UPDATE ON public.profiles TO authenticated;
</file>

<file path="supabase/fix_coach_role.sql">
-- ---------------------------------------------------------
-- FIX: CORRECT COACH ROLE (ENUM HANDLING)
-- ---------------------------------------------------------

-- 1. Add 'coach' to the enum if it doesn't represent
-- We use a DO block to handle the exception if it already exists (for older PG versions)
-- Or just standard ALTER TYPE if supported.
DO $$
BEGIN
    ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'coach';
EXCEPTION
    WHEN duplicate_object THEN null; -- Ignore if exists
    WHEN OTHERS THEN null; -- Ignore other errors (like if not an enum)
END $$;

-- 2. Force update the 'coach' role
UPDATE public.profiles
SET role = 'coach'
FROM auth.users
WHERE public.profiles.id = auth.users.id
AND auth.users.email = 'coach@wildrobot.com';

-- 3. Verify
-- SELECT * FROM public.profiles WHERE role = 'coach';
</file>

<file path="supabase/fix_missing_columns.sql">
-- FIX: Add missing columns to 'academies' table
-- The error "Could not find column... in schema cache" means these columns do not exist in the database yet.

-- 1. setup_completed
ALTER TABLE public.academies 
ADD COLUMN IF NOT EXISTS setup_completed boolean DEFAULT false;

-- 2. brand_color
ALTER TABLE public.academies 
ADD COLUMN IF NOT EXISTS brand_color text DEFAULT '#10b981';

-- 3. business_type (academy vs club)
ALTER TABLE public.academies 
ADD COLUMN IF NOT EXISTS business_type text DEFAULT 'academy';

-- 4. currency
ALTER TABLE public.academies 
ADD COLUMN IF NOT EXISTS currency text DEFAULT 'AED';

-- 5. subscription_model
ALTER TABLE public.academies 
ADD COLUMN IF NOT EXISTS subscription_model text DEFAULT 'term_based';

-- 6. subscription_status
ALTER TABLE public.academies 
ADD COLUMN IF NOT EXISTS subscription_status text DEFAULT 'trial';

-- Refresh the schema cache (PostgREST sometimes needs a nudge, though usually automatic)
NOTIFY pgrst, 'reload config';
</file>

<file path="supabase/fix_rls_sessions.sql">
-- ---------------------------------------------------------
-- FIX: ACTIVE SESSIONS RLS POLICIES
-- ---------------------------------------------------------
-- The "System Error" occurred because the user (Authenticated) 
-- did not have permission to DELETE or INSERT into 'active_sessions'.

-- 1. Ensure Table Exists
CREATE TABLE IF NOT EXISTS public.active_sessions (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE NOT NULL,
    user_agent TEXT,
    last_active TIMESTAMPTZ DEFAULT now(),
    created_at TIMESTAMPTZ DEFAULT now()
);

-- 2. Enable RLS
ALTER TABLE public.active_sessions ENABLE ROW LEVEL SECURITY;

-- 3. DROP Existing Policies to ensure clean slate
DROP POLICY IF EXISTS "Users can view their own sessions" ON public.active_sessions;
DROP POLICY IF EXISTS "Users can insert their own sessions" ON public.active_sessions;
DROP POLICY IF EXISTS "Users can delete their own sessions" ON public.active_sessions;
DROP POLICY IF EXISTS "Users can update their own sessions" ON public.active_sessions;

-- 4. CREATE Correct Policies
-- Allow SELECT
CREATE POLICY "Users can view their own sessions"
ON public.active_sessions FOR SELECT
USING (auth.uid() = user_id);

-- Allow INSERT
CREATE POLICY "Users can insert their own sessions"
ON public.active_sessions FOR INSERT
WITH CHECK (auth.uid() = user_id);

-- Allow DELETE (Crucial for the "Simulated Logout" / Wipe)
CREATE POLICY "Users can delete their own sessions"
ON public.active_sessions FOR DELETE
USING (auth.uid() = user_id);

-- Allow UPDATE
CREATE POLICY "Users can update their own sessions"
ON public.active_sessions FOR UPDATE
USING (auth.uid() = user_id);

-- 5. Add Profile Column for Device Limit (Ensure it exists)
-- This prevents the "Profile Not Found" retry loop if the column is missing.
ALTER TABLE public.profiles ADD COLUMN IF NOT EXISTS max_allowed_devices INT DEFAULT 1;
</file>

<file path="supabase/fix_student_role.sql">
-- ---------------------------------------------------------
-- FIX: ADD ROLE COLUMN AND UPDATE STUDENT
-- ---------------------------------------------------------

-- 1. Add 'role' column to profiles if it doesn't exist
DO $$ 
BEGIN 
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name='profiles' AND column_name='role') THEN 
        ALTER TABLE public.profiles ADD COLUMN role TEXT DEFAULT 'coach'; 
    END IF; 
END $$;

-- 2. Update the specific student user to 'athlete'
-- Since profiles might not have 'email', we join with auth.users
UPDATE public.profiles
SET role = 'athlete'
FROM auth.users
WHERE public.profiles.id = auth.users.id
AND auth.users.email = 'student@wildrobot.com';

-- 3. Verify the role (Optional check)
-- SELECT * FROM public.profiles WHERE role = 'athlete';
</file>

<file path="supabase/fix_type_column.sql">
-- FIX: Add missing 'type' column to academies table
-- The frontend sends 'type' (Mapped to Sport Name, e.g., 'Gymnastics'), but the DB is missing it.

ALTER TABLE public.academies 
ADD COLUMN IF NOT EXISTS type text DEFAULT 'General';

-- Refresh schema cache
NOTIFY pgrst, 'reload config';
</file>

<file path="supabase/fix_unique_constraint.sql">
-- FIX: Add UNIQUE constraint to owner_id in academies table
-- The error "there is no unique or exclusion constraint matching the ON CONFLICT specification"
-- happens because we rely on 'owner_id' to be unique for the UPSERT operation, but the database doesn't enforce it yet.

ALTER TABLE public.academies
ADD CONSTRAINT academies_owner_id_key UNIQUE (owner_id);

-- Refresh schema cache
NOTIFY pgrst, 'reload config';
</file>

<file path="supabase/functions/create-user/index.ts">
import { serve } from "https://deno.land/std@0.168.0/http/server.ts"
import { createClient } from "https://esm.sh/@supabase/supabase-js@2"

const corsHeaders = {
    'Access-Control-Allow-Origin': '*',
    'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',
}

serve(async (req) => {
    // Handle CORS preflight requests
    if (req.method === 'OPTIONS') {
        return new Response('ok', { headers: corsHeaders })
    }

    try {
        // 1. Create a Supabase client with the Auth context of the logged in user
        const supabaseClient = createClient(
            Deno.env.get('SUPABASE_URL') ?? '',
            Deno.env.get('SUPABASE_ANON_KEY') ?? '',
            { global: { headers: { Authorization: req.headers.get('Authorization')! } } }
        )

        // 2. Check if the user is an Admin/Owner
        const {
            data: { user },
        } = await supabaseClient.auth.getUser()

        if (!user) {
            throw new Error('Unauthorized')
        }

        // Optional: Add stricter role checks here via database lookup if needed
        // For now, we assume if they can call this (protected by RLS usually), they are okay. 
        // BUT since this is an edge function, we need to be careful.
        // Ideally, we verify the user's role from the 'profiles' table.

        // 3. Create the Admin Client (SERVICE_ROLE_KEY) to create users without login
        // WARNING: This key has full access. Use with care.
        const supabaseAdmin = createClient(
            Deno.env.get('SUPABASE_URL') ?? '',
            Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ?? ''
        )

        // 4. Parse Request Body
        const { email, password, userData } = await req.json()

        // 5. Create the User via Admin Client
        const { data: newUser, error: createError } = await supabaseAdmin.auth.admin.createUser({
            email,
            password,
            email_confirm: true, // Auto-confirm
            user_metadata: userData
        })

        if (createError) throw createError

        // 6. Return Success
        return new Response(
            JSON.stringify(newUser),
            {
                headers: { ...corsHeaders, 'Content-Type': 'application/json' },
                status: 200,
            }
        )

    } catch (error) {
        return new Response(
            JSON.stringify({ error: error.message }),
            {
                headers: { ...corsHeaders, 'Content-Type': 'application/json' },
                status: 400,
            }
        )
    }
})
</file>

<file path="supabase/reset_sessions_table.sql">
-- ================================================================
-- ðŸš€ WILD ROBOT MASTER SCRIPT (V4.0 - FINAL FOUNDATION)
-- ================================================================
-- Ù‡Ø°Ø§ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª ÙŠÙ‚ÙˆÙ… Ø¨Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
-- ÙˆÙŠØ¯Ø¹Ù… Ø§Ù„Ø´Ø§ØªØŒ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©ØŒ ÙˆØ¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ØµØµ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ.
-- ================================================================

-- 1. Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø´Ø§Ù…Ù„ (CLEANUP)
-- Ø¨Ù†Ù…Ø³Ø­ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¹Ø´Ø§Ù† Ù†Ø¨Ø¯Ø£ Ø¹Ù„Ù‰ Ù†Ø¸Ø§ÙØ©
DROP TABLE IF EXISTS public.messages CASCADE;
DROP TABLE IF EXISTS public.enrollments CASCADE;
DROP TABLE IF EXISTS public.sessions CASCADE;
DROP TABLE IF EXISTS public.active_sessions CASCADE;
-- Ù…Ù„Ø§Ø­Ø¸Ø©: Ù…Ø´ Ù‡Ù†Ù…Ø³Ø­ Ø¬Ø¯ÙˆÙ„ profiles Ø¹Ø´Ø§Ù† Ù…Ù†Ø¨ÙˆØ¸Ø´ Ø§Ù„Ù€ Auth LinksØŒ Ø¨Ø³ Ù‡Ù†Ø­Ø¯Ø«Ù‡.

-- 2. ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± (ENUMS & ROLES)
DO $$ BEGIN
    -- Ø¥Ù†Ø´Ø§Ø¡ Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø£Ø¯ÙˆØ§Ø± Ù„Ùˆ Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯
    IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'app_role') THEN
        CREATE TYPE public.app_role AS ENUM (
            'super_admin',  -- Ø§Ù„Ù…Ø§Ù„Ùƒ
            'manager',      -- Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø´Ø§Ø·
            'hr',           -- Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©
            'head_coach',   -- Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„ÙÙ†ÙŠ
            'coach',        -- Ø§Ù„Ù…Ø¯Ø±Ø¨
            'accountant',   -- Ø§Ù„Ù…Ø­Ø§Ø³Ø¨
            'sales_admin',  -- Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
            'athlete',      -- Ø§Ù„Ø·Ø§Ù„Ø¨
            'parent'        -- ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
        );
    ELSE
        -- Ù„Ùˆ Ø§Ù„Ù†ÙˆØ¹ Ù…ÙˆØ¬ÙˆØ¯ØŒ Ø¨Ù†Ø­Ø§ÙˆÙ„ Ù†Ø¶ÙŠÙ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Postgres workaround)
        ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'super_admin';
        ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'hr';
    END IF;
EXCEPTION
    WHEN duplicate_object THEN null; -- ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø®Ø·Ø£ Ù„Ùˆ Ø§Ù„Ù‚ÙŠÙ…Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©
END $$;

DO $$ BEGIN
    CREATE TYPE public.attendance_status AS ENUM ('present', 'absent', 'excused', 'late');
EXCEPTION WHEN duplicate_object THEN null; END $$;

-- 3. ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ (PROFILES TABLE)
CREATE TABLE IF NOT EXISTS public.profiles (
    id UUID REFERENCES auth.users(id) ON DELETE CASCADE PRIMARY KEY,
    email TEXT,
    full_name TEXT,
    role public.app_role DEFAULT 'coach', -- Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
    branch TEXT DEFAULT 'Main Branch',
    avatar_url TEXT,
    max_allowed_devices INTEGER DEFAULT 2,
    created_at TIMESTAMPTZ DEFAULT now(),
    updated_at TIMESTAMPTZ DEFAULT now()
);

-- ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ù…Ø§Ù† (RLS)
ALTER TABLE public.profiles ENABLE ROW LEVEL SECURITY;

-- Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†:
-- 1. Ø£ÙŠ Ø­Ø¯ ÙŠÙ‚Ø¯Ø± ÙŠÙ‚Ø±Ø§ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ (Ø¹Ø´Ø§Ù† Ø§Ù„Ø´Ø§Øª ÙˆØ§Ù„Ù…Ù†Ø´Ù†)
DROP POLICY IF EXISTS "Public profiles are viewable by everyone" ON public.profiles;
CREATE POLICY "Public profiles are viewable by everyone" ON public.profiles FOR SELECT USING (true);

-- 2. Ø§Ù„ÙŠÙˆØ²Ø± ÙŠÙ‚Ø¯Ø± ÙŠØ¹Ø¯Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ Ù‡Ùˆ Ø¨Ø³
DROP POLICY IF EXISTS "Users can update own profile" ON public.profiles;
CREATE POLICY "Users can update own profile" ON public.profiles FOR UPDATE USING (auth.uid() = id);

-- 4. Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø´Ø§Øª (MESSAGES TABLE) ðŸ’¬
CREATE TABLE IF NOT EXISTS public.messages (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    sender_id UUID REFERENCES public.profiles(id) NOT NULL,
    receiver_id UUID REFERENCES public.profiles(id), -- Ù„Ùˆ NULL ÙŠØ¨Ù‚Ù‰ Ø±Ø³Ø§Ù„Ø© Ø¬Ù…Ø§Ø¹ÙŠØ©
    content TEXT NOT NULL,
    is_read BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMPTZ DEFAULT now()
);
ALTER TABLE public.messages ENABLE ROW LEVEL SECURITY;

-- Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø´Ø§Øª: Ø£Ø´ÙˆÙ Ø±Ø³Ø§ÙŠÙ„ÙŠ ÙˆØ§Ù„Ø±Ø³Ø§ÙŠÙ„ Ø§Ù„Ù„ÙŠ Ù…Ø¨Ø¹ÙˆØªØ§Ù„ÙŠ ÙˆØ§Ù„Ø±Ø³Ø§ÙŠÙ„ Ø§Ù„Ø¹Ø§Ù…Ø©
DROP POLICY IF EXISTS "Users see their own chats" ON public.messages;
CREATE POLICY "Users see their own chats" ON public.messages 
FOR SELECT USING (auth.uid() = sender_id OR auth.uid() = receiver_id OR receiver_id IS NULL);

DROP POLICY IF EXISTS "Users can send messages" ON public.messages;
CREATE POLICY "Users can send messages" ON public.messages 
FOR INSERT WITH CHECK (auth.uid() = sender_id);


-- 5. Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ØµØµ (SESSIONS & ENROLLMENTS) ðŸ“…
CREATE TABLE IF NOT EXISTS public.sessions (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    title TEXT NOT NULL,
    coach_id UUID REFERENCES public.profiles(id),
    branch TEXT NOT NULL,
    start_time TIMESTAMPTZ NOT NULL,
    end_time TIMESTAMPTZ NOT NULL,
    level TEXT,
    max_capacity INTEGER DEFAULT 20,
    created_at TIMESTAMPTZ DEFAULT now()
);
ALTER TABLE public.sessions ENABLE ROW LEVEL SECURITY;
DROP POLICY IF EXISTS "Public view sessions" ON public.sessions;
CREATE POLICY "Public view sessions" ON public.sessions FOR SELECT USING (true);

CREATE TABLE IF NOT EXISTS public.enrollments (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    session_id UUID REFERENCES public.sessions(id) ON DELETE CASCADE,
    student_id UUID REFERENCES public.profiles(id) ON DELETE CASCADE,
    status public.attendance_status DEFAULT NULL,
    notes TEXT,
    created_at TIMESTAMPTZ DEFAULT now(),
    UNIQUE(session_id, student_id)
);
ALTER TABLE public.enrollments ENABLE ROW LEVEL SECURITY;
DROP POLICY IF EXISTS "Coaches manage enrollments" ON public.enrollments;
CREATE POLICY "Coaches manage enrollments" ON public.enrollments FOR ALL USING (true); 


-- 6. Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù† (ACTIVE SESSIONS) ðŸ›¡ï¸
CREATE TABLE IF NOT EXISTS public.active_sessions (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
    user_agent TEXT,
    last_active TIMESTAMPTZ DEFAULT now(),
    created_at TIMESTAMPTZ DEFAULT now()
);
ALTER TABLE public.active_sessions ENABLE ROW LEVEL SECURITY;
DROP POLICY IF EXISTS "Manage own sessions" ON public.active_sessions;
CREATE POLICY "Manage own sessions" ON public.active_sessions FOR ALL USING (auth.uid() = user_id);

-- ================================================================
-- ðŸŒ± Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (SEED DATA) - Ø¹Ø´Ø§Ù† Ù†Ø¬Ø±Ø¨ ÙÙˆØ±Ø§Ù‹
-- ================================================================

-- 1. Ø¥Ø¶Ø§ÙØ© Ù…Ø¯Ø±Ø¨ (Coach) - Ù„Ùˆ Ø§Ù„ÙŠÙˆØ²Ø± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ù†Ø­Ø¯Ø« Ø¯ÙˆØ±Ù‡
INSERT INTO public.profiles (id, email, full_name, role, branch)
VALUES 
    ('0036e85b-c82b-4f12-b43f-2a2d49dd4ffa', 'coach@wildrobot.com', 'Captain Majed', 'coach', 'Ajman Academy')
ON CONFLICT (id) DO UPDATE SET role = 'coach', full_name = 'Captain Majed';

-- 2. Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ (Student)
INSERT INTO public.profiles (id, email, full_name, role, branch)
VALUES 
    ('3555c4b2-f51b-4e88-9522-3455deeac3d0', 'student@wildrobot.com', 'Hero Student', 'athlete', 'Ajman Academy')
ON CONFLICT (id) DO UPDATE SET role = 'athlete', full_name = 'Hero Student';

-- 3. Ø¥Ø¶Ø§ÙØ© Ø­ØµØµ Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø¯Ù‡ (Real Schedule)
INSERT INTO public.sessions (id, title, coach_id, branch, start_time, end_time, level)
VALUES 
    (gen_random_uuid(), 'Elite Gymnastics', '0036e85b-c82b-4f12-b43f-2a2d49dd4ffa', 'Ajman Academy', now() + interval '2 hours', now() + interval '3 hours', 'Level 3'),
    (gen_random_uuid(), 'Swimming Basics', '0036e85b-c82b-4f12-b43f-2a2d49dd4ffa', 'Sharjah Branch', now() + interval '1 day', now() + interval '1 day 2 hours', 'Level 1');

-- 4. ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ Ø§Ù„Ø­ØµØ© Ø§Ù„Ø£ÙˆÙ„Ù‰
INSERT INTO public.enrollments (session_id, student_id, status)
SELECT id, '3555c4b2-f51b-4e88-9522-3455deeac3d0', 'present'
FROM public.sessions LIMIT 1;

-- 5. Ø±Ø³Ø§Ù„Ø© Ø´Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
INSERT INTO public.messages (sender_id, content)
VALUES ('0036e85b-c82b-4f12-b43f-2a2d49dd4ffa', 'Welcome to Wild Robot System! ðŸ¤–');
</file>

<file path="supabase/rpc_force_device.sql">
-- ---------------------------------------------------------
-- RPC: FORCE DEVICE ACCESS (Atomic Wipe & Register)
-- ---------------------------------------------------------
-- This function deletes all sessions for a user and immediately 
-- inserts the current device, preventing RLS race conditions.

CREATE OR REPLACE FUNCTION force_device_access(target_user_id UUID, current_fingerprint TEXT)
RETURNS VOID
LANGUAGE plpgsql
SECURITY DEFINER -- Runs with elevated permissions (bypassing RLS for the cleanup)
AS $$
BEGIN
    -- 1. Wipe all sessions for this user
    DELETE FROM public.active_sessions 
    WHERE user_id = target_user_id;

    -- 2. Register the current device
    INSERT INTO public.active_sessions (user_id, user_agent, last_active)
    VALUES (target_user_id, current_fingerprint, now());
END;
$$;
</file>

<file path="supabase/seed_users.sql">
-- ---------------------------------------------------------
-- MISSION: LINK AUTH USERS TO PROFILES
-- ---------------------------------------------------------

-- 1. Insert Coach into `public.profiles`
-- We use ON CONFLICT to avoid errors if they already exist.
-- Adjust 'full_name' and 'email' if you have specific values.
INSERT INTO public.profiles (id, email, full_name, coach_type)
VALUES (
    '0036e85b-c82b-4f12-b43f-2a2d49dd4ffa', -- Coach UID
    'coach@wildrobot.com',                  -- Placeholder Email
    'Coach One',                            -- Placeholder Name
    'coach'                                 -- Role
)
ON CONFLICT (id) DO UPDATE 
SET coach_type = 'coach', full_name = 'Coach One';


-- 2. Insert Student into `public.students`
-- This assumes a `students` table exists as per frontend code.
INSERT INTO public.students (id, full_name, level, avatar_url)
VALUES (
    '3555c4b2-f51b-4e88-9522-3455deeac3d0', -- Student UID
    'Hero Student',                         -- Placeholder Name
    'Gold',                                 -- Placeholder Level
    '/wibo_assets/Gamification/wibo_skill_master_hero.png' -- Default Avatar
)
ON CONFLICT (id) DO UPDATE
SET full_name = 'Hero Student';

-- 3. (Optional) Ensure Student has a Profile entry if your app requires it for login
-- Some apps use a central `profiles` table for ALL users + `students` for details.
-- Uncomment below if you experience login issues for the student.

-- INSERT INTO public.profiles (id, email, full_name, coach_type)
-- VALUES (
--     '3555c4b2-f51b-4e88-9522-3455deeac3d0',
--     'student@wildrobot.com',
--     'Hero Student',
--     'student'
-- )
-- ON CONFLICT (id) DO NOTHING;
</file>

<file path="supabase/setup_pricing_infrastructure.sql">
-- PRICING INFRASTRUCTURE SETUP
-- Creates subscription_plans and updates academies for limits enforcement.

-- 1. Create 'subscription_plans' table
CREATE TABLE IF NOT EXISTS public.subscription_plans (
    id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
    name text NOT NULL,
    tier_slug text NOT NULL UNIQUE, -- 'starter', 'pro', 'elite'
    price_monthly integer DEFAULT 0,
    price_yearly integer DEFAULT 0,
    max_athletes integer, -- NULL means Unlimited
    features jsonb DEFAULT '[]'::jsonb,
    created_at timestamptz DEFAULT now()
);

-- 2. Update 'academies' table
-- Add columns for plan tracking
DO $$ 
BEGIN 
    -- current_plan_id
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'current_plan_id') THEN 
        ALTER TABLE public.academies ADD COLUMN current_plan_id uuid REFERENCES public.subscription_plans(id); 
    END IF;

    -- subscription_status (Ensuring it exists, though usually added previously)
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'subscription_status') THEN 
        ALTER TABLE public.academies ADD COLUMN subscription_status text DEFAULT 'trial'; 
    END IF;

    -- trial_ends_at
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'trial_ends_at') THEN 
        ALTER TABLE public.academies ADD COLUMN trial_ends_at timestamptz DEFAULT (now() + interval '14 days'); 
    END IF;

END $$;

-- 3. Seed Data (Upsert Logic to prevent duplicates)
-- STARTER
INSERT INTO public.subscription_plans (tier_slug, name, price_monthly, price_yearly, max_athletes, features)
VALUES (
    'starter', 
    'Starter', 
    0, 
    0, 
    10, 
    '["Up to 10 Athletes", "Basic Scheduling", "Attendance Tracking", "Mobile App Access"]'::jsonb
) ON CONFLICT (tier_slug) DO UPDATE SET 
    name = EXCLUDED.name,
    price_monthly = EXCLUDED.price_monthly, 
    price_yearly = EXCLUDED.price_yearly,
    max_athletes = EXCLUDED.max_athletes,
    features = EXCLUDED.features;

-- PRO
INSERT INTO public.subscription_plans (tier_slug, name, price_monthly, price_yearly, max_athletes, features)
VALUES (
    'pro', 
    'Pro', 
    29, 
    24, 
    50, 
    '["Up to 50 Athletes", "Video Analysis", "Performance Evals", "Parent Portal"]'::jsonb
) ON CONFLICT (tier_slug) DO UPDATE SET 
    name = EXCLUDED.name,
    price_monthly = EXCLUDED.price_monthly, 
    price_yearly = EXCLUDED.price_yearly,
    max_athletes = EXCLUDED.max_athletes,
    features = EXCLUDED.features;

-- ELITE
INSERT INTO public.subscription_plans (tier_slug, name, price_monthly, price_yearly, max_athletes, features)
VALUES (
    'elite', 
    'Elite', 
    99, 
    81, 
    NULL, -- Unlimited
    '["Unlimited Athletes", "Advanced Analytics", "Tournament Planner", "Live Streaming"]'::jsonb
) ON CONFLICT (tier_slug) DO UPDATE SET 
    name = EXCLUDED.name,
    price_monthly = EXCLUDED.price_monthly, 
    price_yearly = EXCLUDED.price_yearly,
    max_athletes = EXCLUDED.max_athletes,
    features = EXCLUDED.features;


-- 4. RLS Policies
ALTER TABLE public.subscription_plans ENABLE ROW LEVEL SECURITY;

-- Allow read access to everyone (public plans)
DROP POLICY IF EXISTS "Read access for plans" ON public.subscription_plans;
CREATE POLICY "Read access for plans" ON public.subscription_plans FOR SELECT TO authenticated, anon USING (true);


NOTIFY pgrst, 'reload config';

SELECT 'Pricing Infrastructure Deployed & Seeded' as result;
</file>

<file path="supabase/strict_fix.sql">
-- ---------------------------------------------------------
-- STRICT FIX: MANUAL UPSERT (Bypasses Constraint Check) ðŸ›¡ï¸
-- ---------------------------------------------------------

-- 1. Enable Crypto
CREATE EXTENSION IF NOT EXISTS "pgcrypto";

-- 2. Safe Enum Update
DO $$ 
BEGIN
    ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'admin';
    ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'sales_admin';
    ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'coach';
    ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'athlete';
EXCEPTION 
    WHEN OTHERS THEN null;
END $$;

-- 3. FUNCTIONAL BLOCK: Handle Users & Profiles One by One
DO $$ 
DECLARE
    curr_uid uuid;
BEGIN
    -- ====================================================
    -- USER 1: ADMIN (abdulla.smozy@gmail.com)
    -- ====================================================
    SELECT id INTO curr_uid FROM auth.users WHERE email = 'abdulla.smozy@gmail.com';
    
    IF curr_uid IS NOT NULL THEN
        -- UPDATE EXISTING
        UPDATE auth.users 
        SET encrypted_password = crypt('password123', gen_salt('bf')),
            raw_user_meta_data = '{"full_name":"Abdulla Smozy"}'
        WHERE id = curr_uid;
    ELSE
        -- INSERT NEW
        curr_uid := 'e9dc1d40-8fa5-4334-bea9-6b9424d2705a'; -- Hardcoded for admin
        INSERT INTO auth.users (instance_id, id, aud, role, email, encrypted_password, email_confirmed_at, raw_app_meta_data, raw_user_meta_data, created_at, updated_at)
        VALUES ('00000000-0000-0000-0000-000000000000', curr_uid, 'authenticated', 'authenticated', 'abdulla.smozy@gmail.com', crypt('password123', gen_salt('bf')), now(), '{"provider":"email","providers":["email"]}', '{"full_name":"Abdulla Smozy"}', now(), now());
    END IF;

    -- Sync Profile (Admin)
    INSERT INTO public.profiles (id, full_name, role, max_allowed_devices)
    VALUES (curr_uid, 'Abdulla Smozy', 'admin', 10)
    ON CONFLICT (id) DO UPDATE SET role = EXCLUDED.role, max_allowed_devices = 10;


    -- ====================================================
    -- USER 2: COACH (coach@wildrobot.com)
    -- ====================================================
    curr_uid := NULL;
    SELECT id INTO curr_uid FROM auth.users WHERE email = 'coach@wildrobot.com';

    IF curr_uid IS NOT NULL THEN
        UPDATE auth.users 
        SET encrypted_password = crypt('password123', gen_salt('bf')),
            raw_user_meta_data = '{"full_name":"Main Coach"}'
        WHERE id = curr_uid;
    ELSE
        curr_uid := gen_random_uuid();
        INSERT INTO auth.users (instance_id, id, aud, role, email, encrypted_password, email_confirmed_at, raw_app_meta_data, raw_user_meta_data, created_at, updated_at)
        VALUES ('00000000-0000-0000-0000-000000000000', curr_uid, 'authenticated', 'authenticated', 'coach@wildrobot.com', crypt('password123', gen_salt('bf')), now(), '{"provider":"email","providers":["email"]}', '{"full_name":"Main Coach"}', now(), now());
    END IF;

    -- Sync Profile (Coach)
    INSERT INTO public.profiles (id, full_name, role, max_allowed_devices)
    VALUES (curr_uid, 'Main Coach', 'coach', 2)
    ON CONFLICT (id) DO UPDATE SET role = 'coach', max_allowed_devices = 2;


    -- ====================================================
    -- USER 3: STUDENT (student@wildrobot.com)
    -- ====================================================
    curr_uid := NULL;
    SELECT id INTO curr_uid FROM auth.users WHERE email = 'student@wildrobot.com';

    IF curr_uid IS NOT NULL THEN
        UPDATE auth.users 
        SET encrypted_password = crypt('password123', gen_salt('bf')),
            raw_user_meta_data = '{"full_name":"Hero Student"}'
        WHERE id = curr_uid;
    ELSE
        curr_uid := gen_random_uuid();
        INSERT INTO auth.users (instance_id, id, aud, role, email, encrypted_password, email_confirmed_at, raw_app_meta_data, raw_user_meta_data, created_at, updated_at)
        VALUES ('00000000-0000-0000-0000-000000000000', curr_uid, 'authenticated', 'authenticated', 'student@wildrobot.com', crypt('password123', gen_salt('bf')), now(), '{"provider":"email","providers":["email"]}', '{"full_name":"Hero Student"}', now(), now());
    END IF;

    -- Sync Profile (Student/Athlete)
    INSERT INTO public.profiles (id, full_name, role, max_allowed_devices)
    VALUES (curr_uid, 'Hero Student', 'athlete', 2)
    ON CONFLICT (id) DO UPDATE SET role = 'athlete', max_allowed_devices = 2;

END $$;
</file>

<file path="supabase/universal_fix.sql">
-- ---------------------------------------------------------
-- UNIVERSAL DATABASE FIX & SEED ðŸ› ï¸
-- ---------------------------------------------------------

-- 1. Enable Required Encryption Extension (Crucial for password hashing)
CREATE EXTENSION IF NOT EXISTS "pgcrypto";

-- 2. Update Enums (Safely)
-- We run these inside a strict transaction block to catch issues.
DO $$
BEGIN
    -- Attempt to add values. 'IF NOT EXISTS' handles duplicates safely.
    ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'admin';
    ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'sales_admin';
    ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'coach';
    ALTER TYPE public.app_role ADD VALUE IF NOT EXISTS 'athlete';
EXCEPTION
    WHEN OTHERS THEN 
        RAISE NOTICE 'Enum update warning (safe to ignore if values exist): %', SQLERRM;
END $$;

-- 3. Seed/Sync Auth Users (The Source of Truth)
-- We use DO UPDATE to ensure metadata is fresh even if user exists.
INSERT INTO auth.users (
    instance_id, 
    id, 
    aud, 
    role, 
    email, 
    encrypted_password, 
    email_confirmed_at, 
    raw_app_meta_data, 
    raw_user_meta_data, 
    created_at, 
    updated_at
)
VALUES 
    ('00000000-0000-0000-0000-000000000000', 'e9dc1d40-8fa5-4334-bea9-6b9424d2705a', 'authenticated', 'authenticated', 'abdulla.smozy@gmail.com', crypt('password123', gen_salt('bf')), now(), '{"provider":"email","providers":["email"]}', '{"full_name":"Abdulla Smozy"}', now(), now()),
    ('00000000-0000-0000-0000-000000000000', gen_random_uuid(), 'authenticated', 'authenticated', 'sales@wildrobot.com', crypt('password123', gen_salt('bf')), now(), '{"provider":"email","providers":["email"]}', '{"full_name":"Sales Admin"}', now(), now()),
    ('00000000-0000-0000-0000-000000000000', gen_random_uuid(), 'authenticated', 'authenticated', 'coach@wildrobot.com', crypt('password123', gen_salt('bf')), now(), '{"provider":"email","providers":["email"]}', '{"full_name":"Main Coach"}', now(), now()),
    ('00000000-0000-0000-0000-000000000000', gen_random_uuid(), 'authenticated', 'authenticated', 'student@wildrobot.com', crypt('password123', gen_salt('bf')), now(), '{"provider":"email","providers":["email"]}', '{"full_name":"Hero Student"}', now(), now())
ON CONFLICT (email) DO UPDATE SET
    encrypted_password = EXCLUDED.encrypted_password,
    raw_user_meta_data = EXCLUDED.raw_user_meta_data,
    updated_at = now();

-- 4. Sync Profiles (The App Layer)
-- Now we are guaranteed that auth.users contains our targets.
INSERT INTO public.profiles (id, full_name, role, max_allowed_devices)
SELECT 
    id, 
    raw_user_meta_data->>'full_name',
    CASE 
        WHEN email = 'abdulla.smozy@gmail.com' THEN 'admin'::public.app_role
        WHEN email = 'sales@wildrobot.com' THEN 'sales_admin'::public.app_role
        WHEN email = 'student@wildrobot.com' THEN 'athlete'::public.app_role
        ELSE 'coach'::public.app_role
    END,
    CASE WHEN email = 'abdulla.smozy@gmail.com' THEN 10 ELSE 2 END
FROM auth.users
WHERE email IN ('abdulla.smozy@gmail.com', 'sales@wildrobot.com', 'coach@wildrobot.com', 'student@wildrobot.com')
ON CONFLICT (id) DO UPDATE 
SET 
    role = EXCLUDED.role,
    max_allowed_devices = EXCLUDED.max_allowed_devices,
    full_name = EXCLUDED.full_name;

-- 5. Verification
SELECT email, role, id FROM public.profiles WHERE email IN ('coach@wildrobot.com', 'student@wildrobot.com');
</file>

<file path="supabase/upgrade_schema_enterprise.sql">
-- UPGRADE SCHEMA: ENTERPRISE FEATURES
-- Adds support for Business Types, Currencies, and Branding

DO $$ 
BEGIN 
    -- 1. Add 'business_type' (academy vs club)
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'business_type') THEN 
        ALTER TABLE public.academies ADD COLUMN business_type text DEFAULT 'academy'; 
        -- Constraint check
        ALTER TABLE public.academies ADD CONSTRAINT check_business_type CHECK (business_type IN ('academy', 'club', 'hybrid'));
    END IF;

    -- 2. Add 'currency' (ISO Code)
    -- Note: We used 'currency' in previous fix, this ensures it exists or verifies default.
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'currency') THEN 
        ALTER TABLE public.academies ADD COLUMN currency text DEFAULT 'AED'; 
    END IF;

    -- 3. Add 'subscription_model' (Term vs Monthly)
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'subscription_model') THEN 
        ALTER TABLE public.academies ADD COLUMN subscription_model text DEFAULT 'term_based';
        -- Constraint check
        ALTER TABLE public.academies ADD CONSTRAINT check_subscription_model CHECK (subscription_model IN ('term_based', 'monthly_recurring'));
    END IF;

    -- 4. Add 'brand_color' (Theming)
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'brand_color') THEN 
        ALTER TABLE public.academies ADD COLUMN brand_color text DEFAULT '#10b981'; -- Default Emerald-500
    END IF;

    -- 5. Add 'setup_completed' (Onboarding Tracker)
    IF NOT EXISTS (SELECT 1 FROM information_schema.columns WHERE table_name = 'academies' AND column_name = 'setup_completed') THEN 
        ALTER TABLE public.academies ADD COLUMN setup_completed boolean DEFAULT false; 
    END IF;

END $$;

-- Reload Schema to update PostgREST API
NOTIFY pgrst, 'reload config';

SELECT 'Enterprise Schema Applied Successfully' as result;
</file>

<file path="tailwind.config.js">
/** @type {import('tailwindcss').Config} */
export default {
    darkMode: 'class',
    content: [
        "./index.html",
        "./src/**/*.{js,ts,jsx,tsx}",
    ],
    theme: {
        extend: {
            colors: {
                "primary": "#10b77f",
                "background-light": "#f6f8f7",
                "background-dark": "#10221c",
                "branch-ajman": "#ec4899", // Pink
                "branch-sharjah": "#3b82f6", // Blue
            },
            fontFamily: { "display": ["Lexend", "sans-serif"] }
        },
    },
    plugins: [],
}
</file>

<file path="vercel.json">
{
    "rewrites": [
        {
            "source": "/(.*)",
            "destination": "/"
        }
    ]
}
</file>

<file path="vite.config.js">
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vitejs.dev/config/
export default defineConfig({
    plugins: [react()],
    // ØªØ£ÙƒØ¯ Ø¥Ù† Ù…ÙÙŠØ´ Ø³Ø·Ø± Ø²ÙŠ base: '/app' Ù‡Ù†Ø§ØŒ Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯ Ø§Ù…Ø³Ø­Ù‡
})
</file>

<file path="package.json">
{
    "name": "wild-robot",
    "private": true,
    "version": "0.0.0",
    "type": "module",
    "scripts": {
        "dev": "vite",
        "build": "vite build",
        "lint": "eslint .",
        "preview": "vite preview"
    },
    "dependencies": {
        "@supabase/ssr": "^0.8.0",
        "@supabase/supabase-js": "^2.88.0",
        "@vercel/speed-insights": "^1.3.1",
        "ag-grid-community": "^35.0.0",
        "ag-grid-react": "^35.0.0",
        "canvas-confetti": "^1.9.4",
        "clsx": "^2.1.1",
        "date-fns": "^3.0.0",
        "framer-motion": "^12.23.26",
        "jspdf": "^3.0.4",
        "jspdf-autotable": "^5.0.2",
        "libphonenumber-js": "^1.12.33",
        "lucide-react": "^0.561.0",
        "react": "^18.2.0",
        "react-dom": "^18.2.0",
        "react-router-dom": "^6.20.0",
        "recharts": "^2.10.0",
        "sonner": "^2.0.7",
        "tailwind-merge": "^2.6.0"
    },
    "devDependencies": {
        "@types/react": "^18.2.43",
        "@types/react-dom": "^18.2.17",
        "@vitejs/plugin-react": "^4.2.1",
        "autoprefixer": "^10.4.16",
        "eslint": "^8.55.0",
        "eslint-plugin-react": "^7.33.2",
        "eslint-plugin-react-hooks": "^4.6.0",
        "eslint-plugin-react-refresh": "^0.4.5",
        "postcss": "^8.4.32",
        "tailwindcss": "^3.4.0",
        "vite": "^5.0.8"
    }
}
</file>

<file path="src/App.jsx">
import React from 'react';
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import { Toaster } from 'sonner';

// ----------------------------------------------------------------------
// 1. Imports
// ----------------------------------------------------------------------

// Auth
import Login from './pages/auth/Login';
import Signup from './pages/auth/Signup';
import MobileLogin from './pages/auth/MobileLogin';
import Pricing from './pages/auth/Pricing';
import FakeCheckout from './pages/auth/FakeCheckout';
import AuthCallback from './pages/auth/AuthCallback';
import SetupAccount from './pages/auth/SetupAccount';

// Layouts
import OwnerLayout from './layouts/OwnerLayout';
import AthleteLayout from './layouts/StudentLayout';

// Owner Pages
import OwnerDashboard from './pages/owner/OwnerDashboard';
import AcademySetup from './pages/owner/AcademySetup';
import StaffRoster from './pages/owner/StaffRoster';
import AthletesRoster from './pages/owner/AthletesRoster';

// Athlete Pages
import AthleteHome from './pages/Athlete/AthleteHome';
import Achievements from './pages/Athlete/Achievements';

// Lazy Loading
const AthleteBilling = React.lazy(() => import('./pages/Athlete/Billing'));
const AthleteSettings = React.lazy(() => import('./pages/Athlete/Settings'));

// Shared
import Landing from './pages/Landing';
import NotFound from './pages/NotFound';
import SecurityCheckpointPage from './components/SecurityCheckpoint';

// Components
import ErrorBoundary from './components/ErrorBoundary';
import CommandPalette from './components/CommandPalette';
import AuthGuard from './components/AuthGuard';
import ProtectedRoute from './components/ProtectedRoute';

function App() {
    return (
        <ErrorBoundary>
            <BrowserRouter>
                <CommandPalette />
                <Toaster position="top-center" richColors />
                <Routes>
                    {/* Public Routes */}
                    <Route path="/" element={<Landing />} />
                    <Route path="/login" element={<Login />} />
                    <Route path="/signup" element={<Signup />} />
                    <Route path="/athlete/login" element={<Navigate to="/login" replace />} />
                    <Route path="/pricing" element={<Pricing />} />
                    <Route path="/checkout" element={<FakeCheckout />} />
                    <Route path="/security-checkpoint" element={<SecurityCheckpointPage />} />

                    {/* Authentication Flow */}
                    <Route path="/auth/callback" element={<AuthCallback />} />
                    <Route path="/auth/setup-account" element={<SetupAccount />} />

                    {/* -----------------------------------------------------------------
                        ðŸ›¡ï¸ OWNER SETUP ZONE
                        Special Route: Allows access even if setup is incomplete.
                        Prop: allowSetup={true}
                    ----------------------------------------------------------------- */}
                    <Route element={<ProtectedRoute allowSetup={true} />}>
                        <Route path="/setup" element={<AcademySetup />} />
                    </Route>

                    {/* -----------------------------------------------------------------
                        ðŸ° OWNER KINGDOM
                        Standard Protection: Requires Setup to be complete.
                        Guard will redirect to /setup if not done.
                        Switching to /owner layout immediately.
                    ----------------------------------------------------------------- */}
                    <Route element={<ProtectedRoute />}>
                        <Route path="/owner" element={<OwnerLayout />}>
                            <Route index element={<Navigate to="/owner/dashboard" replace />} />
                            <Route path="dashboard" element={<OwnerDashboard />} />

                            {/* Modules */}
                            <Route path="academy" element={<div className="p-10 font-bold text-slate-400 text-center">Academy Management</div>} />
                            <Route path="staff" element={<StaffRoster />} />
                            <Route path="finance" element={<div className="p-10 font-bold text-slate-400 text-center">Treasury & Finance</div>} />
                            <Route path="athletes" element={<AthletesRoster />} />
                            <Route path="schedule" element={<div className="p-10 font-bold text-slate-400 text-center">Class Schedule</div>} />
                            <Route path="settings" element={<div className="p-10 font-bold text-slate-400 text-center">System Settings</div>} />
                        </Route>
                    </Route>

                    {/* COACH ZONE - Placeholder */}
                    <Route path="/coach" element={<ProtectedRoute />}>
                        <Route path="*" element={<Navigate to="/owner/dashboard" replace />} />
                    </Route>

                    {/* ðŸ”„ Legacy Redirects */}
                    <Route path="/student/*" element={<Navigate to="/athlete" replace />} />

                    {/* ðŸ… ATHLETE DASHBOARD */}
                    <Route path="/athlete" element={
                        <AuthGuard>
                            <AthleteLayout />
                        </AuthGuard>
                    }>
                        <Route index element={<AthleteHome />} />
                        <Route path="achievements" element={<Achievements />} />

                        <Route path="billing" element={
                            <React.Suspense fallback={<div>Loading...</div>}>
                                <AthleteBilling />
                            </React.Suspense>
                        } />

                        <Route path="settings" element={
                            <React.Suspense fallback={<div>Loading...</div>}>
                                <AthleteSettings />
                            </React.Suspense>
                        } />
                    </Route>

                    <Route path="*" element={<NotFound />} />
                </Routes>
            </BrowserRouter>
        </ErrorBoundary>
    );
}

export default App;
</file>

<file path="src/main.jsx">
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App.jsx'
import './index.css'

import { ThemeProvider } from './context/ThemeContext'
import { UserProvider } from './context/UserContext'

ReactDOM.createRoot(document.getElementById('root')).render(
    <React.StrictMode>
        <UserProvider>
            <ThemeProvider>
                <App />
            </ThemeProvider>
        </UserProvider>
    </React.StrictMode>,
)
</file>

<file path="src/pages/auth/Signup.jsx">
import React, { useState } from 'react';
import { Link, useNavigate } from 'react-router-dom';
import { motion, AnimatePresence } from 'framer-motion';
import { Mail, Lock, User, ArrowRight, CheckCircle, AlertCircle, Loader2, Star, ShieldCheck } from 'lucide-react';
import { supabase } from '../../supabaseClient';

const Signup = () => {
    const navigate = useNavigate();
    const [loading, setLoading] = useState(false);
    const [errorMsg, setErrorMsg] = useState(null);

    const [formData, setFormData] = useState({
        firstName: '',
        lastName: '',
        email: '',
        password: ''
    });

    const handleChange = (e) => {
        setFormData({ ...formData, [e.target.name]: e.target.value });
    };

    const handleSignup = async (e) => {
        e.preventDefault();
        setLoading(true);
        setErrorMsg(null);

        try {
            const fullName = `${formData.firstName} ${formData.lastName}`.trim();

            const { data, error } = await supabase.auth.signUp({
                email: formData.email,
                password: formData.password,
                options: {
                    data: {
                        full_name: fullName,
                        first_name: formData.firstName,
                        last_name: formData.lastName,
                        role: 'owner'
                    }
                }
            });

            if (error) throw error;

            if (data.user) {
                // Success! Redirect to Owner Dashboard
                navigate('/owner/dashboard');
            }

        } catch (error) {
            console.error("Signup Error:", error);
            setErrorMsg(error.message);
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="min-h-screen bg-white md:bg-slate-50 flex font-sans">

            {/* --- LEFT SIDE: FEATURE SHOWCASE (Hidden on mobile) --- */}
            <div className="hidden md:flex md:w-1/2 lg:w-5/12 bg-slate-900 relative overflow-hidden flex-col justify-between p-12 text-white">

                {/* Background FX */}
                <div className="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 pointer-events-none"></div>
                <div className="absolute top-[-20%] right-[-20%] w-[80%] h-[80%] bg-emerald-600/20 rounded-full blur-[120px]"></div>
                <div className="absolute bottom-[-20%] left-[-20%] w-[80%] h-[80%] bg-blue-600/20 rounded-full blur-[120px]"></div>

                {/* Brand */}
                <div className="relative z-10 flex items-center gap-3">
                    <div className="bg-emerald-500 rounded-lg p-1.5">
                        <ShieldCheck className="w-5 h-5 text-white" />
                    </div>
                    <span className="font-bold text-lg tracking-tight">Wild Robot</span>
                </div>

                {/* Main Content */}
                <div className="relative z-10 space-y-8">
                    <h1 className="text-4xl lg:text-5xl font-black leading-tight">
                        A small step for you, <br />
                        a <span className="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-teal-300">giant leap</span> for your team.
                    </h1>

                    <div className="space-y-4">
                        <div className="flex items-center gap-4 text-slate-300 font-medium text-lg">
                            <div className="p-1 rounded-full bg-emerald-500/20 text-emerald-400"><CheckCircle size={20} /></div>
                            Automated Scheduling
                        </div>
                        <div className="flex items-center gap-4 text-slate-300 font-medium text-lg">
                            <div className="p-1 rounded-full bg-emerald-500/20 text-emerald-400"><CheckCircle size={20} /></div>
                            Skill Tracking & Reports
                        </div>
                        <div className="flex items-center gap-4 text-slate-300 font-medium text-lg">
                            <div className="p-1 rounded-full bg-emerald-500/20 text-emerald-400"><CheckCircle size={20} /></div>
                            Payroll & Invoicing
                        </div>
                    </div>
                </div>

                {/* Footer Quote */}
                <div className="relative z-10 bg-slate-800/50 backdrop-blur-md p-6 rounded-2xl border border-slate-700">
                    <div className="flex gap-1 mb-3 text-amber-400">
                        <Star size={16} fill="currentColor" />
                        <Star size={16} fill="currentColor" />
                        <Star size={16} fill="currentColor" />
                        <Star size={16} fill="currentColor" />
                        <Star size={16} fill="currentColor" />
                    </div>
                    <p className="text-slate-300 italic mb-4">"This platform completely transformed how we run our gymnastics academy. It's like having a superpower."</p>
                    <div className="flex items-center gap-3">
                        <div className="w-10 h-10 rounded-full bg-indigo-500 flex items-center justify-center font-bold text-white">SJ</div>
                        <div>
                            <p className="font-bold text-white text-sm">Sarah Jenkins</p>
                            <p className="text-slate-400 text-xs">Head Coach, Elite Gym</p>
                        </div>
                    </div>
                </div>
            </div>

            {/* --- RIGHT SIDE: FORM --- */}
            <div className="w-full md:w-1/2 lg:w-7/12 flex items-center justify-center p-6 md:p-12 relative">
                <div className="w-full max-w-md space-y-8">

                    <div className="text-center md:text-left">
                        <h2 className="text-3xl font-black text-slate-900 mb-2">Create your account</h2>
                        <p className="text-slate-500 font-medium">Start your 14-day free trial. No credit card required.</p>
                    </div>

                    {/* Error Display */}
                    <AnimatePresence>
                        {errorMsg && (
                            <motion.div
                                initial={{ opacity: 0, height: 0 }}
                                animate={{ opacity: 1, height: 'auto' }}
                                exit={{ opacity: 0, height: 0 }}
                                className="bg-red-50 text-red-600 border border-red-200 p-4 rounded-xl flex gap-3 items-start text-sm font-bold"
                            >
                                <AlertCircle size={18} className="shrink-0 mt-0.5" />
                                {errorMsg}
                            </motion.div>
                        )}
                    </AnimatePresence>

                    <form onSubmit={handleSignup} className="space-y-6">

                        {/* Name Row */}
                        <div className="grid grid-cols-2 gap-4">
                            <div className="space-y-1">
                                <label className="text-sm font-bold text-slate-700">First Name</label>
                                <input
                                    type="text"
                                    name="firstName"
                                    value={formData.firstName}
                                    onChange={handleChange}
                                    placeholder="John"
                                    className="w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-medium text-slate-900 placeholder:text-slate-300 bg-slate-50 focus:bg-white"
                                    required
                                />
                            </div>
                            <div className="space-y-1">
                                <label className="text-sm font-bold text-slate-700">Last Name</label>
                                <input
                                    type="text"
                                    name="lastName"
                                    value={formData.lastName}
                                    onChange={handleChange}
                                    placeholder="Doe"
                                    className="w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-medium text-slate-900 placeholder:text-slate-300 bg-slate-50 focus:bg-white"
                                    required
                                />
                            </div>
                        </div>

                        {/* Email */}
                        <div className="space-y-1">
                            <label className="text-sm font-bold text-slate-700">Business Email</label>
                            <input
                                type="email"
                                name="email"
                                value={formData.email}
                                onChange={handleChange}
                                placeholder="name@company.com"
                                className="w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-medium text-slate-900 placeholder:text-slate-300 bg-slate-50 focus:bg-white"
                                required
                            />
                        </div>

                        {/* Password */}
                        <div className="space-y-1">
                            <label className="text-sm font-bold text-slate-700">Create Password</label>
                            <input
                                type="password"
                                name="password"
                                value={formData.password}
                                onChange={handleChange}
                                placeholder="Min 8 characters"
                                minLength={8}
                                className="w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-medium text-slate-900 placeholder:text-slate-300 bg-slate-50 focus:bg-white"
                                required
                            />
                        </div>

                        <button
                            type="submit"
                            disabled={loading}
                            className="w-full py-4 text-lg font-bold text-white bg-emerald-600 hover:bg-emerald-500 active:scale-[0.98] rounded-2xl shadow-lg shadow-emerald-500/30 transition-all flex items-center justify-center gap-2"
                        >
                            {loading ? <Loader2 className="animate-spin" /> : <>GET STARTED <ArrowRight size={20} /></>}
                        </button>
                    </form>

                    <div className="text-center">
                        <p className="text-slate-500 font-medium">
                            Already have an account? <Link to="/login" className="text-emerald-600 font-bold hover:underline">Log in</Link>
                        </p>
                    </div>

                </div>
            </div>
        </div>
    );
};

export default Signup;
</file>

<file path="src/pages/coach/Roster.jsx">
import React, { useState, useEffect } from 'react';
import { motion } from 'framer-motion';
import { Search, Filter, Plus, Users, MoreHorizontal, Mail, Phone, UserPlus } from 'lucide-react';
import { supabase } from '../../supabaseClient';
import AddAthleteModal from '../../components/AddAthleteModal';

export default function Roster() {
    const [loading, setLoading] = useState(true);
    const [athletes, setAthletes] = useState([]);
    const [filterName, setFilterName] = useState('');
    const [coachProfile, setCoachProfile] = useState(null);
    const [isModalOpen, setIsModalOpen] = useState(false);

    useEffect(() => {
        fetchRoster();
    }, []);

    const fetchRoster = async () => {
        setLoading(true);
        try {
            // 1. Get Current Coach Info (needed for academy_name)
            const { data: { user } } = await supabase.auth.getUser();
            if (!user) return;

            const { data: profile } = await supabase
                .from('profiles')
                .select('academy_name')
                .eq('id', user.id)
                .single();

            // Fallback for metadata if profile incomplete
            const academyName = profile?.academy_name || user.user_metadata?.academy_name;
            setCoachProfile({ ...profile, academy_name: academyName });

            if (academyName) {
                // 2. Fetch Athletes linked to this Academy
                const { data: athleteData, error } = await supabase
                    .from('profiles')
                    .select('*')
                    .eq('role', 'athlete')
                    .eq('academy_name', academyName)
                    .order('full_name', { ascending: true });

                if (error) throw error;
                setAthletes(athleteData || []);
            }
        } catch (error) {
            console.error('Error fetching roster:', error);
        } finally {
            setLoading(false);
        }
    };

    // Filtering
    const filteredAthletes = athletes.filter(p =>
        (p.full_name || '').toLowerCase().includes(filterName.toLowerCase()) ||
        (p.email || '').toLowerCase().includes(filterName.toLowerCase())
    );

    return (
        <div className="min-h-screen bg-slate-50 font-sans p-4 sm:p-6 lg:p-8">

            {/* --- HEADER --- */}
            <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8">
                <div>
                    <h1 className="text-2xl font-black text-slate-900 flex items-center gap-3">
                        <Users className="text-emerald-600" size={28} />
                        My Athletes
                    </h1>
                    <p className="text-slate-500 font-medium mt-1">
                        Managing {athletes.length} profiles for <span className="text-emerald-600 font-bold">{coachProfile?.academy_name || 'Your Academy'}</span>
                    </p>
                </div>
                <button
                    onClick={() => setIsModalOpen(true)}
                    className="bg-emerald-600 hover:bg-emerald-500 text-white px-5 py-3 rounded-xl font-bold shadow-lg shadow-emerald-200 transition-all hover:-translate-y-0.5 flex items-center gap-2"
                >
                    <Plus size={20} />
                    Add Athlete
                </button>
            </div>

            {/* --- TOOLBAR --- */}
            <div className="bg-white p-4 rounded-2xl border border-slate-200 shadow-sm mb-6 flex flex-col sm:flex-row gap-4">
                <div className="relative flex-1">
                    <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" size={20} />
                    <input
                        type="text"
                        placeholder="Search athletes by name or email..."
                        value={filterName}
                        onChange={(e) => setFilterName(e.target.value)}
                        className="w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500/20 font-medium"
                    />
                </div>
                <button className="px-4 py-2.5 border border-slate-200 rounded-xl font-bold text-slate-600 hover:bg-slate-50 flex items-center gap-2">
                    <Filter size={18} />
                    Filter
                </button>
            </div>

            {/* --- CONTENT --- */}
            {loading ? (
                <div className="py-20 flex justify-center">
                    <div className="w-10 h-10 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"></div>
                </div>
            ) : athletes.length === 0 ? (

                /* --- EMPTY STATE --- */
                <div className="bg-white rounded-3xl border border-slate-200 border-dashed p-12 text-center flex flex-col items-center justify-center min-h-[400px]">
                    <div className="w-20 h-20 bg-slate-50 rounded-full flex items-center justify-center mb-6">
                        <UserPlus className="w-10 h-10 text-slate-300" />
                    </div>
                    <h3 className="text-2xl font-black text-slate-900 mb-2">No Athletes Yet</h3>
                    <p className="text-slate-500 max-w-sm mx-auto mb-8 font-medium">
                        Your roster is looking a bit empty. Add your first athlete to start tracking their progress directly in Wild Robot.
                    </p>
                    <button
                        onClick={() => setIsModalOpen(true)}
                        className="px-8 py-3 bg-emerald-600 hover:bg-emerald-500 text-white font-bold rounded-xl shadow-lg shadow-emerald-200 transition-all hover:-translate-y-1"
                    >
                        Add First Athlete
                    </button>
                </div>

            ) : (

                /* --- GRID VIEW --- */
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                    {filteredAthletes.map((athlete) => (
                        <motion.div
                            key={athlete.id}
                            initial={{ opacity: 0, y: 10 }}
                            animate={{ opacity: 1, y: 0 }}
                            className="bg-white rounded-2xl border border-slate-200 p-5 shadow-sm hover:shadow-md transition-shadow group relative"
                        >
                            <div className="flex items-start justify-between mb-4">
                                <div className="w-12 h-12 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-700 font-bold text-lg">
                                    {athlete.full_name?.charAt(0) || 'A'}
                                </div>
                                <button className="text-slate-300 hover:text-slate-600">
                                    <MoreHorizontal size={20} />
                                </button>
                            </div>

                            <h3 className="font-bold text-slate-900 text-lg truncate mb-1">{athlete.full_name || 'Unnamed Athlete'}</h3>

                            <div className="space-y-2 mb-4">
                                <div className="flex items-center gap-2 text-sm text-slate-500">
                                    <Mail size={14} />
                                    <span className="truncate">{athlete.email}</span>
                                </div>
                                {athlete.phone && (
                                    <div className="flex items-center gap-2 text-sm text-slate-500">
                                        <Phone size={14} />
                                        <span className="truncate">{athlete.phone}</span>
                                    </div>
                                )}
                            </div>

                            <div className="pt-4 border-t border-slate-50 flex items-center justify-between">
                                <span className="px-2 py-1 rounded bg-slate-100 text-xs font-bold text-slate-600 uppercase tracking-wide">
                                    {athlete.level || 'Bronze'}
                                </span>
                                <span className="flex items-center gap-1 text-xs font-bold text-emerald-600">
                                    Active
                                    <span className="w-2 h-2 rounded-full bg-emerald-500 relative">
                                        <span className="absolute inset-0 rounded-full bg-emerald-500 animate-ping opacity-50"></span>
                                    </span>
                                </span>
                            </div>
                        </motion.div>
                    ))}
                </div>
            )}

            {/* --- MODAL --- */}
            <AddAthleteModal
                isOpen={isModalOpen}
                onClose={() => setIsModalOpen(false)}
                academyName={coachProfile?.academy_name}
                onSuccess={() => fetchRoster()}
            />

        </div>
    );
}
</file>

<file path="src/pages/auth/Login.jsx">
import React, { useState, useEffect } from 'react';
import { Link, useNavigate, useLocation } from 'react-router-dom';
import { motion, AnimatePresence } from 'framer-motion';
import { Lock, Mail, ArrowRight, AlertCircle, CheckSquare, User, Zap, Trophy, ShieldCheck, UserCheck, Shield, ChevronLeft } from 'lucide-react';
import { supabase } from '../../supabaseClient';

// Using consistent branding colors
const THEME = {
    COACH: {
        primary: 'emerald',
        bg: 'from-emerald-500/20 to-teal-500/20',
        text: 'text-emerald-500',
        border: 'border-emerald-500/30',
        hoverBorder: 'hover:border-emerald-400',
        gradient: 'from-emerald-600 to-teal-600',
        icon: ShieldCheck
    },
    ATHLETE: {
        primary: 'blue',
        bg: 'from-blue-500/20 to-indigo-500/20',
        text: 'text-blue-500',
        border: 'border-blue-500/30',
        hoverBorder: 'hover:border-blue-400',
        gradient: 'from-blue-600 to-indigo-600',
        icon: Zap
    }
};

const Login = () => {
    const navigate = useNavigate();
    const location = useLocation();

    // State
    const [mode, setMode] = useState(null); // null (selection) | 'coach' | 'athlete'
    const [email, setEmail] = useState('');
    const [password, setPassword] = useState('');
    const [loading, setLoading] = useState(false);
    const [authChecking, setAuthChecking] = useState(true);
    const [errorMsg, setErrorMsg] = useState(null);
    const [rememberMe, setRememberMe] = useState(true);

    // Initial Auth Check
    useEffect(() => {
        const checkSession = async () => {
            const { data: { session } } = await supabase.auth.getSession();
            if (session) {
                // Verify role and redirect immediately
                const { data: profile } = await supabase
                    .from('profiles')
                    .select('role')
                    .eq('id', session.user.id)
                    .single();

                const userRole = profile?.role || 'coach';

                if (userRole === 'athlete') {
                    navigate('/athlete', { replace: true });
                } else {
                    // Let the Traffic Cop (ProtectedRoute) decide where they go
                    navigate('/owner/dashboard', { replace: true });
                }
            } else {
                setAuthChecking(false);
            }
        };

        // Handle error messages from redirects
        if (location.state?.error) {
            setErrorMsg(location.state.error);
            window.history.replaceState({}, document.title);
        }

        checkSession();
    }, [navigate, location]);

    const handleLogin = async (e) => {
        e.preventDefault();
        setLoading(true);
        setErrorMsg(null);

        try {
            // 1. Sign In
            const { data, error } = await supabase.auth.signInWithPassword({
                email,
                password,
            });

            if (error) throw error;

            // 2. Role Check
            const uid = data.user.id;
            let { data: profile } = await supabase
                .from('profiles')
                .select('role')
                .eq('id', uid)
                .single();

            if (!profile) {
                // FALLBACK: If RLS blocks profile read or it doesn't exist, check User Metadata.
                // This prevents "User Profile Missing" lockout for valid Auth users.
                const metaRole = data.user.user_metadata?.role;
                if (metaRole) {
                    // We found a role in metadata, let's use it temporarily
                    console.warn("Profile missing, using metadata fallback.");
                    profile = { role: metaRole };
                } else {
                    throw new Error("SYSTEM ERROR: User profile missing and no metadata role found.");
                }
            }

            const userRole = profile.role;

            // 3. Gatekeeper Logic
            if (mode === 'athlete' && userRole !== 'athlete') {
                await supabase.auth.signOut();
                throw new Error("ACCESS DENIED: Coach account detected. Please use the Coach Portal.");
            }

            if (mode === 'coach' && userRole === 'athlete') {
                await supabase.auth.signOut();
                throw new Error("ACCESS DENIED: Athlete account detected. Please use the Athlete Portal.");
            }

            // 4. Success Redirect
            if (userRole === 'athlete') {
                navigate('/athlete');
            } else {
                // Check if Academy is set up
                // Let the Guard handle the setup check
                navigate('/owner/dashboard');
            }

        } catch (error) {
            console.error("Login Error:", error);
            setErrorMsg(error.message);
            // Shake effect or visual feedback could be added here
        } finally {
            setLoading(false);
        }
    };

    if (authChecking) return null; // Or a loading spinner

    // Render Helpers
    const isAthlete = mode === 'athlete';
    const activeTheme = isAthlete ? THEME.ATHLETE : THEME.COACH;

    return (
        <div className="min-h-screen bg-slate-950 flex items-center justify-center p-4 font-sans relative overflow-hidden select-none">

            {/* AMBIENT BACKGROUND */}
            <div className="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 pointer-events-none"></div>
            <div className="absolute top-[-20%] left-[-10%] w-[50%] h-[50%] bg-blue-600/10 rounded-full blur-[150px] pointer-events-none"></div>
            <div className="absolute bottom-[-20%] right-[-10%] w-[50%] h-[50%] bg-emerald-600/10 rounded-full blur-[150px] pointer-events-none"></div>

            <div className="w-full max-w-md relative z-10">

                {/* HEADLINE (Only show in selection mode or transition it) */}
                <AnimatePresence mode="wait">
                    {!mode && (
                        <motion.div
                            initial={{ opacity: 0, y: -20 }}
                            animate={{ opacity: 1, y: 0 }}
                            exit={{ opacity: 0, y: -20 }}
                            className="text-center mb-10"
                        >
                            <div className="inline-block p-3 rounded-2xl bg-slate-900 border border-slate-800 shadow-xl mb-4">
                                <Trophy className="w-8 h-8 text-white" />
                            </div>
                            <h1 className="text-4xl font-black text-white tracking-tight mb-2">Welcome Back.</h1>
                            <p className="text-slate-400 font-medium">Select your portal to continue.</p>
                        </motion.div>
                    )}
                </AnimatePresence>

                {/* ERROR TOAST */}
                <AnimatePresence>
                    {errorMsg && (
                        <motion.div
                            initial={{ opacity: 0, scale: 0.9 }}
                            animate={{ opacity: 1, scale: 1 }}
                            exit={{ opacity: 0 }}
                            className="mb-6 p-4 bg-red-500/10 border border-red-500/50 rounded-xl flex items-center gap-3 text-red-400 text-sm font-bold shadow-lg"
                        >
                            <AlertCircle size={18} />
                            {errorMsg}
                            <button onClick={() => setErrorMsg(null)} className="ml-auto opacity-50 hover:opacity-100">âœ•</button>
                        </motion.div>
                    )}
                </AnimatePresence>

                <AnimatePresence mode="wait">

                    {/* --- VIEW 1: SELECTION CARDS --- */}
                    {!mode ? (
                        <motion.div
                            key="selection"
                            initial={{ opacity: 0, scale: 0.95 }}
                            animate={{ opacity: 1, scale: 1 }}
                            exit={{ opacity: 0, scale: 0.95, transition: { duration: 0.2 } }}
                            className="grid gap-4"
                        >
                            {/* COACH CARD */}
                            <button
                                onClick={() => setMode('coach')}
                                className="group relative bg-slate-900/50 hover:bg-slate-900 border border-slate-800 hover:border-emerald-500/50 p-6 rounded-2xl text-left transition-all duration-300 hover:shadow-2xl hover:shadow-emerald-900/20 hover:-translate-y-1"
                            >
                                <div className="absolute inset-0 bg-gradient-to-r from-transparent via-transparent to-emerald-500/5 opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl" />
                                <div className="flex items-center justify-between pointer-events-none">
                                    <div className="flex items-center gap-4">
                                        <div className="w-12 h-12 rounded-xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 group-hover:bg-emerald-500 group-hover:text-white transition-all">
                                            <ShieldCheck className="w-6 h-6" />
                                        </div>
                                        <div>
                                            <h3 className="text-lg font-bold text-white group-hover:text-emerald-400 transition-colors">Staff Portal</h3>
                                            <p className="text-slate-500 text-xs font-medium">Management & Operations Dashboard</p>
                                        </div>
                                    </div>
                                    <ArrowRight className="text-slate-600 group-hover:text-emerald-500 group-hover:translate-x-1 transition-all" />
                                </div>
                            </button>

                            {/* ATHLETE CARD */}
                            <button
                                onClick={() => setMode('athlete')}
                                className="group relative bg-slate-900/50 hover:bg-slate-900 border border-slate-800 hover:border-blue-500/50 p-6 rounded-2xl text-left transition-all duration-300 hover:shadow-2xl hover:shadow-blue-900/20 hover:-translate-y-1"
                            >
                                <div className="absolute inset-0 bg-gradient-to-r from-transparent via-transparent to-blue-500/5 opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl" />
                                <div className="flex items-center justify-between pointer-events-none">
                                    <div className="flex items-center gap-4">
                                        <div className="w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center text-blue-500 group-hover:bg-blue-500 group-hover:text-white transition-all">
                                            <Zap className="w-6 h-6" />
                                        </div>
                                        <div>
                                            <h3 className="text-lg font-bold text-white group-hover:text-blue-400 transition-colors">Athlete Portal</h3>
                                            <p className="text-slate-500 text-xs font-medium">Training & Progress</p>
                                        </div>
                                    </div>
                                    <ArrowRight className="text-slate-600 group-hover:text-blue-500 group-hover:translate-x-1 transition-all" />
                                </div>
                            </button>

                            <div className="mt-8 text-center">
                                <Link to="/" className="text-xs font-bold text-slate-600 hover:text-white transition-colors uppercase tracking-widest">
                                    â† Return to Home
                                </Link>
                            </div>
                        </motion.div>
                    ) : (

                        /* --- VIEW 2: LOGIN FORM --- */
                        <motion.div
                            key="login-form"
                            initial={{ opacity: 0, x: 50 }}
                            animate={{ opacity: 1, x: 0 }}
                            exit={{ opacity: 0, x: 50 }}
                            className="bg-slate-900/80 backdrop-blur-xl border border-slate-800 rounded-3xl p-8 shadow-2xl relative overflow-hidden"
                        >
                            {/* DECORATIVE TOP BORDER */}
                            <div className={`absolute top-0 left-0 right-0 h-1 bg-gradient-to-r ${activeTheme.gradient}`}></div>

                            {/* BACK BUTTON */}
                            <button
                                onClick={() => { setErrorMsg(null); setMode(null); }}
                                className="flex items-center gap-2 text-slate-500 hover:text-white text-xs font-bold uppercase tracking-wider mb-6 transition-colors"
                            >
                                <ChevronLeft size={16} /> Back
                            </button>

                            {/* HEADER */}
                            <div className="mb-8">
                                <h2 className="text-2xl font-black text-white mb-2 flex items-center gap-3">
                                    <activeTheme.icon className={`w-8 h-8 ${activeTheme.text}`} />
                                    {isAthlete ? 'Athlete Access' : 'Welcome Back'}
                                </h2>
                                <p className="text-slate-400 text-sm">
                                    Enter your credentials to access the
                                    <span className={`font-bold ${activeTheme.text}`}> Workspace</span>.
                                </p>
                            </div>

                            {/* FORM */}
                            <form onSubmit={handleLogin} className="space-y-5">
                                <div className="space-y-2">
                                    <label className="text-xs font-bold text-slate-400 uppercase tracking-widest pl-1">Email</label>
                                    <div className="relative group">
                                        <Mail className={`absolute left-4 top-3.5 w-5 h-5 text-slate-500 group-focus-within:${activeTheme.text} transition-colors`} />
                                        <input
                                            type="email"
                                            value={email}
                                            onChange={(e) => setEmail(e.target.value)}
                                            className="w-full bg-slate-800/50 border border-slate-700 rounded-xl py-3 pl-12 pr-4 text-white placeholder-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 transition-all font-medium"
                                            style={{ '--tw-ring-color': isAthlete ? '#3b82f6' : '#10b981' }}
                                            placeholder="name@wildrobot.com"
                                            required
                                        />
                                    </div>
                                </div>

                                <div className="space-y-2">
                                    <label className="text-xs font-bold text-slate-400 uppercase tracking-widest pl-1">Password</label>
                                    <div className="relative group">
                                        <Lock className={`absolute left-4 top-3.5 w-5 h-5 text-slate-500 group-focus-within:${activeTheme.text} transition-colors`} />
                                        <input
                                            type="password"
                                            value={password}
                                            onChange={(e) => setPassword(e.target.value)}
                                            className="w-full bg-slate-800/50 border border-slate-700 rounded-xl py-3 pl-12 pr-4 text-white placeholder-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 transition-all font-medium"
                                            style={{ '--tw-ring-color': isAthlete ? '#3b82f6' : '#10b981' }}
                                            placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                                            required
                                        />
                                    </div>
                                </div>

                                <button
                                    type="submit"
                                    disabled={loading}
                                    className={`w-full py-4 rounded-xl font-bold text-white shadow-lg bg-gradient-to-r ${activeTheme.gradient} hover:brightness-110 active:scale-[0.98] transition-all flex items-center justify-center gap-2`}
                                >
                                    {loading ? (
                                        <div className="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin" />
                                    ) : (
                                        <>
                                            Sign In <ArrowRight size={18} />
                                        </>
                                    )}
                                </button>
                            </form>

                            <div className="mt-8 text-center space-y-4">
                                <Link to="/forgot-password" className="text-sm font-medium text-slate-500 hover:text-white transition-colors block">
                                    Forgot your password?
                                </Link>
                                {!isAthlete && (
                                    <p className="text-sm text-slate-500">
                                        No account? <Link to="/signup" className="text-emerald-500 font-bold hover:underline">Create Academy</Link>
                                    </p>
                                )}
                            </div>

                        </motion.div>
                    )}
                </AnimatePresence>

            </div>

            <div className="absolute bottom-6 text-center w-full text-slate-700 text-[10px] font-mono tracking-widest opacity-50">
                WILD ROBOT SYSTEM v3.1  //  SECURE CONNECTION ESTABLISHED
            </div>
        </div>
    );
};

export default Login;
</file>

</files>
